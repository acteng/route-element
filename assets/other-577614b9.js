import{a0 as ee,a1 as te,a2 as j,w as B,e as d,x as E,t as _,a3 as ne,S as G,i as J,s as O,A as le,a4 as oe,B as re,E as se,H as z,c as v,J as S,r as M,m as w,v as k,Y as L,y as h,f as C,I as Q,M as ae,b as q,a as K,d as T,G as y,K as D,N as b,h as ie,$ as N,a5 as ce,u as ue,j as fe,k as pe,l as _e,U as me,R as X,X as I,W as A,Z as Y,_ as de,O as ge,T as ke,Q as V,P as he}from"./Layout-b626fc7f.js";function be(o,e){const n=e.token={};function t(i,s,l,a){if(e.token!==n)return;e.resolved=a;let r=e.ctx;l!==void 0&&(r=r.slice(),r[l]=a);const f=i&&(e.current=i)(r);let c=!1;e.block&&(e.blocks?e.blocks.forEach((p,u)=>{u!==s&&p&&(B(),d(p,1,1,()=>{e.blocks[u]===p&&(e.blocks[u]=null)}),E())}):e.block.d(1),f.c(),_(f,1),f.m(e.mount(),e.anchor),c=!0),e.block=f,e.blocks&&(e.blocks[s]=f),c&&ne()}if(ee(o)){const i=te();if(o.then(s=>{j(i),t(e.then,1,e.value,s),j(null)},s=>{if(j(i),t(e.catch,2,e.error,s),j(null),!e.hasCatch)throw s}),e.current!==e.pending)return t(e.pending,0),!0}else{if(e.current!==e.then)return t(e.then,1,e.value,o),!0;e.resolved=o}}function $e(o,e,n){const t=e.slice(),{resolved:i}=o;o.current===o.then&&(t[o.value]=i),o.current===o.catch&&(t[o.error]=i),o.block.p(t,n)}function ye(o,e,n){let t;const i=le();let{layer:s=void 0}=e;const{map:l}=oe();re(o,l,c=>n(2,t=c));function a(c){i(c.type,{...c,map:l})}const r=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu","mouseover","mouseout"],f=["click","dblclick","contextmenu","mousemove","movestart","moveend","zoomstart","zoom","zoomend"];return se(()=>{if(t)if(s)for(const c of r)t.off(c,s,a);else for(const c of f)t.off(c,a)}),o.$$set=c=>{"layer"in c&&n(1,s=c.layer)},o.$$.update=()=>{if(o.$$.dirty&6&&t)if(s)for(const c of r)t.on(c,s,a);else for(const c of f)t.on(c,a)},[l,s,t]}class ve extends G{constructor(e){super(),J(this,e,ye,null,O,{layer:1})}}function P(o,e,n){const t=o.slice();return t[5]=e[n],t[6]=e,t[7]=n,t}function we(o){let e,n;return{c(){e=y("span"),n=S(),D(e,"class","dot svelte-1lzmzqo")},m(t,i){k(t,e,i),k(t,n,i)},p:b,d(t){t&&(h(e),h(n))}}}function R(o){let e,n,t;function i(l){o[4](l,o[5],o[6],o[7])}let s={draggable:!0,$$slots:{default:[we]},$$scope:{ctx:o}};return o[5]!==void 0&&(s.lngLat=o[5]),e=new ae({props:s}),q.push(()=>K(e,"lngLat",i)),{c(){v(e.$$.fragment)},m(l,a){w(e,l,a),t=!0},p(l,a){o=l;const r={};a&256&&(r.$$scope={dirty:a,ctx:o}),!n&&a&1&&(n=!0,r.lngLat=o[5],T(()=>n=!1)),e.$set(r)},i(l){t||(_(e.$$.fragment,l),t=!0)},o(l){d(e.$$.fragment,l),t=!1},d(l){C(e,l)}}}function Ce(o){let e,n,t,i,s,l;e=new ve({}),e.$on("click",o[1]);let a=z(o[0].geometry.coordinates),r=[];for(let c=0;c<a.length;c+=1)r[c]=R(P(o,a,c));const f=c=>d(r[c],1,1,()=>{r[c]=null});return{c(){v(e.$$.fragment),n=S();for(let c=0;c<r.length;c+=1)r[c].c();t=M()},m(c,p){w(e,c,p),k(c,n,p);for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(c,p);k(c,t,p),i=!0,s||(l=L(window,"keydown",o[2]),s=!0)},p(c,[p]){if(p&1){a=z(c[0].geometry.coordinates);let u;for(u=0;u<a.length;u+=1){const g=P(c,a,u);r[u]?(r[u].p(g,p),_(r[u],1)):(r[u]=R(g),r[u].c(),_(r[u],1),r[u].m(t.parentNode,t))}for(B(),u=a.length;u<r.length;u+=1)f(u);E()}},i(c){if(!i){_(e.$$.fragment,c);for(let p=0;p<a.length;p+=1)_(r[p]);i=!0}},o(c){d(e.$$.fragment,c),r=r.filter(Boolean);for(let p=0;p<r.length;p+=1)d(r[p]);i=!1},d(c){c&&(h(n),h(t)),C(e,c),Q(r,c),s=!1,l()}}}function Se(o,e,n){let{f:t}=e,{onDone:i}=e;function s(r){t.geometry.coordinates.push(r.detail.lngLat.toArray()),n(0,t)}function l(r){r.key=="Enter"&&i()}function a(r,f,c,p){c[p]=r,n(0,t)}return o.$$set=r=>{"f"in r&&n(0,t=r.f),"onDone"in r&&n(3,i=r.onDone)},[t,s,l,i,a]}class Le extends G{constructor(e){super(),J(this,e,Se,Ce,O,{f:0,onDone:3})}}let U="MZEJTanw3WpxRvt7qDfo";async function Be(o){return o?{version:8,sources:{"raster-tiles":{type:"raster",tiles:[`https://tile.googleapis.com/v1/2dtiles/{z}/{x}/{y}?session=${await Ee(o)}&key=${o}`],tileSize:256,attribution:"Google (detailed attributions not wired up)"}},layers:[{id:"raster-basemap",type:"raster",source:"raster-tiles"}],glyphs:`https://api.maptiler.com/fonts/{fontstack}/{range}.pbf?key=${U}`}:`https://api.maptiler.com/maps/dataviz/style.json?key=${U}`}async function Ee(o){try{let n=await(await fetch(`https://tile.googleapis.com/v1/createSession?key=${o}`,{method:"POST",body:JSON.stringify({mapType:"satellite",language:"en-GB",region:"GB"})})).json();return"session"in n?n.session:(console.error(`Couldn't get Google tile session key: ${JSON.stringify(n)}`),"")}catch(e){return console.error(`Couldn't get Google tile session key: ${e}`),""}}function Ne(o){let e,n,t,i;const s=o[2].default,l=ie(s,o,o[1],null);return{c(){e=y("a"),l&&l.c(),D(e,"href","#"),N(e,"color",o[0])},m(a,r){k(a,e,r),l&&l.m(e,null),n=!0,t||(i=L(e,"click",ce(o[3])),t=!0)},p(a,[r]){l&&l.p&&(!n||r&2)&&ue(l,s,a,a[1],n?pe(s,a[1],r,null):fe(a[1]),null),r&1&&N(e,"color",a[0])},i(a){n||(_(l,a),n=!0)},o(a){d(l,a),n=!1},d(a){a&&h(e),l&&l.d(a),t=!1,i()}}}function De(o,e,n){let{$$slots:t={},$$scope:i}=e,{color:s}=e;function l(a){_e.call(this,o,a)}return o.$$set=a=>{"color"in a&&n(0,s=a.color),"$$scope"in a&&n(1,i=a.$$scope)},[s,i,t,l]}class Fe extends G{constructor(e){super(),J(this,e,De,Ne,O,{color:0})}}function H(o,e,n){const t=o.slice();return t[14]=e[n],t[16]=n,t}function je(o){let e,n,t,i,s,l,a;return{c(){e=y("button"),e.textContent="Done",n=S(),t=y("label"),i=X(`Name:
        `),s=y("input"),D(s,"type","text")},m(r,f){k(r,e,f),k(r,n,f),k(r,t,f),I(t,i),I(t,s),A(s,o[0][o[3]].properties.name),l||(a=[L(e,"click",o[11]),L(s,"input",o[12])],l=!0)},p(r,f){f&9&&s.value!==r[0][r[3]].properties.name&&A(s,r[0][r[3]].properties.name)},i:b,o:b,d(r){r&&(h(e),h(n),h(t)),l=!1,Y(a)}}}function ze(o){let e,n,t,i,s,l,a,r,f=z(o[0]),c=[];for(let u=0;u<f.length;u+=1)c[u]=W(H(o,f,u));const p=u=>d(c[u],1,1,()=>{c[u]=null});return{c(){e=y("button"),e.textContent="New link",n=S(),t=y("button"),t.textContent="Clear",i=S(),s=y("ol");for(let u=0;u<c.length;u+=1)c[u].c()},m(u,g){k(u,e,g),k(u,n,g),k(u,t,g),k(u,i,g),k(u,s,g);for(let m=0;m<c.length;m+=1)c[m]&&c[m].m(s,null);l=!0,a||(r=[L(e,"click",o[5]),L(t,"click",o[4])],a=!0)},p(u,g){if(g&9){f=z(u[0]);let m;for(m=0;m<f.length;m+=1){const F=H(u,f,m);c[m]?(c[m].p(F,g),_(c[m],1)):(c[m]=W(F),c[m].c(),_(c[m],1),c[m].m(s,null))}for(B(),m=f.length;m<c.length;m+=1)p(m);E()}},i(u){if(!l){for(let g=0;g<f.length;g+=1)_(c[g]);l=!0}},o(u){c=c.filter(Boolean);for(let g=0;g<c.length;g+=1)d(c[g]);l=!1},d(u){u&&(h(e),h(n),h(t),h(i),h(s)),Q(c,u),a=!1,Y(r)}}}function Ge(o){let e=o[14].properties.name+"",n;return{c(){n=X(e)},m(t,i){k(t,n,i)},p(t,i){i&1&&e!==(e=t[14].properties.name+"")&&ke(n,e)},d(t){t&&h(n)}}}function W(o){let e,n,t,i;function s(){return o[10](o[16])}return n=new Fe({props:{color:o[14].properties.color,$$slots:{default:[Ge]},$$scope:{ctx:o}}}),n.$on("click",s),{c(){e=y("li"),v(n.$$.fragment),t=S()},m(l,a){k(l,e,a),w(n,e,null),I(e,t),i=!0},p(l,a){o=l;const r={};a&1&&(r.color=o[14].properties.color),a&131073&&(r.$$scope={dirty:a,ctx:o}),n.$set(r)},i(l){i||(_(n.$$.fragment,l),i=!0)},o(l){d(n.$$.fragment,l),i=!1},d(l){l&&h(e),C(n)}}}function Je(o){let e,n,t,i;const s=[ze,je],l=[];function a(r,f){return r[3]==null?0:1}return n=a(o),t=l[n]=s[n](o),{c(){e=y("div"),t.c(),D(e,"slot","left")},m(r,f){k(r,e,f),l[n].m(e,null),i=!0},p(r,f){let c=n;n=a(r),n===c?l[n].p(r,f):(B(),d(l[c],1,1,()=>{l[c]=null}),E(),t=l[n],t?t.p(r,f):(t=l[n]=s[n](r),t.c()),_(t,1),t.m(e,null))},i(r){i||(_(t),i=!0)},o(r){d(t),i=!1},d(r){r&&h(e),l[n].d()}}}function Oe(o){return{c:b,m:b,p:b,i:b,o:b,d:b}}function Ie(o){let e,n,t;function i(l){o[9](l)}let s={style:o[13],standardControls:!0,hash:!0,$$slots:{default:[Te]},$$scope:{ctx:o}};return o[2]!==void 0&&(s.map=o[2]),e=new de({props:s}),q.push(()=>K(e,"map",i)),{c(){v(e.$$.fragment)},m(l,a){w(e,l,a),t=!0},p(l,a){const r={};a&131083&&(r.$$scope={dirty:a,ctx:l}),!n&&a&4&&(n=!0,r.map=l[2],T(()=>n=!1)),e.$set(r)},i(l){t||(_(e.$$.fragment,l),t=!0)},o(l){d(e.$$.fragment,l),t=!1},d(l){C(e,l)}}}function Me(o){let e,n;return e=new V({props:{paint:{"line-color":"black","line-opacity":.5,"line-width":6}}}),{c(){v(e.$$.fragment)},m(t,i){w(e,t,i),n=!0},p:b,i(t){n||(_(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function qe(o){let e,n;return e=new V({props:{manageHoverState:!0,paint:{"line-color":["get","color"],"line-width":he(6,9)},hoverCursor:"pointer"}}),e.$on("click",o[6]),{c(){v(e.$$.fragment)},m(t,i){w(e,t,i),n=!0},p:b,i(t){n||(_(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function Ke(o){let e,n,t,i;const s=[qe,Me],l=[];function a(r,f){return r[3]==null?0:1}return e=a(o),n=l[e]=s[e](o),{c(){n.c(),t=M()},m(r,f){l[e].m(r,f),k(r,t,f),i=!0},p(r,f){let c=e;e=a(r),e===c?l[e].p(r,f):(B(),d(l[c],1,1,()=>{l[c]=null}),E(),n=l[e],n?n.p(r,f):(n=l[e]=s[e](r),n.c()),_(n,1),n.m(t.parentNode,t))},i(r){i||(_(n),i=!0)},o(r){d(n),i=!1},d(r){r&&h(t),l[e].d(r)}}}function Z(o){let e,n,t;function i(l){o[8](l)}let s={onDone:o[7]};return o[0][o[3]]!==void 0&&(s.f=o[0][o[3]]),e=new Le({props:s}),q.push(()=>K(e,"f",i)),{c(){v(e.$$.fragment)},m(l,a){w(e,l,a),t=!0},p(l,a){const r={};a&8&&(r.onDone=l[7]),!n&&a&9&&(n=!0,r.f=l[0][l[3]],T(()=>n=!1)),e.$set(r)},i(l){t||(_(e.$$.fragment,l),t=!0)},o(l){d(e.$$.fragment,l),t=!1},d(l){C(e,l)}}}function Te(o){let e,n,t,i;e=new ge({props:{data:o[1],generateId:!0,$$slots:{default:[Ke]},$$scope:{ctx:o}}});let s=o[3]!=null&&Z(o);return{c(){v(e.$$.fragment),n=S(),s&&s.c(),t=M()},m(l,a){w(e,l,a),k(l,n,a),s&&s.m(l,a),k(l,t,a),i=!0},p(l,a){const r={};a&2&&(r.data=l[1]),a&131080&&(r.$$scope={dirty:a,ctx:l}),e.$set(r),l[3]!=null?s?(s.p(l,a),a&8&&_(s,1)):(s=Z(l),s.c(),_(s,1),s.m(t.parentNode,t)):s&&(B(),d(s,1,1,()=>{s=null}),E())},i(l){i||(_(e.$$.fragment,l),_(s),i=!0)},o(l){d(e.$$.fragment,l),d(s),i=!1},d(l){l&&(h(n),h(t)),C(e,l),s&&s.d(l)}}}function Ae(o){return{c:b,m:b,p:b,i:b,o:b,d:b}}function Pe(o){let e,n,t={ctx:o,current:null,token:null,hasCatch:!1,pending:Ae,then:Ie,catch:Oe,value:13,blocks:[,,,]};return be(Be(new URLSearchParams(window.location.search).get("google")||""),t),{c(){e=y("div"),t.block.c(),D(e,"slot","main"),N(e,"position","relative"),N(e,"width","100%"),N(e,"height","100vh")},m(i,s){k(i,e,s),t.block.m(e,t.anchor=null),t.mount=()=>e,t.anchor=null,n=!0},p(i,s){o=i,$e(t,o,s)},i(i){n||(_(t.block),n=!0)},o(i){for(let s=0;s<3;s+=1){const l=t.blocks[s];d(l)}n=!1},d(i){i&&h(e),t.block.d(),t.token=null,t=null}}}function Re(o){let e,n;return e=new me({props:{$$slots:{main:[Pe],left:[Je]},$$scope:{ctx:o}}}),{c(){v(e.$$.fragment)},m(t,i){w(e,t,i),n=!0},p(t,[i]){const s={};i&131087&&(s.$$scope={dirty:i,ctx:t}),e.$set(s)},i(t){n||(_(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function Ue(){try{let o=JSON.parse(window.localStorage.getItem("tmp-rcv2")||"");if("features"in o)return o.features}catch{}return[]}function He(o,e,n){let t,i,s=Ue(),l=null;function a(){n(0,s=[])}function r(){let $=["#66C5CC","#F6CF71","#F89C74","#DCB0F2","#87C55F","#9EB9F3","#FE88B1","#C9DB74","#8BE0A4","#B497E7","#D3B484","#B3B3B3"],x={type:"Feature",geometry:{type:"LineString",coordinates:[]},properties:{name:"Untitled link",color:$[s.length%$.length]}};n(0,s=[...s,x]),n(3,l=s.length-1)}const f=$=>n(3,l=$.detail.features[0].id),c=()=>n(3,l=null);function p($){o.$$.not_equal(s[l],$)&&(s[l]=$,n(0,s))}function u($){i=$,n(2,i)}const g=$=>n(3,l=$),m=()=>n(3,l=null);function F(){s[l].properties.name=this.value,n(0,s)}return o.$$.update=()=>{o.$$.dirty&1&&n(1,t={type:"FeatureCollection",features:s}),o.$$.dirty&2&&window.localStorage.setItem("tmp-rcv2",JSON.stringify(t))},[s,t,i,l,a,r,f,c,p,u,g,m,F]}class We extends G{constructor(e){super(),J(this,e,He,Re,O,{})}}new We({target:document.getElementById("app")});
