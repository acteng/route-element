import{V as Vn,W as Qn,X as st,r as be,e as y,v as ve,t as k,Y as Yn,S as _e,i as he,s as $e,Z as xn,_ as el,$ as re,a0 as tl,L as nl,b as we,a as Ne,c as D,m as q,d as Ee,f as P,g as ll,h as We,u as Ve,j as Qe,k as Ye,l as Ie,y as $,z as A,q as b,w as v,a1 as lt,G as Ce,E as De,B as le,D as xe,Q as Z,a2 as rt,o as Y,F as U,A as R,a3 as mt,O as d,N as ae,a4 as Oe,x as oe,R as Me,M as Fe,a5 as ee,a6 as et,a7 as dt,U as te,a8 as bt,a9 as jt,H as ie,p as pt,K as gt,aa as rl,ab as $t,ac as ol,C as tt,P as Jn,ad as il,I as sl,T as al}from"./Layout-4695594c.js";function cl(t,e){const l=e.token={};function n(r,o,i,a){if(e.token!==l)return;e.resolved=a;let s=e.ctx;i!==void 0&&(s=s.slice(),s[i]=a);const u=r&&(e.current=r)(s);let c=!1;e.block&&(e.blocks?e.blocks.forEach((m,p)=>{p!==o&&m&&(be(),y(m,1,1,()=>{e.blocks[p]===m&&(e.blocks[p]=null)}),ve())}):e.block.d(1),u.c(),k(u,1),u.m(e.mount(),e.anchor),c=!0),e.block=u,e.blocks&&(e.blocks[o]=u),c&&Yn()}if(Vn(t)){const r=Qn();if(t.then(o=>{st(r),n(e.then,1,e.value,o),st(null)},o=>{if(st(r),n(e.catch,2,e.error,o),st(null),!e.hasCatch)throw o}),e.current!==e.pending)return n(e.pending,0),!0}else{if(e.current!==e.then)return n(e.then,1,e.value,t),!0;e.resolved=t}}function ul(t,e,l){const n=e.slice(),{resolved:r}=t;t.current===t.then&&(n[t.value]=r),t.current===t.catch&&(n[t.error]=r),t.block.p(n,l)}function fl(t,e,l){let n;const r=xn();let{layer:o=void 0}=e;const{map:i}=el();re(t,i,c=>l(2,n=c));function a(c){r(c.type,{...c,map:i})}const s=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu","mouseover","mouseout"],u=["click","dblclick","contextmenu","mousemove","movestart","moveend","zoomstart","zoom","zoomend"];return tl(()=>{if(n)if(o)for(const c of s)n.off(c,o,a);else for(const c of u)n.off(c,a)}),t.$$set=c=>{"layer"in c&&l(1,o=c.layer)},t.$$.update=()=>{if(t.$$.dirty&6&&n)if(o)for(const c of s)n.on(c,o,a);else for(const c of u)n.on(c,a)},[i,o,n]}class zn extends _e{constructor(e){super(),he(this,e,fl,null,$e,{layer:1})}}function ml(t){let e;const l=t[16].default,n=We(l,t,t[24],null);return{c(){n&&n.c()},m(r,o){n&&n.m(r,o),e=!0},p(r,o){n&&n.p&&(!e||o&16777216)&&Ve(n,l,r,r[24],e?Ye(l,r[24],o,null):Qe(r[24]),null)},i(r){e||(k(n,r),e=!0)},o(r){y(n,r),e=!1},d(r){n&&n.d(r)}}}function dl(t){let e,l,n;function r(i){t[17](i)}let o={id:t[1],type:"symbol",source:t[2],sourceLayer:t[3],beforeId:t[4],beforeLayerType:t[5],paint:t[6],layout:t[7],filter:t[8],applyToClusters:t[9],minzoom:t[10],maxzoom:t[11],hoverCursor:t[12],manageHoverState:t[13],eventsIfTopMost:t[14],interactive:t[15],$$slots:{default:[ml]},$$scope:{ctx:t}};return t[0]!==void 0&&(o.hovered=t[0]),e=new nl({props:o}),we.push(()=>Ne(e,"hovered",r)),e.$on("click",t[18]),e.$on("dblclick",t[19]),e.$on("contextmenu",t[20]),e.$on("mouseenter",t[21]),e.$on("mousemove",t[22]),e.$on("mouseleave",t[23]),{c(){D(e.$$.fragment)},m(i,a){q(e,i,a),n=!0},p(i,[a]){const s={};a&2&&(s.id=i[1]),a&4&&(s.source=i[2]),a&8&&(s.sourceLayer=i[3]),a&16&&(s.beforeId=i[4]),a&32&&(s.beforeLayerType=i[5]),a&64&&(s.paint=i[6]),a&128&&(s.layout=i[7]),a&256&&(s.filter=i[8]),a&512&&(s.applyToClusters=i[9]),a&1024&&(s.minzoom=i[10]),a&2048&&(s.maxzoom=i[11]),a&4096&&(s.hoverCursor=i[12]),a&8192&&(s.manageHoverState=i[13]),a&16384&&(s.eventsIfTopMost=i[14]),a&32768&&(s.interactive=i[15]),a&16777216&&(s.$$scope={dirty:a,ctx:i}),!l&&a&1&&(l=!0,s.hovered=i[0],Ee(()=>l=!1)),e.$set(s)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){y(e.$$.fragment,i),n=!1},d(i){P(e,i)}}}function pl(t,e,l){let{$$slots:n={},$$scope:r}=e,{id:o=ll("symbol")}=e,{source:i=void 0}=e,{sourceLayer:a=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:u=void 0}=e,{paint:c=void 0}=e,{layout:m=void 0}=e,{filter:p=void 0}=e,{applyToClusters:f=void 0}=e,{minzoom:g=void 0}=e,{maxzoom:_=void 0}=e,{hoverCursor:L=void 0}=e,{manageHoverState:h=!1}=e,{hovered:j=null}=e,{eventsIfTopMost:O=!1}=e,{interactive:G=!0}=e;function B(w){j=w,l(0,j)}function z(w){Ie.call(this,t,w)}function H(w){Ie.call(this,t,w)}function I(w){Ie.call(this,t,w)}function M(w){Ie.call(this,t,w)}function T(w){Ie.call(this,t,w)}function N(w){Ie.call(this,t,w)}return t.$$set=w=>{"id"in w&&l(1,o=w.id),"source"in w&&l(2,i=w.source),"sourceLayer"in w&&l(3,a=w.sourceLayer),"beforeId"in w&&l(4,s=w.beforeId),"beforeLayerType"in w&&l(5,u=w.beforeLayerType),"paint"in w&&l(6,c=w.paint),"layout"in w&&l(7,m=w.layout),"filter"in w&&l(8,p=w.filter),"applyToClusters"in w&&l(9,f=w.applyToClusters),"minzoom"in w&&l(10,g=w.minzoom),"maxzoom"in w&&l(11,_=w.maxzoom),"hoverCursor"in w&&l(12,L=w.hoverCursor),"manageHoverState"in w&&l(13,h=w.manageHoverState),"hovered"in w&&l(0,j=w.hovered),"eventsIfTopMost"in w&&l(14,O=w.eventsIfTopMost),"interactive"in w&&l(15,G=w.interactive),"$$scope"in w&&l(24,r=w.$$scope)},[j,o,i,a,s,u,c,m,p,f,g,_,L,h,O,G,n,B,z,H,I,M,T,N,r]}class gl extends _e{constructor(e){super(),he(this,e,pl,dl,$e,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}const _l=t=>({}),Ct=t=>({}),hl=t=>({}),At=t=>({});function $l(t){let e,l,n,r;const o=t[3].sidebar,i=We(o,t,t[2],At),a=t[3].map,s=We(a,t,t[2],Ct);return{c(){e=$("div"),i&&i.c(),l=A(),n=$("div"),s&&s.c()},m(u,c){b(u,e,c),i&&i.m(e,null),t[4](e),b(u,l,c),b(u,n,c),s&&s.m(n,null),t[5](n),r=!0},p(u,[c]){i&&i.p&&(!r||c&4)&&Ve(i,o,u,u[2],r?Ye(o,u[2],c,hl):Qe(u[2]),At),s&&s.p&&(!r||c&4)&&Ve(s,a,u,u[2],r?Ye(a,u[2],c,_l):Qe(u[2]),Ct)},i(u){r||(k(i,u),k(s,u),r=!0)},o(u){y(i,u),y(s,u),r=!1},d(u){u&&(v(e),v(l),v(n)),i&&i.d(u),t[4](null),s&&s.d(u),t[5](null)}}}function kl(t,e,l){let n,r;re(t,vt,u=>l(0,n=u)),re(t,wt,u=>l(1,r=u));let{$$slots:o={},$$scope:i}=e;function a(u){we[u?"unshift":"push"](()=>{n=u,vt.set(n)})}function s(u){we[u?"unshift":"push"](()=>{r=u,wt.set(r)})}return t.$$set=u=>{"$$scope"in u&&l(2,i=u.$$scope)},[n,r,i,o,a,s]}class Ze extends _e{constructor(e){super(),he(this,e,kl,$l,$e,{})}}let vt=lt(null),wt=lt(null),ut=lt(void 0),K=lt(jl());function ce(t){return{type:"FeatureCollection",features:t}}let ne=lt({kind:"neutral"});function Se(){return["","2","1","0","Critical"]}let Te=[{name:"Street or path check",description:"Is this on-carriageway or a traffic-free path?",choices:["","Street check","Path check"]},{name:"SA03",description:"lane widths",choices:Se()},{name:"SA04",description:"trip hazards",choices:Se()},{name:"SA05",description:"kerbside activity",choices:Se()},{name:"SA08",description:"motor traffic speed",choices:Se()},{name:"SA09",description:"motor traffic volume",choices:Se()},{name:"SA11",description:"footway widths",choices:Se()},{name:"SA12",description:"effective width next to tram lines",choices:Se()},{name:"SA13",description:"crossing angle of tram/train rails",choices:Se()},{name:"SA14",description:"cycling surface and maintenance defects",choices:Se()},{name:"SA15",description:"WW surface and maintenance defects",choices:Se()},{name:"SA16",description:"guard railing",choices:Se()}],Be=["#66C5CC","#F6CF71","#F89C74","#DCB0F2","#87C55F","#9EB9F3","#FE88B1","#C9DB74","#8BE0A4","#B497E7","#D3B484","#B3B3B3"];function bl(t){return{type:"Feature",geometry:{type:"LineString",coordinates:[]},properties:{name:"Untitled link",color:Be[t%Be.length],answers:Array(Te.length).fill("")}}}function vl(t,e){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{name:"Untitled bus stop",color:Be[t%Be.length],st20:""}}}function wl(t,e){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{name:"Untitled crossing",color:Be[t%Be.length],sa10:""}}}function yl(t,e){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{name:"Untitled JAT",color:Be[t%Be.length],existing:{arms:[],movements:[],notes:""},proposed:{arms:[],movements:[],notes:""}}}}function jl(){try{let t=JSON.parse(window.localStorage.getItem("tmp-rcv2")||"");if("links"in t&&"jats"in t&&"crossings"in t)return t}catch{}return{links:[],jats:[],bus_stops:[],crossings:[]}}function Cl(t){let e,l;return e=new De({props:{paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":"black","circle-radius":20}}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p:le,i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function Al(t){let e,l;return e=new Ce({props:{data:ce(t[0].jats),$$slots:{default:[Cl]},$$scope:{ctx:t}}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,[r]){const o={};r&1&&(o.data=ce(n[0].jats)),r&2&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function Ll(t,e,l){let n;return re(t,K,r=>l(0,n=r)),[n]}class _t extends _e{constructor(e){super(),he(this,e,Ll,Al,$e,{})}}function Sl(t){let e,l;return e=new xe({props:{paint:{"line-color":t[0]?["get","color"]:"black","line-width":6}}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,r){const o={};r&1&&(o.paint={"line-color":n[0]?["get","color"]:"black","line-width":6}),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function Tl(t){let e,l;return e=new Ce({props:{data:ce(t[1].links),$$slots:{default:[Sl]},$$scope:{ctx:t}}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,[r]){const o={};r&2&&(o.data=ce(n[1].links)),r&5&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function Ml(t,e,l){let n;re(t,K,o=>l(1,n=o));let{showColor:r=!1}=e;return t.$$set=o=>{"showColor"in o&&l(0,r=o.showColor)},[r,n]}class ot extends _e{constructor(e){super(),he(this,e,Ml,Tl,$e,{showColor:0})}}const{window:Il}=rt;function Nl(t,e,l){const n=t.slice();return n[9]=e[l],n}function El(t){let e;return{c(){e=$("option"),e.textContent=`${t[9]}`,e.__value=t[9],ae(e,e.__value)},m(l,n){b(l,e,n)},p:le,d(l){l&&v(e)}}}function Dl(t){let e,l,n,r,o,i,a,s,u,c,m,p,f,g,_=Y(Se()),L=[];for(let h=0;h<_.length;h+=1)L[h]=El(Nl(t,_,h));return{c(){e=$("div"),l=$("button"),l.textContent="Done",n=A(),r=$("button"),r.textContent="Delete bus stop",o=A(),i=$("label"),a=U(`Name:
      `),s=$("input"),u=A(),c=$("label"),m=U(`ST20: bus stops
      `),p=$("select");for(let h=0;h<L.length;h+=1)L[h].c();R(s,"type","text"),t[1].bus_stops[t[0]].properties.st20===void 0&&mt(()=>t[8].call(p)),R(e,"slot","sidebar")},m(h,j){b(h,e,j),d(e,l),d(e,n),d(e,r),d(e,o),d(e,i),d(i,a),d(i,s),ae(s,t[1].bus_stops[t[0]].properties.name),d(e,u),d(e,c),d(c,m),d(c,p);for(let O=0;O<L.length;O+=1)L[O]&&L[O].m(p,null);Oe(p,t[1].bus_stops[t[0]].properties.st20,!0),f||(g=[Z(l,"click",t[6]),Z(r,"click",t[4]),Z(s,"input",t[7]),Z(p,"change",t[8])],f=!0)},p(h,j){j&3&&s.value!==h[1].bus_stops[h[0]].properties.name&&ae(s,h[1].bus_stops[h[0]].properties.name),j&3&&Oe(p,h[1].bus_stops[h[0]].properties.st20)},d(h){h&&v(e),oe(L,h),f=!1,Me(g)}}}function ql(t){let e,l;return e=new De({props:{filter:["!=",["id"],t[0]],paint:{"circle-color":"black","circle-radius":10}}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,r){const o={};r&1&&(o.filter=["!=",["id"],n[0]]),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function Pl(t){let e;return{c(){e=$("span"),R(e,"class","dot svelte-1j72wc4"),te(e,"background-color",t[1].bus_stops[t[0]].properties.color)},m(l,n){b(l,e,n)},p(l,n){n&3&&te(e,"background-color",l[1].bus_stops[l[0]].properties.color)},d(l){l&&v(e)}}}function Fl(t){let e,l,n,r,o,i,a,s,u,c;l=new ot({}),r=new _t({}),i=new Ce({props:{data:ce(t[1].bus_stops),generateId:!0,$$slots:{default:[ql]},$$scope:{ctx:t}}});function m(f){t[5](f)}let p={draggable:!0,$$slots:{default:[Pl]},$$scope:{ctx:t}};return t[1].bus_stops[t[0]].geometry.coordinates!==void 0&&(p.lngLat=t[1].bus_stops[t[0]].geometry.coordinates),s=new Fe({props:p}),we.push(()=>Ne(s,"lngLat",m)),{c(){e=$("div"),D(l.$$.fragment),n=A(),D(r.$$.fragment),o=A(),D(i.$$.fragment),a=A(),D(s.$$.fragment),R(e,"slot","map")},m(f,g){b(f,e,g),q(l,e,null),d(e,n),q(r,e,null),d(e,o),q(i,e,null),d(e,a),q(s,e,null),c=!0},p(f,g){const _={};g&2&&(_.data=ce(f[1].bus_stops)),g&4097&&(_.$$scope={dirty:g,ctx:f}),i.$set(_);const L={};g&4099&&(L.$$scope={dirty:g,ctx:f}),!u&&g&3&&(u=!0,L.lngLat=f[1].bus_stops[f[0]].geometry.coordinates,Ee(()=>u=!1)),s.$set(L)},i(f){c||(k(l.$$.fragment,f),k(r.$$.fragment,f),k(i.$$.fragment,f),k(s.$$.fragment,f),c=!0)},o(f){y(l.$$.fragment,f),y(r.$$.fragment,f),y(i.$$.fragment,f),y(s.$$.fragment,f),c=!1},d(f){f&&v(e),P(l),P(r),P(i),P(s)}}}function Ol(t){let e,l,n,r;return e=new Ze({props:{$$slots:{map:[Fl],sidebar:[Dl]},$$scope:{ctx:t}}}),{c(){D(e.$$.fragment)},m(o,i){q(e,o,i),l=!0,n||(r=Z(Il,"keydown",t[3]),n=!0)},p(o,[i]){const a={};i&4103&&(a.$$scope={dirty:i,ctx:o}),e.$set(a)},i(o){l||(k(e.$$.fragment,o),l=!0)},o(o){y(e.$$.fragment,o),l=!1},d(o){P(e,o),n=!1,r()}}}function Bl(t,e,l){let n,r;re(t,K,p=>l(1,n=p)),re(t,ne,p=>l(2,r=p));let{idx:o}=e;function i(p){p.key=="Escape"&&ee(ne,r={kind:"neutral"},r)}async function a(){window.confirm("Really delete this bus stop?")&&(ee(ne,r={kind:"neutral"},r),await et(),n.bus_stops.splice(o,1),K.set(n))}function s(p){t.$$.not_equal(n.bus_stops[o].geometry.coordinates,p)&&(n.bus_stops[o].geometry.coordinates=p,K.set(n))}const u=()=>ee(ne,r={kind:"neutral"},r);function c(){n.bus_stops[o].properties.name=this.value,K.set(n)}function m(){n.bus_stops[o].properties.st20=dt(this),K.set(n)}return t.$$set=p=>{"idx"in p&&l(0,o=p.idx)},[o,n,r,i,a,s,u,c,m]}class Jl extends _e{constructor(e){super(),he(this,e,Bl,Ol,$e,{idx:0})}}const{window:zl}=rt;function Rl(t,e,l){const n=t.slice();return n[9]=e[l],n}function Hl(t){let e;return{c(){e=$("option"),e.textContent=`${t[9]}`,e.__value=t[9],ae(e,e.__value)},m(l,n){b(l,e,n)},p:le,d(l){l&&v(e)}}}function Gl(t){let e,l,n,r,o,i,a,s,u,c,m,p,f,g,_=Y(Se()),L=[];for(let h=0;h<_.length;h+=1)L[h]=Hl(Rl(t,_,h));return{c(){e=$("div"),l=$("button"),l.textContent="Done",n=A(),r=$("button"),r.textContent="Delete crossing",o=A(),i=$("label"),a=U(`Name:
      `),s=$("input"),u=A(),c=$("label"),m=U(`SA10: pedestrian crossing speed
      `),p=$("select");for(let h=0;h<L.length;h+=1)L[h].c();R(s,"type","text"),t[1].crossings[t[0]].properties.sa10===void 0&&mt(()=>t[8].call(p)),R(e,"slot","sidebar")},m(h,j){b(h,e,j),d(e,l),d(e,n),d(e,r),d(e,o),d(e,i),d(i,a),d(i,s),ae(s,t[1].crossings[t[0]].properties.name),d(e,u),d(e,c),d(c,m),d(c,p);for(let O=0;O<L.length;O+=1)L[O]&&L[O].m(p,null);Oe(p,t[1].crossings[t[0]].properties.sa10,!0),f||(g=[Z(l,"click",t[6]),Z(r,"click",t[4]),Z(s,"input",t[7]),Z(p,"change",t[8])],f=!0)},p(h,j){j&3&&s.value!==h[1].crossings[h[0]].properties.name&&ae(s,h[1].crossings[h[0]].properties.name),j&3&&Oe(p,h[1].crossings[h[0]].properties.sa10)},d(h){h&&v(e),oe(L,h),f=!1,Me(g)}}}function Ul(t){let e,l;return e=new De({props:{filter:["!=",["id"],t[0]],paint:{"circle-color":"black","circle-radius":10}}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,r){const o={};r&1&&(o.filter=["!=",["id"],n[0]]),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function Zl(t){let e;return{c(){e=$("span"),R(e,"class","dot svelte-1j72wc4"),te(e,"background-color",t[1].crossings[t[0]].properties.color)},m(l,n){b(l,e,n)},p(l,n){n&3&&te(e,"background-color",l[1].crossings[l[0]].properties.color)},d(l){l&&v(e)}}}function Kl(t){let e,l,n,r,o,i,a,s,u,c;l=new ot({}),r=new _t({}),i=new Ce({props:{data:ce(t[1].crossings),generateId:!0,$$slots:{default:[Ul]},$$scope:{ctx:t}}});function m(f){t[5](f)}let p={draggable:!0,$$slots:{default:[Zl]},$$scope:{ctx:t}};return t[1].crossings[t[0]].geometry.coordinates!==void 0&&(p.lngLat=t[1].crossings[t[0]].geometry.coordinates),s=new Fe({props:p}),we.push(()=>Ne(s,"lngLat",m)),{c(){e=$("div"),D(l.$$.fragment),n=A(),D(r.$$.fragment),o=A(),D(i.$$.fragment),a=A(),D(s.$$.fragment),R(e,"slot","map")},m(f,g){b(f,e,g),q(l,e,null),d(e,n),q(r,e,null),d(e,o),q(i,e,null),d(e,a),q(s,e,null),c=!0},p(f,g){const _={};g&2&&(_.data=ce(f[1].crossings)),g&4097&&(_.$$scope={dirty:g,ctx:f}),i.$set(_);const L={};g&4099&&(L.$$scope={dirty:g,ctx:f}),!u&&g&3&&(u=!0,L.lngLat=f[1].crossings[f[0]].geometry.coordinates,Ee(()=>u=!1)),s.$set(L)},i(f){c||(k(l.$$.fragment,f),k(r.$$.fragment,f),k(i.$$.fragment,f),k(s.$$.fragment,f),c=!0)},o(f){y(l.$$.fragment,f),y(r.$$.fragment,f),y(i.$$.fragment,f),y(s.$$.fragment,f),c=!1},d(f){f&&v(e),P(l),P(r),P(i),P(s)}}}function Xl(t){let e,l,n,r;return e=new Ze({props:{$$slots:{map:[Kl],sidebar:[Gl]},$$scope:{ctx:t}}}),{c(){D(e.$$.fragment)},m(o,i){q(e,o,i),l=!0,n||(r=Z(zl,"keydown",t[3]),n=!0)},p(o,[i]){const a={};i&4103&&(a.$$scope={dirty:i,ctx:o}),e.$set(a)},i(o){l||(k(e.$$.fragment,o),l=!0)},o(o){y(e.$$.fragment,o),l=!1},d(o){P(e,o),n=!1,r()}}}function Wl(t,e,l){let n,r;re(t,K,p=>l(1,n=p)),re(t,ne,p=>l(2,r=p));let{idx:o}=e;function i(p){p.key=="Escape"&&ee(ne,r={kind:"neutral"},r)}async function a(){window.confirm("Really delete this crossing?")&&(ee(ne,r={kind:"neutral"},r),await et(),n.crossings.splice(o,1),K.set(n))}function s(p){t.$$.not_equal(n.crossings[o].geometry.coordinates,p)&&(n.crossings[o].geometry.coordinates=p,K.set(n))}const u=()=>ee(ne,r={kind:"neutral"},r);function c(){n.crossings[o].properties.name=this.value,K.set(n)}function m(){n.crossings[o].properties.sa10=dt(this),K.set(n)}return t.$$set=p=>{"idx"in p&&l(0,o=p.idx)},[o,n,r,i,a,s,u,c,m]}class Vl extends _e{constructor(e){super(),he(this,e,Wl,Xl,$e,{idx:0})}}let Lt="MZEJTanw3WpxRvt7qDfo";async function Ql(t){return t?{version:8,sources:{"raster-tiles":{type:"raster",tiles:[`https://tile.googleapis.com/v1/2dtiles/{z}/{x}/{y}?session=${await Yl(t)}&key=${t}`],tileSize:256,attribution:"Google (detailed attributions not wired up)"}},layers:[{id:"raster-basemap",type:"raster",source:"raster-tiles"}],glyphs:`https://api.maptiler.com/fonts/{fontstack}/{range}.pbf?key=${Lt}`}:`https://api.maptiler.com/maps/dataviz/style.json?key=${Lt}`}async function Yl(t){try{let l=await(await fetch(`https://tile.googleapis.com/v1/createSession?key=${t}`,{method:"POST",body:JSON.stringify({mapType:"satellite",language:"en-GB",region:"GB"})})).json();return"session"in l?l.session:(console.error(`Couldn't get Google tile session key: ${JSON.stringify(l)}`),"")}catch(e){return console.error(`Couldn't get Google tile session key: ${e}`),""}}function xl(t){let e,l;return e=new De({props:{paint:{"circle-color":"black","circle-radius":10}}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p:le,i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function er(t){let e,l;return e=new Ce({props:{data:ce(t[0].bus_stops),$$slots:{default:[xl]},$$scope:{ctx:t}}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,[r]){const o={};r&1&&(o.data=ce(n[0].bus_stops)),r&2&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function tr(t,e,l){let n;return re(t,K,r=>l(0,n=r)),[n]}class ht extends _e{constructor(e){super(),he(this,e,tr,er,$e,{})}}const nr="/route-element/assets/right-arrow-d8c7892c.svg";function St(t){let e,l;const n=t[4].default,r=We(n,t,t[3],null);return{c(){e=$("div"),r&&r.c(),R(e,"class","section svelte-zax3q3")},m(o,i){b(o,e,i),r&&r.m(e,null),l=!0},p(o,i){r&&r.p&&(!l||i&8)&&Ve(r,n,o,o[3],l?Ye(n,o[3],i,null):Qe(o[3]),null)},i(o){l||(k(r,o),l=!0)},o(o){y(r,o),l=!1},d(o){o&&v(e),r&&r.d(o)}}}function lr(t){let e,l,n,r,o,i,a,s,u,c,m,p,f=t[2]&&St(t);return{c(){e=$("button"),l=$("div"),n=$("span"),r=U(t[0]),o=A(),i=$("img"),u=A(),f&&f.c(),R(i,"class","arrow svelte-zax3q3"),bt(i.src,a=nr)||R(i,"src",a),R(i,"alt",s="Select "+t[0]),R(l,"class","top-section section svelte-zax3q3"),jt(l,"bordered",t[2]),R(e,"class","clickable-card svelte-zax3q3"),e.disabled=t[1]},m(g,_){b(g,e,_),d(e,l),d(l,n),d(n,r),d(l,o),d(l,i),d(e,u),f&&f.m(e,null),c=!0,m||(p=[Z(e,"click",t[5]),Z(e,"mouseenter",t[6]),Z(e,"mouseleave",t[7])],m=!0)},p(g,[_]){(!c||_&1)&&ie(r,g[0]),(!c||_&1&&s!==(s="Select "+g[0]))&&R(i,"alt",s),(!c||_&4)&&jt(l,"bordered",g[2]),g[2]?f?(f.p(g,_),_&4&&k(f,1)):(f=St(g),f.c(),k(f,1),f.m(e,null)):f&&(be(),y(f,1,1,()=>{f=null}),ve()),(!c||_&2)&&(e.disabled=g[1])},i(g){c||(k(f),c=!0)},o(g){y(f),c=!1},d(g){g&&v(e),f&&f.d(),m=!1,Me(p)}}}function rr(t,e,l){let{$$slots:n={},$$scope:r}=e,{name:o}=e,{disabled:i=!1}=e,{hasSlot:a=!0}=e;function s(m){Ie.call(this,t,m)}function u(m){Ie.call(this,t,m)}function c(m){Ie.call(this,t,m)}return t.$$set=m=>{"name"in m&&l(0,o=m.name),"disabled"in m&&l(1,i=m.disabled),"hasSlot"in m&&l(2,a=m.hasSlot),"$$scope"in m&&l(3,r=m.$$scope)},[o,i,a,r,n,s,u,c]}class Rn extends _e{constructor(e){super(),he(this,e,rr,lr,$e,{name:0,disabled:1,hasSlot:2})}}let Pe={critical:{background:"#232323",font:"white"},red:{background:"#b73d25",font:"white"},amber:{background:"#ffd833",font:"black"},green:{background:"#006853",font:"white"},notApplicable:{background:"white",font:"black"}};const or=t=>({dialog:t&1}),Tt=t=>({dialog:t[0]});function ir(t){let e,l,n,r,o;const i=t[4].default,a=We(i,t,t[3],Tt);return{c(){e=$("dialog"),l=$("article"),a&&a.c(),e.open=!0},m(s,u){b(s,e,u),d(e,l),a&&a.m(l,null),t[6](e),n=!0,r||(o=[Z(window,"click",t[1]),Z(window,"keydown",t[2]),Z(e,"close",t[5])],r=!0)},p(s,[u]){a&&a.p&&(!n||u&9)&&Ve(a,i,s,s[3],n?Ye(i,s[3],u,or):Qe(s[3]),Tt)},i(s){n||(k(a,s),n=!0)},o(s){y(a,s),n=!1},d(s){s&&v(e),a&&a.d(s),t[6](null),r=!1,Me(o)}}}function sr(t,e,l){let{$$slots:n={},$$scope:r}=e,o;function i(c){o.open&&c.target==o&&o.close()}function a(c){(c.key=="Escape"||c.key=="Enter")&&(c.stopPropagation(),o.close())}function s(c){Ie.call(this,t,c)}function u(c){we[c?"unshift":"push"](()=>{o=c,l(0,o)})}return t.$$set=c=>{"$$scope"in c&&l(3,r=c.$$scope)},[o,i,a,r,n,s,u]}class Hn extends _e{constructor(e){super(),he(this,e,sr,ir,$e,{})}}function ar(t,e){let l=document.createElement("a");l.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),l.setAttribute("download",t),document.body.appendChild(l),l.click(),document.body.removeChild(l)}const Ke={"Any type of junction":{"All movements":{scoreZero:["Cycle movement in potential conflict with heavy motor traffic flow.","Cycle movement mixed with or crossing traffic with 85th percentile speed exceeding 60kph, or where vehicles accelerate rapidly.","Necessary to cross more than one traffic lane (without refuge or protection) to complete cycle movement unless traffic flows are low.","Cycle movement crosses wide junction entry or exit: e.g. with merge or diverge taper or slip lane.","Pinch points on junction entry or exit (lane width 3.2m-3.9m).","Cycle movement affected by very poor surface quality utility reinstatement, gully positioning, debris."],scoreOne:["Cycle movement in potential conflict with moderate traffic flow.","Cycle lanes through junction meeting appropriate desirable minimum width requirements for the movement under consideration.","Raised table at junction crossed by traffic in potential conflict with cycle movement.","Cycle movement made by transiting onto section of shared use footway."],scoreTwo:["Low traffic speed and volume in mixed traffic environment (e.g. access-only streets in a residential area).","Cycle movement separated physically and/or in time from motor traffic and also separated from pedestrians.","Cycle movement bypasses junction completely, including via good quality grade separation."]}},"Simple priority T-junction":{"Right turn from minor arm":{scoreZero:["Heavy traffic movements and/or high bus and HGV flows in potential conflict with cycle movement, with no physical refuge in the centre of the major road (including ghost island junction)."],scoreOne:["Central refuge allowing two-stage cycle movement crossing one traffic lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm with dedicated cycle signals or cycle priority."]},"Left turn from major arm":{scoreZero:[],scoreOne:["Side road entry treatment (table across minor arm)."],scoreTwo:["Continuous footway and cycle track across minor arm."]},"Right turn from major arm":{scoreZero:["Heavy traffic movements and/or high bus and HGV flows in potential conflict with no physical refuge in the centre of major road (including ghost island junction)."],scoreOne:["Protected turning refuge allowing two stage cycle movement, crossing one lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm via dedicated cycle signals or cycle priority."]},"Ahead on major arm, crossing minor arm":{scoreZero:["Congested conditions causing poor visibility for right-turning motor vehicles from major arm.","Junction corner radius ≥9m, including where off-carriageway cycle track crosses minor arm."],scoreOne:["Junction free from queueing traffic and cycle lane on major arm meeting desirable minimum width requirements.","Junction corner radius <9m, including where off-carriageway cycle track crosses minor arm without priority.","Side road entry treatment (table across minor arm)."],scoreTwo:["Off-carriageway cycle track or stepped cycle track alongside major arm, crossing minor arm with priority over turning traffic."]}},Crossroads:{"Ahead from minor arm":{scoreZero:["Heavy opposing traffic movements with no physical refuge (including ghost island junction)."],scoreOne:["Protected pocket refuge for ahead cycles allowing two stage movement, crossing one lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm via dedicated cycle signals or cycle priority."]}},"Traffic Signals":{"All movements":{scoreZero:["Single or multiple queuing lanes with no cycle lanes or tracks on approaches.","Junctions with unsignalised left turn merge/diverge and signalised ahead lanes."],scoreOne:["Advance Cycle Stop lines, at least 5m deep and where the signals on the approach are on green for <30% of the cycle time.","Signal timings adjusted to provide extended intergreen to suit cycle movement under consideration.","Cycle/pedestrian scramble (toucan crossings with all-red stage).","Early release for cycles, with enough time to clear junction for cycle movement being considered."],scoreTwo:["Cycle movement has no potential conflict with motor traffic, e.g. dedicated cycle stage, conflicting traffic movement held or banned."]},"Right turn":{scoreZero:[],scoreOne:["Two-stage right turn via ASL or marked area in front of stop line."],scoreTwo:["Two-stage right turn with physically protected waiting area."]}},Roundabout:{"All movements":{scoreZero:["Any type of roundabout with high traffic throughput.","Normal roundabout with multi-lane flared approaches.","Any type of roundabout with annular cycle lane marked on the circulatory carriageway."],scoreOne:["Compact roundabout or raised mini roundabout with no more than moderate traffic throughput","Off-carriageway cycle track with crossings of entries and exits without cycle priority, crossing single traffic lanes with traffic flows < 4000 vehicles per day or 400 HGV/bus flow. "],scoreTwo:["Off-carriageway cycle track with crossings of entries and exits with signals or cycle priority."]}}},yt=Object.keys(Ke);function ft(t){return Object.keys(Ke[t])}const Ue="All movements";function Mt(t,e){let l=[],n=Ke[t][e];n&&l.push({junctionType:t,movementType:e,...n});let r=Ke[t][Ue];if(r&&e!=Ue&&l.push({junctionType:t,movementType:Ue,...r}),t=="Crossroads"){let o=Ke["Simple priority T-junction"][Ue];o&&l.push({junctionType:"Simple priority T-junction",movementType:Ue,...o})}if(t!="Any type of junction"){let o=Ke["Any type of junction"][Ue];o&&l.push({junctionType:"Any type of junction",movementType:Ue,...o})}return l}function It(t,e,l){const n=t.slice();return n[10]=e[l],n}function Nt(t,e,l){const n=t.slice();return n[13]=e[l],n}function Et(t,e,l){const n=t.slice();return n[13]=e[l],n}function Dt(t,e,l){const n=t.slice();return n[13]=e[l],n}function qt(t,e,l){const n=t.slice();return n[20]=e[l],n}function Pt(t,e,l){const n=t.slice();return n[20]=e[l],n}function Ft(t){let e,l;return e=new Hn({props:{$$slots:{default:[cr]},$$scope:{ctx:t}}}),e.$on("close",t[9]),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,r){const o={};r&33554439&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function Ot(t){let e,l,n,r,o,i,a,s;return i=gt(t[6][1]),{c(){e=$("label"),l=$("input"),n=A(),r=U(t[20]),o=A(),R(l,"type","radio"),l.__value=t[20],ae(l,l.__value),i.p(l)},m(u,c){b(u,e,c),d(e,l),l.checked=l.__value===t[1],d(e,n),d(e,r),d(e,o),a||(s=[Z(l,"change",t[5]),Z(l,"change",t[3])],a=!0)},p(u,c){c&2&&(l.checked=l.__value===u[1])},d(u){u&&v(e),i.r(),a=!1,Me(s)}}}function Bt(t){let e,l,n,r=!1,o,i=t[20]+"",a,s,u,c,m;return u=gt(t[6][0]),{c(){e=$("label"),l=$("input"),o=A(),a=U(i),s=A(),R(l,"type","radio"),l.__value=n=t[20],ae(l,l.__value),u.p(l)},m(p,f){b(p,e,f),d(e,l),l.checked=l.__value===t[2],d(e,o),d(e,a),d(e,s),c||(m=Z(l,"change",t[7]),c=!0)},p(p,f){f&2&&n!==(n=p[20])&&(l.__value=n,ae(l,l.__value),r=!0),(r||f&6)&&(l.checked=l.__value===p[2]),f&2&&i!==(i=p[20]+"")&&ie(a,i)},d(p){p&&v(e),u.r(),c=!1,m()}}}function Jt(t){let e,l=t[13]+"",n;return{c(){e=$("li"),n=U(l)},m(r,o){b(r,e,o),d(e,n)},p(r,o){o&6&&l!==(l=r[13]+"")&&ie(n,l)},d(r){r&&v(e)}}}function zt(t){let e,l=t[13]+"",n;return{c(){e=$("li"),n=U(l)},m(r,o){b(r,e,o),d(e,n)},p(r,o){o&6&&l!==(l=r[13]+"")&&ie(n,l)},d(r){r&&v(e)}}}function Rt(t){let e,l=t[13]+"",n;return{c(){e=$("li"),n=U(l)},m(r,o){b(r,e,o),d(e,n)},p(r,o){o&6&&l!==(l=r[13]+"")&&ie(n,l)},d(r){r&&v(e)}}}function Ht(t){let e,l,n=t[10].junctionType+"",r,o,i,a,s,u,c=t[10].movementType+"",m,p,f,g,_,L,h,j,O,G,B,z=Y(t[10].scoreZero),H=[];for(let w=0;w<z.length;w+=1)H[w]=Jt(Dt(t,z,w));let I=Y(t[10].scoreOne),M=[];for(let w=0;w<I.length;w+=1)M[w]=zt(Et(t,I,w));let T=Y(t[10].scoreTwo),N=[];for(let w=0;w<T.length;w+=1)N[w]=Rt(Nt(t,T,w));return{c(){e=$("tr"),l=$("td"),r=U(n),o=A(),i=$("br"),a=A(),s=$("br"),u=A(),m=U(c),p=A(),f=$("td"),g=$("ul");for(let w=0;w<H.length;w+=1)H[w].c();_=A(),L=$("td"),h=$("ul");for(let w=0;w<M.length;w+=1)M[w].c();j=A(),O=$("td"),G=$("ul");for(let w=0;w<N.length;w+=1)N[w].c();B=A(),R(l,"class","type-row svelte-k4kgn3"),R(f,"class","score-zero svelte-k4kgn3"),R(L,"class","score-one svelte-k4kgn3"),R(O,"class","score-two svelte-k4kgn3")},m(w,X){b(w,e,X),d(e,l),d(l,r),d(l,o),d(l,i),d(l,a),d(l,s),d(l,u),d(l,m),d(e,p),d(e,f),d(f,g);for(let C=0;C<H.length;C+=1)H[C]&&H[C].m(g,null);d(e,_),d(e,L),d(L,h);for(let C=0;C<M.length;C+=1)M[C]&&M[C].m(h,null);d(e,j),d(e,O),d(O,G);for(let C=0;C<N.length;C+=1)N[C]&&N[C].m(G,null);d(e,B)},p(w,X){if(X&6&&n!==(n=w[10].junctionType+"")&&ie(r,n),X&6&&c!==(c=w[10].movementType+"")&&ie(m,c),X&6){z=Y(w[10].scoreZero);let C;for(C=0;C<z.length;C+=1){const ke=Dt(w,z,C);H[C]?H[C].p(ke,X):(H[C]=Jt(ke),H[C].c(),H[C].m(g,null))}for(;C<H.length;C+=1)H[C].d(1);H.length=z.length}if(X&6){I=Y(w[10].scoreOne);let C;for(C=0;C<I.length;C+=1){const ke=Et(w,I,C);M[C]?M[C].p(ke,X):(M[C]=zt(ke),M[C].c(),M[C].m(h,null))}for(;C<M.length;C+=1)M[C].d(1);M.length=I.length}if(X&6){T=Y(w[10].scoreTwo);let C;for(C=0;C<T.length;C+=1){const ke=Nt(w,T,C);N[C]?N[C].p(ke,X):(N[C]=Rt(ke),N[C].c(),N[C].m(G,null))}for(;C<N.length;C+=1)N[C].d(1);N.length=T.length}},d(w){w&&v(e),oe(H,w),oe(M,w),oe(N,w)}}}function cr(t){let e,l,n,r,o,i,a,s,u,c,m,p,f,g,_,L,h,j=Y(yt),O=[];for(let I=0;I<j.length;I+=1)O[I]=Ot(Pt(t,j,I));let G=Y(ft(t[1])),B=[];for(let I=0;I<G.length;I+=1)B[I]=Bt(qt(t,G,I));let z=Y(Mt(t[1],t[2])),H=[];for(let I=0;I<z.length;I+=1)H[I]=Ht(It(t,z,I));return{c(){e=$("h1"),e.textContent="LTN 1/20 scoring guidance",l=A(),n=$("p"),n.innerHTML=`Guidance from <a target="_blank" href="https://assets.publishing.service.gov.uk/media/5ffa1f96d3bf7f65d9e35825/cycle-infrastructure-design-ltn-1-20.pdf">LTN 1/20 appendix B</a>
      .`,r=A(),o=$("div"),i=U(`Type of junction:
      `),a=$("fieldset");for(let I=0;I<O.length;I+=1)O[I].c();s=U(`

      Type of movement:
      `),u=$("fieldset");for(let I=0;I<B.length;I+=1)B[I].c();c=A(),m=$("table"),p=$("tr"),p.innerHTML=`<th class="type-header svelte-k4kgn3">Type of junction and movement</th> <th class="score-zero-header svelte-k4kgn3"><p class="svelte-k4kgn3"><b>Score = 0</b></p> <p class="svelte-k4kgn3">Suitable only for confident existing cyclists, and may be avoided by
            some experienced cyclists</p> <p class="svelte-k4kgn3">Conditions are most likely to give rise to the most common collision
            types</p></th> <th class="score-one-header svelte-k4kgn3"><p class="svelte-k4kgn3"><b>Score = 1</b></p> <p class="svelte-k4kgn3">Likely to be more acceptable to most cyclists, but may still pose
            problems for less confident or new cyclists</p> <p class="svelte-k4kgn3">The risk of collisions has been reduced by design layout or traffic
            management interventions</p></th> <th class="score-two-header svelte-k4kgn3"><p class="svelte-k4kgn3"><b>Score = 2</b></p> <p class="svelte-k4kgn3">Suitable for all potential and existing cyclists</p> <p class="svelte-k4kgn3">The potential for collisions has been removed, or managed to a high
            standard of safety for cyclists</p></th>`,f=A();for(let I=0;I<H.length;I+=1)H[I].c();g=A(),_=$("button"),_.textContent="OK",te(o,"display","flex"),te(o,"justify-content","space-between")},m(I,M){b(I,e,M),b(I,l,M),b(I,n,M),b(I,r,M),b(I,o,M),d(o,i),d(o,a);for(let T=0;T<O.length;T+=1)O[T]&&O[T].m(a,null);d(o,s),d(o,u);for(let T=0;T<B.length;T+=1)B[T]&&B[T].m(u,null);b(I,c,M),b(I,m,M),d(m,p),d(m,f);for(let T=0;T<H.length;T+=1)H[T]&&H[T].m(m,null);b(I,g,M),b(I,_,M),L||(h=Z(_,"click",t[8]),L=!0)},p(I,M){if(M&10){j=Y(yt);let T;for(T=0;T<j.length;T+=1){const N=Pt(I,j,T);O[T]?O[T].p(N,M):(O[T]=Ot(N),O[T].c(),O[T].m(a,null))}for(;T<O.length;T+=1)O[T].d(1);O.length=j.length}if(M&6){G=Y(ft(I[1]));let T;for(T=0;T<G.length;T+=1){const N=qt(I,G,T);B[T]?B[T].p(N,M):(B[T]=Bt(N),B[T].c(),B[T].m(u,null))}for(;T<B.length;T+=1)B[T].d(1);B.length=G.length}if(M&6){z=Y(Mt(I[1],I[2]));let T;for(T=0;T<z.length;T+=1){const N=It(I,z,T);H[T]?H[T].p(N,M):(H[T]=Ht(N),H[T].c(),H[T].m(m,null))}for(;T<H.length;T+=1)H[T].d(1);H.length=z.length}},d(I){I&&(v(e),v(l),v(n),v(r),v(o),v(c),v(m),v(g),v(_)),oe(O,I),oe(B,I),oe(H,I),L=!1,h()}}}function ur(t){let e,l,n,r,o,i,a=t[0]&&Ft(t);return{c(){e=$("button"),e.textContent="LTN 1/20 scoring guidance",l=A(),a&&a.c(),n=pt(),R(e,"class","secondary")},m(s,u){b(s,e,u),b(s,l,u),a&&a.m(s,u),b(s,n,u),r=!0,o||(i=Z(e,"click",t[4]),o=!0)},p(s,[u]){s[0]?a?(a.p(s,u),u&1&&k(a,1)):(a=Ft(s),a.c(),k(a,1),a.m(n.parentNode,n)):a&&(be(),y(a,1,1,()=>{a=null}),ve())},i(s){r||(k(a),r=!0)},o(s){y(a),r=!1},d(s){s&&(v(e),v(l),v(n)),a&&a.d(s),o=!1,i()}}}function fr(t,e,l){let n=!1,r=yt[0],o=ft(r)[0];function i(){l(2,o=ft(r)[0])}const a=[[],[]],s=()=>l(0,n=!0);function u(){r=this.__value,l(1,r)}function c(){o=this.__value,l(2,o)}return[n,r,o,i,s,u,a,c,()=>l(0,n=!1),()=>l(0,n=!1)]}class mr extends _e{constructor(e){super(),he(this,e,fr,ur,$e,{})}}function Gt(t,e,l){const n=t.slice();return n[11]=e[l][0],n[12]=e[l][1],n}function Ut(t){let e,l;return e=new mr({}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function Zt(t){let e,l,n,r=t[12]+"",o,i,a,s,u;return a=gt(t[7][0]),{c(){e=$("label"),l=$("input"),n=A(),o=U(r),i=A(),R(l,"type","radio"),l.__value=t[11],ae(l,l.__value),a.p(l)},m(c,m){b(c,e,m),d(e,l),l.checked=l.__value===t[3].jats[t[0]].properties[t[1]].movements[t[2]].score,d(e,n),d(e,o),d(e,i),s||(u=Z(l,"change",t[9]),s=!0)},p(c,m){m&15&&(l.checked=l.__value===c[3].jats[c[0]].properties[c[1]].movements[c[2]].score)},d(c){c&&v(e),a.r(),s=!1,u()}}}function dr(t){let e,l,n,r,o,i,a,s,u,c,m,p,f,g,_,L,h,j,O,G,B,z,H,I=t[3].jats[t[0]].properties[t[1]].movements[t[2]].kind=="cycling"&&Ut(),M=Y(t[4]),T=[];for(let N=0;N<M.length;N+=1)T[N]=Zt(Gt(t,M,N));return B=gt(t[7][1]),{c(){e=$("label"),l=U(`Name
  `),n=$("input"),r=A(),o=$("fieldset"),i=$("label"),a=$("input"),s=U(`
    Cycling`),u=A(),c=$("label"),m=$("input"),p=U(`
    Walking & Wheeling`),f=A(),I&&I.c(),g=A(),_=$("fieldset");for(let N=0;N<T.length;N+=1)T[N].c();L=A(),h=$("label"),j=U(`Comments
  `),O=$("textarea"),R(n,"type","text"),R(a,"type","radio"),a.__value="cycling",ae(a,a.__value),R(m,"type","radio"),m.__value="walking & wheeling",ae(m,m.__value),B.p(a,m)},m(N,w){b(N,e,w),d(e,l),d(e,n),ae(n,t[3].jats[t[0]].properties[t[1]].movements[t[2]].name),b(N,r,w),b(N,o,w),d(o,i),d(i,a),a.checked=a.__value===t[3].jats[t[0]].properties[t[1]].movements[t[2]].kind,d(i,s),d(o,u),d(o,c),d(c,m),m.checked=m.__value===t[3].jats[t[0]].properties[t[1]].movements[t[2]].kind,d(c,p),b(N,f,w),I&&I.m(N,w),b(N,g,w),b(N,_,w);for(let X=0;X<T.length;X+=1)T[X]&&T[X].m(_,null);b(N,L,w),b(N,h,w),d(h,j),d(h,O),ae(O,t[3].jats[t[0]].properties[t[1]].movements[t[2]].notes),G=!0,z||(H=[Z(n,"input",t[5]),Z(a,"change",t[6]),Z(m,"change",t[8]),Z(O,"input",t[10])],z=!0)},p(N,[w]){if(w&15&&n.value!==N[3].jats[N[0]].properties[N[1]].movements[N[2]].name&&ae(n,N[3].jats[N[0]].properties[N[1]].movements[N[2]].name),w&15&&(a.checked=a.__value===N[3].jats[N[0]].properties[N[1]].movements[N[2]].kind),w&15&&(m.checked=m.__value===N[3].jats[N[0]].properties[N[1]].movements[N[2]].kind),N[3].jats[N[0]].properties[N[1]].movements[N[2]].kind=="cycling"?I?w&15&&k(I,1):(I=Ut(),I.c(),k(I,1),I.m(g.parentNode,g)):I&&(be(),y(I,1,1,()=>{I=null}),ve()),w&31){M=Y(N[4]);let X;for(X=0;X<M.length;X+=1){const C=Gt(N,M,X);T[X]?T[X].p(C,w):(T[X]=Zt(C),T[X].c(),T[X].m(_,null))}for(;X<T.length;X+=1)T[X].d(1);T.length=M.length}w&15&&ae(O,N[3].jats[N[0]].properties[N[1]].movements[N[2]].notes)},i(N){G||(k(I),G=!0)},o(N){y(I),G=!1},d(N){N&&(v(e),v(r),v(o),v(f),v(g),v(_),v(L),v(h)),I&&I.d(N),oe(T,N),B.r(),z=!1,Me(H)}}}function pr(t,e,l){let n;re(t,K,g=>l(3,n=g));let{junctionIdx:r}=e,{stage:o}=e,{idx:i}=e,a=[["X","X - black"],["0","0 - red"],["1","1 - amber"],["2","2 - green"]];const s=[[],[]];function u(){n.jats[r].properties[o].movements[i].name=this.value,K.set(n)}function c(){n.jats[r].properties[o].movements[i].kind=this.__value,K.set(n)}function m(){n.jats[r].properties[o].movements[i].kind=this.__value,K.set(n)}function p(){n.jats[r].properties[o].movements[i].score=this.__value,K.set(n)}function f(){n.jats[r].properties[o].movements[i].notes=this.value,K.set(n)}return t.$$set=g=>{"junctionIdx"in g&&l(0,r=g.junctionIdx),"stage"in g&&l(1,o=g.stage),"idx"in g&&l(2,i=g.idx)},[r,o,i,n,a,u,c,s,m,p,f]}class gr extends _e{constructor(e){super(),he(this,e,pr,dr,$e,{junctionIdx:0,stage:1,idx:2})}}function _r(t){return t%(2*Math.PI)*180/Math.PI}function at(t){return t%360*Math.PI/180}function Kt(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Gn(t,e,l={}){if(l.final===!0)return hr(t,e);const n=Kt(t),r=Kt(e),o=at(n[0]),i=at(r[0]),a=at(n[1]),s=at(r[1]),u=Math.sin(i-o)*Math.cos(s),c=Math.cos(a)*Math.sin(s)-Math.sin(a)*Math.cos(s)*Math.cos(i-o);return _r(Math.atan2(u,c))}function hr(t,e){let l=Gn(e,t);return l=(l+180)%360,l}var Xe=Gn;function $r(t,e,l={}){const n={type:"Feature"};return(l.id===0||l.id)&&(n.id=l.id),l.bbox&&(n.bbox=l.bbox),n.properties=e||{},n.geometry=t,n}function kr(t,e,l={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Xt(t[0])||!Xt(t[1]))throw new Error("coordinates must contain numbers");return $r({type:"Point",coordinates:t},e,l)}function Xt(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function br(t,e={}){const l=rl(t),n=(l[0]+l[2])/2,r=(l[1]+l[3])/2;return kr([n,r],e.properties,e)}var vr=br,Ae=63710088e-1,wr={centimeters:Ae*100,centimetres:Ae*100,degrees:360/(2*Math.PI),feet:Ae*3.28084,inches:Ae*39.37,kilometers:Ae/1e3,kilometres:Ae/1e3,meters:Ae,metres:Ae,miles:Ae/1609.344,millimeters:Ae*1e3,millimetres:Ae*1e3,nauticalmiles:Ae/1852,radians:1,yards:Ae*1.0936};function yr(t,e,l={}){const n={type:"Feature"};return(l.id===0||l.id)&&(n.id=l.id),l.bbox&&(n.bbox=l.bbox),n.properties=e||{},n.geometry=t,n}function jr(t,e,l={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Vt(t[0])||!Vt(t[1]))throw new Error("coordinates must contain numbers");return yr({type:"Point",coordinates:t},e,l)}function Cr(t,e="kilometers"){const l=wr[e];if(!l)throw new Error(e+" units is invalid");return t/l}function Wt(t){return t%(2*Math.PI)*180/Math.PI}function kt(t){return t%360*Math.PI/180}function Vt(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function Ar(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Lr(t,e,l,n={}){const r=Ar(t),o=kt(r[0]),i=kt(r[1]),a=kt(l),s=Cr(e,n.units),u=Math.asin(Math.sin(i)*Math.cos(s)+Math.cos(i)*Math.sin(s)*Math.cos(a)),c=o+Math.atan2(Math.sin(a)*Math.sin(s)*Math.cos(i),Math.cos(s)-Math.sin(i)*Math.sin(u)),m=Wt(c),p=Wt(u);return jr([m,p],n.properties)}var nt=Lr,Le=63710088e-1,Sr={centimeters:Le*100,centimetres:Le*100,degrees:360/(2*Math.PI),feet:Le*3.28084,inches:Le*39.37,kilometers:Le/1e3,kilometres:Le/1e3,meters:Le,metres:Le,miles:Le/1609.344,millimeters:Le*1e3,millimetres:Le*1e3,nauticalmiles:Le/1852,radians:1,yards:Le*1.0936};function Tr(t,e="kilometers"){const l=Sr[e];if(!l)throw new Error(e+" units is invalid");return t*l}function ct(t){return t%360*Math.PI/180}function Qt(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Mr(t,e,l={}){var n=Qt(t),r=Qt(e),o=ct(r[1]-n[1]),i=ct(r[0]-n[0]),a=ct(n[1]),s=ct(r[1]),u=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(a)*Math.cos(s);return Tr(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),l.units)}var Ir=Mr;function Nr(t){let e=vr({type:"FeatureCollection",features:t.map(n=>({type:"Feature",geometry:{type:"Point",coordinates:n.point},properties:{}}))}).geometry.coordinates;t.sort((n,r)=>Yt(Xe(e,r.point))-Yt(Xe(e,n.point)));let l=[];for(let n=0;n<t.length;n++){let r=t[n],o=Xe(r.point,e),i=1;for(let a of Dr(n,t.length)){let s=t[a],u=Xe(e,s.point),c=Er(r.point,e,i++),m=Ir(r.point,e),p=nt(c,.5*m,o).geometry.coordinates,f=nt(p,.2*m,u).geometry.coordinates;l.push({point1:c,point2:p,point3:f,kind:"cycling",score:"X",name:`${r.name} to ${s.name}`,notes:""})}}return l}function Er(t,e,l){let n=.003,o=Xe(t,e)-90,i=n*l;return nt(t,i,o).geometry.coordinates}function Yt(t){return(t+360)%360}function Dr(t,e){let l=[];for(let n=t+1;n<e;n++)l.push(n);for(let n=0;n<t;n++)l.push(n);return l}const qr="/route-element/assets/movement-aa45473c.svg",Pr="/route-element/assets/pan-fbcec4cd.svg";function xt(t,e,l){const n=t.slice();return n[31]=e[l],n[32]=e,n[33]=l,n}function en(t,e,l){const n=t.slice();return n[34]=e[l],n[35]=e,n[33]=l,n}function tn(t){let e,l,n,r,o,i,a,s,u,c,m,p,f,g,_,L,h,j,O;function G(X,C){return X[0].mode=="select"?Or:Fr}let B=G(t),z=B(t);function H(X,C){return X[0].mode=="new-arm"?Jr:Br}let I=H(t),M=I(t);function T(X,C){return X[0].mode=="new-movement"?Rr:zr}let N=T(t),w=N(t);return{c(){e=$("div"),l=$("button"),n=$("img"),o=A(),z.c(),i=A(),a=$("button"),s=$t("svg"),u=$t("circle"),c=$t("text"),m=U("A"),p=A(),M.c(),f=A(),g=$("button"),_=$("img"),h=A(),w.c(),bt(n.src,r=Pr)||R(n,"src",r),R(n,"alt","Move map"),te(n,"vertical-align","middle"),R(l,"class","outline"),R(u,"cx","12"),R(u,"cy","12"),R(u,"r","12"),R(u,"fill","white"),R(c,"x","6"),R(c,"y","16"),R(c,"fill","#4472c4"),R(s,"width","24"),R(s,"height","24"),R(s,"xmlns","http://www.w3.org/2000/svg"),te(s,"vertical-align","middle"),R(a,"class","outline"),bt(_.src,L=qr)||R(_,"src",L),R(_,"alt","New movement"),te(_,"vertical-align","middle"),R(g,"class","outline"),R(e,"class","control-panel svelte-l1e6xi")},m(X,C){b(X,e,C),d(e,l),d(l,n),d(l,o),z.m(l,null),d(e,i),d(e,a),d(a,s),d(s,u),d(s,c),d(c,m),d(a,p),M.m(a,null),d(e,f),d(e,g),d(g,_),d(g,h),w.m(g,null),j||(O=[Z(l,"click",function(){ol(t[4])&&t[4].apply(this,arguments)}),Z(a,"click",t[12]),Z(g,"click",t[13])],j=!0)},p(X,C){t=X,B!==(B=G(t))&&(z.d(1),z=B(t),z&&(z.c(),z.m(l,null))),I!==(I=H(t))&&(M.d(1),M=I(t),M&&(M.c(),M.m(a,null))),N!==(N=T(t))&&(w.d(1),w=N(t),w&&(w.c(),w.m(g,null)))},d(X){X&&v(e),z.d(),M.d(),w.d(),j=!1,Me(O)}}}function Fr(t){let e;return{c(){e=U("Move map")},m(l,n){b(l,e,n)},d(l){l&&v(e)}}}function Or(t){let e;return{c(){e=$("b"),e.textContent="Move map"},m(l,n){b(l,e,n)},d(l){l&&v(e)}}}function Br(t){let e;return{c(){e=U("New arm")},m(l,n){b(l,e,n)},d(l){l&&v(e)}}}function Jr(t){let e;return{c(){e=$("b"),e.textContent="New arm"},m(l,n){b(l,e,n)},d(l){l&&v(e)}}}function zr(t){let e;return{c(){e=U("New movement")},m(l,n){b(l,e,n)},d(l){l&&v(e)}}}function Rr(t){let e;return{c(){e=$("b"),e.textContent="New movement"},m(l,n){b(l,e,n)},d(l){l&&v(e)}}}function Hr(t){let e;return{c(){e=$("span"),e.textContent=`${to(t[33])}`,R(e,"class","dot svelte-l1e6xi"),te(e,"color","#4472c4"),te(e,"background-color","white")},m(l,n){b(l,e,n)},p:le,d(l){l&&v(e)}}}function nn(t){let e,l,n;function r(s){t[14](s,t[34])}function o(){return t[15](t[33])}function i(){return t[16](t[33])}let a={draggable:!0,$$slots:{default:[Hr]},$$scope:{ctx:t}};return t[34].point!==void 0&&(a.lngLat=t[34].point),e=new Fe({props:a}),we.push(()=>Ne(e,"lngLat",r)),e.$on("dragend",o),e.$on("click",i),{c(){D(e.$$.fragment)},m(s,u){q(e,s,u),n=!0},p(s,u){t=s;const c={};u[1]&32&&(c.$$scope={dirty:u,ctx:t}),!l&&u[0]&38&&(l=!0,c.lngLat=t[34].point,Ee(()=>l=!1)),e.$set(c)},i(s){n||(k(e.$$.fragment,s),n=!0)},o(s){y(e.$$.fragment,s),n=!1},d(s){P(e,s)}}}function Gr(t){let e;return{c(){e=$("span"),R(e,"class","dot svelte-l1e6xi"),te(e,"background-color",t[7][t[31].score]),te(e,"opacity",t[31].kind=="walking & wheeling"?"0%":"100%")},m(l,n){b(l,e,n)},p(l,n){n[0]&38&&te(e,"background-color",l[7][l[31].score]),n[0]&38&&te(e,"opacity",l[31].kind=="walking & wheeling"?"0%":"100%")},d(l){l&&v(e)}}}function Ur(t){let e;return{c(){e=$("span"),R(e,"class","dot svelte-l1e6xi"),te(e,"background-color",t[7][t[31].score])},m(l,n){b(l,e,n)},p(l,n){n[0]&38&&te(e,"background-color",l[7][l[31].score])},d(l){l&&v(e)}}}function Zr(t){let e;return{c(){e=$("span"),R(e,"class","dot svelte-l1e6xi"),te(e,"background-color",t[7][t[31].score]),te(e,"opacity","0%")},m(l,n){b(l,e,n)},p(l,n){n[0]&38&&te(e,"background-color",l[7][l[31].score])},d(l){l&&v(e)}}}function ln(t){let e,l,n,r,o,i,a,s,u;function c(z){t[17](z,t[31])}function m(){return t[18](t[33])}function p(){return t[19](t[33])}let f={draggable:!0,$$slots:{default:[Gr]},$$scope:{ctx:t}};t[31].point1!==void 0&&(f.lngLat=t[31].point1),e=new Fe({props:f}),we.push(()=>Ne(e,"lngLat",c)),e.$on("dragend",m),e.$on("click",p);function g(z){t[20](z,t[31])}function _(){return t[21](t[33])}function L(){return t[22](t[33])}let h={draggable:!0,$$slots:{default:[Ur]},$$scope:{ctx:t}};t[31].point2!==void 0&&(h.lngLat=t[31].point2),r=new Fe({props:h}),we.push(()=>Ne(r,"lngLat",g)),r.$on("dragend",_),r.$on("click",L);function j(z){t[23](z,t[31])}function O(){return t[24](t[33])}function G(){return t[25](t[33])}let B={draggable:!0,$$slots:{default:[Zr]},$$scope:{ctx:t}};return t[31].point3!==void 0&&(B.lngLat=t[31].point3),a=new Fe({props:B}),we.push(()=>Ne(a,"lngLat",j)),a.$on("dragend",O),a.$on("click",G),{c(){D(e.$$.fragment),n=A(),D(r.$$.fragment),i=A(),D(a.$$.fragment)},m(z,H){q(e,z,H),b(z,n,H),q(r,z,H),b(z,i,H),q(a,z,H),u=!0},p(z,H){t=z;const I={};H[0]&38|H[1]&32&&(I.$$scope={dirty:H,ctx:t}),!l&&H[0]&38&&(l=!0,I.lngLat=t[31].point1,Ee(()=>l=!1)),e.$set(I);const M={};H[0]&38|H[1]&32&&(M.$$scope={dirty:H,ctx:t}),!o&&H[0]&38&&(o=!0,M.lngLat=t[31].point2,Ee(()=>o=!1)),r.$set(M);const T={};H[0]&38|H[1]&32&&(T.$$scope={dirty:H,ctx:t}),!s&&H[0]&38&&(s=!0,T.lngLat=t[31].point3,Ee(()=>s=!1)),a.$set(T)},i(z){u||(k(e.$$.fragment,z),k(r.$$.fragment,z),k(a.$$.fragment,z),u=!0)},o(z){y(e.$$.fragment,z),y(r.$$.fragment,z),y(a.$$.fragment,z),u=!1},d(z){z&&(v(n),v(i)),P(e,z),P(r,z),P(a,z)}}}function Kr(t){let e=(t[30].name||"Untitled movement")+"",l;return{c(){l=U(e)},m(n,r){b(n,l,r)},p(n,r){r[0]&1073741824&&e!==(e=(n[30].name||"Untitled movement")+"")&&ie(l,e)},d(n){n&&v(l)}}}function Xr(t){let e,l;return e=new Jn({props:{$$slots:{default:[Kr,({props:n})=>({30:n}),({props:n})=>[n?1073741824:0]]},$$scope:{ctx:t}}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,r){const o={};r[0]&1073741824|r[1]&32&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function Wr(t){let e=(t[30].name||"Untitled movement")+"",l;return{c(){l=U(e)},m(n,r){b(n,l,r)},p(n,r){r[0]&1073741824&&e!==(e=(n[30].name||"Untitled movement")+"")&&ie(l,e)},d(n){n&&v(l)}}}function Vr(t){let e,l;return e=new Jn({props:{$$slots:{default:[Wr,({props:n})=>({30:n}),({props:n})=>[n?1073741824:0]]},$$scope:{ctx:t}}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,r){const o={};r[0]&1073741824|r[1]&32&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function Qr(t){let e,l,n,r,o,i;return e=new xe({props:{id:"jat-cycling",manageHoverState:!0,paint:{"line-width":tt(6,10),"line-color":["get","color"]},filter:["==",["get","kind"],"cycling"],$$slots:{default:[Xr]},$$scope:{ctx:t}}}),e.$on("click",t[9]),n=new xe({props:{id:"jat-walking-wheeling",manageHoverState:!0,paint:{"line-width":tt(6,8),"line-color":["get","color"],"line-dasharray":[3,2]},filter:["==",["get","kind"],"walking & wheeling"],$$slots:{default:[Vr]},$$scope:{ctx:t}}}),n.$on("click",t[9]),o=new gl({props:{id:"jat-arrow",filter:["has","angle"],paint:{"text-color":["get","color"],"text-halo-color":"white","text-halo-width":3},layout:{"text-field":"⬆","text-overlap":"always","text-rotate":["get","angle"],"text-size":70}}}),{c(){D(e.$$.fragment),l=A(),D(n.$$.fragment),r=A(),D(o.$$.fragment)},m(a,s){q(e,a,s),b(a,l,s),q(n,a,s),b(a,r,s),q(o,a,s),i=!0},p(a,s){const u={};s[1]&32&&(u.$$scope={dirty:s,ctx:a}),e.$set(u);const c={};s[1]&32&&(c.$$scope={dirty:s,ctx:a}),n.$set(c)},i(a){i||(k(e.$$.fragment,a),k(n.$$.fragment,a),k(o.$$.fragment,a),i=!0)},o(a){y(e.$$.fragment,a),y(n.$$.fragment,a),y(o.$$.fragment,a),i=!1},d(a){a&&(v(l),v(r)),P(e,a),P(n,a),P(o,a)}}}function Yr(t){let e,l,n,r;return e=new xe({props:{paint:{"line-width":5,"line-color":"yellow","line-gap-width":45}}}),n=new De({props:{filter:["==",["get","kind"],"arm"],paint:{"circle-radius":20,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){D(e.$$.fragment),l=A(),D(n.$$.fragment)},m(o,i){q(e,o,i),b(o,l,i),q(n,o,i),r=!0},p:le,i(o){r||(k(e.$$.fragment,o),k(n.$$.fragment,o),r=!0)},o(o){y(e.$$.fragment,o),y(n.$$.fragment,o),r=!1},d(o){o&&v(l),P(e,o),P(n,o)}}}function xr(t){let e,l,n,r,o,i,a,s,u;e=new zn({}),e.$on("click",t[8]);let c=t[0].mode!="editing"&&tn(t),m=Y(t[5].jats[t[1]].properties[t[2]].arms),p=[];for(let h=0;h<m.length;h+=1)p[h]=nn(en(t,m,h));const f=h=>y(p[h],1,1,()=>{p[h]=null});let g=Y(t[5].jats[t[1]].properties[t[2]].movements),_=[];for(let h=0;h<g.length;h+=1)_[h]=ln(xt(t,g,h));const L=h=>y(_[h],1,1,()=>{_[h]=null});return i=new Ce({props:{data:t[10](t[5]),$$slots:{default:[Qr]},$$scope:{ctx:t}}}),s=new Ce({props:{data:t[6],$$slots:{default:[Yr]},$$scope:{ctx:t}}}),{c(){D(e.$$.fragment),l=A(),c&&c.c(),n=A();for(let h=0;h<p.length;h+=1)p[h].c();r=A();for(let h=0;h<_.length;h+=1)_[h].c();o=A(),D(i.$$.fragment),a=A(),D(s.$$.fragment)},m(h,j){q(e,h,j),b(h,l,j),c&&c.m(h,j),b(h,n,j);for(let O=0;O<p.length;O+=1)p[O]&&p[O].m(h,j);b(h,r,j);for(let O=0;O<_.length;O+=1)_[O]&&_[O].m(h,j);b(h,o,j),q(i,h,j),b(h,a,j),q(s,h,j),u=!0},p(h,j){if(h[0].mode!="editing"?c?c.p(h,j):(c=tn(h),c.c(),c.m(n.parentNode,n)):c&&(c.d(1),c=null),j[0]&46){m=Y(h[5].jats[h[1]].properties[h[2]].arms);let B;for(B=0;B<m.length;B+=1){const z=en(h,m,B);p[B]?(p[B].p(z,j),k(p[B],1)):(p[B]=nn(z),p[B].c(),k(p[B],1),p[B].m(r.parentNode,r))}for(be(),B=m.length;B<p.length;B+=1)f(B);ve()}if(j[0]&174){g=Y(h[5].jats[h[1]].properties[h[2]].movements);let B;for(B=0;B<g.length;B+=1){const z=xt(h,g,B);_[B]?(_[B].p(z,j),k(_[B],1)):(_[B]=ln(z),_[B].c(),k(_[B],1),_[B].m(o.parentNode,o))}for(be(),B=g.length;B<_.length;B+=1)L(B);ve()}const O={};j[0]&32&&(O.data=h[10](h[5])),j[1]&32&&(O.$$scope={dirty:j,ctx:h}),i.$set(O);const G={};j[0]&64&&(G.data=h[6]),j[1]&32&&(G.$$scope={dirty:j,ctx:h}),s.$set(G)},i(h){if(!u){k(e.$$.fragment,h);for(let j=0;j<m.length;j+=1)k(p[j]);for(let j=0;j<g.length;j+=1)k(_[j]);k(i.$$.fragment,h),k(s.$$.fragment,h),u=!0}},o(h){y(e.$$.fragment,h),p=p.filter(Boolean);for(let j=0;j<p.length;j+=1)y(p[j]);_=_.filter(Boolean);for(let j=0;j<_.length;j+=1)y(_[j]);y(i.$$.fragment,h),y(s.$$.fragment,h),u=!1},d(h){h&&(v(l),v(n),v(r),v(o),v(a)),P(e,h),c&&c.d(h),oe(p,h),oe(_,h),P(i,h),P(s,h)}}}function eo(t,e){return{type:"Feature",id:e,properties:{kind:"arm"},geometry:{type:"Point",coordinates:t.point}}}function to(t){return String.fromCharCode(t+"A".charCodeAt(0))}function no(t,e,l){let n,r,o;re(t,K,F=>l(5,r=F)),re(t,ut,F=>l(26,o=F));let{junctionIdx:i}=e,{stage:a}=e,{mode:s}=e,{hoveringSidebar:u}=e,{select:c}=e,{stopEditing:m}=e,p={0:Pe.red.background,1:Pe.amber.background,2:Pe.green.background,X:Pe.critical.background};function f(F,W,ye){let se={type:"FeatureCollection",features:[]},E=W.mode=="editing"?W.id:ye;return E!=null&&(E.kind=="arm"?se.features.push(eo(F.jats[i].properties[a].arms[E.idx],E.idx)):se.features.push(h(F.jats[i].properties[a].movements[E.idx],E.idx))),se}async function g(F){if(o){for(let W of o.queryRenderedFeatures(F.detail.point,{layers:["jat-cycling","jat-walking-wheeling"]}))return;if(s.mode!="select"){if(s.mode=="editing"){await m();return}s.mode=="new-arm"?(ee(K,r.jats[i].properties[a].arms=[...r.jats[i].properties[a].arms,{point:F.detail.lngLat.toArray(),name:""}],r),await c({kind:"arm",idx:r.jats[i].properties[a].arms.length-1})):(ee(K,r.jats[i].properties[a].movements=[...r.jats[i].properties[a].movements,{point1:F.detail.lngLat.toArray(),point2:nt(F.detail.lngLat.toArray(),.005,0).geometry.coordinates,point3:nt(F.detail.lngLat.toArray(),.01,0).geometry.coordinates,kind:"cycling",score:"X",name:"",notes:""}],r),await c({kind:"movement",idx:r.jats[i].properties[a].movements.length-1}))}}}async function _(F){await c({kind:"movement",idx:F.detail.features[0].id})}function L(F){let W={type:"FeatureCollection",features:F.jats[i].properties[a].movements.map((ye,se)=>h(ye,se))};for(let ye of F.jats[i].properties[a].movements)if(W.features.push(j(ye,W.features.length)),ye.kind=="walking & wheeling"){let se={...ye,point1:ye.point3,point3:ye.point1};W.features.push(j(se,W.features.length))}return W}function h(F,W){return{type:"Feature",id:W,properties:{name:F.name,kind:F.kind,color:p[F.score]},geometry:{type:"LineString",coordinates:[F.point1,F.point2,F.point3]}}}function j(F,W){return{type:"Feature",id:W,properties:{kind:F.kind,color:p[F.score],angle:Xe(F.point2,F.point3)},geometry:{type:"Point",coordinates:F.point3}}}const O=()=>l(0,s={mode:"new-arm"}),G=()=>l(0,s={mode:"new-movement"});function B(F,W){t.$$.not_equal(W.point,F)&&(W.point=F,K.set(r))}const z=F=>c({kind:"arm",idx:F}),H=F=>c({kind:"arm",idx:F});function I(F,W){t.$$.not_equal(W.point1,F)&&(W.point1=F,K.set(r))}const M=F=>c({kind:"movement",idx:F}),T=F=>c({kind:"movement",idx:F});function N(F,W){t.$$.not_equal(W.point2,F)&&(W.point2=F,K.set(r))}const w=F=>c({kind:"movement",idx:F}),X=F=>c({kind:"movement",idx:F});function C(F,W){t.$$.not_equal(W.point3,F)&&(W.point3=F,K.set(r))}const ke=F=>c({kind:"movement",idx:F}),ue=F=>c({kind:"movement",idx:F});return t.$$set=F=>{"junctionIdx"in F&&l(1,i=F.junctionIdx),"stage"in F&&l(2,a=F.stage),"mode"in F&&l(0,s=F.mode),"hoveringSidebar"in F&&l(11,u=F.hoveringSidebar),"select"in F&&l(3,c=F.select),"stopEditing"in F&&l(4,m=F.stopEditing)},t.$$.update=()=>{t.$$.dirty[0]&2081&&l(6,n=f(r,s,u))},[s,i,a,c,m,r,n,p,g,_,L,u,O,G,B,z,H,I,M,T,N,w,X,C,ke,ue]}class lo extends _e{constructor(e){super(),he(this,e,no,xr,$e,{junctionIdx:1,stage:2,mode:0,hoveringSidebar:11,select:3,stopEditing:4},null,[-1,-1])}}function rn(t){if(t.movements.length==0)return"No movements added";let e=0,l=0;for(let r of t.movements)e+={0:0,1:1,2:2,X:0}[r.score],l+=2;let n=e/l*100;return`${Math.round(n)}%`}const{window:ro}=rt;function on(t,e,l){const n=t.slice();n[27]=e[l],n[30]=l;const r=n[14][n[27].score];return n[28]=r,n}function sn(t,e,l){const n=t.slice();return n[31]=e[l],n[30]=l,n}function oo(t){let e,l,n,r,o,i,a,s,u;return{c(){e=$("button"),e.textContent="Done",l=A(),n=$("button"),n.textContent="Delete",r=A(),o=$("label"),i=U(`Arm name
        `),a=$("input"),R(a,"type","text")},m(c,m){b(c,e,m),b(c,l,m),b(c,n,m),b(c,r,m),b(c,o,m),d(o,i),d(o,a),ae(a,t[5].jats[t[0]].properties[t[1]].arms[t[2].id.idx].name),s||(u=[Z(e,"click",t[23]),Z(n,"click",t[10]),Z(a,"input",t[24])],s=!0)},p(c,m){m[0]&39&&a.value!==c[5].jats[c[0]].properties[c[1]].arms[c[2].id.idx].name&&ae(a,c[5].jats[c[0]].properties[c[1]].arms[c[2].id.idx].name)},i:le,o:le,d(c){c&&(v(e),v(l),v(n),v(r),v(o)),s=!1,Me(u)}}}function io(t){let e,l,n,r,o,i,a,s;return e=new gr({props:{junctionIdx:t[0],stage:t[1],idx:t[2].id.idx}}),{c(){D(e.$$.fragment),l=A(),n=$("button"),n.textContent="Save",r=A(),o=$("button"),o.textContent="Delete"},m(u,c){q(e,u,c),b(u,l,c),b(u,n,c),b(u,r,c),b(u,o,c),i=!0,a||(s=[Z(n,"click",t[9]),Z(o,"click",t[10])],a=!0)},p(u,c){const m={};c[0]&1&&(m.junctionIdx=u[0]),c[0]&2&&(m.stage=u[1]),c[0]&4&&(m.idx=u[2].id.idx),e.$set(m)},i(u){i||(k(e.$$.fragment,u),i=!0)},o(u){y(e.$$.fragment,u),i=!1},d(u){u&&(v(l),v(n),v(r),v(o)),P(e,u),a=!1,Me(s)}}}function so(t){let e,l,n,r,o,i,a,s,u,c,m,p,f,g=t[5].jats[t[0]].properties.name+"",_,L,h=rn(t[5].jats[t[0]].properties[t[1]])+"",j,O,G,B,z,H,I,M,T,N,w,X=Y(t[5].jats[t[0]].properties[t[1]].arms),C=[];for(let E=0;E<X.length;E+=1)C[E]=an(sn(t,X,E));const ke=E=>y(C[E],1,1,()=>{C[E]=null});let ue=t[5].jats[t[0]].properties[t[7]].arms.length>0&&cn(t),F=Y(t[5].jats[t[0]].properties[t[1]].movements),W=[];for(let E=0;E<F.length;E+=1)W[E]=un(on(t,F,E));const ye=E=>y(W[E],1,1,()=>{W[E]=null});let se=t[5].jats[t[0]].properties[t[7]].movements.length>0&&fn(t);return{c(){e=$("button"),e.textContent="Done",l=A(),n=$("h3"),n.textContent="Arms",r=A();for(let E=0;E<C.length;E+=1)C[E].c();o=A(),ue&&ue.c(),i=A(),a=$("h3"),a.textContent="Movements",s=A(),u=$("p"),c=U("Total JAT score for "),m=U(t[1]),p=U(` junction
        `),f=$("i"),_=U(g),L=U(`
        : `),j=U(h),O=A(),G=$("button"),B=U("Generate cycling movements between all arms"),H=A();for(let E=0;E<W.length;E+=1)W[E].c();I=A(),se&&se.c(),M=pt(),R(G,"class","secondary"),G.disabled=z=t[5].jats[t[0]].properties[t[1]].arms.length<2},m(E,Q){b(E,e,Q),b(E,l,Q),b(E,n,Q),b(E,r,Q);for(let x=0;x<C.length;x+=1)C[x]&&C[x].m(E,Q);b(E,o,Q),ue&&ue.m(E,Q),b(E,i,Q),b(E,a,Q),b(E,s,Q),b(E,u,Q),d(u,c),d(u,m),d(u,p),d(u,f),d(f,_),d(u,L),d(u,j),b(E,O,Q),b(E,G,Q),d(G,B),b(E,H,Q);for(let x=0;x<W.length;x+=1)W[x]&&W[x].m(E,Q);b(E,I,Q),se&&se.m(E,Q),b(E,M,Q),T=!0,N||(w=[Z(e,"click",t[16]),Z(G,"click",t[15])],N=!0)},p(E,Q){if(Q[0]&299){X=Y(E[5].jats[E[0]].properties[E[1]].arms);let x;for(x=0;x<X.length;x+=1){const qe=sn(E,X,x);C[x]?(C[x].p(qe,Q),k(C[x],1)):(C[x]=an(qe),C[x].c(),k(C[x],1),C[x].m(o.parentNode,o))}for(be(),x=X.length;x<C.length;x+=1)ke(x);ve()}if(E[5].jats[E[0]].properties[E[7]].arms.length>0?ue?ue.p(E,Q):(ue=cn(E),ue.c(),ue.m(i.parentNode,i)):ue&&(ue.d(1),ue=null),(!T||Q[0]&2)&&ie(m,E[1]),(!T||Q[0]&33)&&g!==(g=E[5].jats[E[0]].properties.name+"")&&ie(_,g),(!T||Q[0]&35)&&h!==(h=rn(E[5].jats[E[0]].properties[E[1]])+"")&&ie(j,h),(!T||Q[0]&35&&z!==(z=E[5].jats[E[0]].properties[E[1]].arms.length<2))&&(G.disabled=z),Q[0]&16683){F=Y(E[5].jats[E[0]].properties[E[1]].movements);let x;for(x=0;x<F.length;x+=1){const qe=on(E,F,x);W[x]?(W[x].p(qe,Q),k(W[x],1)):(W[x]=un(qe),W[x].c(),k(W[x],1),W[x].m(I.parentNode,I))}for(be(),x=F.length;x<W.length;x+=1)ye(x);ve()}E[5].jats[E[0]].properties[E[7]].movements.length>0?se?se.p(E,Q):(se=fn(E),se.c(),se.m(M.parentNode,M)):se&&(se.d(1),se=null)},i(E){if(!T){for(let Q=0;Q<X.length;Q+=1)k(C[Q]);for(let Q=0;Q<F.length;Q+=1)k(W[Q]);T=!0}},o(E){C=C.filter(Boolean);for(let Q=0;Q<C.length;Q+=1)y(C[Q]);W=W.filter(Boolean);for(let Q=0;Q<W.length;Q+=1)y(W[Q]);T=!1},d(E){E&&(v(e),v(l),v(n),v(r),v(o),v(i),v(a),v(s),v(u),v(O),v(G),v(H),v(I),v(M)),oe(C,E),ue&&ue.d(E),oe(W,E),se&&se.d(E),N=!1,Me(w)}}}function an(t){let e,l;function n(){return t[17](t[30])}function r(){return t[18](t[30])}return e=new Rn({props:{name:`${mn(t[30])} - ${t[31].name||"Unnamed arm"}`,hasSlot:!1}}),e.$on("click",n),e.$on("mouseenter",r),e.$on("mouseleave",t[19]),{c(){D(e.$$.fragment)},m(o,i){q(e,o,i),l=!0},p(o,i){t=o;const a={};i[0]&35&&(a.name=`${mn(t[30])} - ${t[31].name||"Unnamed arm"}`),e.$set(a)},i(o){l||(k(e.$$.fragment,o),l=!0)},o(o){y(e.$$.fragment,o),l=!1},d(o){P(e,o)}}}function cn(t){let e,l,n;return{c(){e=$("button"),e.textContent=`Copy arms from ${t[7]}`,R(e,"class","secondary")},m(r,o){b(r,e,o),l||(n=Z(e,"click",t[12]),l=!0)},p:le,d(r){r&&v(e),l=!1,n()}}}function ao(t){let e,l,n,r=t[27].score+"",o,i,a,s=dn(t[27].kind)+"",u;return{c(){e=$("div"),l=$("span"),n=U("Score: "),o=U(r),i=A(),a=$("span"),u=U(s),te(l,"padding","4px"),te(l,"color",t[28].font),te(l,"background-color",t[28].background),te(e,"width","100%"),te(e,"display","flex"),te(e,"justify-content","space-between")},m(c,m){b(c,e,m),d(e,l),d(l,n),d(l,o),d(e,i),d(e,a),d(a,u)},p(c,m){m[0]&35&&r!==(r=c[27].score+"")&&ie(o,r),m[0]&35&&te(l,"color",c[28].font),m[0]&35&&te(l,"background-color",c[28].background),m[0]&35&&s!==(s=dn(c[27].kind)+"")&&ie(u,s)},d(c){c&&v(e)}}}function un(t){let e,l;function n(){return t[20](t[30])}function r(){return t[21](t[30])}return e=new Rn({props:{name:t[27].name||"Unnamed movement",$$slots:{default:[ao]},$$scope:{ctx:t}}}),e.$on("click",n),e.$on("mouseenter",r),e.$on("mouseleave",t[22]),{c(){D(e.$$.fragment)},m(o,i){q(e,o,i),l=!0},p(o,i){t=o;const a={};i[0]&35&&(a.name=t[27].name||"Unnamed movement"),i[0]&35|i[1]&4&&(a.$$scope={dirty:i,ctx:t}),e.$set(a)},i(o){l||(k(e.$$.fragment,o),l=!0)},o(o){y(e.$$.fragment,o),l=!1},d(o){P(e,o)}}}function fn(t){let e,l,n;return{c(){e=$("button"),e.textContent=`Copy movements from ${t[7]}`,R(e,"class","secondary")},m(r,o){b(r,e,o),l||(n=Z(e,"click",t[13]),l=!0)},p:le,d(r){r&&v(e),l=!1,n()}}}function co(t){let e,l,n,r,o=t[5].jats[t[0]].properties.name+"",i,a,s,u,c;const m=[so,io,oo],p=[];function f(g,_){return g[2].mode!="editing"?0:g[2].id.kind=="movement"?1:2}return s=f(t),u=p[s]=m[s](t),{c(){e=$("div"),l=$("h2"),n=U(t[1]),r=U(" JAT for "),i=U(o),a=A(),u.c(),R(e,"slot","sidebar")},m(g,_){b(g,e,_),d(e,l),d(l,n),d(l,r),d(l,i),d(e,a),p[s].m(e,null),t[25](e),c=!0},p(g,_){(!c||_[0]&2)&&ie(n,g[1]),(!c||_[0]&33)&&o!==(o=g[5].jats[g[0]].properties.name+"")&&ie(i,o);let L=s;s=f(g),s===L?p[s].p(g,_):(be(),y(p[L],1,1,()=>{p[L]=null}),ve(),u=p[s],u?u.p(g,_):(u=p[s]=m[s](g),u.c()),k(u,1),u.m(e,null))},i(g){c||(k(u),c=!0)},o(g){y(u),c=!1},d(g){g&&v(e),p[s].d(),t[25](null)}}}function uo(t){let e,l;return e=new De({props:{filter:["!=",["id"],t[0]],paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":"black","circle-radius":20}}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,r){const o={};r[0]&1&&(o.filter=["!=",["id"],n[0]]),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function fo(t){let e,l,n,r,o,i,a,s,u;return l=new ot({}),r=new ht({}),i=new Ce({props:{data:ce(t[5].jats),generateId:!0,$$slots:{default:[uo]},$$scope:{ctx:t}}}),s=new lo({props:{junctionIdx:t[0],stage:t[1],mode:t[2],hoveringSidebar:t[3],select:t[8],stopEditing:t[9]}}),{c(){e=$("div"),D(l.$$.fragment),n=A(),D(r.$$.fragment),o=A(),D(i.$$.fragment),a=A(),D(s.$$.fragment),R(e,"slot","map")},m(c,m){b(c,e,m),q(l,e,null),d(e,n),q(r,e,null),d(e,o),q(i,e,null),d(e,a),q(s,e,null),u=!0},p(c,m){const p={};m[0]&32&&(p.data=ce(c[5].jats)),m[0]&1|m[1]&4&&(p.$$scope={dirty:m,ctx:c}),i.$set(p);const f={};m[0]&1&&(f.junctionIdx=c[0]),m[0]&2&&(f.stage=c[1]),m[0]&4&&(f.mode=c[2]),m[0]&8&&(f.hoveringSidebar=c[3]),s.$set(f)},i(c){u||(k(l.$$.fragment,c),k(r.$$.fragment,c),k(i.$$.fragment,c),k(s.$$.fragment,c),u=!0)},o(c){y(l.$$.fragment,c),y(r.$$.fragment,c),y(i.$$.fragment,c),y(s.$$.fragment,c),u=!1},d(c){c&&v(e),P(l),P(r),P(i),P(s)}}}function mo(t){let e,l,n,r;return e=new Ze({props:{$$slots:{map:[fo],sidebar:[co]},$$scope:{ctx:t}}}),{c(){D(e.$$.fragment)},m(o,i){q(e,o,i),l=!0,n||(r=Z(ro,"keydown",t[11]),n=!0)},p(o,i){const a={};i[0]&127|i[1]&4&&(a.$$scope={dirty:i,ctx:o}),e.$set(a)},i(o){l||(k(e.$$.fragment,o),l=!0)},o(o){y(e.$$.fragment,o),l=!1},d(o){P(e,o),n=!1,r()}}}function mn(t){return String.fromCharCode(t+"A".charCodeAt(0))}function dn(t){return t.split(" ").map(e=>e.length>0?e[0].toUpperCase()+e.substr(1):e).join(" ")}function po(t,e,l){let n,r;re(t,K,C=>l(5,n=C)),re(t,ne,C=>l(6,r=C));let{junctionIdx:o}=e,{stage:i}=e,a=i=="existing"?"proposed":"existing",s={mode:"select"},u=null,c=null,m;async function p(C){u=m.scrollTop,l(2,s={mode:"editing",id:C}),l(3,c=null),await et(),l(4,m.scrollTop=0,m)}async function f(){l(2,s={mode:"select"}),u!=null&&(await et(),l(4,m.scrollTop=u,m),u=null)}function g(){s.mode=="editing"&&window.confirm(`Delete this ${s.id.kind}?`)&&(s.id.kind=="movement"?(n.jats[o].properties[i].movements.splice(s.id.idx,1),K.set(n)):(n.jats[o].properties[i].arms.splice(s.id.idx,1),K.set(n)),f())}function _(C){if(s.mode!="editing")return;let ke=C.target.tagName,ue=ke=="INPUT"||ke=="TEXTAREA";C.key=="Escape"||C.key=="Enter"&&!ue?(C.stopPropagation(),f()):C.key=="Delete"&&!ue&&(C.stopPropagation(),g())}function L(){n.jats[o].properties[i].arms.length>0&&!window.confirm("Overwrite arms?")||(ee(K,n.jats[o].properties[i].arms=JSON.parse(JSON.stringify(n.jats[o].properties[a].arms)),n),K.set(n))}function h(){n.jats[o].properties[i].movements.length>0&&!window.confirm("Overwrite movements?")||(ee(K,n.jats[o].properties[i].movements=JSON.parse(JSON.stringify(n.jats[o].properties[a].movements)),n),K.set(n))}let j={0:Pe.red,1:Pe.amber,2:Pe.green,X:Pe.critical};function O(){if(n.jats[o].properties[i].movements.length>0&&!window.confirm("Overwrite all cycling movements?"))return;let C=n.jats[o].properties[i].movements.filter(ke=>ke.kind=="walking & wheeling");ee(K,n.jats[o].properties[i].movements=[...C,...Nr(n.jats[o].properties[i].arms)],n)}const G=()=>ee(ne,r={kind:"edit-jat",idx:o},r),B=C=>p({kind:"arm",idx:C}),z=C=>l(3,c={kind:"arm",idx:C}),H=()=>l(3,c=null),I=C=>p({kind:"movement",idx:C}),M=C=>l(3,c={kind:"movement",idx:C}),T=()=>l(3,c=null),N=()=>l(2,s={mode:"select"});function w(){n.jats[o].properties[i].arms[s.id.idx].name=this.value,K.set(n)}function X(C){we[C?"unshift":"push"](()=>{m=C,l(4,m)})}return t.$$set=C=>{"junctionIdx"in C&&l(0,o=C.junctionIdx),"stage"in C&&l(1,i=C.stage)},[o,i,s,c,m,n,r,a,p,f,g,_,L,h,j,O,G,B,z,H,I,M,T,N,w,X]}class go extends _e{constructor(e){super(),he(this,e,po,mo,$e,{junctionIdx:0,stage:1},null,[-1,-1])}}const{window:_o}=rt;function ho(t){let e,l,n,r,o,i,a,s,u,c,m,p,f,g;return{c(){e=$("div"),l=$("button"),l.textContent="Done",n=A(),r=$("button"),r.textContent="Delete JAT",o=A(),i=$("label"),a=U(`Name:
      `),s=$("input"),u=A(),c=$("button"),c.textContent="Existing",m=A(),p=$("button"),p.textContent="Proposed",R(s,"type","text"),R(e,"slot","sidebar")},m(_,L){b(_,e,L),d(e,l),d(e,n),d(e,r),d(e,o),d(e,i),d(i,a),d(i,s),ae(s,t[1].jats[t[0]].properties.name),d(e,u),d(e,c),d(e,m),d(e,p),f||(g=[Z(l,"click",t[6]),Z(r,"click",t[4]),Z(s,"input",t[7]),Z(c,"click",t[8]),Z(p,"click",t[9])],f=!0)},p(_,L){L&3&&s.value!==_[1].jats[_[0]].properties.name&&ae(s,_[1].jats[_[0]].properties.name)},d(_){_&&v(e),f=!1,Me(g)}}}function $o(t){let e,l;return e=new De({props:{filter:["!=",["id"],t[0]],paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":"black","circle-radius":20}}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,r){const o={};r&1&&(o.filter=["!=",["id"],n[0]]),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function ko(t){let e;return{c(){e=$("span"),R(e,"class","dot svelte-114j1n1"),te(e,"border-color",t[1].jats[t[0]].properties.color)},m(l,n){b(l,e,n)},p(l,n){n&3&&te(e,"border-color",l[1].jats[l[0]].properties.color)},d(l){l&&v(e)}}}function bo(t){let e,l,n,r,o,i,a,s,u,c;l=new ot({}),r=new ht({}),i=new Ce({props:{data:ce(t[1].jats),generateId:!0,$$slots:{default:[$o]},$$scope:{ctx:t}}});function m(f){t[5](f)}let p={draggable:!0,$$slots:{default:[ko]},$$scope:{ctx:t}};return t[1].jats[t[0]].geometry.coordinates!==void 0&&(p.lngLat=t[1].jats[t[0]].geometry.coordinates),s=new Fe({props:p}),we.push(()=>Ne(s,"lngLat",m)),{c(){e=$("div"),D(l.$$.fragment),n=A(),D(r.$$.fragment),o=A(),D(i.$$.fragment),a=A(),D(s.$$.fragment),R(e,"slot","map")},m(f,g){b(f,e,g),q(l,e,null),d(e,n),q(r,e,null),d(e,o),q(i,e,null),d(e,a),q(s,e,null),c=!0},p(f,g){const _={};g&2&&(_.data=ce(f[1].jats)),g&1025&&(_.$$scope={dirty:g,ctx:f}),i.$set(_);const L={};g&1027&&(L.$$scope={dirty:g,ctx:f}),!u&&g&3&&(u=!0,L.lngLat=f[1].jats[f[0]].geometry.coordinates,Ee(()=>u=!1)),s.$set(L)},i(f){c||(k(l.$$.fragment,f),k(r.$$.fragment,f),k(i.$$.fragment,f),k(s.$$.fragment,f),c=!0)},o(f){y(l.$$.fragment,f),y(r.$$.fragment,f),y(i.$$.fragment,f),y(s.$$.fragment,f),c=!1},d(f){f&&v(e),P(l),P(r),P(i),P(s)}}}function vo(t){let e,l,n,r;return e=new Ze({props:{$$slots:{map:[bo],sidebar:[ho]},$$scope:{ctx:t}}}),{c(){D(e.$$.fragment)},m(o,i){q(e,o,i),l=!0,n||(r=Z(_o,"keydown",t[3]),n=!0)},p(o,[i]){const a={};i&1031&&(a.$$scope={dirty:i,ctx:o}),e.$set(a)},i(o){l||(k(e.$$.fragment,o),l=!0)},o(o){y(e.$$.fragment,o),l=!1},d(o){P(e,o),n=!1,r()}}}function wo(t,e,l){let n,r;re(t,K,f=>l(1,n=f)),re(t,ne,f=>l(2,r=f));let{idx:o}=e;function i(f){f.key=="Escape"&&ee(ne,r={kind:"neutral"},r)}async function a(){window.confirm("Really delete this JAT?")&&(ee(ne,r={kind:"neutral"},r),await et(),n.jats.splice(o,1),K.set(n))}function s(f){t.$$.not_equal(n.jats[o].geometry.coordinates,f)&&(n.jats[o].geometry.coordinates=f,K.set(n))}const u=()=>ee(ne,r={kind:"neutral"},r);function c(){n.jats[o].properties.name=this.value,K.set(n)}const m=()=>ee(ne,r={kind:"edit-jat-detail",idx:o,stage:"existing"},r),p=()=>ee(ne,r={kind:"edit-jat-detail",idx:o,stage:"proposed"},r);return t.$$set=f=>{"idx"in f&&l(0,o=f.idx)},[o,n,r,i,a,s,u,c,m,p]}class yo extends _e{constructor(e){super(),he(this,e,wo,vo,$e,{idx:0})}}function pn(t,e,l){const n=t.slice();return n[3]=e[l],n[4]=e,n[5]=l,n}function jo(t){let e,l;return{c(){e=$("span"),l=A(),R(e,"class","dot svelte-jgyhla")},m(n,r){b(n,e,r),b(n,l,r)},p:le,d(n){n&&(v(e),v(l))}}}function gn(t){let e,l,n;function r(i){t[2](i,t[3],t[4],t[5])}let o={draggable:!0,$$slots:{default:[jo]},$$scope:{ctx:t}};return t[3]!==void 0&&(o.lngLat=t[3]),e=new Fe({props:o}),we.push(()=>Ne(e,"lngLat",r)),{c(){D(e.$$.fragment)},m(i,a){q(e,i,a),n=!0},p(i,a){t=i;const s={};a&64&&(s.$$scope={dirty:a,ctx:t}),!l&&a&1&&(l=!0,s.lngLat=t[3],Ee(()=>l=!1)),e.$set(s)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){y(e.$$.fragment,i),n=!1},d(i){P(e,i)}}}function Co(t){let e,l,n,r;e=new zn({}),e.$on("click",t[1]);let o=Y(t[0].geometry.coordinates),i=[];for(let s=0;s<o.length;s+=1)i[s]=gn(pn(t,o,s));const a=s=>y(i[s],1,1,()=>{i[s]=null});return{c(){D(e.$$.fragment),l=A();for(let s=0;s<i.length;s+=1)i[s].c();n=pt()},m(s,u){q(e,s,u),b(s,l,u);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(s,u);b(s,n,u),r=!0},p(s,[u]){if(u&1){o=Y(s[0].geometry.coordinates);let c;for(c=0;c<o.length;c+=1){const m=pn(s,o,c);i[c]?(i[c].p(m,u),k(i[c],1)):(i[c]=gn(m),i[c].c(),k(i[c],1),i[c].m(n.parentNode,n))}for(be(),c=o.length;c<i.length;c+=1)a(c);ve()}},i(s){if(!r){k(e.$$.fragment,s);for(let u=0;u<o.length;u+=1)k(i[u]);r=!0}},o(s){y(e.$$.fragment,s),i=i.filter(Boolean);for(let u=0;u<i.length;u+=1)y(i[u]);r=!1},d(s){s&&(v(l),v(n)),P(e,s),oe(i,s)}}}function Ao(t,e,l){let{f:n}=e;function r(i){n.geometry.coordinates.push(i.detail.lngLat.toArray()),l(0,n)}function o(i,a,s,u){s[u]=i,l(0,n)}return t.$$set=i=>{"f"in i&&l(0,n=i.f)},[n,r,o]}class Lo extends _e{constructor(e){super(),he(this,e,Ao,Co,$e,{f:0})}}const{window:So}=rt;function _n(t,e,l){const n=t.slice();return n[10]=e[l],n[11]=e,n[12]=l,n}function To(t,e,l){const n=t.slice();return n[13]=e[l],n}function hn(t){let e;return{c(){e=$("p"),e.textContent="A link needs at least two points"},m(l,n){b(l,e,n)},d(l){l&&v(e)}}}function Mo(t){let e;return{c(){e=$("option"),e.textContent=`${t[13]}`,e.__value=t[13],ae(e,e.__value)},m(l,n){b(l,e,n)},p:le,d(l){l&&v(e)}}}function $n(t){let e,l=t[10].name+"",n,r,o=t[10].description+"",i,a,s,u,c,m,p=Y(t[10].choices),f=[];for(let _=0;_<p.length;_+=1)f[_]=Mo(To(t,p,_));function g(){t[9].call(s,t[12])}return{c(){e=$("label"),n=U(l),r=U(": "),i=U(o),a=A(),s=$("select");for(let _=0;_<f.length;_+=1)f[_].c();u=A(),t[1].links[t[0]].properties.answers[t[12]]===void 0&&mt(g)},m(_,L){b(_,e,L),d(e,n),d(e,r),d(e,i),d(e,a),d(e,s);for(let h=0;h<f.length;h+=1)f[h]&&f[h].m(s,null);Oe(s,t[1].links[t[0]].properties.answers[t[12]],!0),d(e,u),c||(m=Z(s,"change",g),c=!0)},p(_,L){t=_,L&3&&Oe(s,t[1].links[t[0]].properties.answers[t[12]])},d(_){_&&v(e),oe(f,_),c=!1,m()}}}function Io(t){let e,l,n,r,o,i,a,s,u,c,m,p,f,g,_=!t[2]&&hn(),L=Y(Te),h=[];for(let j=0;j<L.length;j+=1)h[j]=$n(_n(t,L,j));return{c(){e=$("div"),l=$("button"),n=U("Done"),o=A(),i=$("button"),i.textContent="Delete link",a=A(),_&&_.c(),s=A(),u=$("label"),c=U(`Name:
      `),m=$("input"),p=A();for(let j=0;j<h.length;j+=1)h[j].c();l.disabled=r=!t[2],R(m,"type","text"),R(e,"slot","sidebar")},m(j,O){b(j,e,O),d(e,l),d(l,n),d(e,o),d(e,i),d(e,a),_&&_.m(e,null),d(e,s),d(e,u),d(u,c),d(u,m),ae(m,t[1].links[t[0]].properties.name),d(e,p);for(let G=0;G<h.length;G+=1)h[G]&&h[G].m(e,null);f||(g=[Z(l,"click",t[7]),Z(i,"click",t[5]),Z(m,"input",t[8])],f=!0)},p(j,O){if(O&4&&r!==(r=!j[2])&&(l.disabled=r),j[2]?_&&(_.d(1),_=null):_||(_=hn(),_.c(),_.m(e,s)),O&3&&m.value!==j[1].links[j[0]].properties.name&&ae(m,j[1].links[j[0]].properties.name),O&3){L=Y(Te);let G;for(G=0;G<L.length;G+=1){const B=_n(j,L,G);h[G]?h[G].p(B,O):(h[G]=$n(B),h[G].c(),h[G].m(e,null))}for(;G<h.length;G+=1)h[G].d(1);h.length=L.length}},d(j){j&&v(e),_&&_.d(),oe(h,j),f=!1,Me(g)}}}function No(t){let e,l;return e=new xe({props:{paint:{"line-color":["case",["==",["id"],t[0]],["get","color"],"black"],"line-width":6}}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,r){const o={};r&1&&(o.paint={"line-color":["case",["==",["id"],n[0]],["get","color"],"black"],"line-width":6}),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function Eo(t){let e,l,n,r,o,i,a,s,u,c;l=new Ce({props:{data:ce(t[1].links),generateId:!0,$$slots:{default:[No]},$$scope:{ctx:t}}}),r=new _t({}),i=new ht({});function m(f){t[6](f)}let p={};return t[1].links[t[0]]!==void 0&&(p.f=t[1].links[t[0]]),s=new Lo({props:p}),we.push(()=>Ne(s,"f",m)),{c(){e=$("div"),D(l.$$.fragment),n=A(),D(r.$$.fragment),o=A(),D(i.$$.fragment),a=A(),D(s.$$.fragment),R(e,"slot","map")},m(f,g){b(f,e,g),q(l,e,null),d(e,n),q(r,e,null),d(e,o),q(i,e,null),d(e,a),q(s,e,null),c=!0},p(f,g){const _={};g&2&&(_.data=ce(f[1].links)),g&65537&&(_.$$scope={dirty:g,ctx:f}),l.$set(_);const L={};!u&&g&3&&(u=!0,L.f=f[1].links[f[0]],Ee(()=>u=!1)),s.$set(L)},i(f){c||(k(l.$$.fragment,f),k(r.$$.fragment,f),k(i.$$.fragment,f),k(s.$$.fragment,f),c=!0)},o(f){y(l.$$.fragment,f),y(r.$$.fragment,f),y(i.$$.fragment,f),y(s.$$.fragment,f),c=!1},d(f){f&&v(e),P(l),P(r),P(i),P(s)}}}function Do(t){let e,l,n,r;return e=new Ze({props:{$$slots:{map:[Eo],sidebar:[Io]},$$scope:{ctx:t}}}),{c(){D(e.$$.fragment)},m(o,i){q(e,o,i),l=!0,n||(r=Z(So,"keydown",t[4]),n=!0)},p(o,[i]){const a={};i&65551&&(a.$$scope={dirty:i,ctx:o}),e.$set(a)},i(o){l||(k(e.$$.fragment,o),l=!0)},o(o){y(e.$$.fragment,o),l=!1},d(o){P(e,o),n=!1,r()}}}function qo(t,e,l){let n,r,o;re(t,K,f=>l(1,r=f)),re(t,ne,f=>l(3,o=f));let{idx:i}=e;function a(f){f.key=="Escape"&&n&&ee(ne,o={kind:"neutral"},o)}async function s(){window.confirm("Really delete this link?")&&(ee(ne,o={kind:"neutral"},o),await et(),r.links.splice(i,1),K.set(r))}function u(f){t.$$.not_equal(r.links[i],f)&&(r.links[i]=f,K.set(r))}const c=()=>ee(ne,o={kind:"neutral"},o);function m(){r.links[i].properties.name=this.value,K.set(r)}function p(f){r.links[i].properties.answers[f]=dt(this),K.set(r)}return t.$$set=f=>{"idx"in f&&l(0,i=f.idx)},t.$$.update=()=>{t.$$.dirty&3&&l(2,n=r.links[i].geometry.coordinates.length>=2)},[i,r,n,o,a,s,u,c,m,p]}class Po extends _e{constructor(e){super(),he(this,e,qo,Do,$e,{idx:0})}}function kn(t,e,l){const n=t.slice();return n[6]=e[l],n[7]=e,n[8]=l,n}function bn(t,e,l){const n=t.slice();return n[9]=e[l],n}function vn(t){let e,l=t[9]+"",n,r;return{c(){e=$("option"),n=U(l),e.__value=r=t[9],ae(e,e.__value)},m(o,i){b(o,e,i),d(e,n)},p(o,i){i&1&&l!==(l=o[9]+"")&&ie(n,l),i&1&&r!==(r=o[9])&&(e.__value=r,ae(e,e.__value))},d(o){o&&v(e)}}}function wn(t){let e,l,n=t[6].properties.name+"",r,o,i,a,s,u,c=Y(Te[t[0]].choices),m=[];for(let f=0;f<c.length;f+=1)m[f]=vn(bn(t,c,f));function p(){t[5].call(i,t[7],t[8])}return{c(){e=$("li"),l=$("span"),r=U(n),o=A(),i=$("select");for(let f=0;f<m.length;f+=1)m[f].c();a=A(),te(l,"color",t[6].properties.color),t[6].properties.answers[t[0]]===void 0&&mt(p)},m(f,g){b(f,e,g),d(e,l),d(l,r),d(e,o),d(e,i);for(let _=0;_<m.length;_+=1)m[_]&&m[_].m(i,null);Oe(i,t[6].properties.answers[t[0]],!0),d(e,a),s||(u=Z(i,"change",p),s=!0)},p(f,g){if(t=f,g&4&&n!==(n=t[6].properties.name+"")&&ie(r,n),g&4&&te(l,"color",t[6].properties.color),g&1){c=Y(Te[t[0]].choices);let _;for(_=0;_<c.length;_+=1){const L=bn(t,c,_);m[_]?m[_].p(L,g):(m[_]=vn(L),m[_].c(),m[_].m(i,null))}for(;_<m.length;_+=1)m[_].d(1);m.length=c.length}g&5&&Oe(i,t[6].properties.answers[t[0]])},d(f){f&&v(e),oe(m,f),s=!1,u()}}}function Fo(t){let e,l,n,r,o=Te[t[0]].name+"",i,a,s=Te[t[0]].description+"",u,c,m,p,f,g=Y(t[2].links),_=[];for(let L=0;L<g.length;L+=1)_[L]=wn(kn(t,g,L));return{c(){e=$("div"),l=$("button"),l.textContent="Done",n=A(),r=$("h2"),i=U(o),a=U(": "),u=U(s),c=A(),m=$("ol");for(let L=0;L<_.length;L+=1)_[L].c();R(e,"slot","sidebar")},m(L,h){b(L,e,h),d(e,l),d(e,n),d(e,r),d(r,i),d(r,a),d(r,u),d(e,c),d(e,m);for(let j=0;j<_.length;j+=1)_[j]&&_[j].m(m,null);p||(f=Z(l,"click",t[4]),p=!0)},p(L,h){if(h&1&&o!==(o=Te[L[0]].name+"")&&ie(i,o),h&1&&s!==(s=Te[L[0]].description+"")&&ie(u,s),h&5){g=Y(L[2].links);let j;for(j=0;j<g.length;j+=1){const O=kn(L,g,j);_[j]?_[j].p(O,h):(_[j]=wn(O),_[j].c(),_[j].m(m,null))}for(;j<_.length;j+=1)_[j].d(1);_.length=g.length}},d(L){L&&v(e),oe(_,L),p=!1,f()}}}function Oo(t){let e,l,n,r,o,i,a;return l=new ot({props:{showColor:!0}}),r=new _t({}),i=new ht({}),{c(){e=$("div"),D(l.$$.fragment),n=A(),D(r.$$.fragment),o=A(),D(i.$$.fragment),R(e,"slot","map")},m(s,u){b(s,e,u),q(l,e,null),d(e,n),q(r,e,null),d(e,o),q(i,e,null),a=!0},p:le,i(s){a||(k(l.$$.fragment,s),k(r.$$.fragment,s),k(i.$$.fragment,s),a=!0)},o(s){y(l.$$.fragment,s),y(r.$$.fragment,s),y(i.$$.fragment,s),a=!1},d(s){s&&v(e),P(l),P(r),P(i)}}}function Bo(t){let e,l,n,r;return e=new Ze({props:{$$slots:{map:[Oo],sidebar:[Fo]},$$scope:{ctx:t}}}),{c(){D(e.$$.fragment)},m(o,i){q(e,o,i),l=!0,n||(r=Z(window,"keydown",t[3]),n=!0)},p(o,[i]){const a={};i&4103&&(a.$$scope={dirty:i,ctx:o}),e.$set(a)},i(o){l||(k(e.$$.fragment,o),l=!0)},o(o){y(e.$$.fragment,o),l=!1},d(o){P(e,o),n=!1,r()}}}function Jo(t,e,l){let n,r;re(t,ne,u=>l(1,n=u)),re(t,K,u=>l(2,r=u));let{qIdx:o}=e;function i(u){u.key=="Escape"&&ee(ne,n={kind:"neutral"},n)}const a=()=>ee(ne,n={kind:"neutral"},n);function s(u,c){u[c].properties.answers[o]=dt(this),K.set(r),l(0,o)}return t.$$set=u=>{"qIdx"in u&&l(0,o=u.qIdx)},[o,n,r,i,a,s]}class zo extends _e{constructor(e){super(),he(this,e,Jo,Bo,$e,{qIdx:0})}}function Ro(t){let e,l,n,r;const o=t[2].default,i=We(o,t,t[1],null);return{c(){e=$("a"),i&&i.c(),R(e,"href","#"),te(e,"color",t[0])},m(a,s){b(a,e,s),i&&i.m(e,null),l=!0,n||(r=Z(e,"click",il(t[3])),n=!0)},p(a,[s]){i&&i.p&&(!l||s&2)&&Ve(i,o,a,a[1],l?Ye(o,a[1],s,null):Qe(a[1]),null),s&1&&te(e,"color",a[0])},i(a){l||(k(i,a),l=!0)},o(a){y(i,a),l=!1},d(a){a&&v(e),i&&i.d(a),n=!1,r()}}}function Ho(t,e,l){let{$$slots:n={},$$scope:r}=e,{color:o=void 0}=e;function i(a){Ie.call(this,t,a)}return t.$$set=a=>{"color"in a&&l(0,o=a.color),"$$scope"in a&&l(1,r=a.$$scope)},[o,r,n,i]}class it extends _e{constructor(e){super(),he(this,e,Ho,Ro,$e,{color:0})}}function yn(t,e,l){const n=t.slice();return n[2]=e[l],n[4]=l,n}function jn(t,e,l){const n=t.slice();n[5]=e[l];const r=n[5].properties.answers[n[4]];return n[6]=r,n}function Cn(t,e,l){const n=t.slice();return n[5]=e[l],n}function An(t){let e,l=t[5].properties.name+"",n;return{c(){e=$("th"),n=U(l),te(e,"color",t[5].properties.color)},m(r,o){b(r,e,o),d(e,n)},p(r,o){o&1&&l!==(l=r[5].properties.name+"")&&ie(n,l),o&1&&te(e,"color",r[5].properties.color)},d(r){r&&v(e)}}}function Ln(t){let e,l=t[6]+"",n;return{c(){e=$("td"),n=U(l),te(e,"background",t[6]==""?"red":"green")},m(r,o){b(r,e,o),d(e,n)},p(r,o){o&1&&l!==(l=r[6]+"")&&ie(n,l),o&1&&te(e,"background",r[6]==""?"red":"green")},d(r){r&&v(e)}}}function Sn(t){let e,l,n,r,o=Y(t[0].links),i=[];for(let a=0;a<o.length;a+=1)i[a]=Ln(jn(t,o,a));return{c(){e=$("tr"),l=$("th"),l.textContent=`${t[2].name}`,n=A();for(let a=0;a<i.length;a+=1)i[a].c();r=A()},m(a,s){b(a,e,s),d(e,l),d(e,n);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);d(e,r)},p(a,s){if(s&1){o=Y(a[0].links);let u;for(u=0;u<o.length;u+=1){const c=jn(a,o,u);i[u]?i[u].p(c,s):(i[u]=Ln(c),i[u].c(),i[u].m(e,r))}for(;u<i.length;u+=1)i[u].d(1);i.length=o.length}},d(a){a&&v(e),oe(i,a)}}}function Go(t){let e,l,n,r,o,i,a,s=Y(t[0].links),u=[];for(let p=0;p<s.length;p+=1)u[p]=An(Cn(t,s,p));let c=Y(Te),m=[];for(let p=0;p<c.length;p+=1)m[p]=Sn(yn(t,c,p));return{c(){e=$("table"),l=$("thead"),n=$("tr"),r=$("th"),o=A();for(let p=0;p<u.length;p+=1)u[p].c();i=A(),a=$("tbody");for(let p=0;p<m.length;p+=1)m[p].c()},m(p,f){b(p,e,f),d(e,l),d(l,n),d(n,r),d(n,o);for(let g=0;g<u.length;g+=1)u[g]&&u[g].m(n,null);d(e,i),d(e,a);for(let g=0;g<m.length;g+=1)m[g]&&m[g].m(a,null)},p(p,f){if(f&1){s=Y(p[0].links);let g;for(g=0;g<s.length;g+=1){const _=Cn(p,s,g);u[g]?u[g].p(_,f):(u[g]=An(_),u[g].c(),u[g].m(n,null))}for(;g<u.length;g+=1)u[g].d(1);u.length=s.length}if(f&1){c=Y(Te);let g;for(g=0;g<c.length;g+=1){const _=yn(p,c,g);m[g]?m[g].p(_,f):(m[g]=Sn(_),m[g].c(),m[g].m(a,null))}for(;g<m.length;g+=1)m[g].d(1);m.length=c.length}},d(p){p&&v(e),oe(u,p),oe(m,p)}}}function Uo(t){let e,l;return e=new Hn({props:{$$slots:{default:[Go]},$$scope:{ctx:t}}}),e.$on("close",t[1]),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,[r]){const o={};r&2049&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function Zo(t,e,l){let n;re(t,K,o=>l(0,n=o));function r(o){Ie.call(this,t,o)}return[n,r]}class Ko extends _e{constructor(e){super(),he(this,e,Zo,Uo,$e,{})}}function Tn(t,e,l){const n=t.slice();return n[22]=e[l],n[24]=l,n}function Mn(t,e,l){const n=t.slice();return n[25]=e[l],n[24]=l,n}function In(t,e,l){const n=t.slice();return n[27]=e[l],n[24]=l,n}function Nn(t,e,l){const n=t.slice();return n[29]=e[l],n[24]=l,n}function En(t,e,l){const n=t.slice();return n[31]=e[l],n[24]=l,n}function Dn(t){let e,l;return e=new Ko({}),e.$on("close",t[8]),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p:le,i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function Xo(t){let e=t[31].properties.name+"",l;return{c(){l=U(e)},m(n,r){b(n,l,r)},p(n,r){r[0]&2&&e!==(e=n[31].properties.name+"")&&ie(l,e)},d(n){n&&v(l)}}}function qn(t){let e,l,n,r;function o(){return t[15](t[24])}return l=new it({props:{color:t[31].properties.color,$$slots:{default:[Xo]},$$scope:{ctx:t}}}),l.$on("click",o),{c(){e=$("li"),D(l.$$.fragment),n=A()},m(i,a){b(i,e,a),q(l,e,null),d(e,n),r=!0},p(i,a){t=i;const s={};a[0]&2&&(s.color=t[31].properties.color),a[0]&2|a[1]&4&&(s.$$scope={dirty:a,ctx:t}),l.$set(s)},i(i){r||(k(l.$$.fragment,i),r=!0)},o(i){y(l.$$.fragment,i),r=!1},d(i){i&&v(e),P(l)}}}function Wo(t){let e=t[29].name+"",l,n;return{c(){l=U(e),n=A()},m(r,o){b(r,l,o),b(r,n,o)},p:le,d(r){r&&(v(l),v(n))}}}function Pn(t){let e,l,n,r,o,i,a,s;function u(){return t[16](t[24])}l=new it({props:{$$slots:{default:[Wo]},$$scope:{ctx:t}}}),l.$on("click",u);function c(...m){return t[17](t[24],...m)}return{c(){e=$("li"),D(l.$$.fragment),n=U(`:
          `),r=$("progress"),a=A(),r.value=o=t[1].links.filter(c).length,R(r,"max",i=t[1].links.length),R(r,"class","svelte-zadug4")},m(m,p){b(m,e,p),q(l,e,null),d(e,n),d(e,r),d(e,a),s=!0},p(m,p){t=m;const f={};p[1]&4&&(f.$$scope={dirty:p,ctx:t}),l.$set(f),(!s||p[0]&2&&o!==(o=t[1].links.filter(c).length))&&(r.value=o),(!s||p[0]&2&&i!==(i=t[1].links.length))&&R(r,"max",i)},i(m){s||(k(l.$$.fragment,m),s=!0)},o(m){y(l.$$.fragment,m),s=!1},d(m){m&&v(e),P(l)}}}function Vo(t){let e=t[27].properties.name+"",l;return{c(){l=U(e)},m(n,r){b(n,l,r)},p(n,r){r[0]&2&&e!==(e=n[27].properties.name+"")&&ie(l,e)},d(n){n&&v(l)}}}function Fn(t){let e,l,n,r;function o(){return t[18](t[24])}return l=new it({props:{color:t[27].properties.color,$$slots:{default:[Vo]},$$scope:{ctx:t}}}),l.$on("click",o),{c(){e=$("li"),D(l.$$.fragment),n=A()},m(i,a){b(i,e,a),q(l,e,null),d(e,n),r=!0},p(i,a){t=i;const s={};a[0]&2&&(s.color=t[27].properties.color),a[0]&2|a[1]&4&&(s.$$scope={dirty:a,ctx:t}),l.$set(s)},i(i){r||(k(l.$$.fragment,i),r=!0)},o(i){y(l.$$.fragment,i),r=!1},d(i){i&&v(e),P(l)}}}function Qo(t){let e=t[25].properties.name+"",l;return{c(){l=U(e)},m(n,r){b(n,l,r)},p(n,r){r[0]&2&&e!==(e=n[25].properties.name+"")&&ie(l,e)},d(n){n&&v(l)}}}function On(t){let e,l,n,r;function o(){return t[19](t[24])}return l=new it({props:{color:t[25].properties.color,$$slots:{default:[Qo]},$$scope:{ctx:t}}}),l.$on("click",o),{c(){e=$("li"),D(l.$$.fragment),n=A()},m(i,a){b(i,e,a),q(l,e,null),d(e,n),r=!0},p(i,a){t=i;const s={};a[0]&2&&(s.color=t[25].properties.color),a[0]&2|a[1]&4&&(s.$$scope={dirty:a,ctx:t}),l.$set(s)},i(i){r||(k(l.$$.fragment,i),r=!0)},o(i){y(l.$$.fragment,i),r=!1},d(i){i&&v(e),P(l)}}}function Yo(t){let e=t[22].properties.name+"",l;return{c(){l=U(e)},m(n,r){b(n,l,r)},p(n,r){r[0]&2&&e!==(e=n[22].properties.name+"")&&ie(l,e)},d(n){n&&v(l)}}}function Bn(t){let e,l,n,r;function o(){return t[20](t[24])}return l=new it({props:{color:t[22].properties.color,$$slots:{default:[Yo]},$$scope:{ctx:t}}}),l.$on("click",o),{c(){e=$("li"),D(l.$$.fragment),n=A()},m(i,a){b(i,e,a),q(l,e,null),d(e,n),r=!0},p(i,a){t=i;const s={};a[0]&2&&(s.color=t[22].properties.color),a[0]&2|a[1]&4&&(s.$$scope={dirty:a,ctx:t}),l.$set(s)},i(i){r||(k(l.$$.fragment,i),r=!0)},o(i){y(l.$$.fragment,i),r=!1},d(i){i&&v(e),P(l)}}}function xo(t){let e,l,n,r,o,i,a,s,u,c,m,p,f,g,_,L,h,j,O,G,B,z,H,I,M,T,N,w,X,C,ke,ue,F,W,ye,se,E,Q,x,qe,Je=Y(t[1].links),fe=[];for(let J=0;J<Je.length;J+=1)fe[J]=qn(En(t,Je,J));const Un=J=>y(fe[J],1,1,()=>{fe[J]=null});let ze=Y(Te),me=[];for(let J=0;J<ze.length;J+=1)me[J]=Pn(Nn(t,ze,J));const Zn=J=>y(me[J],1,1,()=>{me[J]=null});let Re=Y(t[1].jats),de=[];for(let J=0;J<Re.length;J+=1)de[J]=Fn(In(t,Re,J));const Kn=J=>y(de[J],1,1,()=>{de[J]=null});let He=Y(t[1].bus_stops),pe=[];for(let J=0;J<He.length;J+=1)pe[J]=On(Mn(t,He,J));const Xn=J=>y(pe[J],1,1,()=>{pe[J]=null});let Ge=Y(t[1].crossings),ge=[];for(let J=0;J<Ge.length;J+=1)ge[J]=Bn(Tn(t,Ge,J));const Wn=J=>y(ge[J],1,1,()=>{ge[J]=null});return{c(){e=$("div"),l=$("div"),n=$("button"),n.textContent="Download",r=A(),o=$("button"),o.textContent="Clear",i=A(),a=$("hr"),s=A(),u=$("div"),c=$("button"),c.textContent="New link",m=A(),p=$("button"),p.textContent="Table of questions",f=U(`

    Links:
    `),g=$("ol");for(let J=0;J<fe.length;J+=1)fe[J].c();_=U(`

    Questions:
    `),L=$("ol");for(let J=0;J<me.length;J+=1)me[J].c();h=A(),j=$("hr"),O=U(`

    JATs:

    `),G=$("div"),B=$("button"),B.textContent="New JAT",z=A(),H=$("ol");for(let J=0;J<de.length;J+=1)de[J].c();I=A(),M=$("hr"),T=U(`

    Bus stops:

    `),N=$("div"),w=$("button"),w.textContent="New bus stop",X=A(),C=$("ol");for(let J=0;J<pe.length;J+=1)pe[J].c();ke=A(),ue=$("hr"),F=U(`

    Crossings:

    `),W=$("div"),ye=$("button"),ye.textContent="New crossing",se=A(),E=$("ol");for(let J=0;J<ge.length;J+=1)ge[J].c();R(n,"class","secondary"),R(o,"class","secondary"),R(e,"slot","sidebar")},m(J,V){b(J,e,V),d(e,l),d(l,n),d(l,r),d(l,o),d(e,i),d(e,a),d(e,s),d(e,u),d(u,c),d(u,m),d(u,p),d(e,f),d(e,g);for(let S=0;S<fe.length;S+=1)fe[S]&&fe[S].m(g,null);d(e,_),d(e,L);for(let S=0;S<me.length;S+=1)me[S]&&me[S].m(L,null);d(e,h),d(e,j),d(e,O),d(e,G),d(G,B),d(e,z),d(e,H);for(let S=0;S<de.length;S+=1)de[S]&&de[S].m(H,null);d(e,I),d(e,M),d(e,T),d(e,N),d(N,w),d(e,X),d(e,C);for(let S=0;S<pe.length;S+=1)pe[S]&&pe[S].m(C,null);d(e,ke),d(e,ue),d(e,F),d(e,W),d(W,ye),d(e,se),d(e,E);for(let S=0;S<ge.length;S+=1)ge[S]&&ge[S].m(E,null);Q=!0,x||(qe=[Z(n,"click",t[13]),Z(o,"click",t[3]),Z(c,"click",t[4]),Z(p,"click",t[14]),Z(B,"click",t[5]),Z(w,"click",t[6]),Z(ye,"click",t[7])],x=!0)},p(J,V){if(V[0]&6){Je=Y(J[1].links);let S;for(S=0;S<Je.length;S+=1){const je=En(J,Je,S);fe[S]?(fe[S].p(je,V),k(fe[S],1)):(fe[S]=qn(je),fe[S].c(),k(fe[S],1),fe[S].m(g,null))}for(be(),S=Je.length;S<fe.length;S+=1)Un(S);ve()}if(V[0]&6){ze=Y(Te);let S;for(S=0;S<ze.length;S+=1){const je=Nn(J,ze,S);me[S]?(me[S].p(je,V),k(me[S],1)):(me[S]=Pn(je),me[S].c(),k(me[S],1),me[S].m(L,null))}for(be(),S=ze.length;S<me.length;S+=1)Zn(S);ve()}if(V[0]&6){Re=Y(J[1].jats);let S;for(S=0;S<Re.length;S+=1){const je=In(J,Re,S);de[S]?(de[S].p(je,V),k(de[S],1)):(de[S]=Fn(je),de[S].c(),k(de[S],1),de[S].m(H,null))}for(be(),S=Re.length;S<de.length;S+=1)Kn(S);ve()}if(V[0]&6){He=Y(J[1].bus_stops);let S;for(S=0;S<He.length;S+=1){const je=Mn(J,He,S);pe[S]?(pe[S].p(je,V),k(pe[S],1)):(pe[S]=On(je),pe[S].c(),k(pe[S],1),pe[S].m(C,null))}for(be(),S=He.length;S<pe.length;S+=1)Xn(S);ve()}if(V[0]&6){Ge=Y(J[1].crossings);let S;for(S=0;S<Ge.length;S+=1){const je=Tn(J,Ge,S);ge[S]?(ge[S].p(je,V),k(ge[S],1)):(ge[S]=Bn(je),ge[S].c(),k(ge[S],1),ge[S].m(E,null))}for(be(),S=Ge.length;S<ge.length;S+=1)Wn(S);ve()}},i(J){if(!Q){for(let V=0;V<Je.length;V+=1)k(fe[V]);for(let V=0;V<ze.length;V+=1)k(me[V]);for(let V=0;V<Re.length;V+=1)k(de[V]);for(let V=0;V<He.length;V+=1)k(pe[V]);for(let V=0;V<Ge.length;V+=1)k(ge[V]);Q=!0}},o(J){fe=fe.filter(Boolean);for(let V=0;V<fe.length;V+=1)y(fe[V]);me=me.filter(Boolean);for(let V=0;V<me.length;V+=1)y(me[V]);de=de.filter(Boolean);for(let V=0;V<de.length;V+=1)y(de[V]);pe=pe.filter(Boolean);for(let V=0;V<pe.length;V+=1)y(pe[V]);ge=ge.filter(Boolean);for(let V=0;V<ge.length;V+=1)y(ge[V]);Q=!1},d(J){J&&v(e),oe(fe,J),oe(me,J),oe(de,J),oe(pe,J),oe(ge,J),x=!1,Me(qe)}}}function ei(t){let e,l;return e=new xe({props:{manageHoverState:!0,paint:{"line-color":["get","color"],"line-width":tt(6,9)},hoverCursor:"pointer"}}),e.$on("click",t[9]),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p:le,i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function ti(t){let e,l;return e=new De({props:{manageHoverState:!0,paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":["get","color"],"circle-radius":tt(20,25)},hoverCursor:"pointer"}}),e.$on("click",t[10]),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p:le,i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function ni(t){let e,l;return e=new De({props:{manageHoverState:!0,paint:{"circle-color":["get","color"],"circle-radius":tt(10,15)},hoverCursor:"pointer"}}),e.$on("click",t[11]),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p:le,i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function li(t){let e,l;return e=new De({props:{manageHoverState:!0,paint:{"circle-color":["get","color"],"circle-radius":tt(10,15)},hoverCursor:"pointer"}}),e.$on("click",t[12]),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p:le,i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function ri(t){let e,l,n,r,o,i,a,s,u;return l=new Ce({props:{data:ce(t[1].links),generateId:!0,$$slots:{default:[ei]},$$scope:{ctx:t}}}),r=new Ce({props:{data:ce(t[1].jats),generateId:!0,$$slots:{default:[ti]},$$scope:{ctx:t}}}),i=new Ce({props:{data:ce(t[1].bus_stops),generateId:!0,$$slots:{default:[ni]},$$scope:{ctx:t}}}),s=new Ce({props:{data:ce(t[1].crossings),generateId:!0,$$slots:{default:[li]},$$scope:{ctx:t}}}),{c(){e=$("div"),D(l.$$.fragment),n=A(),D(r.$$.fragment),o=A(),D(i.$$.fragment),a=A(),D(s.$$.fragment),R(e,"slot","map")},m(c,m){b(c,e,m),q(l,e,null),d(e,n),q(r,e,null),d(e,o),q(i,e,null),d(e,a),q(s,e,null),u=!0},p(c,m){const p={};m[0]&2&&(p.data=ce(c[1].links)),m[0]&4|m[1]&4&&(p.$$scope={dirty:m,ctx:c}),l.$set(p);const f={};m[0]&2&&(f.data=ce(c[1].jats)),m[0]&4|m[1]&4&&(f.$$scope={dirty:m,ctx:c}),r.$set(f);const g={};m[0]&2&&(g.data=ce(c[1].bus_stops)),m[0]&4|m[1]&4&&(g.$$scope={dirty:m,ctx:c}),i.$set(g);const _={};m[0]&2&&(_.data=ce(c[1].crossings)),m[0]&4|m[1]&4&&(_.$$scope={dirty:m,ctx:c}),s.$set(_)},i(c){u||(k(l.$$.fragment,c),k(r.$$.fragment,c),k(i.$$.fragment,c),k(s.$$.fragment,c),u=!0)},o(c){y(l.$$.fragment,c),y(r.$$.fragment,c),y(i.$$.fragment,c),y(s.$$.fragment,c),u=!1},d(c){c&&v(e),P(l),P(r),P(i),P(s)}}}function oi(t){let e,l,n,r=t[0]&&Dn(t);return l=new Ze({props:{$$slots:{map:[ri],sidebar:[xo]},$$scope:{ctx:t}}}),{c(){r&&r.c(),e=A(),D(l.$$.fragment)},m(o,i){r&&r.m(o,i),b(o,e,i),q(l,o,i),n=!0},p(o,i){o[0]?r?(r.p(o,i),i[0]&1&&k(r,1)):(r=Dn(o),r.c(),k(r,1),r.m(e.parentNode,e)):r&&(be(),y(r,1,1,()=>{r=null}),ve());const a={};i[0]&7|i[1]&4&&(a.$$scope={dirty:i,ctx:o}),l.$set(a)},i(o){n||(k(r),k(l.$$.fragment,o),n=!0)},o(o){y(r),y(l.$$.fragment,o),n=!1},d(o){o&&v(e),r&&r.d(o),P(l,o)}}}function ii(t,e,l){let n,r,o;re(t,K,M=>l(1,n=M)),re(t,ne,M=>l(2,r=M)),re(t,ut,M=>l(21,o=M));let i=!1;function a(){ee(K,n.links=[],n),ee(K,n.jats=[],n),ee(K,n.bus_stops=[],n),ee(K,n.crossings=[],n)}function s(){let M=bl(n.links.length);ee(K,n.links=[...n.links,M],n),ee(ne,r={kind:"edit-link",idx:n.links.length-1},r)}function u(){if(!o)return;let M=yl(n.jats.length,o.getCenter().toArray());ee(K,n.jats=[...n.jats,M],n),ee(ne,r={kind:"edit-jat",idx:n.jats.length-1},r)}function c(){if(!o)return;let M=vl(n.bus_stops.length,o.getCenter().toArray());ee(K,n.bus_stops=[...n.bus_stops,M],n),ee(ne,r={kind:"edit-bus-stop",idx:n.bus_stops.length-1},r)}function m(){if(!o)return;let M=wl(n.crossings.length,o.getCenter().toArray());ee(K,n.crossings=[...n.crossings,M],n),ee(ne,r={kind:"edit-crossing",idx:n.crossings.length-1},r)}return[i,n,r,a,s,u,c,m,()=>l(0,i=!1),M=>ee(ne,r={kind:"edit-link",idx:M.detail.features[0].id},r),M=>ee(ne,r={kind:"edit-jat",idx:M.detail.features[0].id},r),M=>ee(ne,r={kind:"edit-bus-stop",idx:M.detail.features[0].id},r),M=>ee(ne,r={kind:"edit-crossing",idx:M.detail.features[0].id},r),()=>ar("rcv2.geojson",JSON.stringify(n)),()=>l(0,i=!0),M=>ee(ne,r={kind:"edit-link",idx:M},r),M=>ee(ne,r={kind:"edit-question",idx:M},r),(M,T)=>T.properties.answers[M]!="",M=>ee(ne,r={kind:"edit-jat",idx:M},r),M=>ee(ne,r={kind:"edit-bus-stop",idx:M},r),M=>ee(ne,r={kind:"edit-crossing",idx:M},r)]}class si extends _e{constructor(e){super(),he(this,e,ii,oi,$e,{},null,[-1,-1])}}function ai(t){let e,l;return{c(){e=$("div"),l=$("div"),R(e,"slot","left")},m(n,r){b(n,e,r),d(e,l),t[9](l)},p:le,d(n){n&&v(e),t[9](null)}}}function ci(t){return{c:le,m:le,p:le,i:le,o:le,d:le}}function ui(t){let e,l,n;function r(i){t[8](i)}let o={style:t[10],standardControls:!0,hash:!0,$$slots:{default:[$i]},$$scope:{ctx:t}};return t[2]!==void 0&&(o.map=t[2]),e=new al({props:o}),we.push(()=>Ne(e,"map",r)),{c(){D(e.$$.fragment)},m(i,a){q(e,i,a),n=!0},p(i,a){const s={};a&2058&&(s.$$scope={dirty:a,ctx:i}),!l&&a&4&&(l=!0,s.map=i[2],Ee(()=>l=!1)),e.$set(s)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){y(e.$$.fragment,i),n=!1},d(i){P(e,i)}}}function fi(t){let e,l;return e=new zo({props:{qIdx:t[3].idx}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,r){const o={};r&8&&(o.qIdx=n[3].idx),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function mi(t){let e,l;return e=new Vl({props:{idx:t[3].idx}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,r){const o={};r&8&&(o.idx=n[3].idx),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function di(t){let e,l;return e=new Jl({props:{idx:t[3].idx}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,r){const o={};r&8&&(o.idx=n[3].idx),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function pi(t){let e,l;return e=new go({props:{junctionIdx:t[3].idx,stage:t[3].stage}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,r){const o={};r&8&&(o.junctionIdx=n[3].idx),r&8&&(o.stage=n[3].stage),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function gi(t){let e,l;return e=new yo({props:{idx:t[3].idx}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,r){const o={};r&8&&(o.idx=n[3].idx),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function _i(t){let e,l;return e=new Po({props:{idx:t[3].idx}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,r){const o={};r&8&&(o.idx=n[3].idx),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function hi(t){let e,l;return e=new si({}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p:le,i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function $i(t){let e,l,n,r,o,i;const a=[hi,_i,gi,pi,di,mi,fi],s=[];function u(c,m){return c[3].kind=="neutral"?0:c[3].kind=="edit-link"?1:c[3].kind=="edit-jat"?2:c[3].kind=="edit-jat-detail"?3:c[3].kind=="edit-bus-stop"?4:c[3].kind=="edit-crossing"?5:c[3].kind=="edit-question"?6:-1}return~(n=u(t))&&(r=s[n]=a[n](t)),{c(){e=$("div"),l=A(),r&&r.c(),o=pt()},m(c,m){b(c,e,m),t[7](e),b(c,l,m),~n&&s[n].m(c,m),b(c,o,m),i=!0},p(c,m){let p=n;n=u(c),n===p?~n&&s[n].p(c,m):(r&&(be(),y(s[p],1,1,()=>{s[p]=null}),ve()),~n?(r=s[n],r?r.p(c,m):(r=s[n]=a[n](c),r.c()),k(r,1),r.m(o.parentNode,o)):r=null)},i(c){i||(k(r),i=!0)},o(c){y(r),i=!1},d(c){c&&(v(e),v(l),v(o)),t[7](null),~n&&s[n].d(c)}}}function ki(t){return{c:le,m:le,p:le,i:le,o:le,d:le}}function bi(t){let e,l,n={ctx:t,current:null,token:null,hasCatch:!1,pending:ki,then:ui,catch:ci,value:10,blocks:[,,,]};return cl(Ql(new URLSearchParams(window.location.search).get("google")||""),n),{c(){e=$("div"),n.block.c(),R(e,"slot","main"),te(e,"position","relative"),te(e,"width","100%"),te(e,"height","100vh")},m(r,o){b(r,e,o),n.block.m(e,n.anchor=null),n.mount=()=>e,n.anchor=null,l=!0},p(r,o){t=r,ul(n,t,o)},i(r){l||(k(n.block),l=!0)},o(r){for(let o=0;o<3;o+=1){const i=n.blocks[o];y(i)}l=!1},d(r){r&&v(e),n.block.d(),n.token=null,n=null}}}function vi(t){let e,l;return e=new sl({props:{$$slots:{main:[bi],left:[ai]},$$scope:{ctx:t}}}),{c(){D(e.$$.fragment)},m(n,r){q(e,n,r),l=!0},p(n,[r]){const o={};r&2063&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){P(e,n)}}}function wi(t,e,l){let n,r,o,i,a;re(t,wt,f=>l(4,n=f)),re(t,vt,f=>l(5,r=f)),re(t,K,f=>l(6,o=f)),re(t,ut,f=>l(2,i=f)),re(t,ne,f=>l(3,a=f));let s,u;function c(f){we[f?"unshift":"push"](()=>{u=f,l(1,u),l(4,n)})}function m(f){i=f,ut.set(i)}function p(f){we[f?"unshift":"push"](()=>{s=f,l(0,s),l(5,r)})}return t.$$.update=()=>{t.$$.dirty&64&&window.localStorage.setItem("tmp-rcv2",JSON.stringify(o)),t.$$.dirty&33&&s&&r&&(l(0,s.innerHTML="",s),s.appendChild(r)),t.$$.dirty&18&&u&&n&&(l(1,u.innerHTML="",u),u.appendChild(n))},[s,u,i,a,n,r,o,c,m,p]}class yi extends _e{constructor(e){super(),he(this,e,wi,vi,$e,{})}}new yi({target:document.getElementById("app")});
