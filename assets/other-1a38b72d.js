import{V as En,W as Dn,X as We,r as ue,e as y,v as fe,t as v,Y as qn,S as ie,i as se,s as ae,Z as Pn,_ as Fn,$ as ee,a0 as On,L as Bn,b as pe,a as ye,c as D,m as q,d as je,f as P,g as Jn,h as De,u as qe,j as Pe,k as Fe,l as ve,y as $,z as C,q as k,w as b,a1 as Ue,p as Ze,G as _e,D as Oe,E as Ce,B as te,Q as G,a2 as Ke,o as K,F as H,A as R,a3 as xe,O as _,N as oe,a4 as Ae,x as le,R as ge,M as Se,a5 as V,a6 as Be,a7 as et,U as x,a8 as rt,a9 as at,H as re,K as tt,aa as zn,ab as nt,ac as Rn,C as Je,P as An,ad as Hn,I as Gn,T as Un}from"./Layout-4695594c.js";function Zn(n,e){const l=e.token={};function t(r,o,i,c){if(e.token!==l)return;e.resolved=c;let s=e.ctx;i!==void 0&&(s=s.slice(),s[i]=c);const u=r&&(e.current=r)(s);let a=!1;e.block&&(e.blocks?e.blocks.forEach((f,m)=>{m!==o&&f&&(ue(),y(f,1,1,()=>{e.blocks[m]===f&&(e.blocks[m]=null)}),fe())}):e.block.d(1),u.c(),v(u,1),u.m(e.mount(),e.anchor),a=!0),e.block=u,e.blocks&&(e.blocks[o]=u),a&&qn()}if(En(n)){const r=Dn();if(n.then(o=>{We(r),t(e.then,1,e.value,o),We(null)},o=>{if(We(r),t(e.catch,2,e.error,o),We(null),!e.hasCatch)throw o}),e.current!==e.pending)return t(e.pending,0),!0}else{if(e.current!==e.then)return t(e.then,1,e.value,n),!0;e.resolved=n}}function Kn(n,e,l){const t=e.slice(),{resolved:r}=n;n.current===n.then&&(t[n.value]=r),n.current===n.catch&&(t[n.error]=r),n.block.p(t,l)}function Xn(n,e,l){let t;const r=Pn();let{layer:o=void 0}=e;const{map:i}=Fn();ee(n,i,a=>l(2,t=a));function c(a){r(a.type,{...a,map:i})}const s=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu","mouseover","mouseout"],u=["click","dblclick","contextmenu","mousemove","movestart","moveend","zoomstart","zoom","zoomend"];return On(()=>{if(t)if(o)for(const a of s)t.off(a,o,c);else for(const a of u)t.off(a,c)}),n.$$set=a=>{"layer"in a&&l(1,o=a.layer)},n.$$.update=()=>{if(n.$$.dirty&6&&t)if(o)for(const a of s)t.on(a,o,c);else for(const a of u)t.on(a,c)},[i,o,t]}class Tn extends ie{constructor(e){super(),se(this,e,Xn,null,ae,{layer:1})}}function Wn(n){let e;const l=n[16].default,t=De(l,n,n[24],null);return{c(){t&&t.c()},m(r,o){t&&t.m(r,o),e=!0},p(r,o){t&&t.p&&(!e||o&16777216)&&qe(t,l,r,r[24],e?Fe(l,r[24],o,null):Pe(r[24]),null)},i(r){e||(v(t,r),e=!0)},o(r){y(t,r),e=!1},d(r){t&&t.d(r)}}}function Vn(n){let e,l,t;function r(i){n[17](i)}let o={id:n[1],type:"symbol",source:n[2],sourceLayer:n[3],beforeId:n[4],beforeLayerType:n[5],paint:n[6],layout:n[7],filter:n[8],applyToClusters:n[9],minzoom:n[10],maxzoom:n[11],hoverCursor:n[12],manageHoverState:n[13],eventsIfTopMost:n[14],interactive:n[15],$$slots:{default:[Wn]},$$scope:{ctx:n}};return n[0]!==void 0&&(o.hovered=n[0]),e=new Bn({props:o}),pe.push(()=>ye(e,"hovered",r)),e.$on("click",n[18]),e.$on("dblclick",n[19]),e.$on("contextmenu",n[20]),e.$on("mouseenter",n[21]),e.$on("mousemove",n[22]),e.$on("mouseleave",n[23]),{c(){D(e.$$.fragment)},m(i,c){q(e,i,c),t=!0},p(i,[c]){const s={};c&2&&(s.id=i[1]),c&4&&(s.source=i[2]),c&8&&(s.sourceLayer=i[3]),c&16&&(s.beforeId=i[4]),c&32&&(s.beforeLayerType=i[5]),c&64&&(s.paint=i[6]),c&128&&(s.layout=i[7]),c&256&&(s.filter=i[8]),c&512&&(s.applyToClusters=i[9]),c&1024&&(s.minzoom=i[10]),c&2048&&(s.maxzoom=i[11]),c&4096&&(s.hoverCursor=i[12]),c&8192&&(s.manageHoverState=i[13]),c&16384&&(s.eventsIfTopMost=i[14]),c&32768&&(s.interactive=i[15]),c&16777216&&(s.$$scope={dirty:c,ctx:i}),!l&&c&1&&(l=!0,s.hovered=i[0],je(()=>l=!1)),e.$set(s)},i(i){t||(v(e.$$.fragment,i),t=!0)},o(i){y(e.$$.fragment,i),t=!1},d(i){P(e,i)}}}function Qn(n,e,l){let{$$slots:t={},$$scope:r}=e,{id:o=Jn("symbol")}=e,{source:i=void 0}=e,{sourceLayer:c=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:u=void 0}=e,{paint:a=void 0}=e,{layout:f=void 0}=e,{filter:m=void 0}=e,{applyToClusters:d=void 0}=e,{minzoom:p=void 0}=e,{maxzoom:g=void 0}=e,{hoverCursor:N=void 0}=e,{manageHoverState:h=!1}=e,{hovered:w=null}=e,{eventsIfTopMost:O=!1}=e,{interactive:T=!0}=e;function A(j){w=j,l(0,w)}function S(j){ve.call(this,n,j)}function z(j){ve.call(this,n,j)}function I(j){ve.call(this,n,j)}function J(j){ve.call(this,n,j)}function M(j){ve.call(this,n,j)}function E(j){ve.call(this,n,j)}return n.$$set=j=>{"id"in j&&l(1,o=j.id),"source"in j&&l(2,i=j.source),"sourceLayer"in j&&l(3,c=j.sourceLayer),"beforeId"in j&&l(4,s=j.beforeId),"beforeLayerType"in j&&l(5,u=j.beforeLayerType),"paint"in j&&l(6,a=j.paint),"layout"in j&&l(7,f=j.layout),"filter"in j&&l(8,m=j.filter),"applyToClusters"in j&&l(9,d=j.applyToClusters),"minzoom"in j&&l(10,p=j.minzoom),"maxzoom"in j&&l(11,g=j.maxzoom),"hoverCursor"in j&&l(12,N=j.hoverCursor),"manageHoverState"in j&&l(13,h=j.manageHoverState),"hovered"in j&&l(0,w=j.hovered),"eventsIfTopMost"in j&&l(14,O=j.eventsIfTopMost),"interactive"in j&&l(15,T=j.interactive),"$$scope"in j&&l(24,r=j.$$scope)},[w,o,i,c,s,u,a,f,m,d,p,g,N,h,O,T,t,A,S,z,I,J,M,E,r]}class Yn extends ie{constructor(e){super(),se(this,e,Qn,Vn,ae,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}const xn=n=>({}),ct=n=>({}),el=n=>({}),ut=n=>({});function tl(n){let e,l,t,r;const o=n[3].sidebar,i=De(o,n,n[2],ut),c=n[3].map,s=De(c,n,n[2],ct);return{c(){e=$("div"),i&&i.c(),l=C(),t=$("div"),s&&s.c()},m(u,a){k(u,e,a),i&&i.m(e,null),n[4](e),k(u,l,a),k(u,t,a),s&&s.m(t,null),n[5](t),r=!0},p(u,[a]){i&&i.p&&(!r||a&4)&&qe(i,o,u,u[2],r?Fe(o,u[2],a,el):Pe(u[2]),ut),s&&s.p&&(!r||a&4)&&qe(s,c,u,u[2],r?Fe(c,u[2],a,xn):Pe(u[2]),ct)},i(u){r||(v(i,u),v(s,u),r=!0)},o(u){y(i,u),y(s,u),r=!1},d(u){u&&(b(e),b(l),b(t)),i&&i.d(u),n[4](null),s&&s.d(u),n[5](null)}}}function nl(n,e,l){let t,r;ee(n,ot,u=>l(0,t=u)),ee(n,it,u=>l(1,r=u));let{$$slots:o={},$$scope:i}=e;function c(u){pe[u?"unshift":"push"](()=>{t=u,ot.set(t)})}function s(u){pe[u?"unshift":"push"](()=>{r=u,it.set(r)})}return n.$$set=u=>{"$$scope"in u&&l(2,i=u.$$scope)},[t,r,i,o,c,s]}class Ie extends ie{constructor(e){super(),se(this,e,nl,tl,ae,{})}}let ot=Ue(null),it=Ue(null);function ke(){return["","2","1","0","Critical"]}let Te=["#66C5CC","#F6CF71","#F89C74","#DCB0F2","#87C55F","#9EB9F3","#FE88B1","#C9DB74","#8BE0A4","#B497E7","#D3B484","#B3B3B3"],ze=Ue(void 0),U=Ue(ll());function ne(n){return{type:"FeatureCollection",features:n}}let Q=Ue({kind:"neutral"});function ll(){try{let n=JSON.parse(window.localStorage.getItem("tmp-rcv2")||"");if("links"in n&&"jats"in n&&"crossings"in n)return n}catch{}return{links:[],jats:[],bus_stops:[],crossings:[]}}function ft(n){let e,l;return e=new _e({props:{data:ne(n[2].links),$$slots:{default:[rl]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r&4&&(o.data=ne(t[2].links)),r&10&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function rl(n){let e,l;return e=new Oe({props:{paint:{"line-color":n[1]?["get","color"]:"black","line-width":6}}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r&2&&(o.paint={"line-color":t[1]?["get","color"]:"black","line-width":6}),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function mt(n){let e,l;return e=new _e({props:{data:ne(n[2].bus_stops),$$slots:{default:[ol]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r&4&&(o.data=ne(t[2].bus_stops)),r&8&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function ol(n){let e,l;return e=new Ce({props:{paint:{"circle-color":"black","circle-radius":10}}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p:te,i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function dt(n){let e,l;return e=new _e({props:{data:ne(n[2].crossings),$$slots:{default:[il]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r&4&&(o.data=ne(t[2].crossings)),r&8&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function il(n){let e,l;return e=new Ce({props:{paint:{"circle-color":"black","circle-radius":10}}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p:te,i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function pt(n){let e,l;return e=new _e({props:{data:ne(n[2].jats),$$slots:{default:[sl]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r&4&&(o.data=ne(t[2].jats)),r&8&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function sl(n){let e,l;return e=new Ce({props:{paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":"black","circle-radius":20}}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p:te,i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function al(n){let e,l,t,r,o,i=n[0]!="links"&&ft(n),c=n[0]!="bus_stops"&&mt(n),s=n[0]!="crossings"&&dt(n),u=n[0]!="jats"&&pt(n);return{c(){i&&i.c(),e=C(),c&&c.c(),l=C(),s&&s.c(),t=C(),u&&u.c(),r=Ze()},m(a,f){i&&i.m(a,f),k(a,e,f),c&&c.m(a,f),k(a,l,f),s&&s.m(a,f),k(a,t,f),u&&u.m(a,f),k(a,r,f),o=!0},p(a,[f]){a[0]!="links"?i?(i.p(a,f),f&1&&v(i,1)):(i=ft(a),i.c(),v(i,1),i.m(e.parentNode,e)):i&&(ue(),y(i,1,1,()=>{i=null}),fe()),a[0]!="bus_stops"?c?(c.p(a,f),f&1&&v(c,1)):(c=mt(a),c.c(),v(c,1),c.m(l.parentNode,l)):c&&(ue(),y(c,1,1,()=>{c=null}),fe()),a[0]!="crossings"?s?(s.p(a,f),f&1&&v(s,1)):(s=dt(a),s.c(),v(s,1),s.m(t.parentNode,t)):s&&(ue(),y(s,1,1,()=>{s=null}),fe()),a[0]!="jats"?u?(u.p(a,f),f&1&&v(u,1)):(u=pt(a),u.c(),v(u,1),u.m(r.parentNode,r)):u&&(ue(),y(u,1,1,()=>{u=null}),fe())},i(a){o||(v(i),v(c),v(s),v(u),o=!0)},o(a){y(i),y(c),y(s),y(u),o=!1},d(a){a&&(b(e),b(l),b(t),b(r)),i&&i.d(a),c&&c.d(a),s&&s.d(a),u&&u.d(a)}}}function cl(n,e,l){let t;ee(n,U,i=>l(2,t=i));let{except:r}=e,{showLinkColor:o=!1}=e;return n.$$set=i=>{"except"in i&&l(0,r=i.except),"showLinkColor"in i&&l(1,o=i.showLinkColor)},[r,o,t]}class Re extends ie{constructor(e){super(),se(this,e,cl,al,ae,{except:0,showLinkColor:1})}}const{window:ul}=Ke;function fl(n,e,l){const t=n.slice();return t[9]=e[l],t}function ml(n){let e;return{c(){e=$("option"),e.textContent=`${n[9]}`,e.__value=n[9],oe(e,e.__value)},m(l,t){k(l,e,t)},p:te,d(l){l&&b(e)}}}function dl(n){let e,l,t,r,o,i,c,s,u,a,f,m,d,p,g=K(ke()),N=[];for(let h=0;h<g.length;h+=1)N[h]=ml(fl(n,g,h));return{c(){e=$("div"),l=$("button"),l.textContent="Done",t=C(),r=$("button"),r.textContent="Delete bus stop",o=C(),i=$("label"),c=H(`Name:
      `),s=$("input"),u=C(),a=$("label"),f=H(`ST20: bus stops
      `),m=$("select");for(let h=0;h<N.length;h+=1)N[h].c();R(s,"type","text"),n[1].bus_stops[n[0]].properties.st20===void 0&&xe(()=>n[8].call(m)),R(e,"slot","sidebar")},m(h,w){k(h,e,w),_(e,l),_(e,t),_(e,r),_(e,o),_(e,i),_(i,c),_(i,s),oe(s,n[1].bus_stops[n[0]].properties.name),_(e,u),_(e,a),_(a,f),_(a,m);for(let O=0;O<N.length;O+=1)N[O]&&N[O].m(m,null);Ae(m,n[1].bus_stops[n[0]].properties.st20,!0),d||(p=[G(l,"click",n[6]),G(r,"click",n[4]),G(s,"input",n[7]),G(m,"change",n[8])],d=!0)},p(h,w){w&3&&s.value!==h[1].bus_stops[h[0]].properties.name&&oe(s,h[1].bus_stops[h[0]].properties.name),w&3&&Ae(m,h[1].bus_stops[h[0]].properties.st20)},d(h){h&&b(e),le(N,h),d=!1,ge(p)}}}function pl(n){let e,l;return e=new Ce({props:{filter:["!=",["id"],n[0]],paint:{"circle-color":"black","circle-radius":10}}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r&1&&(o.filter=["!=",["id"],t[0]]),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function _l(n){let e;return{c(){e=$("span"),R(e,"class","dot svelte-1j72wc4"),x(e,"background-color",n[1].bus_stops[n[0]].properties.color)},m(l,t){k(l,e,t)},p(l,t){t&3&&x(e,"background-color",l[1].bus_stops[l[0]].properties.color)},d(l){l&&b(e)}}}function gl(n){let e,l,t,r,o,i,c,s;l=new Re({props:{except:"bus_stops"}}),r=new _e({props:{data:ne(n[1].bus_stops),generateId:!0,$$slots:{default:[pl]},$$scope:{ctx:n}}});function u(f){n[5](f)}let a={draggable:!0,$$slots:{default:[_l]},$$scope:{ctx:n}};return n[1].bus_stops[n[0]].geometry.coordinates!==void 0&&(a.lngLat=n[1].bus_stops[n[0]].geometry.coordinates),i=new Se({props:a}),pe.push(()=>ye(i,"lngLat",u)),{c(){e=$("div"),D(l.$$.fragment),t=C(),D(r.$$.fragment),o=C(),D(i.$$.fragment),R(e,"slot","map")},m(f,m){k(f,e,m),q(l,e,null),_(e,t),q(r,e,null),_(e,o),q(i,e,null),s=!0},p(f,m){const d={};m&2&&(d.data=ne(f[1].bus_stops)),m&4097&&(d.$$scope={dirty:m,ctx:f}),r.$set(d);const p={};m&4099&&(p.$$scope={dirty:m,ctx:f}),!c&&m&3&&(c=!0,p.lngLat=f[1].bus_stops[f[0]].geometry.coordinates,je(()=>c=!1)),i.$set(p)},i(f){s||(v(l.$$.fragment,f),v(r.$$.fragment,f),v(i.$$.fragment,f),s=!0)},o(f){y(l.$$.fragment,f),y(r.$$.fragment,f),y(i.$$.fragment,f),s=!1},d(f){f&&b(e),P(l),P(r),P(i)}}}function hl(n){let e,l,t,r;return e=new Ie({props:{$$slots:{map:[gl],sidebar:[dl]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},m(o,i){q(e,o,i),l=!0,t||(r=G(ul,"keydown",n[3]),t=!0)},p(o,[i]){const c={};i&4103&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){l||(v(e.$$.fragment,o),l=!0)},o(o){y(e.$$.fragment,o),l=!1},d(o){P(e,o),t=!1,r()}}}function $l(n,e,l){let t,r;ee(n,U,m=>l(1,t=m)),ee(n,Q,m=>l(2,r=m));let{idx:o}=e;function i(m){m.key=="Escape"&&V(Q,r={kind:"neutral"},r)}async function c(){window.confirm("Really delete this bus stop?")&&(V(Q,r={kind:"neutral"},r),await Be(),t.bus_stops.splice(o,1),U.set(t))}function s(m){n.$$.not_equal(t.bus_stops[o].geometry.coordinates,m)&&(t.bus_stops[o].geometry.coordinates=m,U.set(t))}const u=()=>V(Q,r={kind:"neutral"},r);function a(){t.bus_stops[o].properties.name=this.value,U.set(t)}function f(){t.bus_stops[o].properties.st20=et(this),U.set(t)}return n.$$set=m=>{"idx"in m&&l(0,o=m.idx)},[o,t,r,i,c,s,u,a,f]}class kl extends ie{constructor(e){super(),se(this,e,$l,hl,ae,{idx:0})}}const{window:bl}=Ke;function vl(n,e,l){const t=n.slice();return t[9]=e[l],t}function wl(n){let e;return{c(){e=$("option"),e.textContent=`${n[9]}`,e.__value=n[9],oe(e,e.__value)},m(l,t){k(l,e,t)},p:te,d(l){l&&b(e)}}}function yl(n){let e,l,t,r,o,i,c,s,u,a,f,m,d,p,g=K(ke()),N=[];for(let h=0;h<g.length;h+=1)N[h]=wl(vl(n,g,h));return{c(){e=$("div"),l=$("button"),l.textContent="Done",t=C(),r=$("button"),r.textContent="Delete crossing",o=C(),i=$("label"),c=H(`Name:
      `),s=$("input"),u=C(),a=$("label"),f=H(`SA10: pedestrian crossing speed
      `),m=$("select");for(let h=0;h<N.length;h+=1)N[h].c();R(s,"type","text"),n[1].crossings[n[0]].properties.sa10===void 0&&xe(()=>n[8].call(m)),R(e,"slot","sidebar")},m(h,w){k(h,e,w),_(e,l),_(e,t),_(e,r),_(e,o),_(e,i),_(i,c),_(i,s),oe(s,n[1].crossings[n[0]].properties.name),_(e,u),_(e,a),_(a,f),_(a,m);for(let O=0;O<N.length;O+=1)N[O]&&N[O].m(m,null);Ae(m,n[1].crossings[n[0]].properties.sa10,!0),d||(p=[G(l,"click",n[6]),G(r,"click",n[4]),G(s,"input",n[7]),G(m,"change",n[8])],d=!0)},p(h,w){w&3&&s.value!==h[1].crossings[h[0]].properties.name&&oe(s,h[1].crossings[h[0]].properties.name),w&3&&Ae(m,h[1].crossings[h[0]].properties.sa10)},d(h){h&&b(e),le(N,h),d=!1,ge(p)}}}function jl(n){let e,l;return e=new Ce({props:{filter:["!=",["id"],n[0]],paint:{"circle-color":"black","circle-radius":10}}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r&1&&(o.filter=["!=",["id"],t[0]]),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Cl(n){let e;return{c(){e=$("span"),R(e,"class","dot svelte-1j72wc4"),x(e,"background-color",n[1].crossings[n[0]].properties.color)},m(l,t){k(l,e,t)},p(l,t){t&3&&x(e,"background-color",l[1].crossings[l[0]].properties.color)},d(l){l&&b(e)}}}function Ll(n){let e,l,t,r,o,i,c,s;l=new Re({props:{except:"crossings"}}),r=new _e({props:{data:ne(n[1].crossings),generateId:!0,$$slots:{default:[jl]},$$scope:{ctx:n}}});function u(f){n[5](f)}let a={draggable:!0,$$slots:{default:[Cl]},$$scope:{ctx:n}};return n[1].crossings[n[0]].geometry.coordinates!==void 0&&(a.lngLat=n[1].crossings[n[0]].geometry.coordinates),i=new Se({props:a}),pe.push(()=>ye(i,"lngLat",u)),{c(){e=$("div"),D(l.$$.fragment),t=C(),D(r.$$.fragment),o=C(),D(i.$$.fragment),R(e,"slot","map")},m(f,m){k(f,e,m),q(l,e,null),_(e,t),q(r,e,null),_(e,o),q(i,e,null),s=!0},p(f,m){const d={};m&2&&(d.data=ne(f[1].crossings)),m&4097&&(d.$$scope={dirty:m,ctx:f}),r.$set(d);const p={};m&4099&&(p.$$scope={dirty:m,ctx:f}),!c&&m&3&&(c=!0,p.lngLat=f[1].crossings[f[0]].geometry.coordinates,je(()=>c=!1)),i.$set(p)},i(f){s||(v(l.$$.fragment,f),v(r.$$.fragment,f),v(i.$$.fragment,f),s=!0)},o(f){y(l.$$.fragment,f),y(r.$$.fragment,f),y(i.$$.fragment,f),s=!1},d(f){f&&b(e),P(l),P(r),P(i)}}}function Sl(n){let e,l,t,r;return e=new Ie({props:{$$slots:{map:[Ll],sidebar:[yl]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},m(o,i){q(e,o,i),l=!0,t||(r=G(bl,"keydown",n[3]),t=!0)},p(o,[i]){const c={};i&4103&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){l||(v(e.$$.fragment,o),l=!0)},o(o){y(e.$$.fragment,o),l=!1},d(o){P(e,o),t=!1,r()}}}function Al(n,e,l){let t,r;ee(n,U,m=>l(1,t=m)),ee(n,Q,m=>l(2,r=m));let{idx:o}=e;function i(m){m.key=="Escape"&&V(Q,r={kind:"neutral"},r)}async function c(){window.confirm("Really delete this crossing?")&&(V(Q,r={kind:"neutral"},r),await Be(),t.crossings.splice(o,1),U.set(t))}function s(m){n.$$.not_equal(t.crossings[o].geometry.coordinates,m)&&(t.crossings[o].geometry.coordinates=m,U.set(t))}const u=()=>V(Q,r={kind:"neutral"},r);function a(){t.crossings[o].properties.name=this.value,U.set(t)}function f(){t.crossings[o].properties.sa10=et(this),U.set(t)}return n.$$set=m=>{"idx"in m&&l(0,o=m.idx)},[o,t,r,i,c,s,u,a,f]}class Tl extends ie{constructor(e){super(),se(this,e,Al,Sl,ae,{idx:0})}}let _t="MZEJTanw3WpxRvt7qDfo";async function Ml(n){return n?{version:8,sources:{"raster-tiles":{type:"raster",tiles:[`https://tile.googleapis.com/v1/2dtiles/{z}/{x}/{y}?session=${await Il(n)}&key=${n}`],tileSize:256,attribution:"Google (detailed attributions not wired up)"}},layers:[{id:"raster-basemap",type:"raster",source:"raster-tiles"}],glyphs:`https://api.maptiler.com/fonts/{fontstack}/{range}.pbf?key=${_t}`}:`https://api.maptiler.com/maps/dataviz/style.json?key=${_t}`}async function Il(n){try{let l=await(await fetch(`https://tile.googleapis.com/v1/createSession?key=${n}`,{method:"POST",body:JSON.stringify({mapType:"satellite",language:"en-GB",region:"GB"})})).json();return"session"in l?l.session:(console.error(`Couldn't get Google tile session key: ${JSON.stringify(l)}`),"")}catch(e){return console.error(`Couldn't get Google tile session key: ${e}`),""}}const Nl="/route-element/assets/right-arrow-d8c7892c.svg";function gt(n){let e,l;const t=n[4].default,r=De(t,n,n[3],null);return{c(){e=$("div"),r&&r.c(),R(e,"class","section svelte-zax3q3")},m(o,i){k(o,e,i),r&&r.m(e,null),l=!0},p(o,i){r&&r.p&&(!l||i&8)&&qe(r,t,o,o[3],l?Fe(t,o[3],i,null):Pe(o[3]),null)},i(o){l||(v(r,o),l=!0)},o(o){y(r,o),l=!1},d(o){o&&b(e),r&&r.d(o)}}}function El(n){let e,l,t,r,o,i,c,s,u,a,f,m,d=n[2]&&gt(n);return{c(){e=$("button"),l=$("div"),t=$("span"),r=H(n[0]),o=C(),i=$("img"),u=C(),d&&d.c(),R(i,"class","arrow svelte-zax3q3"),rt(i.src,c=Nl)||R(i,"src",c),R(i,"alt",s="Select "+n[0]),R(l,"class","top-section section svelte-zax3q3"),at(l,"bordered",n[2]),R(e,"class","clickable-card svelte-zax3q3"),e.disabled=n[1]},m(p,g){k(p,e,g),_(e,l),_(l,t),_(t,r),_(l,o),_(l,i),_(e,u),d&&d.m(e,null),a=!0,f||(m=[G(e,"click",n[5]),G(e,"mouseenter",n[6]),G(e,"mouseleave",n[7])],f=!0)},p(p,[g]){(!a||g&1)&&re(r,p[0]),(!a||g&1&&s!==(s="Select "+p[0]))&&R(i,"alt",s),(!a||g&4)&&at(l,"bordered",p[2]),p[2]?d?(d.p(p,g),g&4&&v(d,1)):(d=gt(p),d.c(),v(d,1),d.m(e,null)):d&&(ue(),y(d,1,1,()=>{d=null}),fe()),(!a||g&2)&&(e.disabled=p[1])},i(p){a||(v(d),a=!0)},o(p){y(d),a=!1},d(p){p&&b(e),d&&d.d(),f=!1,ge(m)}}}function Dl(n,e,l){let{$$slots:t={},$$scope:r}=e,{name:o}=e,{disabled:i=!1}=e,{hasSlot:c=!0}=e;function s(f){ve.call(this,n,f)}function u(f){ve.call(this,n,f)}function a(f){ve.call(this,n,f)}return n.$$set=f=>{"name"in f&&l(0,o=f.name),"disabled"in f&&l(1,i=f.disabled),"hasSlot"in f&&l(2,c=f.hasSlot),"$$scope"in f&&l(3,r=f.$$scope)},[o,i,c,r,t,s,u,a]}class Mn extends ie{constructor(e){super(),se(this,e,Dl,El,ae,{name:0,disabled:1,hasSlot:2})}}let Le={critical:{background:"#232323",font:"white"},red:{background:"#b73d25",font:"white"},amber:{background:"#ffd833",font:"black"},green:{background:"#006853",font:"white"},notApplicable:{background:"white",font:"black"}};const ql=n=>({dialog:n&1}),ht=n=>({dialog:n[0]});function Pl(n){let e,l,t,r,o;const i=n[4].default,c=De(i,n,n[3],ht);return{c(){e=$("dialog"),l=$("article"),c&&c.c(),e.open=!0},m(s,u){k(s,e,u),_(e,l),c&&c.m(l,null),n[6](e),t=!0,r||(o=[G(window,"click",n[1]),G(window,"keydown",n[2]),G(e,"close",n[5])],r=!0)},p(s,[u]){c&&c.p&&(!t||u&9)&&qe(c,i,s,s[3],t?Fe(i,s[3],u,ql):Pe(s[3]),ht)},i(s){t||(v(c,s),t=!0)},o(s){y(c,s),t=!1},d(s){s&&b(e),c&&c.d(s),n[6](null),r=!1,ge(o)}}}function Fl(n,e,l){let{$$slots:t={},$$scope:r}=e,o;function i(a){o.open&&a.target==o&&o.close()}function c(a){(a.key=="Escape"||a.key=="Enter")&&(a.stopPropagation(),o.close())}function s(a){ve.call(this,n,a)}function u(a){pe[a?"unshift":"push"](()=>{o=a,l(0,o)})}return n.$$set=a=>{"$$scope"in a&&l(3,r=a.$$scope)},[o,i,c,r,t,s,u]}class In extends ie{constructor(e){super(),se(this,e,Fl,Pl,ae,{})}}function Ol(n,e){let l=document.createElement("a");l.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),l.setAttribute("download",n),document.body.appendChild(l),l.click(),document.body.removeChild(l)}const Ne={"Any type of junction":{"All movements":{scoreZero:["Cycle movement in potential conflict with heavy motor traffic flow.","Cycle movement mixed with or crossing traffic with 85th percentile speed exceeding 60kph, or where vehicles accelerate rapidly.","Necessary to cross more than one traffic lane (without refuge or protection) to complete cycle movement unless traffic flows are low.","Cycle movement crosses wide junction entry or exit: e.g. with merge or diverge taper or slip lane.","Pinch points on junction entry or exit (lane width 3.2m-3.9m).","Cycle movement affected by very poor surface quality utility reinstatement, gully positioning, debris."],scoreOne:["Cycle movement in potential conflict with moderate traffic flow.","Cycle lanes through junction meeting appropriate desirable minimum width requirements for the movement under consideration.","Raised table at junction crossed by traffic in potential conflict with cycle movement.","Cycle movement made by transiting onto section of shared use footway."],scoreTwo:["Low traffic speed and volume in mixed traffic environment (e.g. access-only streets in a residential area).","Cycle movement separated physically and/or in time from motor traffic and also separated from pedestrians.","Cycle movement bypasses junction completely, including via good quality grade separation."]}},"Simple priority T-junction":{"Right turn from minor arm":{scoreZero:["Heavy traffic movements and/or high bus and HGV flows in potential conflict with cycle movement, with no physical refuge in the centre of the major road (including ghost island junction)."],scoreOne:["Central refuge allowing two-stage cycle movement crossing one traffic lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm with dedicated cycle signals or cycle priority."]},"Left turn from major arm":{scoreZero:[],scoreOne:["Side road entry treatment (table across minor arm)."],scoreTwo:["Continuous footway and cycle track across minor arm."]},"Right turn from major arm":{scoreZero:["Heavy traffic movements and/or high bus and HGV flows in potential conflict with no physical refuge in the centre of major road (including ghost island junction)."],scoreOne:["Protected turning refuge allowing two stage cycle movement, crossing one lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm via dedicated cycle signals or cycle priority."]},"Ahead on major arm, crossing minor arm":{scoreZero:["Congested conditions causing poor visibility for right-turning motor vehicles from major arm.","Junction corner radius ≥9m, including where off-carriageway cycle track crosses minor arm."],scoreOne:["Junction free from queueing traffic and cycle lane on major arm meeting desirable minimum width requirements.","Junction corner radius <9m, including where off-carriageway cycle track crosses minor arm without priority.","Side road entry treatment (table across minor arm)."],scoreTwo:["Off-carriageway cycle track or stepped cycle track alongside major arm, crossing minor arm with priority over turning traffic."]}},Crossroads:{"Ahead from minor arm":{scoreZero:["Heavy opposing traffic movements with no physical refuge (including ghost island junction)."],scoreOne:["Protected pocket refuge for ahead cycles allowing two stage movement, crossing one lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm via dedicated cycle signals or cycle priority."]}},"Traffic Signals":{"All movements":{scoreZero:["Single or multiple queuing lanes with no cycle lanes or tracks on approaches.","Junctions with unsignalised left turn merge/diverge and signalised ahead lanes."],scoreOne:["Advance Cycle Stop lines, at least 5m deep and where the signals on the approach are on green for <30% of the cycle time.","Signal timings adjusted to provide extended intergreen to suit cycle movement under consideration.","Cycle/pedestrian scramble (toucan crossings with all-red stage).","Early release for cycles, with enough time to clear junction for cycle movement being considered."],scoreTwo:["Cycle movement has no potential conflict with motor traffic, e.g. dedicated cycle stage, conflicting traffic movement held or banned."]},"Right turn":{scoreZero:[],scoreOne:["Two-stage right turn via ASL or marked area in front of stop line."],scoreTwo:["Two-stage right turn with physically protected waiting area."]}},Roundabout:{"All movements":{scoreZero:["Any type of roundabout with high traffic throughput.","Normal roundabout with multi-lane flared approaches.","Any type of roundabout with annular cycle lane marked on the circulatory carriageway."],scoreOne:["Compact roundabout or raised mini roundabout with no more than moderate traffic throughput","Off-carriageway cycle track with crossings of entries and exits without cycle priority, crossing single traffic lanes with traffic flows < 4000 vehicles per day or 400 HGV/bus flow. "],scoreTwo:["Off-carriageway cycle track with crossings of entries and exits with signals or cycle priority."]}}},st=Object.keys(Ne);function Ye(n){return Object.keys(Ne[n])}const Me="All movements";function $t(n,e){let l=[],t=Ne[n][e];t&&l.push({junctionType:n,movementType:e,...t});let r=Ne[n][Me];if(r&&e!=Me&&l.push({junctionType:n,movementType:Me,...r}),n=="Crossroads"){let o=Ne["Simple priority T-junction"][Me];o&&l.push({junctionType:"Simple priority T-junction",movementType:Me,...o})}if(n!="Any type of junction"){let o=Ne["Any type of junction"][Me];o&&l.push({junctionType:"Any type of junction",movementType:Me,...o})}return l}function kt(n,e,l){const t=n.slice();return t[10]=e[l],t}function bt(n,e,l){const t=n.slice();return t[13]=e[l],t}function vt(n,e,l){const t=n.slice();return t[13]=e[l],t}function wt(n,e,l){const t=n.slice();return t[13]=e[l],t}function yt(n,e,l){const t=n.slice();return t[20]=e[l],t}function jt(n,e,l){const t=n.slice();return t[20]=e[l],t}function Ct(n){let e,l;return e=new In({props:{$$slots:{default:[Bl]},$$scope:{ctx:n}}}),e.$on("close",n[9]),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r&33554439&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Lt(n){let e,l,t,r,o,i,c,s;return i=tt(n[6][1]),{c(){e=$("label"),l=$("input"),t=C(),r=H(n[20]),o=C(),R(l,"type","radio"),l.__value=n[20],oe(l,l.__value),i.p(l)},m(u,a){k(u,e,a),_(e,l),l.checked=l.__value===n[1],_(e,t),_(e,r),_(e,o),c||(s=[G(l,"change",n[5]),G(l,"change",n[3])],c=!0)},p(u,a){a&2&&(l.checked=l.__value===u[1])},d(u){u&&b(e),i.r(),c=!1,ge(s)}}}function St(n){let e,l,t,r=!1,o,i=n[20]+"",c,s,u,a,f;return u=tt(n[6][0]),{c(){e=$("label"),l=$("input"),o=C(),c=H(i),s=C(),R(l,"type","radio"),l.__value=t=n[20],oe(l,l.__value),u.p(l)},m(m,d){k(m,e,d),_(e,l),l.checked=l.__value===n[2],_(e,o),_(e,c),_(e,s),a||(f=G(l,"change",n[7]),a=!0)},p(m,d){d&2&&t!==(t=m[20])&&(l.__value=t,oe(l,l.__value),r=!0),(r||d&6)&&(l.checked=l.__value===m[2]),d&2&&i!==(i=m[20]+"")&&re(c,i)},d(m){m&&b(e),u.r(),a=!1,f()}}}function At(n){let e,l=n[13]+"",t;return{c(){e=$("li"),t=H(l)},m(r,o){k(r,e,o),_(e,t)},p(r,o){o&6&&l!==(l=r[13]+"")&&re(t,l)},d(r){r&&b(e)}}}function Tt(n){let e,l=n[13]+"",t;return{c(){e=$("li"),t=H(l)},m(r,o){k(r,e,o),_(e,t)},p(r,o){o&6&&l!==(l=r[13]+"")&&re(t,l)},d(r){r&&b(e)}}}function Mt(n){let e,l=n[13]+"",t;return{c(){e=$("li"),t=H(l)},m(r,o){k(r,e,o),_(e,t)},p(r,o){o&6&&l!==(l=r[13]+"")&&re(t,l)},d(r){r&&b(e)}}}function It(n){let e,l,t=n[10].junctionType+"",r,o,i,c,s,u,a=n[10].movementType+"",f,m,d,p,g,N,h,w,O,T,A,S=K(n[10].scoreZero),z=[];for(let j=0;j<S.length;j+=1)z[j]=At(wt(n,S,j));let I=K(n[10].scoreOne),J=[];for(let j=0;j<I.length;j+=1)J[j]=Tt(vt(n,I,j));let M=K(n[10].scoreTwo),E=[];for(let j=0;j<M.length;j+=1)E[j]=Mt(bt(n,M,j));return{c(){e=$("tr"),l=$("td"),r=H(t),o=C(),i=$("br"),c=C(),s=$("br"),u=C(),f=H(a),m=C(),d=$("td"),p=$("ul");for(let j=0;j<z.length;j+=1)z[j].c();g=C(),N=$("td"),h=$("ul");for(let j=0;j<J.length;j+=1)J[j].c();w=C(),O=$("td"),T=$("ul");for(let j=0;j<E.length;j+=1)E[j].c();A=C(),R(l,"class","type-row svelte-k4kgn3"),R(d,"class","score-zero svelte-k4kgn3"),R(N,"class","score-one svelte-k4kgn3"),R(O,"class","score-two svelte-k4kgn3")},m(j,Z){k(j,e,Z),_(e,l),_(l,r),_(l,o),_(l,i),_(l,c),_(l,s),_(l,u),_(l,f),_(e,m),_(e,d),_(d,p);for(let L=0;L<z.length;L+=1)z[L]&&z[L].m(p,null);_(e,g),_(e,N),_(N,h);for(let L=0;L<J.length;L+=1)J[L]&&J[L].m(h,null);_(e,w),_(e,O),_(O,T);for(let L=0;L<E.length;L+=1)E[L]&&E[L].m(T,null);_(e,A)},p(j,Z){if(Z&6&&t!==(t=j[10].junctionType+"")&&re(r,t),Z&6&&a!==(a=j[10].movementType+"")&&re(f,a),Z&6){S=K(j[10].scoreZero);let L;for(L=0;L<S.length;L+=1){const de=wt(j,S,L);z[L]?z[L].p(de,Z):(z[L]=At(de),z[L].c(),z[L].m(p,null))}for(;L<z.length;L+=1)z[L].d(1);z.length=S.length}if(Z&6){I=K(j[10].scoreOne);let L;for(L=0;L<I.length;L+=1){const de=vt(j,I,L);J[L]?J[L].p(de,Z):(J[L]=Tt(de),J[L].c(),J[L].m(h,null))}for(;L<J.length;L+=1)J[L].d(1);J.length=I.length}if(Z&6){M=K(j[10].scoreTwo);let L;for(L=0;L<M.length;L+=1){const de=bt(j,M,L);E[L]?E[L].p(de,Z):(E[L]=Mt(de),E[L].c(),E[L].m(T,null))}for(;L<E.length;L+=1)E[L].d(1);E.length=M.length}},d(j){j&&b(e),le(z,j),le(J,j),le(E,j)}}}function Bl(n){let e,l,t,r,o,i,c,s,u,a,f,m,d,p,g,N,h,w=K(st),O=[];for(let I=0;I<w.length;I+=1)O[I]=Lt(jt(n,w,I));let T=K(Ye(n[1])),A=[];for(let I=0;I<T.length;I+=1)A[I]=St(yt(n,T,I));let S=K($t(n[1],n[2])),z=[];for(let I=0;I<S.length;I+=1)z[I]=It(kt(n,S,I));return{c(){e=$("h1"),e.textContent="LTN 1/20 scoring guidance",l=C(),t=$("p"),t.innerHTML=`Guidance from <a target="_blank" href="https://assets.publishing.service.gov.uk/media/5ffa1f96d3bf7f65d9e35825/cycle-infrastructure-design-ltn-1-20.pdf">LTN 1/20 appendix B</a>
      .`,r=C(),o=$("div"),i=H(`Type of junction:
      `),c=$("fieldset");for(let I=0;I<O.length;I+=1)O[I].c();s=H(`

      Type of movement:
      `),u=$("fieldset");for(let I=0;I<A.length;I+=1)A[I].c();a=C(),f=$("table"),m=$("tr"),m.innerHTML=`<th class="type-header svelte-k4kgn3">Type of junction and movement</th> <th class="score-zero-header svelte-k4kgn3"><p class="svelte-k4kgn3"><b>Score = 0</b></p> <p class="svelte-k4kgn3">Suitable only for confident existing cyclists, and may be avoided by
            some experienced cyclists</p> <p class="svelte-k4kgn3">Conditions are most likely to give rise to the most common collision
            types</p></th> <th class="score-one-header svelte-k4kgn3"><p class="svelte-k4kgn3"><b>Score = 1</b></p> <p class="svelte-k4kgn3">Likely to be more acceptable to most cyclists, but may still pose
            problems for less confident or new cyclists</p> <p class="svelte-k4kgn3">The risk of collisions has been reduced by design layout or traffic
            management interventions</p></th> <th class="score-two-header svelte-k4kgn3"><p class="svelte-k4kgn3"><b>Score = 2</b></p> <p class="svelte-k4kgn3">Suitable for all potential and existing cyclists</p> <p class="svelte-k4kgn3">The potential for collisions has been removed, or managed to a high
            standard of safety for cyclists</p></th>`,d=C();for(let I=0;I<z.length;I+=1)z[I].c();p=C(),g=$("button"),g.textContent="OK",x(o,"display","flex"),x(o,"justify-content","space-between")},m(I,J){k(I,e,J),k(I,l,J),k(I,t,J),k(I,r,J),k(I,o,J),_(o,i),_(o,c);for(let M=0;M<O.length;M+=1)O[M]&&O[M].m(c,null);_(o,s),_(o,u);for(let M=0;M<A.length;M+=1)A[M]&&A[M].m(u,null);k(I,a,J),k(I,f,J),_(f,m),_(f,d);for(let M=0;M<z.length;M+=1)z[M]&&z[M].m(f,null);k(I,p,J),k(I,g,J),N||(h=G(g,"click",n[8]),N=!0)},p(I,J){if(J&10){w=K(st);let M;for(M=0;M<w.length;M+=1){const E=jt(I,w,M);O[M]?O[M].p(E,J):(O[M]=Lt(E),O[M].c(),O[M].m(c,null))}for(;M<O.length;M+=1)O[M].d(1);O.length=w.length}if(J&6){T=K(Ye(I[1]));let M;for(M=0;M<T.length;M+=1){const E=yt(I,T,M);A[M]?A[M].p(E,J):(A[M]=St(E),A[M].c(),A[M].m(u,null))}for(;M<A.length;M+=1)A[M].d(1);A.length=T.length}if(J&6){S=K($t(I[1],I[2]));let M;for(M=0;M<S.length;M+=1){const E=kt(I,S,M);z[M]?z[M].p(E,J):(z[M]=It(E),z[M].c(),z[M].m(f,null))}for(;M<z.length;M+=1)z[M].d(1);z.length=S.length}},d(I){I&&(b(e),b(l),b(t),b(r),b(o),b(a),b(f),b(p),b(g)),le(O,I),le(A,I),le(z,I),N=!1,h()}}}function Jl(n){let e,l,t,r,o,i,c=n[0]&&Ct(n);return{c(){e=$("button"),e.textContent="LTN 1/20 scoring guidance",l=C(),c&&c.c(),t=Ze(),R(e,"class","secondary")},m(s,u){k(s,e,u),k(s,l,u),c&&c.m(s,u),k(s,t,u),r=!0,o||(i=G(e,"click",n[4]),o=!0)},p(s,[u]){s[0]?c?(c.p(s,u),u&1&&v(c,1)):(c=Ct(s),c.c(),v(c,1),c.m(t.parentNode,t)):c&&(ue(),y(c,1,1,()=>{c=null}),fe())},i(s){r||(v(c),r=!0)},o(s){y(c),r=!1},d(s){s&&(b(e),b(l),b(t)),c&&c.d(s),o=!1,i()}}}function zl(n,e,l){let t=!1,r=st[0],o=Ye(r)[0];function i(){l(2,o=Ye(r)[0])}const c=[[],[]],s=()=>l(0,t=!0);function u(){r=this.__value,l(1,r)}function a(){o=this.__value,l(2,o)}return[t,r,o,i,s,u,c,a,()=>l(0,t=!1),()=>l(0,t=!1)]}class Rl extends ie{constructor(e){super(),se(this,e,zl,Jl,ae,{})}}function Nt(n,e,l){const t=n.slice();return t[11]=e[l][0],t[12]=e[l][1],t}function Et(n){let e,l;return e=new Rl({}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Dt(n){let e,l,t,r=n[12]+"",o,i,c,s,u;return c=tt(n[7][0]),{c(){e=$("label"),l=$("input"),t=C(),o=H(r),i=C(),R(l,"type","radio"),l.__value=n[11],oe(l,l.__value),c.p(l)},m(a,f){k(a,e,f),_(e,l),l.checked=l.__value===n[3].jats[n[0]].properties[n[1]].movements[n[2]].score,_(e,t),_(e,o),_(e,i),s||(u=G(l,"change",n[9]),s=!0)},p(a,f){f&15&&(l.checked=l.__value===a[3].jats[a[0]].properties[a[1]].movements[a[2]].score)},d(a){a&&b(e),c.r(),s=!1,u()}}}function Hl(n){let e,l,t,r,o,i,c,s,u,a,f,m,d,p,g,N,h,w,O,T,A,S,z,I=n[3].jats[n[0]].properties[n[1]].movements[n[2]].kind=="cycling"&&Et(),J=K(n[4]),M=[];for(let E=0;E<J.length;E+=1)M[E]=Dt(Nt(n,J,E));return A=tt(n[7][1]),{c(){e=$("label"),l=H(`Name
  `),t=$("input"),r=C(),o=$("fieldset"),i=$("label"),c=$("input"),s=H(`
    Cycling`),u=C(),a=$("label"),f=$("input"),m=H(`
    Walking & Wheeling`),d=C(),I&&I.c(),p=C(),g=$("fieldset");for(let E=0;E<M.length;E+=1)M[E].c();N=C(),h=$("label"),w=H(`Comments
  `),O=$("textarea"),R(t,"type","text"),R(c,"type","radio"),c.__value="cycling",oe(c,c.__value),R(f,"type","radio"),f.__value="walking & wheeling",oe(f,f.__value),A.p(c,f)},m(E,j){k(E,e,j),_(e,l),_(e,t),oe(t,n[3].jats[n[0]].properties[n[1]].movements[n[2]].name),k(E,r,j),k(E,o,j),_(o,i),_(i,c),c.checked=c.__value===n[3].jats[n[0]].properties[n[1]].movements[n[2]].kind,_(i,s),_(o,u),_(o,a),_(a,f),f.checked=f.__value===n[3].jats[n[0]].properties[n[1]].movements[n[2]].kind,_(a,m),k(E,d,j),I&&I.m(E,j),k(E,p,j),k(E,g,j);for(let Z=0;Z<M.length;Z+=1)M[Z]&&M[Z].m(g,null);k(E,N,j),k(E,h,j),_(h,w),_(h,O),oe(O,n[3].jats[n[0]].properties[n[1]].movements[n[2]].notes),T=!0,S||(z=[G(t,"input",n[5]),G(c,"change",n[6]),G(f,"change",n[8]),G(O,"input",n[10])],S=!0)},p(E,[j]){if(j&15&&t.value!==E[3].jats[E[0]].properties[E[1]].movements[E[2]].name&&oe(t,E[3].jats[E[0]].properties[E[1]].movements[E[2]].name),j&15&&(c.checked=c.__value===E[3].jats[E[0]].properties[E[1]].movements[E[2]].kind),j&15&&(f.checked=f.__value===E[3].jats[E[0]].properties[E[1]].movements[E[2]].kind),E[3].jats[E[0]].properties[E[1]].movements[E[2]].kind=="cycling"?I?j&15&&v(I,1):(I=Et(),I.c(),v(I,1),I.m(p.parentNode,p)):I&&(ue(),y(I,1,1,()=>{I=null}),fe()),j&31){J=K(E[4]);let Z;for(Z=0;Z<J.length;Z+=1){const L=Nt(E,J,Z);M[Z]?M[Z].p(L,j):(M[Z]=Dt(L),M[Z].c(),M[Z].m(g,null))}for(;Z<M.length;Z+=1)M[Z].d(1);M.length=J.length}j&15&&oe(O,E[3].jats[E[0]].properties[E[1]].movements[E[2]].notes)},i(E){T||(v(I),T=!0)},o(E){y(I),T=!1},d(E){E&&(b(e),b(r),b(o),b(d),b(p),b(g),b(N),b(h)),I&&I.d(E),le(M,E),A.r(),S=!1,ge(z)}}}function Gl(n,e,l){let t;ee(n,U,p=>l(3,t=p));let{junctionIdx:r}=e,{stage:o}=e,{idx:i}=e,c=[["X","X - black"],["0","0 - red"],["1","1 - amber"],["2","2 - green"]];const s=[[],[]];function u(){t.jats[r].properties[o].movements[i].name=this.value,U.set(t)}function a(){t.jats[r].properties[o].movements[i].kind=this.__value,U.set(t)}function f(){t.jats[r].properties[o].movements[i].kind=this.__value,U.set(t)}function m(){t.jats[r].properties[o].movements[i].score=this.__value,U.set(t)}function d(){t.jats[r].properties[o].movements[i].notes=this.value,U.set(t)}return n.$$set=p=>{"junctionIdx"in p&&l(0,r=p.junctionIdx),"stage"in p&&l(1,o=p.stage),"idx"in p&&l(2,i=p.idx)},[r,o,i,t,c,u,a,s,f,m,d]}class Ul extends ie{constructor(e){super(),se(this,e,Gl,Hl,ae,{junctionIdx:0,stage:1,idx:2})}}function Zl(n){return n%(2*Math.PI)*180/Math.PI}function Ve(n){return n%360*Math.PI/180}function qt(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Nn(n,e,l={}){if(l.final===!0)return Kl(n,e);const t=qt(n),r=qt(e),o=Ve(t[0]),i=Ve(r[0]),c=Ve(t[1]),s=Ve(r[1]),u=Math.sin(i-o)*Math.cos(s),a=Math.cos(c)*Math.sin(s)-Math.sin(c)*Math.cos(s)*Math.cos(i-o);return Zl(Math.atan2(u,a))}function Kl(n,e){let l=Nn(e,n);return l=(l+180)%360,l}var Ee=Nn;function Xl(n,e,l={}){const t={type:"Feature"};return(l.id===0||l.id)&&(t.id=l.id),l.bbox&&(t.bbox=l.bbox),t.properties=e||{},t.geometry=n,t}function Wl(n,e,l={}){if(!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Pt(n[0])||!Pt(n[1]))throw new Error("coordinates must contain numbers");return Xl({type:"Point",coordinates:n},e,l)}function Pt(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function Vl(n,e={}){const l=zn(n),t=(l[0]+l[2])/2,r=(l[1]+l[3])/2;return Wl([t,r],e.properties,e)}var Ql=Vl,he=63710088e-1,Yl={centimeters:he*100,centimetres:he*100,degrees:360/(2*Math.PI),feet:he*3.28084,inches:he*39.37,kilometers:he/1e3,kilometres:he/1e3,meters:he,metres:he,miles:he/1609.344,millimeters:he*1e3,millimetres:he*1e3,nauticalmiles:he/1852,radians:1,yards:he*1.0936};function xl(n,e,l={}){const t={type:"Feature"};return(l.id===0||l.id)&&(t.id=l.id),l.bbox&&(t.bbox=l.bbox),t.properties=e||{},t.geometry=n,t}function er(n,e,l={}){if(!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ot(n[0])||!Ot(n[1]))throw new Error("coordinates must contain numbers");return xl({type:"Point",coordinates:n},e,l)}function tr(n,e="kilometers"){const l=Yl[e];if(!l)throw new Error(e+" units is invalid");return n/l}function Ft(n){return n%(2*Math.PI)*180/Math.PI}function lt(n){return n%360*Math.PI/180}function Ot(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function nr(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function lr(n,e,l,t={}){const r=nr(n),o=lt(r[0]),i=lt(r[1]),c=lt(l),s=tr(e,t.units),u=Math.asin(Math.sin(i)*Math.cos(s)+Math.cos(i)*Math.sin(s)*Math.cos(c)),a=o+Math.atan2(Math.sin(c)*Math.sin(s)*Math.cos(i),Math.cos(s)-Math.sin(i)*Math.sin(u)),f=Ft(a),m=Ft(u);return er([f,m],t.properties)}var Ge=lr,$e=63710088e-1,rr={centimeters:$e*100,centimetres:$e*100,degrees:360/(2*Math.PI),feet:$e*3.28084,inches:$e*39.37,kilometers:$e/1e3,kilometres:$e/1e3,meters:$e,metres:$e,miles:$e/1609.344,millimeters:$e*1e3,millimetres:$e*1e3,nauticalmiles:$e/1852,radians:1,yards:$e*1.0936};function or(n,e="kilometers"){const l=rr[e];if(!l)throw new Error(e+" units is invalid");return n*l}function Qe(n){return n%360*Math.PI/180}function Bt(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function ir(n,e,l={}){var t=Bt(n),r=Bt(e),o=Qe(r[1]-t[1]),i=Qe(r[0]-t[0]),c=Qe(t[1]),s=Qe(r[1]),u=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(c)*Math.cos(s);return or(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),l.units)}var sr=ir;function ar(n){let e=Ql({type:"FeatureCollection",features:n.map(t=>({type:"Feature",geometry:{type:"Point",coordinates:t.point},properties:{}}))}).geometry.coordinates;n.sort((t,r)=>Jt(Ee(e,r.point))-Jt(Ee(e,t.point)));let l=[];for(let t=0;t<n.length;t++){let r=n[t],o=Ee(r.point,e),i=1;for(let c of ur(t,n.length)){let s=n[c],u=Ee(e,s.point),a=cr(r.point,e,i++),f=sr(r.point,e),m=Ge(a,.5*f,o).geometry.coordinates,d=Ge(m,.2*f,u).geometry.coordinates;l.push({point1:a,point2:m,point3:d,kind:"cycling",score:"X",name:`${r.name} to ${s.name}`,notes:""})}}return l}function cr(n,e,l){let t=.003,o=Ee(n,e)-90,i=t*l;return Ge(n,i,o).geometry.coordinates}function Jt(n){return(n+360)%360}function ur(n,e){let l=[];for(let t=n+1;t<e;t++)l.push(t);for(let t=0;t<n;t++)l.push(t);return l}const fr="/route-element/assets/movement-aa45473c.svg",mr="/route-element/assets/pan-fbcec4cd.svg";function zt(n,e,l){const t=n.slice();return t[31]=e[l],t[32]=e,t[33]=l,t}function Rt(n,e,l){const t=n.slice();return t[34]=e[l],t[35]=e,t[33]=l,t}function Ht(n){let e,l,t,r,o,i,c,s,u,a,f,m,d,p,g,N,h,w,O;function T(Z,L){return Z[0].mode=="select"?pr:dr}let A=T(n),S=A(n);function z(Z,L){return Z[0].mode=="new-arm"?gr:_r}let I=z(n),J=I(n);function M(Z,L){return Z[0].mode=="new-movement"?$r:hr}let E=M(n),j=E(n);return{c(){e=$("div"),l=$("button"),t=$("img"),o=C(),S.c(),i=C(),c=$("button"),s=nt("svg"),u=nt("circle"),a=nt("text"),f=H("A"),m=C(),J.c(),d=C(),p=$("button"),g=$("img"),h=C(),j.c(),rt(t.src,r=mr)||R(t,"src",r),R(t,"alt","Move map"),x(t,"vertical-align","middle"),R(l,"class","outline"),R(u,"cx","12"),R(u,"cy","12"),R(u,"r","12"),R(u,"fill","white"),R(a,"x","6"),R(a,"y","16"),R(a,"fill","#4472c4"),R(s,"width","24"),R(s,"height","24"),R(s,"xmlns","http://www.w3.org/2000/svg"),x(s,"vertical-align","middle"),R(c,"class","outline"),rt(g.src,N=fr)||R(g,"src",N),R(g,"alt","New movement"),x(g,"vertical-align","middle"),R(p,"class","outline"),R(e,"class","control-panel svelte-l1e6xi")},m(Z,L){k(Z,e,L),_(e,l),_(l,t),_(l,o),S.m(l,null),_(e,i),_(e,c),_(c,s),_(s,u),_(s,a),_(a,f),_(c,m),J.m(c,null),_(e,d),_(e,p),_(p,g),_(p,h),j.m(p,null),w||(O=[G(l,"click",function(){Rn(n[4])&&n[4].apply(this,arguments)}),G(c,"click",n[12]),G(p,"click",n[13])],w=!0)},p(Z,L){n=Z,A!==(A=T(n))&&(S.d(1),S=A(n),S&&(S.c(),S.m(l,null))),I!==(I=z(n))&&(J.d(1),J=I(n),J&&(J.c(),J.m(c,null))),E!==(E=M(n))&&(j.d(1),j=E(n),j&&(j.c(),j.m(p,null)))},d(Z){Z&&b(e),S.d(),J.d(),j.d(),w=!1,ge(O)}}}function dr(n){let e;return{c(){e=H("Move map")},m(l,t){k(l,e,t)},d(l){l&&b(e)}}}function pr(n){let e;return{c(){e=$("b"),e.textContent="Move map"},m(l,t){k(l,e,t)},d(l){l&&b(e)}}}function _r(n){let e;return{c(){e=H("New arm")},m(l,t){k(l,e,t)},d(l){l&&b(e)}}}function gr(n){let e;return{c(){e=$("b"),e.textContent="New arm"},m(l,t){k(l,e,t)},d(l){l&&b(e)}}}function hr(n){let e;return{c(){e=H("New movement")},m(l,t){k(l,e,t)},d(l){l&&b(e)}}}function $r(n){let e;return{c(){e=$("b"),e.textContent="New movement"},m(l,t){k(l,e,t)},d(l){l&&b(e)}}}function kr(n){let e;return{c(){e=$("span"),e.textContent=`${Ir(n[33])}`,R(e,"class","dot svelte-l1e6xi"),x(e,"color","#4472c4"),x(e,"background-color","white")},m(l,t){k(l,e,t)},p:te,d(l){l&&b(e)}}}function Gt(n){let e,l,t;function r(s){n[14](s,n[34])}function o(){return n[15](n[33])}function i(){return n[16](n[33])}let c={draggable:!0,$$slots:{default:[kr]},$$scope:{ctx:n}};return n[34].point!==void 0&&(c.lngLat=n[34].point),e=new Se({props:c}),pe.push(()=>ye(e,"lngLat",r)),e.$on("dragend",o),e.$on("click",i),{c(){D(e.$$.fragment)},m(s,u){q(e,s,u),t=!0},p(s,u){n=s;const a={};u[1]&32&&(a.$$scope={dirty:u,ctx:n}),!l&&u[0]&38&&(l=!0,a.lngLat=n[34].point,je(()=>l=!1)),e.$set(a)},i(s){t||(v(e.$$.fragment,s),t=!0)},o(s){y(e.$$.fragment,s),t=!1},d(s){P(e,s)}}}function br(n){let e;return{c(){e=$("span"),R(e,"class","dot svelte-l1e6xi"),x(e,"background-color",n[7][n[31].score]),x(e,"opacity",n[31].kind=="walking & wheeling"?"0%":"100%")},m(l,t){k(l,e,t)},p(l,t){t[0]&38&&x(e,"background-color",l[7][l[31].score]),t[0]&38&&x(e,"opacity",l[31].kind=="walking & wheeling"?"0%":"100%")},d(l){l&&b(e)}}}function vr(n){let e;return{c(){e=$("span"),R(e,"class","dot svelte-l1e6xi"),x(e,"background-color",n[7][n[31].score])},m(l,t){k(l,e,t)},p(l,t){t[0]&38&&x(e,"background-color",l[7][l[31].score])},d(l){l&&b(e)}}}function wr(n){let e;return{c(){e=$("span"),R(e,"class","dot svelte-l1e6xi"),x(e,"background-color",n[7][n[31].score]),x(e,"opacity","0%")},m(l,t){k(l,e,t)},p(l,t){t[0]&38&&x(e,"background-color",l[7][l[31].score])},d(l){l&&b(e)}}}function Ut(n){let e,l,t,r,o,i,c,s,u;function a(S){n[17](S,n[31])}function f(){return n[18](n[33])}function m(){return n[19](n[33])}let d={draggable:!0,$$slots:{default:[br]},$$scope:{ctx:n}};n[31].point1!==void 0&&(d.lngLat=n[31].point1),e=new Se({props:d}),pe.push(()=>ye(e,"lngLat",a)),e.$on("dragend",f),e.$on("click",m);function p(S){n[20](S,n[31])}function g(){return n[21](n[33])}function N(){return n[22](n[33])}let h={draggable:!0,$$slots:{default:[vr]},$$scope:{ctx:n}};n[31].point2!==void 0&&(h.lngLat=n[31].point2),r=new Se({props:h}),pe.push(()=>ye(r,"lngLat",p)),r.$on("dragend",g),r.$on("click",N);function w(S){n[23](S,n[31])}function O(){return n[24](n[33])}function T(){return n[25](n[33])}let A={draggable:!0,$$slots:{default:[wr]},$$scope:{ctx:n}};return n[31].point3!==void 0&&(A.lngLat=n[31].point3),c=new Se({props:A}),pe.push(()=>ye(c,"lngLat",w)),c.$on("dragend",O),c.$on("click",T),{c(){D(e.$$.fragment),t=C(),D(r.$$.fragment),i=C(),D(c.$$.fragment)},m(S,z){q(e,S,z),k(S,t,z),q(r,S,z),k(S,i,z),q(c,S,z),u=!0},p(S,z){n=S;const I={};z[0]&38|z[1]&32&&(I.$$scope={dirty:z,ctx:n}),!l&&z[0]&38&&(l=!0,I.lngLat=n[31].point1,je(()=>l=!1)),e.$set(I);const J={};z[0]&38|z[1]&32&&(J.$$scope={dirty:z,ctx:n}),!o&&z[0]&38&&(o=!0,J.lngLat=n[31].point2,je(()=>o=!1)),r.$set(J);const M={};z[0]&38|z[1]&32&&(M.$$scope={dirty:z,ctx:n}),!s&&z[0]&38&&(s=!0,M.lngLat=n[31].point3,je(()=>s=!1)),c.$set(M)},i(S){u||(v(e.$$.fragment,S),v(r.$$.fragment,S),v(c.$$.fragment,S),u=!0)},o(S){y(e.$$.fragment,S),y(r.$$.fragment,S),y(c.$$.fragment,S),u=!1},d(S){S&&(b(t),b(i)),P(e,S),P(r,S),P(c,S)}}}function yr(n){let e=(n[30].name||"Untitled movement")+"",l;return{c(){l=H(e)},m(t,r){k(t,l,r)},p(t,r){r[0]&1073741824&&e!==(e=(t[30].name||"Untitled movement")+"")&&re(l,e)},d(t){t&&b(l)}}}function jr(n){let e,l;return e=new An({props:{$$slots:{default:[yr,({props:t})=>({30:t}),({props:t})=>[t?1073741824:0]]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r[0]&1073741824|r[1]&32&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Cr(n){let e=(n[30].name||"Untitled movement")+"",l;return{c(){l=H(e)},m(t,r){k(t,l,r)},p(t,r){r[0]&1073741824&&e!==(e=(t[30].name||"Untitled movement")+"")&&re(l,e)},d(t){t&&b(l)}}}function Lr(n){let e,l;return e=new An({props:{$$slots:{default:[Cr,({props:t})=>({30:t}),({props:t})=>[t?1073741824:0]]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r[0]&1073741824|r[1]&32&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Sr(n){let e,l,t,r,o,i;return e=new Oe({props:{id:"jat-cycling",manageHoverState:!0,paint:{"line-width":Je(6,10),"line-color":["get","color"]},filter:["==",["get","kind"],"cycling"],$$slots:{default:[jr]},$$scope:{ctx:n}}}),e.$on("click",n[9]),t=new Oe({props:{id:"jat-walking-wheeling",manageHoverState:!0,paint:{"line-width":Je(6,8),"line-color":["get","color"],"line-dasharray":[3,2]},filter:["==",["get","kind"],"walking & wheeling"],$$slots:{default:[Lr]},$$scope:{ctx:n}}}),t.$on("click",n[9]),o=new Yn({props:{id:"jat-arrow",filter:["has","angle"],paint:{"text-color":["get","color"],"text-halo-color":"white","text-halo-width":3},layout:{"text-field":"⬆","text-overlap":"always","text-rotate":["get","angle"],"text-size":70}}}),{c(){D(e.$$.fragment),l=C(),D(t.$$.fragment),r=C(),D(o.$$.fragment)},m(c,s){q(e,c,s),k(c,l,s),q(t,c,s),k(c,r,s),q(o,c,s),i=!0},p(c,s){const u={};s[1]&32&&(u.$$scope={dirty:s,ctx:c}),e.$set(u);const a={};s[1]&32&&(a.$$scope={dirty:s,ctx:c}),t.$set(a)},i(c){i||(v(e.$$.fragment,c),v(t.$$.fragment,c),v(o.$$.fragment,c),i=!0)},o(c){y(e.$$.fragment,c),y(t.$$.fragment,c),y(o.$$.fragment,c),i=!1},d(c){c&&(b(l),b(r)),P(e,c),P(t,c),P(o,c)}}}function Ar(n){let e,l,t,r;return e=new Oe({props:{paint:{"line-width":5,"line-color":"yellow","line-gap-width":45}}}),t=new Ce({props:{filter:["==",["get","kind"],"arm"],paint:{"circle-radius":20,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){D(e.$$.fragment),l=C(),D(t.$$.fragment)},m(o,i){q(e,o,i),k(o,l,i),q(t,o,i),r=!0},p:te,i(o){r||(v(e.$$.fragment,o),v(t.$$.fragment,o),r=!0)},o(o){y(e.$$.fragment,o),y(t.$$.fragment,o),r=!1},d(o){o&&b(l),P(e,o),P(t,o)}}}function Tr(n){let e,l,t,r,o,i,c,s,u;e=new Tn({}),e.$on("click",n[8]);let a=n[0].mode!="editing"&&Ht(n),f=K(n[5].jats[n[1]].properties[n[2]].arms),m=[];for(let h=0;h<f.length;h+=1)m[h]=Gt(Rt(n,f,h));const d=h=>y(m[h],1,1,()=>{m[h]=null});let p=K(n[5].jats[n[1]].properties[n[2]].movements),g=[];for(let h=0;h<p.length;h+=1)g[h]=Ut(zt(n,p,h));const N=h=>y(g[h],1,1,()=>{g[h]=null});return i=new _e({props:{data:n[10](n[5]),$$slots:{default:[Sr]},$$scope:{ctx:n}}}),s=new _e({props:{data:n[6],$$slots:{default:[Ar]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment),l=C(),a&&a.c(),t=C();for(let h=0;h<m.length;h+=1)m[h].c();r=C();for(let h=0;h<g.length;h+=1)g[h].c();o=C(),D(i.$$.fragment),c=C(),D(s.$$.fragment)},m(h,w){q(e,h,w),k(h,l,w),a&&a.m(h,w),k(h,t,w);for(let O=0;O<m.length;O+=1)m[O]&&m[O].m(h,w);k(h,r,w);for(let O=0;O<g.length;O+=1)g[O]&&g[O].m(h,w);k(h,o,w),q(i,h,w),k(h,c,w),q(s,h,w),u=!0},p(h,w){if(h[0].mode!="editing"?a?a.p(h,w):(a=Ht(h),a.c(),a.m(t.parentNode,t)):a&&(a.d(1),a=null),w[0]&46){f=K(h[5].jats[h[1]].properties[h[2]].arms);let A;for(A=0;A<f.length;A+=1){const S=Rt(h,f,A);m[A]?(m[A].p(S,w),v(m[A],1)):(m[A]=Gt(S),m[A].c(),v(m[A],1),m[A].m(r.parentNode,r))}for(ue(),A=f.length;A<m.length;A+=1)d(A);fe()}if(w[0]&174){p=K(h[5].jats[h[1]].properties[h[2]].movements);let A;for(A=0;A<p.length;A+=1){const S=zt(h,p,A);g[A]?(g[A].p(S,w),v(g[A],1)):(g[A]=Ut(S),g[A].c(),v(g[A],1),g[A].m(o.parentNode,o))}for(ue(),A=p.length;A<g.length;A+=1)N(A);fe()}const O={};w[0]&32&&(O.data=h[10](h[5])),w[1]&32&&(O.$$scope={dirty:w,ctx:h}),i.$set(O);const T={};w[0]&64&&(T.data=h[6]),w[1]&32&&(T.$$scope={dirty:w,ctx:h}),s.$set(T)},i(h){if(!u){v(e.$$.fragment,h);for(let w=0;w<f.length;w+=1)v(m[w]);for(let w=0;w<p.length;w+=1)v(g[w]);v(i.$$.fragment,h),v(s.$$.fragment,h),u=!0}},o(h){y(e.$$.fragment,h),m=m.filter(Boolean);for(let w=0;w<m.length;w+=1)y(m[w]);g=g.filter(Boolean);for(let w=0;w<g.length;w+=1)y(g[w]);y(i.$$.fragment,h),y(s.$$.fragment,h),u=!1},d(h){h&&(b(l),b(t),b(r),b(o),b(c)),P(e,h),a&&a.d(h),le(m,h),le(g,h),P(i,h),P(s,h)}}}function Mr(n,e){return{type:"Feature",id:e,properties:{kind:"arm"},geometry:{type:"Point",coordinates:n.point}}}function Ir(n){return String.fromCharCode(n+"A".charCodeAt(0))}function Nr(n,e,l){let t,r,o;ee(n,U,B=>l(5,r=B)),ee(n,ze,B=>l(26,o=B));let{junctionIdx:i}=e,{stage:c}=e,{mode:s}=e,{hoveringSidebar:u}=e,{select:a}=e,{stopEditing:f}=e,m={0:Le.red.background,1:Le.amber.background,2:Le.green.background,X:Le.critical.background};function d(B,X,we){let ce={type:"FeatureCollection",features:[]},F=X.mode=="editing"?X.id:we;return F!=null&&(F.kind=="arm"?ce.features.push(Mr(B.jats[i].properties[c].arms[F.idx],F.idx)):ce.features.push(h(B.jats[i].properties[c].movements[F.idx],F.idx))),ce}async function p(B){if(o){for(let X of o.queryRenderedFeatures(B.detail.point,{layers:["jat-cycling","jat-walking-wheeling"]}))return;if(s.mode!="select"){if(s.mode=="editing"){await f();return}s.mode=="new-arm"?(V(U,r.jats[i].properties[c].arms=[...r.jats[i].properties[c].arms,{point:B.detail.lngLat.toArray(),name:""}],r),await a({kind:"arm",idx:r.jats[i].properties[c].arms.length-1})):(V(U,r.jats[i].properties[c].movements=[...r.jats[i].properties[c].movements,{point1:B.detail.lngLat.toArray(),point2:Ge(B.detail.lngLat.toArray(),.005,0).geometry.coordinates,point3:Ge(B.detail.lngLat.toArray(),.01,0).geometry.coordinates,kind:"cycling",score:"X",name:"",notes:""}],r),await a({kind:"movement",idx:r.jats[i].properties[c].movements.length-1}))}}}async function g(B){await a({kind:"movement",idx:B.detail.features[0].id})}function N(B){let X={type:"FeatureCollection",features:B.jats[i].properties[c].movements.map((we,ce)=>h(we,ce))};for(let we of B.jats[i].properties[c].movements)if(X.features.push(w(we,X.features.length)),we.kind=="walking & wheeling"){let ce={...we,point1:we.point3,point3:we.point1};X.features.push(w(ce,X.features.length))}return X}function h(B,X){return{type:"Feature",id:X,properties:{name:B.name,kind:B.kind,color:m[B.score]},geometry:{type:"LineString",coordinates:[B.point1,B.point2,B.point3]}}}function w(B,X){return{type:"Feature",id:X,properties:{kind:B.kind,color:m[B.score],angle:Ee(B.point2,B.point3)},geometry:{type:"Point",coordinates:B.point3}}}const O=()=>l(0,s={mode:"new-arm"}),T=()=>l(0,s={mode:"new-movement"});function A(B,X){n.$$.not_equal(X.point,B)&&(X.point=B,U.set(r))}const S=B=>a({kind:"arm",idx:B}),z=B=>a({kind:"arm",idx:B});function I(B,X){n.$$.not_equal(X.point1,B)&&(X.point1=B,U.set(r))}const J=B=>a({kind:"movement",idx:B}),M=B=>a({kind:"movement",idx:B});function E(B,X){n.$$.not_equal(X.point2,B)&&(X.point2=B,U.set(r))}const j=B=>a({kind:"movement",idx:B}),Z=B=>a({kind:"movement",idx:B});function L(B,X){n.$$.not_equal(X.point3,B)&&(X.point3=B,U.set(r))}const de=B=>a({kind:"movement",idx:B}),me=B=>a({kind:"movement",idx:B});return n.$$set=B=>{"junctionIdx"in B&&l(1,i=B.junctionIdx),"stage"in B&&l(2,c=B.stage),"mode"in B&&l(0,s=B.mode),"hoveringSidebar"in B&&l(11,u=B.hoveringSidebar),"select"in B&&l(3,a=B.select),"stopEditing"in B&&l(4,f=B.stopEditing)},n.$$.update=()=>{n.$$.dirty[0]&2081&&l(6,t=d(r,s,u))},[s,i,c,a,f,r,t,m,p,g,N,u,O,T,A,S,z,I,J,M,E,j,Z,L,de,me]}class Er extends ie{constructor(e){super(),se(this,e,Nr,Tr,ae,{junctionIdx:1,stage:2,mode:0,hoveringSidebar:11,select:3,stopEditing:4},null,[-1,-1])}}function Zt(n){if(n.movements.length==0)return"No movements added";let e=0,l=0;for(let r of n.movements)e+={0:0,1:1,2:2,X:0}[r.score],l+=2;let t=e/l*100;return`${Math.round(t)}%`}const{window:Dr}=Ke;function Kt(n,e,l){const t=n.slice();t[27]=e[l],t[30]=l;const r=t[14][t[27].score];return t[28]=r,t}function Xt(n,e,l){const t=n.slice();return t[31]=e[l],t[30]=l,t}function qr(n){let e,l,t,r,o,i,c,s,u;return{c(){e=$("button"),e.textContent="Done",l=C(),t=$("button"),t.textContent="Delete",r=C(),o=$("label"),i=H(`Arm name
        `),c=$("input"),R(c,"type","text")},m(a,f){k(a,e,f),k(a,l,f),k(a,t,f),k(a,r,f),k(a,o,f),_(o,i),_(o,c),oe(c,n[5].jats[n[0]].properties[n[1]].arms[n[2].id.idx].name),s||(u=[G(e,"click",n[23]),G(t,"click",n[10]),G(c,"input",n[24])],s=!0)},p(a,f){f[0]&39&&c.value!==a[5].jats[a[0]].properties[a[1]].arms[a[2].id.idx].name&&oe(c,a[5].jats[a[0]].properties[a[1]].arms[a[2].id.idx].name)},i:te,o:te,d(a){a&&(b(e),b(l),b(t),b(r),b(o)),s=!1,ge(u)}}}function Pr(n){let e,l,t,r,o,i,c,s;return e=new Ul({props:{junctionIdx:n[0],stage:n[1],idx:n[2].id.idx}}),{c(){D(e.$$.fragment),l=C(),t=$("button"),t.textContent="Save",r=C(),o=$("button"),o.textContent="Delete"},m(u,a){q(e,u,a),k(u,l,a),k(u,t,a),k(u,r,a),k(u,o,a),i=!0,c||(s=[G(t,"click",n[9]),G(o,"click",n[10])],c=!0)},p(u,a){const f={};a[0]&1&&(f.junctionIdx=u[0]),a[0]&2&&(f.stage=u[1]),a[0]&4&&(f.idx=u[2].id.idx),e.$set(f)},i(u){i||(v(e.$$.fragment,u),i=!0)},o(u){y(e.$$.fragment,u),i=!1},d(u){u&&(b(l),b(t),b(r),b(o)),P(e,u),c=!1,ge(s)}}}function Fr(n){let e,l,t,r,o,i,c,s,u,a,f,m,d,p=n[5].jats[n[0]].properties.name+"",g,N,h=Zt(n[5].jats[n[0]].properties[n[1]])+"",w,O,T,A,S,z,I,J,M,E,j,Z=K(n[5].jats[n[0]].properties[n[1]].arms),L=[];for(let F=0;F<Z.length;F+=1)L[F]=Wt(Xt(n,Z,F));const de=F=>y(L[F],1,1,()=>{L[F]=null});let me=n[5].jats[n[0]].properties[n[7]].arms.length>0&&Vt(n),B=K(n[5].jats[n[0]].properties[n[1]].movements),X=[];for(let F=0;F<B.length;F+=1)X[F]=Qt(Kt(n,B,F));const we=F=>y(X[F],1,1,()=>{X[F]=null});let ce=n[5].jats[n[0]].properties[n[7]].movements.length>0&&Yt(n);return{c(){e=$("button"),e.textContent="Done",l=C(),t=$("h3"),t.textContent="Arms",r=C();for(let F=0;F<L.length;F+=1)L[F].c();o=C(),me&&me.c(),i=C(),c=$("h3"),c.textContent="Movements",s=C(),u=$("p"),a=H("Total JAT score for "),f=H(n[1]),m=H(` junction
        `),d=$("i"),g=H(p),N=H(`
        : `),w=H(h),O=C(),T=$("button"),A=H("Generate cycling movements between all arms"),z=C();for(let F=0;F<X.length;F+=1)X[F].c();I=C(),ce&&ce.c(),J=Ze(),R(T,"class","secondary"),T.disabled=S=n[5].jats[n[0]].properties[n[1]].arms.length<2},m(F,W){k(F,e,W),k(F,l,W),k(F,t,W),k(F,r,W);for(let Y=0;Y<L.length;Y+=1)L[Y]&&L[Y].m(F,W);k(F,o,W),me&&me.m(F,W),k(F,i,W),k(F,c,W),k(F,s,W),k(F,u,W),_(u,a),_(u,f),_(u,m),_(u,d),_(d,g),_(u,N),_(u,w),k(F,O,W),k(F,T,W),_(T,A),k(F,z,W);for(let Y=0;Y<X.length;Y+=1)X[Y]&&X[Y].m(F,W);k(F,I,W),ce&&ce.m(F,W),k(F,J,W),M=!0,E||(j=[G(e,"click",n[16]),G(T,"click",n[15])],E=!0)},p(F,W){if(W[0]&299){Z=K(F[5].jats[F[0]].properties[F[1]].arms);let Y;for(Y=0;Y<Z.length;Y+=1){const He=Xt(F,Z,Y);L[Y]?(L[Y].p(He,W),v(L[Y],1)):(L[Y]=Wt(He),L[Y].c(),v(L[Y],1),L[Y].m(o.parentNode,o))}for(ue(),Y=Z.length;Y<L.length;Y+=1)de(Y);fe()}if(F[5].jats[F[0]].properties[F[7]].arms.length>0?me?me.p(F,W):(me=Vt(F),me.c(),me.m(i.parentNode,i)):me&&(me.d(1),me=null),(!M||W[0]&2)&&re(f,F[1]),(!M||W[0]&33)&&p!==(p=F[5].jats[F[0]].properties.name+"")&&re(g,p),(!M||W[0]&35)&&h!==(h=Zt(F[5].jats[F[0]].properties[F[1]])+"")&&re(w,h),(!M||W[0]&35&&S!==(S=F[5].jats[F[0]].properties[F[1]].arms.length<2))&&(T.disabled=S),W[0]&16683){B=K(F[5].jats[F[0]].properties[F[1]].movements);let Y;for(Y=0;Y<B.length;Y+=1){const He=Kt(F,B,Y);X[Y]?(X[Y].p(He,W),v(X[Y],1)):(X[Y]=Qt(He),X[Y].c(),v(X[Y],1),X[Y].m(I.parentNode,I))}for(ue(),Y=B.length;Y<X.length;Y+=1)we(Y);fe()}F[5].jats[F[0]].properties[F[7]].movements.length>0?ce?ce.p(F,W):(ce=Yt(F),ce.c(),ce.m(J.parentNode,J)):ce&&(ce.d(1),ce=null)},i(F){if(!M){for(let W=0;W<Z.length;W+=1)v(L[W]);for(let W=0;W<B.length;W+=1)v(X[W]);M=!0}},o(F){L=L.filter(Boolean);for(let W=0;W<L.length;W+=1)y(L[W]);X=X.filter(Boolean);for(let W=0;W<X.length;W+=1)y(X[W]);M=!1},d(F){F&&(b(e),b(l),b(t),b(r),b(o),b(i),b(c),b(s),b(u),b(O),b(T),b(z),b(I),b(J)),le(L,F),me&&me.d(F),le(X,F),ce&&ce.d(F),E=!1,ge(j)}}}function Wt(n){let e,l;function t(){return n[17](n[30])}function r(){return n[18](n[30])}return e=new Mn({props:{name:`${xt(n[30])} - ${n[31].name||"Unnamed arm"}`,hasSlot:!1}}),e.$on("click",t),e.$on("mouseenter",r),e.$on("mouseleave",n[19]),{c(){D(e.$$.fragment)},m(o,i){q(e,o,i),l=!0},p(o,i){n=o;const c={};i[0]&35&&(c.name=`${xt(n[30])} - ${n[31].name||"Unnamed arm"}`),e.$set(c)},i(o){l||(v(e.$$.fragment,o),l=!0)},o(o){y(e.$$.fragment,o),l=!1},d(o){P(e,o)}}}function Vt(n){let e,l,t;return{c(){e=$("button"),e.textContent=`Copy arms from ${n[7]}`,R(e,"class","secondary")},m(r,o){k(r,e,o),l||(t=G(e,"click",n[12]),l=!0)},p:te,d(r){r&&b(e),l=!1,t()}}}function Or(n){let e,l,t,r=n[27].score+"",o,i,c,s=en(n[27].kind)+"",u;return{c(){e=$("div"),l=$("span"),t=H("Score: "),o=H(r),i=C(),c=$("span"),u=H(s),x(l,"padding","4px"),x(l,"color",n[28].font),x(l,"background-color",n[28].background),x(e,"width","100%"),x(e,"display","flex"),x(e,"justify-content","space-between")},m(a,f){k(a,e,f),_(e,l),_(l,t),_(l,o),_(e,i),_(e,c),_(c,u)},p(a,f){f[0]&35&&r!==(r=a[27].score+"")&&re(o,r),f[0]&35&&x(l,"color",a[28].font),f[0]&35&&x(l,"background-color",a[28].background),f[0]&35&&s!==(s=en(a[27].kind)+"")&&re(u,s)},d(a){a&&b(e)}}}function Qt(n){let e,l;function t(){return n[20](n[30])}function r(){return n[21](n[30])}return e=new Mn({props:{name:n[27].name||"Unnamed movement",$$slots:{default:[Or]},$$scope:{ctx:n}}}),e.$on("click",t),e.$on("mouseenter",r),e.$on("mouseleave",n[22]),{c(){D(e.$$.fragment)},m(o,i){q(e,o,i),l=!0},p(o,i){n=o;const c={};i[0]&35&&(c.name=n[27].name||"Unnamed movement"),i[0]&35|i[1]&4&&(c.$$scope={dirty:i,ctx:n}),e.$set(c)},i(o){l||(v(e.$$.fragment,o),l=!0)},o(o){y(e.$$.fragment,o),l=!1},d(o){P(e,o)}}}function Yt(n){let e,l,t;return{c(){e=$("button"),e.textContent=`Copy movements from ${n[7]}`,R(e,"class","secondary")},m(r,o){k(r,e,o),l||(t=G(e,"click",n[13]),l=!0)},p:te,d(r){r&&b(e),l=!1,t()}}}function Br(n){let e,l,t,r,o=n[5].jats[n[0]].properties.name+"",i,c,s,u,a;const f=[Fr,Pr,qr],m=[];function d(p,g){return p[2].mode!="editing"?0:p[2].id.kind=="movement"?1:2}return s=d(n),u=m[s]=f[s](n),{c(){e=$("div"),l=$("h2"),t=H(n[1]),r=H(" JAT for "),i=H(o),c=C(),u.c(),R(e,"slot","sidebar")},m(p,g){k(p,e,g),_(e,l),_(l,t),_(l,r),_(l,i),_(e,c),m[s].m(e,null),n[25](e),a=!0},p(p,g){(!a||g[0]&2)&&re(t,p[1]),(!a||g[0]&33)&&o!==(o=p[5].jats[p[0]].properties.name+"")&&re(i,o);let N=s;s=d(p),s===N?m[s].p(p,g):(ue(),y(m[N],1,1,()=>{m[N]=null}),fe(),u=m[s],u?u.p(p,g):(u=m[s]=f[s](p),u.c()),v(u,1),u.m(e,null))},i(p){a||(v(u),a=!0)},o(p){y(u),a=!1},d(p){p&&b(e),m[s].d(),n[25](null)}}}function Jr(n){let e,l;return e=new Ce({props:{filter:["!=",["id"],n[0]],paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":"black","circle-radius":20}}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r[0]&1&&(o.filter=["!=",["id"],t[0]]),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function zr(n){let e,l,t,r,o,i,c;return l=new Re({props:{except:"jats"}}),r=new _e({props:{data:ne(n[5].jats),generateId:!0,$$slots:{default:[Jr]},$$scope:{ctx:n}}}),i=new Er({props:{junctionIdx:n[0],stage:n[1],mode:n[2],hoveringSidebar:n[3],select:n[8],stopEditing:n[9]}}),{c(){e=$("div"),D(l.$$.fragment),t=C(),D(r.$$.fragment),o=C(),D(i.$$.fragment),R(e,"slot","map")},m(s,u){k(s,e,u),q(l,e,null),_(e,t),q(r,e,null),_(e,o),q(i,e,null),c=!0},p(s,u){const a={};u[0]&32&&(a.data=ne(s[5].jats)),u[0]&1|u[1]&4&&(a.$$scope={dirty:u,ctx:s}),r.$set(a);const f={};u[0]&1&&(f.junctionIdx=s[0]),u[0]&2&&(f.stage=s[1]),u[0]&4&&(f.mode=s[2]),u[0]&8&&(f.hoveringSidebar=s[3]),i.$set(f)},i(s){c||(v(l.$$.fragment,s),v(r.$$.fragment,s),v(i.$$.fragment,s),c=!0)},o(s){y(l.$$.fragment,s),y(r.$$.fragment,s),y(i.$$.fragment,s),c=!1},d(s){s&&b(e),P(l),P(r),P(i)}}}function Rr(n){let e,l,t,r;return e=new Ie({props:{$$slots:{map:[zr],sidebar:[Br]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},m(o,i){q(e,o,i),l=!0,t||(r=G(Dr,"keydown",n[11]),t=!0)},p(o,i){const c={};i[0]&127|i[1]&4&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){l||(v(e.$$.fragment,o),l=!0)},o(o){y(e.$$.fragment,o),l=!1},d(o){P(e,o),t=!1,r()}}}function xt(n){return String.fromCharCode(n+"A".charCodeAt(0))}function en(n){return n.split(" ").map(e=>e.length>0?e[0].toUpperCase()+e.substr(1):e).join(" ")}function Hr(n,e,l){let t,r;ee(n,U,L=>l(5,t=L)),ee(n,Q,L=>l(6,r=L));let{junctionIdx:o}=e,{stage:i}=e,c=i=="existing"?"proposed":"existing",s={mode:"select"},u=null,a=null,f;async function m(L){u=f.scrollTop,l(2,s={mode:"editing",id:L}),l(3,a=null),await Be(),l(4,f.scrollTop=0,f)}async function d(){l(2,s={mode:"select"}),u!=null&&(await Be(),l(4,f.scrollTop=u,f),u=null)}function p(){s.mode=="editing"&&window.confirm(`Delete this ${s.id.kind}?`)&&(s.id.kind=="movement"?(t.jats[o].properties[i].movements.splice(s.id.idx,1),U.set(t)):(t.jats[o].properties[i].arms.splice(s.id.idx,1),U.set(t)),d())}function g(L){if(s.mode!="editing")return;let de=L.target.tagName,me=de=="INPUT"||de=="TEXTAREA";L.key=="Escape"||L.key=="Enter"&&!me?(L.stopPropagation(),d()):L.key=="Delete"&&!me&&(L.stopPropagation(),p())}function N(){t.jats[o].properties[i].arms.length>0&&!window.confirm("Overwrite arms?")||(V(U,t.jats[o].properties[i].arms=JSON.parse(JSON.stringify(t.jats[o].properties[c].arms)),t),U.set(t))}function h(){t.jats[o].properties[i].movements.length>0&&!window.confirm("Overwrite movements?")||(V(U,t.jats[o].properties[i].movements=JSON.parse(JSON.stringify(t.jats[o].properties[c].movements)),t),U.set(t))}let w={0:Le.red,1:Le.amber,2:Le.green,X:Le.critical};function O(){if(t.jats[o].properties[i].movements.length>0&&!window.confirm("Overwrite all cycling movements?"))return;let L=t.jats[o].properties[i].movements.filter(de=>de.kind=="walking & wheeling");V(U,t.jats[o].properties[i].movements=[...L,...ar(t.jats[o].properties[i].arms)],t)}const T=()=>V(Q,r={kind:"edit-jat",idx:o},r),A=L=>m({kind:"arm",idx:L}),S=L=>l(3,a={kind:"arm",idx:L}),z=()=>l(3,a=null),I=L=>m({kind:"movement",idx:L}),J=L=>l(3,a={kind:"movement",idx:L}),M=()=>l(3,a=null),E=()=>l(2,s={mode:"select"});function j(){t.jats[o].properties[i].arms[s.id.idx].name=this.value,U.set(t)}function Z(L){pe[L?"unshift":"push"](()=>{f=L,l(4,f)})}return n.$$set=L=>{"junctionIdx"in L&&l(0,o=L.junctionIdx),"stage"in L&&l(1,i=L.stage)},[o,i,s,a,f,t,r,c,m,d,p,g,N,h,w,O,T,A,S,z,I,J,M,E,j,Z]}class Gr extends ie{constructor(e){super(),se(this,e,Hr,Rr,ae,{junctionIdx:0,stage:1},null,[-1,-1])}}const{window:Ur}=Ke;function Zr(n){let e,l,t,r,o,i,c,s,u,a,f,m,d,p;return{c(){e=$("div"),l=$("button"),l.textContent="Done",t=C(),r=$("button"),r.textContent="Delete JAT",o=C(),i=$("label"),c=H(`Name:
      `),s=$("input"),u=C(),a=$("button"),a.textContent="Existing",f=C(),m=$("button"),m.textContent="Proposed",R(s,"type","text"),R(e,"slot","sidebar")},m(g,N){k(g,e,N),_(e,l),_(e,t),_(e,r),_(e,o),_(e,i),_(i,c),_(i,s),oe(s,n[1].jats[n[0]].properties.name),_(e,u),_(e,a),_(e,f),_(e,m),d||(p=[G(l,"click",n[6]),G(r,"click",n[4]),G(s,"input",n[7]),G(a,"click",n[8]),G(m,"click",n[9])],d=!0)},p(g,N){N&3&&s.value!==g[1].jats[g[0]].properties.name&&oe(s,g[1].jats[g[0]].properties.name)},d(g){g&&b(e),d=!1,ge(p)}}}function Kr(n){let e,l;return e=new Ce({props:{filter:["!=",["id"],n[0]],paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":"black","circle-radius":20}}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r&1&&(o.filter=["!=",["id"],t[0]]),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Xr(n){let e;return{c(){e=$("span"),R(e,"class","dot svelte-114j1n1"),x(e,"border-color",n[1].jats[n[0]].properties.color)},m(l,t){k(l,e,t)},p(l,t){t&3&&x(e,"border-color",l[1].jats[l[0]].properties.color)},d(l){l&&b(e)}}}function Wr(n){let e,l,t,r,o,i,c,s;l=new Re({props:{except:"jats"}}),r=new _e({props:{data:ne(n[1].jats),generateId:!0,$$slots:{default:[Kr]},$$scope:{ctx:n}}});function u(f){n[5](f)}let a={draggable:!0,$$slots:{default:[Xr]},$$scope:{ctx:n}};return n[1].jats[n[0]].geometry.coordinates!==void 0&&(a.lngLat=n[1].jats[n[0]].geometry.coordinates),i=new Se({props:a}),pe.push(()=>ye(i,"lngLat",u)),{c(){e=$("div"),D(l.$$.fragment),t=C(),D(r.$$.fragment),o=C(),D(i.$$.fragment),R(e,"slot","map")},m(f,m){k(f,e,m),q(l,e,null),_(e,t),q(r,e,null),_(e,o),q(i,e,null),s=!0},p(f,m){const d={};m&2&&(d.data=ne(f[1].jats)),m&1025&&(d.$$scope={dirty:m,ctx:f}),r.$set(d);const p={};m&1027&&(p.$$scope={dirty:m,ctx:f}),!c&&m&3&&(c=!0,p.lngLat=f[1].jats[f[0]].geometry.coordinates,je(()=>c=!1)),i.$set(p)},i(f){s||(v(l.$$.fragment,f),v(r.$$.fragment,f),v(i.$$.fragment,f),s=!0)},o(f){y(l.$$.fragment,f),y(r.$$.fragment,f),y(i.$$.fragment,f),s=!1},d(f){f&&b(e),P(l),P(r),P(i)}}}function Vr(n){let e,l,t,r;return e=new Ie({props:{$$slots:{map:[Wr],sidebar:[Zr]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},m(o,i){q(e,o,i),l=!0,t||(r=G(Ur,"keydown",n[3]),t=!0)},p(o,[i]){const c={};i&1031&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){l||(v(e.$$.fragment,o),l=!0)},o(o){y(e.$$.fragment,o),l=!1},d(o){P(e,o),t=!1,r()}}}function Qr(n,e,l){let t,r;ee(n,U,d=>l(1,t=d)),ee(n,Q,d=>l(2,r=d));let{idx:o}=e;function i(d){d.key=="Escape"&&V(Q,r={kind:"neutral"},r)}async function c(){window.confirm("Really delete this JAT?")&&(V(Q,r={kind:"neutral"},r),await Be(),t.jats.splice(o,1),U.set(t))}function s(d){n.$$.not_equal(t.jats[o].geometry.coordinates,d)&&(t.jats[o].geometry.coordinates=d,U.set(t))}const u=()=>V(Q,r={kind:"neutral"},r);function a(){t.jats[o].properties.name=this.value,U.set(t)}const f=()=>V(Q,r={kind:"edit-jat-detail",idx:o,stage:"existing"},r),m=()=>V(Q,r={kind:"edit-jat-detail",idx:o,stage:"proposed"},r);return n.$$set=d=>{"idx"in d&&l(0,o=d.idx)},[o,t,r,i,c,s,u,a,f,m]}class Yr extends ie{constructor(e){super(),se(this,e,Qr,Vr,ae,{idx:0})}}function tn(n,e,l){const t=n.slice();return t[3]=e[l],t[4]=e,t[5]=l,t}function xr(n){let e,l;return{c(){e=$("span"),l=C(),R(e,"class","dot svelte-jgyhla")},m(t,r){k(t,e,r),k(t,l,r)},p:te,d(t){t&&(b(e),b(l))}}}function nn(n){let e,l,t;function r(i){n[2](i,n[3],n[4],n[5])}let o={draggable:!0,$$slots:{default:[xr]},$$scope:{ctx:n}};return n[3]!==void 0&&(o.lngLat=n[3]),e=new Se({props:o}),pe.push(()=>ye(e,"lngLat",r)),{c(){D(e.$$.fragment)},m(i,c){q(e,i,c),t=!0},p(i,c){n=i;const s={};c&64&&(s.$$scope={dirty:c,ctx:n}),!l&&c&1&&(l=!0,s.lngLat=n[3],je(()=>l=!1)),e.$set(s)},i(i){t||(v(e.$$.fragment,i),t=!0)},o(i){y(e.$$.fragment,i),t=!1},d(i){P(e,i)}}}function eo(n){let e,l,t,r;e=new Tn({}),e.$on("click",n[1]);let o=K(n[0].geometry.coordinates),i=[];for(let s=0;s<o.length;s+=1)i[s]=nn(tn(n,o,s));const c=s=>y(i[s],1,1,()=>{i[s]=null});return{c(){D(e.$$.fragment),l=C();for(let s=0;s<i.length;s+=1)i[s].c();t=Ze()},m(s,u){q(e,s,u),k(s,l,u);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(s,u);k(s,t,u),r=!0},p(s,[u]){if(u&1){o=K(s[0].geometry.coordinates);let a;for(a=0;a<o.length;a+=1){const f=tn(s,o,a);i[a]?(i[a].p(f,u),v(i[a],1)):(i[a]=nn(f),i[a].c(),v(i[a],1),i[a].m(t.parentNode,t))}for(ue(),a=o.length;a<i.length;a+=1)c(a);fe()}},i(s){if(!r){v(e.$$.fragment,s);for(let u=0;u<o.length;u+=1)v(i[u]);r=!0}},o(s){y(e.$$.fragment,s),i=i.filter(Boolean);for(let u=0;u<i.length;u+=1)y(i[u]);r=!1},d(s){s&&(b(l),b(t)),P(e,s),le(i,s)}}}function to(n,e,l){let{f:t}=e;function r(i){t.geometry.coordinates.push(i.detail.lngLat.toArray()),l(0,t)}function o(i,c,s,u){s[u]=i,l(0,t)}return n.$$set=i=>{"f"in i&&l(0,t=i.f)},[t,r,o]}class no extends ie{constructor(e){super(),se(this,e,to,eo,ae,{f:0})}}function lo(n){return{type:"Feature",geometry:{type:"LineString",coordinates:[]},properties:{name:"Untitled link",color:Te[n%Te.length],answers:Array(be.length).fill("")}}}let be=[{name:"Street or path check",description:"Is this on-carriageway or a traffic-free path?",choices:["","Street check","Path check"]},{name:"SA03",description:"lane widths",choices:ke()},{name:"SA04",description:"trip hazards",choices:ke()},{name:"SA05",description:"kerbside activity",choices:ke()},{name:"SA08",description:"motor traffic speed",choices:ke()},{name:"SA09",description:"motor traffic volume",choices:ke()},{name:"SA11",description:"footway widths",choices:ke()},{name:"SA12",description:"effective width next to tram lines",choices:ke()},{name:"SA13",description:"crossing angle of tram/train rails",choices:ke()},{name:"SA14",description:"cycling surface and maintenance defects",choices:ke()},{name:"SA15",description:"WW surface and maintenance defects",choices:ke()},{name:"SA16",description:"guard railing",choices:ke()}];const{window:ro}=Ke;function ln(n,e,l){const t=n.slice();return t[10]=e[l],t[11]=e,t[12]=l,t}function oo(n,e,l){const t=n.slice();return t[13]=e[l],t}function rn(n){let e;return{c(){e=$("p"),e.textContent="A link needs at least two points"},m(l,t){k(l,e,t)},d(l){l&&b(e)}}}function io(n){let e;return{c(){e=$("option"),e.textContent=`${n[13]}`,e.__value=n[13],oe(e,e.__value)},m(l,t){k(l,e,t)},p:te,d(l){l&&b(e)}}}function on(n){let e,l=n[10].name+"",t,r,o=n[10].description+"",i,c,s,u,a,f,m=K(n[10].choices),d=[];for(let g=0;g<m.length;g+=1)d[g]=io(oo(n,m,g));function p(){n[9].call(s,n[12])}return{c(){e=$("label"),t=H(l),r=H(": "),i=H(o),c=C(),s=$("select");for(let g=0;g<d.length;g+=1)d[g].c();u=C(),n[1].links[n[0]].properties.answers[n[12]]===void 0&&xe(p)},m(g,N){k(g,e,N),_(e,t),_(e,r),_(e,i),_(e,c),_(e,s);for(let h=0;h<d.length;h+=1)d[h]&&d[h].m(s,null);Ae(s,n[1].links[n[0]].properties.answers[n[12]],!0),_(e,u),a||(f=G(s,"change",p),a=!0)},p(g,N){n=g,N&3&&Ae(s,n[1].links[n[0]].properties.answers[n[12]])},d(g){g&&b(e),le(d,g),a=!1,f()}}}function so(n){let e,l,t,r,o,i,c,s,u,a,f,m,d,p,g=!n[2]&&rn(),N=K(be),h=[];for(let w=0;w<N.length;w+=1)h[w]=on(ln(n,N,w));return{c(){e=$("div"),l=$("button"),t=H("Done"),o=C(),i=$("button"),i.textContent="Delete link",c=C(),g&&g.c(),s=C(),u=$("label"),a=H(`Name:
      `),f=$("input"),m=C();for(let w=0;w<h.length;w+=1)h[w].c();l.disabled=r=!n[2],R(f,"type","text"),R(e,"slot","sidebar")},m(w,O){k(w,e,O),_(e,l),_(l,t),_(e,o),_(e,i),_(e,c),g&&g.m(e,null),_(e,s),_(e,u),_(u,a),_(u,f),oe(f,n[1].links[n[0]].properties.name),_(e,m);for(let T=0;T<h.length;T+=1)h[T]&&h[T].m(e,null);d||(p=[G(l,"click",n[7]),G(i,"click",n[5]),G(f,"input",n[8])],d=!0)},p(w,O){if(O&4&&r!==(r=!w[2])&&(l.disabled=r),w[2]?g&&(g.d(1),g=null):g||(g=rn(),g.c(),g.m(e,s)),O&3&&f.value!==w[1].links[w[0]].properties.name&&oe(f,w[1].links[w[0]].properties.name),O&3){N=K(be);let T;for(T=0;T<N.length;T+=1){const A=ln(w,N,T);h[T]?h[T].p(A,O):(h[T]=on(A),h[T].c(),h[T].m(e,null))}for(;T<h.length;T+=1)h[T].d(1);h.length=N.length}},d(w){w&&b(e),g&&g.d(),le(h,w),d=!1,ge(p)}}}function ao(n){let e,l;return e=new Oe({props:{paint:{"line-color":["case",["==",["id"],n[0]],["get","color"],"black"],"line-width":6}}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r&1&&(o.paint={"line-color":["case",["==",["id"],t[0]],["get","color"],"black"],"line-width":6}),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function co(n){let e,l,t,r,o,i,c,s;l=new Re({props:{except:"links"}}),r=new _e({props:{data:ne(n[1].links),generateId:!0,$$slots:{default:[ao]},$$scope:{ctx:n}}});function u(f){n[6](f)}let a={};return n[1].links[n[0]]!==void 0&&(a.f=n[1].links[n[0]]),i=new no({props:a}),pe.push(()=>ye(i,"f",u)),{c(){e=$("div"),D(l.$$.fragment),t=C(),D(r.$$.fragment),o=C(),D(i.$$.fragment),R(e,"slot","map")},m(f,m){k(f,e,m),q(l,e,null),_(e,t),q(r,e,null),_(e,o),q(i,e,null),s=!0},p(f,m){const d={};m&2&&(d.data=ne(f[1].links)),m&65537&&(d.$$scope={dirty:m,ctx:f}),r.$set(d);const p={};!c&&m&3&&(c=!0,p.f=f[1].links[f[0]],je(()=>c=!1)),i.$set(p)},i(f){s||(v(l.$$.fragment,f),v(r.$$.fragment,f),v(i.$$.fragment,f),s=!0)},o(f){y(l.$$.fragment,f),y(r.$$.fragment,f),y(i.$$.fragment,f),s=!1},d(f){f&&b(e),P(l),P(r),P(i)}}}function uo(n){let e,l,t,r;return e=new Ie({props:{$$slots:{map:[co],sidebar:[so]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},m(o,i){q(e,o,i),l=!0,t||(r=G(ro,"keydown",n[4]),t=!0)},p(o,[i]){const c={};i&65551&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){l||(v(e.$$.fragment,o),l=!0)},o(o){y(e.$$.fragment,o),l=!1},d(o){P(e,o),t=!1,r()}}}function fo(n,e,l){let t,r,o;ee(n,U,d=>l(1,r=d)),ee(n,Q,d=>l(3,o=d));let{idx:i}=e;function c(d){d.key=="Escape"&&t&&V(Q,o={kind:"neutral"},o)}async function s(){window.confirm("Really delete this link?")&&(V(Q,o={kind:"neutral"},o),await Be(),r.links.splice(i,1),U.set(r))}function u(d){n.$$.not_equal(r.links[i],d)&&(r.links[i]=d,U.set(r))}const a=()=>V(Q,o={kind:"neutral"},o);function f(){r.links[i].properties.name=this.value,U.set(r)}function m(d){r.links[i].properties.answers[d]=et(this),U.set(r)}return n.$$set=d=>{"idx"in d&&l(0,i=d.idx)},n.$$.update=()=>{n.$$.dirty&3&&l(2,t=r.links[i].geometry.coordinates.length>=2)},[i,r,t,o,c,s,u,a,f,m]}class mo extends ie{constructor(e){super(),se(this,e,fo,uo,ae,{idx:0})}}function sn(n,e,l){const t=n.slice();return t[6]=e[l],t[7]=e,t[8]=l,t}function an(n,e,l){const t=n.slice();return t[9]=e[l],t}function cn(n){let e,l=n[9]+"",t,r;return{c(){e=$("option"),t=H(l),e.__value=r=n[9],oe(e,e.__value)},m(o,i){k(o,e,i),_(e,t)},p(o,i){i&1&&l!==(l=o[9]+"")&&re(t,l),i&1&&r!==(r=o[9])&&(e.__value=r,oe(e,e.__value))},d(o){o&&b(e)}}}function un(n){let e,l,t=n[6].properties.name+"",r,o,i,c,s,u,a=K(be[n[0]].choices),f=[];for(let d=0;d<a.length;d+=1)f[d]=cn(an(n,a,d));function m(){n[5].call(i,n[7],n[8])}return{c(){e=$("li"),l=$("span"),r=H(t),o=C(),i=$("select");for(let d=0;d<f.length;d+=1)f[d].c();c=C(),x(l,"color",n[6].properties.color),n[6].properties.answers[n[0]]===void 0&&xe(m)},m(d,p){k(d,e,p),_(e,l),_(l,r),_(e,o),_(e,i);for(let g=0;g<f.length;g+=1)f[g]&&f[g].m(i,null);Ae(i,n[6].properties.answers[n[0]],!0),_(e,c),s||(u=G(i,"change",m),s=!0)},p(d,p){if(n=d,p&4&&t!==(t=n[6].properties.name+"")&&re(r,t),p&4&&x(l,"color",n[6].properties.color),p&1){a=K(be[n[0]].choices);let g;for(g=0;g<a.length;g+=1){const N=an(n,a,g);f[g]?f[g].p(N,p):(f[g]=cn(N),f[g].c(),f[g].m(i,null))}for(;g<f.length;g+=1)f[g].d(1);f.length=a.length}p&5&&Ae(i,n[6].properties.answers[n[0]])},d(d){d&&b(e),le(f,d),s=!1,u()}}}function po(n){let e,l,t,r,o=be[n[0]].name+"",i,c,s=be[n[0]].description+"",u,a,f,m,d,p=K(n[2].links),g=[];for(let N=0;N<p.length;N+=1)g[N]=un(sn(n,p,N));return{c(){e=$("div"),l=$("button"),l.textContent="Done",t=C(),r=$("h2"),i=H(o),c=H(": "),u=H(s),a=C(),f=$("ol");for(let N=0;N<g.length;N+=1)g[N].c();R(e,"slot","sidebar")},m(N,h){k(N,e,h),_(e,l),_(e,t),_(e,r),_(r,i),_(r,c),_(r,u),_(e,a),_(e,f);for(let w=0;w<g.length;w+=1)g[w]&&g[w].m(f,null);m||(d=G(l,"click",n[4]),m=!0)},p(N,h){if(h&1&&o!==(o=be[N[0]].name+"")&&re(i,o),h&1&&s!==(s=be[N[0]].description+"")&&re(u,s),h&5){p=K(N[2].links);let w;for(w=0;w<p.length;w+=1){const O=sn(N,p,w);g[w]?g[w].p(O,h):(g[w]=un(O),g[w].c(),g[w].m(f,null))}for(;w<g.length;w+=1)g[w].d(1);g.length=p.length}},d(N){N&&b(e),le(g,N),m=!1,d()}}}function _o(n){let e,l,t;return l=new Re({props:{showLinkColor:!0,except:""}}),{c(){e=$("div"),D(l.$$.fragment),R(e,"slot","map")},m(r,o){k(r,e,o),q(l,e,null),t=!0},p:te,i(r){t||(v(l.$$.fragment,r),t=!0)},o(r){y(l.$$.fragment,r),t=!1},d(r){r&&b(e),P(l)}}}function go(n){let e,l,t,r;return e=new Ie({props:{$$slots:{map:[_o],sidebar:[po]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},m(o,i){q(e,o,i),l=!0,t||(r=G(window,"keydown",n[3]),t=!0)},p(o,[i]){const c={};i&4103&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){l||(v(e.$$.fragment,o),l=!0)},o(o){y(e.$$.fragment,o),l=!1},d(o){P(e,o),t=!1,r()}}}function ho(n,e,l){let t,r;ee(n,Q,u=>l(1,t=u)),ee(n,U,u=>l(2,r=u));let{qIdx:o}=e;function i(u){u.key=="Escape"&&V(Q,t={kind:"neutral"},t)}const c=()=>V(Q,t={kind:"neutral"},t);function s(u,a){u[a].properties.answers[o]=et(this),U.set(r),l(0,o)}return n.$$set=u=>{"qIdx"in u&&l(0,o=u.qIdx)},[o,t,r,i,c,s]}class $o extends ie{constructor(e){super(),se(this,e,ho,go,ae,{qIdx:0})}}function ko(n){let e,l,t,r;const o=n[2].default,i=De(o,n,n[1],null);return{c(){e=$("a"),i&&i.c(),R(e,"href","#"),x(e,"color",n[0])},m(c,s){k(c,e,s),i&&i.m(e,null),l=!0,t||(r=G(e,"click",Hn(n[3])),t=!0)},p(c,[s]){i&&i.p&&(!l||s&2)&&qe(i,o,c,c[1],l?Fe(o,c[1],s,null):Pe(c[1]),null),s&1&&x(e,"color",c[0])},i(c){l||(v(i,c),l=!0)},o(c){y(i,c),l=!1},d(c){c&&b(e),i&&i.d(c),t=!1,r()}}}function bo(n,e,l){let{$$slots:t={},$$scope:r}=e,{color:o=void 0}=e;function i(c){ve.call(this,n,c)}return n.$$set=c=>{"color"in c&&l(0,o=c.color),"$$scope"in c&&l(1,r=c.$$scope)},[o,r,t,i]}class Xe extends ie{constructor(e){super(),se(this,e,bo,ko,ae,{color:0})}}function vo(n,e){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{name:"Untitled bus stop",color:Te[n%Te.length],st20:""}}}function fn(n,e,l){const t=n.slice();return t[5]=e[l],t[7]=l,t}function wo(n){let e=n[5].properties.name+"",l;return{c(){l=H(e)},m(t,r){k(t,l,r)},p(t,r){r&1&&e!==(e=t[5].properties.name+"")&&re(l,e)},d(t){t&&b(l)}}}function mn(n){let e,l,t,r;function o(){return n[3](n[7])}return l=new Xe({props:{color:n[5].properties.color,$$slots:{default:[wo]},$$scope:{ctx:n}}}),l.$on("click",o),{c(){e=$("li"),D(l.$$.fragment),t=C()},m(i,c){k(i,e,c),q(l,e,null),_(e,t),r=!0},p(i,c){n=i;const s={};c&1&&(s.color=n[5].properties.color),c&257&&(s.$$scope={dirty:c,ctx:n}),l.$set(s)},i(i){r||(v(l.$$.fragment,i),r=!0)},o(i){y(l.$$.fragment,i),r=!1},d(i){i&&b(e),P(l)}}}function yo(n){let e,l,t,r,o,i,c,s,u=K(n[0].bus_stops),a=[];for(let m=0;m<u.length;m+=1)a[m]=mn(fn(n,u,m));const f=m=>y(a[m],1,1,()=>{a[m]=null});return{c(){e=H(`Bus stops:

`),l=$("div"),t=$("button"),t.textContent="New bus stop",r=C(),o=$("ol");for(let m=0;m<a.length;m+=1)a[m].c()},m(m,d){k(m,e,d),k(m,l,d),_(l,t),k(m,r,d),k(m,o,d);for(let p=0;p<a.length;p+=1)a[p]&&a[p].m(o,null);i=!0,c||(s=G(t,"click",n[2]),c=!0)},p(m,[d]){if(d&3){u=K(m[0].bus_stops);let p;for(p=0;p<u.length;p+=1){const g=fn(m,u,p);a[p]?(a[p].p(g,d),v(a[p],1)):(a[p]=mn(g),a[p].c(),v(a[p],1),a[p].m(o,null))}for(ue(),p=u.length;p<a.length;p+=1)f(p);fe()}},i(m){if(!i){for(let d=0;d<u.length;d+=1)v(a[d]);i=!0}},o(m){a=a.filter(Boolean);for(let d=0;d<a.length;d+=1)y(a[d]);i=!1},d(m){m&&(b(e),b(l),b(r),b(o)),le(a,m),c=!1,s()}}}function jo(n,e,l){let t,r,o;ee(n,U,s=>l(0,t=s)),ee(n,Q,s=>l(1,r=s)),ee(n,ze,s=>l(4,o=s));function i(){if(!o)return;let s=vo(t.bus_stops.length,o.getCenter().toArray());V(U,t.bus_stops=[...t.bus_stops,s],t),V(Q,r={kind:"edit-bus-stop",idx:t.bus_stops.length-1},r)}return[t,r,i,s=>V(Q,r={kind:"edit-bus-stop",idx:s},r)]}let Co=class extends ie{constructor(e){super(),se(this,e,jo,yo,ae,{})}};function Lo(n,e){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{name:"Untitled crossing",color:Te[n%Te.length],sa10:""}}}function dn(n,e,l){const t=n.slice();return t[5]=e[l],t[7]=l,t}function So(n){let e=n[5].properties.name+"",l;return{c(){l=H(e)},m(t,r){k(t,l,r)},p(t,r){r&1&&e!==(e=t[5].properties.name+"")&&re(l,e)},d(t){t&&b(l)}}}function pn(n){let e,l,t,r;function o(){return n[3](n[7])}return l=new Xe({props:{color:n[5].properties.color,$$slots:{default:[So]},$$scope:{ctx:n}}}),l.$on("click",o),{c(){e=$("li"),D(l.$$.fragment),t=C()},m(i,c){k(i,e,c),q(l,e,null),_(e,t),r=!0},p(i,c){n=i;const s={};c&1&&(s.color=n[5].properties.color),c&257&&(s.$$scope={dirty:c,ctx:n}),l.$set(s)},i(i){r||(v(l.$$.fragment,i),r=!0)},o(i){y(l.$$.fragment,i),r=!1},d(i){i&&b(e),P(l)}}}function Ao(n){let e,l,t,r,o,i,c,s,u=K(n[0].crossings),a=[];for(let m=0;m<u.length;m+=1)a[m]=pn(dn(n,u,m));const f=m=>y(a[m],1,1,()=>{a[m]=null});return{c(){e=H(`Crossings:

`),l=$("div"),t=$("button"),t.textContent="New crossing",r=C(),o=$("ol");for(let m=0;m<a.length;m+=1)a[m].c()},m(m,d){k(m,e,d),k(m,l,d),_(l,t),k(m,r,d),k(m,o,d);for(let p=0;p<a.length;p+=1)a[p]&&a[p].m(o,null);i=!0,c||(s=G(t,"click",n[2]),c=!0)},p(m,[d]){if(d&3){u=K(m[0].crossings);let p;for(p=0;p<u.length;p+=1){const g=dn(m,u,p);a[p]?(a[p].p(g,d),v(a[p],1)):(a[p]=pn(g),a[p].c(),v(a[p],1),a[p].m(o,null))}for(ue(),p=u.length;p<a.length;p+=1)f(p);fe()}},i(m){if(!i){for(let d=0;d<u.length;d+=1)v(a[d]);i=!0}},o(m){a=a.filter(Boolean);for(let d=0;d<a.length;d+=1)y(a[d]);i=!1},d(m){m&&(b(e),b(l),b(r),b(o)),le(a,m),c=!1,s()}}}function To(n,e,l){let t,r,o;ee(n,U,s=>l(0,t=s)),ee(n,Q,s=>l(1,r=s)),ee(n,ze,s=>l(4,o=s));function i(){if(!o)return;let s=Lo(t.crossings.length,o.getCenter().toArray());V(U,t.crossings=[...t.crossings,s],t),V(Q,r={kind:"edit-crossing",idx:t.crossings.length-1},r)}return[t,r,i,s=>V(Q,r={kind:"edit-crossing",idx:s},r)]}let Mo=class extends ie{constructor(e){super(),se(this,e,To,Ao,ae,{})}};function Io(n,e){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{name:"Untitled JAT",color:Te[n%Te.length],existing:{arms:[],movements:[],notes:""},proposed:{arms:[],movements:[],notes:""}}}}function _n(n,e,l){const t=n.slice();return t[5]=e[l],t[7]=l,t}function No(n){let e=n[5].properties.name+"",l;return{c(){l=H(e)},m(t,r){k(t,l,r)},p(t,r){r&1&&e!==(e=t[5].properties.name+"")&&re(l,e)},d(t){t&&b(l)}}}function gn(n){let e,l,t,r;function o(){return n[3](n[7])}return l=new Xe({props:{color:n[5].properties.color,$$slots:{default:[No]},$$scope:{ctx:n}}}),l.$on("click",o),{c(){e=$("li"),D(l.$$.fragment),t=C()},m(i,c){k(i,e,c),q(l,e,null),_(e,t),r=!0},p(i,c){n=i;const s={};c&1&&(s.color=n[5].properties.color),c&257&&(s.$$scope={dirty:c,ctx:n}),l.$set(s)},i(i){r||(v(l.$$.fragment,i),r=!0)},o(i){y(l.$$.fragment,i),r=!1},d(i){i&&b(e),P(l)}}}function Eo(n){let e,l,t,r,o,i,c,s,u=K(n[0].jats),a=[];for(let m=0;m<u.length;m+=1)a[m]=gn(_n(n,u,m));const f=m=>y(a[m],1,1,()=>{a[m]=null});return{c(){e=H(`JATs:

`),l=$("div"),t=$("button"),t.textContent="New JAT",r=C(),o=$("ol");for(let m=0;m<a.length;m+=1)a[m].c()},m(m,d){k(m,e,d),k(m,l,d),_(l,t),k(m,r,d),k(m,o,d);for(let p=0;p<a.length;p+=1)a[p]&&a[p].m(o,null);i=!0,c||(s=G(t,"click",n[2]),c=!0)},p(m,[d]){if(d&3){u=K(m[0].jats);let p;for(p=0;p<u.length;p+=1){const g=_n(m,u,p);a[p]?(a[p].p(g,d),v(a[p],1)):(a[p]=gn(g),a[p].c(),v(a[p],1),a[p].m(o,null))}for(ue(),p=u.length;p<a.length;p+=1)f(p);fe()}},i(m){if(!i){for(let d=0;d<u.length;d+=1)v(a[d]);i=!0}},o(m){a=a.filter(Boolean);for(let d=0;d<a.length;d+=1)y(a[d]);i=!1},d(m){m&&(b(e),b(l),b(r),b(o)),le(a,m),c=!1,s()}}}function Do(n,e,l){let t,r,o;ee(n,U,s=>l(0,t=s)),ee(n,Q,s=>l(1,r=s)),ee(n,ze,s=>l(4,o=s));function i(){if(!o)return;let s=Io(t.jats.length,o.getCenter().toArray());V(U,t.jats=[...t.jats,s],t),V(Q,r={kind:"edit-jat",idx:t.jats.length-1},r)}return[t,r,i,s=>V(Q,r={kind:"edit-jat",idx:s},r)]}let qo=class extends ie{constructor(e){super(),se(this,e,Do,Eo,ae,{})}};function hn(n,e,l){const t=n.slice();return t[2]=e[l],t[4]=l,t}function $n(n,e,l){const t=n.slice();t[5]=e[l];const r=t[5].properties.answers[t[4]];return t[6]=r,t}function kn(n,e,l){const t=n.slice();return t[5]=e[l],t}function bn(n){let e,l=n[5].properties.name+"",t;return{c(){e=$("th"),t=H(l),x(e,"color",n[5].properties.color)},m(r,o){k(r,e,o),_(e,t)},p(r,o){o&1&&l!==(l=r[5].properties.name+"")&&re(t,l),o&1&&x(e,"color",r[5].properties.color)},d(r){r&&b(e)}}}function vn(n){let e,l=n[6]+"",t;return{c(){e=$("td"),t=H(l),x(e,"background",n[6]==""?"red":"green")},m(r,o){k(r,e,o),_(e,t)},p(r,o){o&1&&l!==(l=r[6]+"")&&re(t,l),o&1&&x(e,"background",r[6]==""?"red":"green")},d(r){r&&b(e)}}}function wn(n){let e,l,t,r,o=K(n[0].links),i=[];for(let c=0;c<o.length;c+=1)i[c]=vn($n(n,o,c));return{c(){e=$("tr"),l=$("th"),l.textContent=`${n[2].name}`,t=C();for(let c=0;c<i.length;c+=1)i[c].c();r=C()},m(c,s){k(c,e,s),_(e,l),_(e,t);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);_(e,r)},p(c,s){if(s&1){o=K(c[0].links);let u;for(u=0;u<o.length;u+=1){const a=$n(c,o,u);i[u]?i[u].p(a,s):(i[u]=vn(a),i[u].c(),i[u].m(e,r))}for(;u<i.length;u+=1)i[u].d(1);i.length=o.length}},d(c){c&&b(e),le(i,c)}}}function Po(n){let e,l,t,r,o,i,c,s=K(n[0].links),u=[];for(let m=0;m<s.length;m+=1)u[m]=bn(kn(n,s,m));let a=K(be),f=[];for(let m=0;m<a.length;m+=1)f[m]=wn(hn(n,a,m));return{c(){e=$("table"),l=$("thead"),t=$("tr"),r=$("th"),o=C();for(let m=0;m<u.length;m+=1)u[m].c();i=C(),c=$("tbody");for(let m=0;m<f.length;m+=1)f[m].c()},m(m,d){k(m,e,d),_(e,l),_(l,t),_(t,r),_(t,o);for(let p=0;p<u.length;p+=1)u[p]&&u[p].m(t,null);_(e,i),_(e,c);for(let p=0;p<f.length;p+=1)f[p]&&f[p].m(c,null)},p(m,d){if(d&1){s=K(m[0].links);let p;for(p=0;p<s.length;p+=1){const g=kn(m,s,p);u[p]?u[p].p(g,d):(u[p]=bn(g),u[p].c(),u[p].m(t,null))}for(;p<u.length;p+=1)u[p].d(1);u.length=s.length}if(d&1){a=K(be);let p;for(p=0;p<a.length;p+=1){const g=hn(m,a,p);f[p]?f[p].p(g,d):(f[p]=wn(g),f[p].c(),f[p].m(c,null))}for(;p<f.length;p+=1)f[p].d(1);f.length=a.length}},d(m){m&&b(e),le(u,m),le(f,m)}}}function Fo(n){let e,l;return e=new In({props:{$$slots:{default:[Po]},$$scope:{ctx:n}}}),e.$on("close",n[1]),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,[r]){const o={};r&2049&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Oo(n,e,l){let t;ee(n,U,o=>l(0,t=o));function r(o){ve.call(this,n,o)}return[t,r]}class Bo extends ie{constructor(e){super(),se(this,e,Oo,Fo,ae,{})}}function yn(n,e,l){const t=n.slice();return t[9]=e[l],t[11]=l,t}function jn(n,e,l){const t=n.slice();return t[12]=e[l],t[11]=l,t}function Cn(n){let e,l;return e=new Bo({}),e.$on("close",n[4]),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p:te,i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Jo(n){let e=n[12].properties.name+"",l;return{c(){l=H(e)},m(t,r){k(t,l,r)},p(t,r){r&2&&e!==(e=t[12].properties.name+"")&&re(l,e)},d(t){t&&b(l)}}}function Ln(n){let e,l,t,r;function o(){return n[6](n[11])}return l=new Xe({props:{color:n[12].properties.color,$$slots:{default:[Jo]},$$scope:{ctx:n}}}),l.$on("click",o),{c(){e=$("li"),D(l.$$.fragment),t=C()},m(i,c){k(i,e,c),q(l,e,null),_(e,t),r=!0},p(i,c){n=i;const s={};c&2&&(s.color=n[12].properties.color),c&16386&&(s.$$scope={dirty:c,ctx:n}),l.$set(s)},i(i){r||(v(l.$$.fragment,i),r=!0)},o(i){y(l.$$.fragment,i),r=!1},d(i){i&&b(e),P(l)}}}function zo(n){let e=n[9].name+"",l,t;return{c(){l=H(e),t=C()},m(r,o){k(r,l,o),k(r,t,o)},p:te,d(r){r&&(b(l),b(t))}}}function Sn(n){let e,l,t,r,o,i,c,s;function u(){return n[7](n[11])}l=new Xe({props:{$$slots:{default:[zo]},$$scope:{ctx:n}}}),l.$on("click",u);function a(...f){return n[8](n[11],...f)}return{c(){e=$("li"),D(l.$$.fragment),t=H(`:
      `),r=$("progress"),c=C(),r.value=o=n[1].links.filter(a).length,R(r,"max",i=n[1].links.length),R(r,"class","svelte-zadug4")},m(f,m){k(f,e,m),q(l,e,null),_(e,t),_(e,r),_(e,c),s=!0},p(f,m){n=f;const d={};m&16384&&(d.$$scope={dirty:m,ctx:n}),l.$set(d),(!s||m&2&&o!==(o=n[1].links.filter(a).length))&&(r.value=o),(!s||m&2&&i!==(i=n[1].links.length))&&R(r,"max",i)},i(f){s||(v(l.$$.fragment,f),s=!0)},o(f){y(l.$$.fragment,f),s=!1},d(f){f&&b(e),P(l)}}}function Ro(n){let e,l,t,r,o,i,c,s,u,a,f,m,d=n[0]&&Cn(n),p=K(n[1].links),g=[];for(let T=0;T<p.length;T+=1)g[T]=Ln(jn(n,p,T));const N=T=>y(g[T],1,1,()=>{g[T]=null});let h=K(be),w=[];for(let T=0;T<h.length;T+=1)w[T]=Sn(yn(n,h,T));const O=T=>y(w[T],1,1,()=>{w[T]=null});return{c(){d&&d.c(),e=C(),l=$("div"),t=$("button"),t.textContent="New link",r=C(),o=$("button"),o.textContent="Table of questions",i=H(`

Links:
`),c=$("ol");for(let T=0;T<g.length;T+=1)g[T].c();s=H(`

Questions:
`),u=$("ol");for(let T=0;T<w.length;T+=1)w[T].c()},m(T,A){d&&d.m(T,A),k(T,e,A),k(T,l,A),_(l,t),_(l,r),_(l,o),k(T,i,A),k(T,c,A);for(let S=0;S<g.length;S+=1)g[S]&&g[S].m(c,null);k(T,s,A),k(T,u,A);for(let S=0;S<w.length;S+=1)w[S]&&w[S].m(u,null);a=!0,f||(m=[G(t,"click",n[3]),G(o,"click",n[5])],f=!0)},p(T,[A]){if(T[0]?d?(d.p(T,A),A&1&&v(d,1)):(d=Cn(T),d.c(),v(d,1),d.m(e.parentNode,e)):d&&(ue(),y(d,1,1,()=>{d=null}),fe()),A&6){p=K(T[1].links);let S;for(S=0;S<p.length;S+=1){const z=jn(T,p,S);g[S]?(g[S].p(z,A),v(g[S],1)):(g[S]=Ln(z),g[S].c(),v(g[S],1),g[S].m(c,null))}for(ue(),S=p.length;S<g.length;S+=1)N(S);fe()}if(A&6){h=K(be);let S;for(S=0;S<h.length;S+=1){const z=yn(T,h,S);w[S]?(w[S].p(z,A),v(w[S],1)):(w[S]=Sn(z),w[S].c(),v(w[S],1),w[S].m(u,null))}for(ue(),S=h.length;S<w.length;S+=1)O(S);fe()}},i(T){if(!a){v(d);for(let A=0;A<p.length;A+=1)v(g[A]);for(let A=0;A<h.length;A+=1)v(w[A]);a=!0}},o(T){y(d),g=g.filter(Boolean);for(let A=0;A<g.length;A+=1)y(g[A]);w=w.filter(Boolean);for(let A=0;A<w.length;A+=1)y(w[A]);a=!1},d(T){T&&(b(e),b(l),b(i),b(c),b(s),b(u)),d&&d.d(T),le(g,T),le(w,T),f=!1,ge(m)}}}function Ho(n,e,l){let t,r;ee(n,U,m=>l(1,t=m)),ee(n,Q,m=>l(2,r=m));let o=!1;function i(){let m=lo(t.links.length);V(U,t.links=[...t.links,m],t),V(Q,r={kind:"edit-link",idx:t.links.length-1},r)}return[o,t,r,i,()=>l(0,o=!1),()=>l(0,o=!0),m=>V(Q,r={kind:"edit-link",idx:m},r),m=>V(Q,r={kind:"edit-question",idx:m},r),(m,d)=>d.properties.answers[m]!=""]}class Go extends ie{constructor(e){super(),se(this,e,Ho,Ro,ae,{})}}function Uo(n){let e,l,t,r,o,i,c,s,u,a,f,m,d,p,g,N,h,w,O,T,A,S,z,I;return u=new Go({}),d=new qo({}),h=new Co({}),A=new Mo({}),{c(){e=$("div"),l=$("div"),t=$("button"),t.textContent="Download",r=C(),o=$("button"),o.textContent="Clear",i=C(),c=$("hr"),s=C(),D(u.$$.fragment),a=C(),f=$("hr"),m=C(),D(d.$$.fragment),p=C(),g=$("hr"),N=C(),D(h.$$.fragment),w=C(),O=$("hr"),T=C(),D(A.$$.fragment),R(t,"class","secondary"),R(o,"class","secondary"),R(e,"slot","sidebar")},m(J,M){k(J,e,M),_(e,l),_(l,t),_(l,r),_(l,o),_(e,i),_(e,c),_(e,s),q(u,e,null),_(e,a),_(e,f),_(e,m),q(d,e,null),_(e,p),_(e,g),_(e,N),q(h,e,null),_(e,w),_(e,O),_(e,T),q(A,e,null),S=!0,z||(I=[G(t,"click",n[7]),G(o,"click",n[2])],z=!0)},p:te,i(J){S||(v(u.$$.fragment,J),v(d.$$.fragment,J),v(h.$$.fragment,J),v(A.$$.fragment,J),S=!0)},o(J){y(u.$$.fragment,J),y(d.$$.fragment,J),y(h.$$.fragment,J),y(A.$$.fragment,J),S=!1},d(J){J&&b(e),P(u),P(d),P(h),P(A),z=!1,ge(I)}}}function Zo(n){let e,l;return e=new Oe({props:{manageHoverState:!0,paint:{"line-color":["get","color"],"line-width":Je(6,9)},hoverCursor:"pointer"}}),e.$on("click",n[3]),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p:te,i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Ko(n){let e,l;return e=new Ce({props:{manageHoverState:!0,paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":["get","color"],"circle-radius":Je(20,25)},hoverCursor:"pointer"}}),e.$on("click",n[4]),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p:te,i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Xo(n){let e,l;return e=new Ce({props:{manageHoverState:!0,paint:{"circle-color":["get","color"],"circle-radius":Je(10,15)},hoverCursor:"pointer"}}),e.$on("click",n[5]),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p:te,i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Wo(n){let e,l;return e=new Ce({props:{manageHoverState:!0,paint:{"circle-color":["get","color"],"circle-radius":Je(10,15)},hoverCursor:"pointer"}}),e.$on("click",n[6]),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p:te,i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Vo(n){let e,l,t,r,o,i,c,s,u;return l=new _e({props:{data:ne(n[0].links),generateId:!0,$$slots:{default:[Zo]},$$scope:{ctx:n}}}),r=new _e({props:{data:ne(n[0].jats),generateId:!0,$$slots:{default:[Ko]},$$scope:{ctx:n}}}),i=new _e({props:{data:ne(n[0].bus_stops),generateId:!0,$$slots:{default:[Xo]},$$scope:{ctx:n}}}),s=new _e({props:{data:ne(n[0].crossings),generateId:!0,$$slots:{default:[Wo]},$$scope:{ctx:n}}}),{c(){e=$("div"),D(l.$$.fragment),t=C(),D(r.$$.fragment),o=C(),D(i.$$.fragment),c=C(),D(s.$$.fragment),R(e,"slot","map")},m(a,f){k(a,e,f),q(l,e,null),_(e,t),q(r,e,null),_(e,o),q(i,e,null),_(e,c),q(s,e,null),u=!0},p(a,f){const m={};f&1&&(m.data=ne(a[0].links)),f&258&&(m.$$scope={dirty:f,ctx:a}),l.$set(m);const d={};f&1&&(d.data=ne(a[0].jats)),f&258&&(d.$$scope={dirty:f,ctx:a}),r.$set(d);const p={};f&1&&(p.data=ne(a[0].bus_stops)),f&258&&(p.$$scope={dirty:f,ctx:a}),i.$set(p);const g={};f&1&&(g.data=ne(a[0].crossings)),f&258&&(g.$$scope={dirty:f,ctx:a}),s.$set(g)},i(a){u||(v(l.$$.fragment,a),v(r.$$.fragment,a),v(i.$$.fragment,a),v(s.$$.fragment,a),u=!0)},o(a){y(l.$$.fragment,a),y(r.$$.fragment,a),y(i.$$.fragment,a),y(s.$$.fragment,a),u=!1},d(a){a&&b(e),P(l),P(r),P(i),P(s)}}}function Qo(n){let e,l;return e=new Ie({props:{$$slots:{map:[Vo],sidebar:[Uo]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,[r]){const o={};r&259&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Yo(n,e,l){let t,r;ee(n,U,f=>l(0,t=f)),ee(n,Q,f=>l(1,r=f));function o(){V(U,t.links=[],t),V(U,t.jats=[],t),V(U,t.bus_stops=[],t),V(U,t.crossings=[],t)}return[t,r,o,f=>V(Q,r={kind:"edit-link",idx:f.detail.features[0].id},r),f=>V(Q,r={kind:"edit-jat",idx:f.detail.features[0].id},r),f=>V(Q,r={kind:"edit-bus-stop",idx:f.detail.features[0].id},r),f=>V(Q,r={kind:"edit-crossing",idx:f.detail.features[0].id},r),()=>Ol("rcv2.geojson",JSON.stringify(t))]}class xo extends ie{constructor(e){super(),se(this,e,Yo,Qo,ae,{})}}function ei(n){let e,l;return{c(){e=$("div"),l=$("div"),R(e,"slot","left")},m(t,r){k(t,e,r),_(e,l),n[9](l)},p:te,d(t){t&&b(e),n[9](null)}}}function ti(n){return{c:te,m:te,p:te,i:te,o:te,d:te}}function ni(n){let e,l,t;function r(i){n[8](i)}let o={style:n[10],standardControls:!0,hash:!0,$$slots:{default:[ui]},$$scope:{ctx:n}};return n[2]!==void 0&&(o.map=n[2]),e=new Un({props:o}),pe.push(()=>ye(e,"map",r)),{c(){D(e.$$.fragment)},m(i,c){q(e,i,c),t=!0},p(i,c){const s={};c&2058&&(s.$$scope={dirty:c,ctx:i}),!l&&c&4&&(l=!0,s.map=i[2],je(()=>l=!1)),e.$set(s)},i(i){t||(v(e.$$.fragment,i),t=!0)},o(i){y(e.$$.fragment,i),t=!1},d(i){P(e,i)}}}function li(n){let e,l;return e=new $o({props:{qIdx:n[3].idx}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r&8&&(o.qIdx=t[3].idx),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function ri(n){let e,l;return e=new Tl({props:{idx:n[3].idx}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r&8&&(o.idx=t[3].idx),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function oi(n){let e,l;return e=new kl({props:{idx:n[3].idx}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r&8&&(o.idx=t[3].idx),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function ii(n){let e,l;return e=new Gr({props:{junctionIdx:n[3].idx,stage:n[3].stage}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r&8&&(o.junctionIdx=t[3].idx),r&8&&(o.stage=t[3].stage),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function si(n){let e,l;return e=new Yr({props:{idx:n[3].idx}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r&8&&(o.idx=t[3].idx),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function ai(n){let e,l;return e=new mo({props:{idx:n[3].idx}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,r){const o={};r&8&&(o.idx=t[3].idx),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function ci(n){let e,l;return e=new xo({}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p:te,i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function ui(n){let e,l,t,r,o,i;const c=[ci,ai,si,ii,oi,ri,li],s=[];function u(a,f){return a[3].kind=="neutral"?0:a[3].kind=="edit-link"?1:a[3].kind=="edit-jat"?2:a[3].kind=="edit-jat-detail"?3:a[3].kind=="edit-bus-stop"?4:a[3].kind=="edit-crossing"?5:a[3].kind=="edit-question"?6:-1}return~(t=u(n))&&(r=s[t]=c[t](n)),{c(){e=$("div"),l=C(),r&&r.c(),o=Ze()},m(a,f){k(a,e,f),n[7](e),k(a,l,f),~t&&s[t].m(a,f),k(a,o,f),i=!0},p(a,f){let m=t;t=u(a),t===m?~t&&s[t].p(a,f):(r&&(ue(),y(s[m],1,1,()=>{s[m]=null}),fe()),~t?(r=s[t],r?r.p(a,f):(r=s[t]=c[t](a),r.c()),v(r,1),r.m(o.parentNode,o)):r=null)},i(a){i||(v(r),i=!0)},o(a){y(r),i=!1},d(a){a&&(b(e),b(l),b(o)),n[7](null),~t&&s[t].d(a)}}}function fi(n){return{c:te,m:te,p:te,i:te,o:te,d:te}}function mi(n){let e,l,t={ctx:n,current:null,token:null,hasCatch:!1,pending:fi,then:ni,catch:ti,value:10,blocks:[,,,]};return Zn(Ml(new URLSearchParams(window.location.search).get("google")||""),t),{c(){e=$("div"),t.block.c(),R(e,"slot","main"),x(e,"position","relative"),x(e,"width","100%"),x(e,"height","100vh")},m(r,o){k(r,e,o),t.block.m(e,t.anchor=null),t.mount=()=>e,t.anchor=null,l=!0},p(r,o){n=r,Kn(t,n,o)},i(r){l||(v(t.block),l=!0)},o(r){for(let o=0;o<3;o+=1){const i=t.blocks[o];y(i)}l=!1},d(r){r&&b(e),t.block.d(),t.token=null,t=null}}}function di(n){let e,l;return e=new Gn({props:{$$slots:{main:[mi],left:[ei]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},m(t,r){q(e,t,r),l=!0},p(t,[r]){const o={};r&2063&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function pi(n,e,l){let t,r,o,i,c;ee(n,it,d=>l(4,t=d)),ee(n,ot,d=>l(5,r=d)),ee(n,U,d=>l(6,o=d)),ee(n,ze,d=>l(2,i=d)),ee(n,Q,d=>l(3,c=d));let s,u;function a(d){pe[d?"unshift":"push"](()=>{u=d,l(1,u),l(4,t)})}function f(d){i=d,ze.set(i)}function m(d){pe[d?"unshift":"push"](()=>{s=d,l(0,s),l(5,r)})}return n.$$.update=()=>{n.$$.dirty&64&&window.localStorage.setItem("tmp-rcv2",JSON.stringify(o)),n.$$.dirty&33&&s&&r&&(l(0,s.innerHTML="",s),s.appendChild(r)),n.$$.dirty&18&&u&&t&&(l(1,u.innerHTML="",u),u.appendChild(t))},[s,u,i,c,t,r,o,a,f,m]}class _i extends ie{constructor(e){super(),se(this,e,pi,di,ae,{})}}new _i({target:document.getElementById("app")});
