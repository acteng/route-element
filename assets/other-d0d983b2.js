import{a0 as Q,a1 as W,a2 as C,w as L,e as m,x as S,t as p,a3 as Y,S as N,i as D,s as z,A as Z,a4 as V,B as X,E as x,H as E,c as $,J as G,r as J,m as b,v as g,Y as j,y as k,f as y,I as H,M as ee,b as O,a as q,d as I,G as v,K as B,N as d,h as te,a5 as ne,u as le,j as re,k as oe,l as se,U as ae,$ as M,_ as ce,O as ie,R as ue,Q as U,P as fe}from"./Layout-b626fc7f.js";function _e(o,e){const n=e.token={};function t(c,s,l,i){if(e.token!==n)return;e.resolved=i;let r=e.ctx;l!==void 0&&(r=r.slice(),r[l]=i);const _=c&&(e.current=c)(r);let a=!1;e.block&&(e.blocks?e.blocks.forEach((f,u)=>{u!==s&&f&&(L(),m(f,1,1,()=>{e.blocks[u]===f&&(e.blocks[u]=null)}),S())}):e.block.d(1),_.c(),p(_,1),_.m(e.mount(),e.anchor),a=!0),e.block=_,e.blocks&&(e.blocks[s]=_),a&&Y()}if(Q(o)){const c=W();if(o.then(s=>{C(c),t(e.then,1,e.value,s),C(null)},s=>{if(C(c),t(e.catch,2,e.error,s),C(null),!e.hasCatch)throw s}),e.current!==e.pending)return t(e.pending,0),!0}else{if(e.current!==e.then)return t(e.then,1,e.value,o),!0;e.resolved=o}}function pe(o,e,n){const t=e.slice(),{resolved:c}=o;o.current===o.then&&(t[o.value]=c),o.current===o.catch&&(t[o.error]=c),o.block.p(t,n)}function me(o,e,n){let t;const c=Z();let{layer:s=void 0}=e;const{map:l}=V();X(o,l,a=>n(2,t=a));function i(a){c(a.type,{...a,map:l})}const r=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu","mouseover","mouseout"],_=["click","dblclick","contextmenu","mousemove","movestart","moveend","zoomstart","zoom","zoomend"];return x(()=>{if(t)if(s)for(const a of r)t.off(a,s,i);else for(const a of _)t.off(a,i)}),o.$$set=a=>{"layer"in a&&n(1,s=a.layer)},o.$$.update=()=>{if(o.$$.dirty&6&&t)if(s)for(const a of r)t.on(a,s,i);else for(const a of _)t.on(a,i)},[l,s,t]}class de extends N{constructor(e){super(),D(this,e,me,null,z,{layer:1})}}function K(o,e,n){const t=o.slice();return t[5]=e[n],t[6]=e,t[7]=n,t}function ge(o){let e,n;return{c(){e=v("span"),n=G(),B(e,"class","dot svelte-1lzmzqo")},m(t,c){g(t,e,c),g(t,n,c)},p:d,d(t){t&&(k(e),k(n))}}}function F(o){let e,n,t;function c(l){o[4](l,o[5],o[6],o[7])}let s={draggable:!0,$$slots:{default:[ge]},$$scope:{ctx:o}};return o[5]!==void 0&&(s.lngLat=o[5]),e=new ee({props:s}),O.push(()=>q(e,"lngLat",c)),{c(){$(e.$$.fragment)},m(l,i){b(e,l,i),t=!0},p(l,i){o=l;const r={};i&256&&(r.$$scope={dirty:i,ctx:o}),!n&&i&1&&(n=!0,r.lngLat=o[5],I(()=>n=!1)),e.$set(r)},i(l){t||(p(e.$$.fragment,l),t=!0)},o(l){m(e.$$.fragment,l),t=!1},d(l){y(e,l)}}}function ke(o){let e,n,t,c,s,l;e=new de({}),e.$on("click",o[1]);let i=E(o[0].geometry.coordinates),r=[];for(let a=0;a<i.length;a+=1)r[a]=F(K(o,i,a));const _=a=>m(r[a],1,1,()=>{r[a]=null});return{c(){$(e.$$.fragment),n=G();for(let a=0;a<r.length;a+=1)r[a].c();t=J()},m(a,f){b(e,a,f),g(a,n,f);for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(a,f);g(a,t,f),c=!0,s||(l=j(window,"keydown",o[2]),s=!0)},p(a,[f]){if(f&1){i=E(a[0].geometry.coordinates);let u;for(u=0;u<i.length;u+=1){const w=K(a,i,u);r[u]?(r[u].p(w,f),p(r[u],1)):(r[u]=F(w),r[u].c(),p(r[u],1),r[u].m(t.parentNode,t))}for(L(),u=i.length;u<r.length;u+=1)_(u);S()}},i(a){if(!c){p(e.$$.fragment,a);for(let f=0;f<i.length;f+=1)p(r[f]);c=!0}},o(a){m(e.$$.fragment,a),r=r.filter(Boolean);for(let f=0;f<r.length;f+=1)m(r[f]);c=!1},d(a){a&&(k(n),k(t)),y(e,a),H(r,a),s=!1,l()}}}function he(o,e,n){let{f:t}=e,{onDone:c}=e;function s(r){t.geometry.coordinates.push(r.detail.lngLat.toArray()),n(0,t)}function l(r){r.key=="Enter"&&c()}function i(r,_,a,f){a[f]=r,n(0,t)}return o.$$set=r=>{"f"in r&&n(0,t=r.f),"onDone"in r&&n(3,c=r.onDone)},[t,s,l,c,i]}class $e extends N{constructor(e){super(),D(this,e,he,ke,z,{f:0,onDone:3})}}let P="MZEJTanw3WpxRvt7qDfo";async function be(o){return o?{version:8,sources:{"raster-tiles":{type:"raster",tiles:[`https://tile.googleapis.com/v1/2dtiles/{z}/{x}/{y}?session=${await ye(o)}&key=${o}`],tileSize:256,attribution:"Google (detailed attributions not wired up)"}},layers:[{id:"raster-basemap",type:"raster",source:"raster-tiles"}],glyphs:`https://api.maptiler.com/fonts/{fontstack}/{range}.pbf?key=${P}`}:`https://api.maptiler.com/maps/dataviz/style.json?key=${P}`}async function ye(o){try{let n=await(await fetch(`https://tile.googleapis.com/v1/createSession?key=${o}`,{method:"POST",body:JSON.stringify({mapType:"satellite",language:"en-GB",region:"GB"})})).json();return"session"in n?n.session:(console.error(`Couldn't get Google tile session key: ${JSON.stringify(n)}`),"")}catch(e){return console.error(`Couldn't get Google tile session key: ${e}`),""}}function ve(o){let e,n,t,c;const s=o[1].default,l=te(s,o,o[0],null);return{c(){e=v("a"),l&&l.c(),B(e,"href","#")},m(i,r){g(i,e,r),l&&l.m(e,null),n=!0,t||(c=j(e,"click",ne(o[2])),t=!0)},p(i,[r]){l&&l.p&&(!n||r&1)&&le(l,s,i,i[0],n?oe(s,i[0],r,null):re(i[0]),null)},i(i){n||(p(l,i),n=!0)},o(i){m(l,i),n=!1},d(i){i&&k(e),l&&l.d(i),t=!1,c()}}}function we(o,e,n){let{$$slots:t={},$$scope:c}=e;function s(l){se.call(this,o,l)}return o.$$set=l=>{"$$scope"in l&&n(0,c=l.$$scope)},[c,t,s]}class Le extends N{constructor(e){super(),D(this,e,we,ve,z,{})}}function R(o,e,n){const t=o.slice();return t[12]=e[n],t[14]=n,t}function Se(o){let e,n,t;return{c(){e=v("button"),e.textContent="Done"},m(c,s){g(c,e,s),n||(t=j(e,"click",o[10]),n=!0)},p:d,i:d,o:d,d(c){c&&k(e),n=!1,t()}}}function Ce(o){let e,n,t,c,s,l,i=E(o[0]),r=[];for(let a=0;a<i.length;a+=1)r[a]=T(R(o,i,a));const _=a=>m(r[a],1,1,()=>{r[a]=null});return{c(){e=v("button"),e.textContent="New link",n=G(),t=v("ol");for(let a=0;a<r.length;a+=1)r[a].c()},m(a,f){g(a,e,f),g(a,n,f),g(a,t,f);for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(t,null);c=!0,s||(l=j(e,"click",o[4]),s=!0)},p(a,f){if(f&5){i=E(a[0]);let u;for(u=0;u<i.length;u+=1){const w=R(a,i,u);r[u]?(r[u].p(w,f),p(r[u],1)):(r[u]=T(w),r[u].c(),p(r[u],1),r[u].m(t,null))}for(L(),u=i.length;u<r.length;u+=1)_(u);S()}},i(a){if(!c){for(let f=0;f<i.length;f+=1)p(r[f]);c=!0}},o(a){r=r.filter(Boolean);for(let f=0;f<r.length;f+=1)m(r[f]);c=!1},d(a){a&&(k(e),k(n),k(t)),H(r,a),s=!1,l()}}}function Ee(o){let e;return{c(){e=ue("Link")},m(n,t){g(n,e,t)},d(n){n&&k(e)}}}function T(o){let e,n,t;function c(){return o[9](o[14])}return n=new Le({props:{$$slots:{default:[Ee]},$$scope:{ctx:o}}}),n.$on("click",c),{c(){e=v("li"),$(n.$$.fragment)},m(s,l){g(s,e,l),b(n,e,null),t=!0},p(s,l){o=s;const i={};l&32768&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(s){t||(p(n.$$.fragment,s),t=!0)},o(s){m(n.$$.fragment,s),t=!1},d(s){s&&k(e),y(n)}}}function Ne(o){let e,n,t,c;const s=[Ce,Se],l=[];function i(r,_){return r[2]==null?0:1}return n=i(o),t=l[n]=s[n](o),{c(){e=v("div"),t.c(),B(e,"slot","left")},m(r,_){g(r,e,_),l[n].m(e,null),c=!0},p(r,_){let a=n;n=i(r),n===a?l[n].p(r,_):(L(),m(l[a],1,1,()=>{l[a]=null}),S(),t=l[n],t?t.p(r,_):(t=l[n]=s[n](r),t.c()),p(t,1),t.m(e,null))},i(r){c||(p(t),c=!0)},o(r){m(t),c=!1},d(r){r&&k(e),l[n].d()}}}function De(o){return{c:d,m:d,p:d,i:d,o:d,d}}function ze(o){let e,n,t;function c(l){o[8](l)}let s={style:o[11],standardControls:!0,hash:!0,$$slots:{default:[Me]},$$scope:{ctx:o}};return o[1]!==void 0&&(s.map=o[1]),e=new ce({props:s}),O.push(()=>q(e,"map",c)),{c(){$(e.$$.fragment)},m(l,i){b(e,l,i),t=!0},p(l,i){const r={};i&32781&&(r.$$scope={dirty:i,ctx:l}),!n&&i&2&&(n=!0,r.map=l[1],I(()=>n=!1)),e.$set(r)},i(l){t||(p(e.$$.fragment,l),t=!0)},o(l){m(e.$$.fragment,l),t=!1},d(l){y(e,l)}}}function Ge(o){let e,n;return e=new U({props:{paint:{"line-color":"black","line-opacity":.5,"line-width":3}}}),{c(){$(e.$$.fragment)},m(t,c){b(e,t,c),n=!0},p:d,i(t){n||(p(e.$$.fragment,t),n=!0)},o(t){m(e.$$.fragment,t),n=!1},d(t){y(e,t)}}}function je(o){let e,n;return e=new U({props:{manageHoverState:!0,paint:{"line-color":fe("black","cyan"),"line-width":3},hoverCursor:"pointer"}}),e.$on("click",o[5]),{c(){$(e.$$.fragment)},m(t,c){b(e,t,c),n=!0},p:d,i(t){n||(p(e.$$.fragment,t),n=!0)},o(t){m(e.$$.fragment,t),n=!1},d(t){y(e,t)}}}function Be(o){let e,n,t,c;const s=[je,Ge],l=[];function i(r,_){return r[2]==null?0:1}return e=i(o),n=l[e]=s[e](o),{c(){n.c(),t=J()},m(r,_){l[e].m(r,_),g(r,t,_),c=!0},p(r,_){let a=e;e=i(r),e===a?l[e].p(r,_):(L(),m(l[a],1,1,()=>{l[a]=null}),S(),n=l[e],n?n.p(r,_):(n=l[e]=s[e](r),n.c()),p(n,1),n.m(t.parentNode,t))},i(r){c||(p(n),c=!0)},o(r){m(n),c=!1},d(r){r&&k(t),l[e].d(r)}}}function A(o){let e,n,t;function c(l){o[7](l)}let s={onDone:o[6]};return o[0][o[2]]!==void 0&&(s.f=o[0][o[2]]),e=new $e({props:s}),O.push(()=>q(e,"f",c)),{c(){$(e.$$.fragment)},m(l,i){b(e,l,i),t=!0},p(l,i){const r={};i&4&&(r.onDone=l[6]),!n&&i&5&&(n=!0,r.f=l[0][l[2]],I(()=>n=!1)),e.$set(r)},i(l){t||(p(e.$$.fragment,l),t=!0)},o(l){m(e.$$.fragment,l),t=!1},d(l){y(e,l)}}}function Me(o){let e,n,t,c;e=new ie({props:{data:o[3],generateId:!0,$$slots:{default:[Be]},$$scope:{ctx:o}}});let s=o[2]!=null&&A(o);return{c(){$(e.$$.fragment),n=G(),s&&s.c(),t=J()},m(l,i){b(e,l,i),g(l,n,i),s&&s.m(l,i),g(l,t,i),c=!0},p(l,i){const r={};i&8&&(r.data=l[3]),i&32772&&(r.$$scope={dirty:i,ctx:l}),e.$set(r),l[2]!=null?s?(s.p(l,i),i&4&&p(s,1)):(s=A(l),s.c(),p(s,1),s.m(t.parentNode,t)):s&&(L(),m(s,1,1,()=>{s=null}),S())},i(l){c||(p(e.$$.fragment,l),p(s),c=!0)},o(l){m(e.$$.fragment,l),m(s),c=!1},d(l){l&&(k(n),k(t)),y(e,l),s&&s.d(l)}}}function Je(o){return{c:d,m:d,p:d,i:d,o:d,d}}function Oe(o){let e,n,t={ctx:o,current:null,token:null,hasCatch:!1,pending:Je,then:ze,catch:De,value:11,blocks:[,,,]};return _e(be(new URLSearchParams(window.location.search).get("google")||""),t),{c(){e=v("div"),t.block.c(),B(e,"slot","main"),M(e,"position","relative"),M(e,"width","100%"),M(e,"height","100vh")},m(c,s){g(c,e,s),t.block.m(e,t.anchor=null),t.mount=()=>e,t.anchor=null,n=!0},p(c,s){o=c,pe(t,o,s)},i(c){n||(p(t.block),n=!0)},o(c){for(let s=0;s<3;s+=1){const l=t.blocks[s];m(l)}n=!1},d(c){c&&k(e),t.block.d(),t.token=null,t=null}}}function qe(o){let e,n;return e=new ae({props:{$$slots:{main:[Oe],left:[Ne]},$$scope:{ctx:o}}}),{c(){$(e.$$.fragment)},m(t,c){b(e,t,c),n=!0},p(t,[c]){const s={};c&32783&&(s.$$scope={dirty:c,ctx:t}),e.$set(s)},i(t){n||(p(e.$$.fragment,t),n=!0)},o(t){m(e.$$.fragment,t),n=!1},d(t){y(e,t)}}}function Ie(o,e,n){let t,c,s=[],l=null;function i(){let h={type:"Feature",geometry:{type:"LineString",coordinates:[]},properties:{}};n(0,s=[...s,h]),n(2,l=s.length-1)}const r=h=>n(2,l=h.detail.features[0].id),_=()=>n(2,l=null);function a(h){o.$$.not_equal(s[l],h)&&(s[l]=h,n(0,s))}function f(h){c=h,n(1,c)}const u=h=>n(2,l=h),w=()=>n(2,l=null);return o.$$.update=()=>{o.$$.dirty&1&&n(3,t={type:"FeatureCollection",features:s})},[s,c,l,t,i,r,_,a,f,u,w]}class Ke extends N{constructor(e){super(),D(this,e,Ie,qe,z,{})}}new Ke({target:document.getElementById("app")});
