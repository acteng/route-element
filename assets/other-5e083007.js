import{V as qn,W as Fn,X as We,r as ae,e as $,v as ue,t as _,Y as Pn,S as le,i as ie,s as re,Z as On,_ as Bn,$ as x,a0 as Un,L as Jn,b as oe,a as fe,c as T,m as I,d as de,f as N,g as Rn,h as Ie,u as Ne,j as Ee,k as De,l as be,y as b,z as L,q as v,w,a1 as Ve,M as Be,A as P,a2 as Ue,U as Y,p as Ge,B as te,a3 as Gn,o as Q,F as R,a4 as Hn,O as g,a5 as st,Q as J,H as se,x as me,R as $e,N as _e,K as Kn,G as ge,D as Ae,E as Se,a6 as He,a7 as G,a8 as qe,a9 as xe,aa as Xn,ab as nt,ac as Zn,C as Je,P as Ln,ad as Vn,I as Wn,T as Qn}from"./Layout-d1a27f85.js";function Yn(n,e){const r=e.token={};function t(o,l,i,a){if(e.token!==r)return;e.resolved=a;let s=e.ctx;i!==void 0&&(s=s.slice(),s[i]=a);const f=o&&(e.current=o)(s);let u=!1;e.block&&(e.blocks?e.blocks.forEach((d,c)=>{c!==l&&d&&(ae(),$(d,1,1,()=>{e.blocks[c]===d&&(e.blocks[c]=null)}),ue())}):e.block.d(1),f.c(),_(f,1),f.m(e.mount(),e.anchor),u=!0),e.block=f,e.blocks&&(e.blocks[l]=f),u&&Pn()}if(qn(n)){const o=Fn();if(n.then(l=>{We(o),t(e.then,1,e.value,l),We(null)},l=>{if(We(o),t(e.catch,2,e.error,l),We(null),!e.hasCatch)throw l}),e.current!==e.pending)return t(e.pending,0),!0}else{if(e.current!==e.then)return t(e.then,1,e.value,n),!0;e.resolved=n}}function xn(n,e,r){const t=e.slice(),{resolved:o}=n;n.current===n.then&&(t[n.value]=o),n.current===n.catch&&(t[n.error]=o),n.block.p(t,r)}function er(n,e,r){let t;const o=On();let{layer:l=void 0}=e;const{map:i}=Bn();x(n,i,u=>r(2,t=u));function a(u){o(u.type,{...u,map:i})}const s=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu","mouseover","mouseout"],f=["click","dblclick","contextmenu","mousemove","movestart","moveend","zoomstart","zoom","zoomend"];return Un(()=>{if(t)if(l)for(const u of s)t.off(u,l,a);else for(const u of f)t.off(u,a)}),n.$$set=u=>{"layer"in u&&r(1,l=u.layer)},n.$$.update=()=>{if(n.$$.dirty&6&&t)if(l)for(const u of s)t.on(u,l,a);else for(const u of f)t.on(u,a)},[i,l,t]}class Sn extends le{constructor(e){super(),ie(this,e,er,null,re,{layer:1})}}function tr(n){let e;const r=n[16].default,t=Ie(r,n,n[24],null);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l&16777216)&&Ne(t,r,o,o[24],e?De(r,o[24],l,null):Ee(o[24]),null)},i(o){e||(_(t,o),e=!0)},o(o){$(t,o),e=!1},d(o){t&&t.d(o)}}}function nr(n){let e,r,t;function o(i){n[17](i)}let l={id:n[1],type:"symbol",source:n[2],sourceLayer:n[3],beforeId:n[4],beforeLayerType:n[5],paint:n[6],layout:n[7],filter:n[8],applyToClusters:n[9],minzoom:n[10],maxzoom:n[11],hoverCursor:n[12],manageHoverState:n[13],eventsIfTopMost:n[14],interactive:n[15],$$slots:{default:[tr]},$$scope:{ctx:n}};return n[0]!==void 0&&(l.hovered=n[0]),e=new Jn({props:l}),oe.push(()=>fe(e,"hovered",o)),e.$on("click",n[18]),e.$on("dblclick",n[19]),e.$on("contextmenu",n[20]),e.$on("mouseenter",n[21]),e.$on("mousemove",n[22]),e.$on("mouseleave",n[23]),{c(){T(e.$$.fragment)},m(i,a){I(e,i,a),t=!0},p(i,[a]){const s={};a&2&&(s.id=i[1]),a&4&&(s.source=i[2]),a&8&&(s.sourceLayer=i[3]),a&16&&(s.beforeId=i[4]),a&32&&(s.beforeLayerType=i[5]),a&64&&(s.paint=i[6]),a&128&&(s.layout=i[7]),a&256&&(s.filter=i[8]),a&512&&(s.applyToClusters=i[9]),a&1024&&(s.minzoom=i[10]),a&2048&&(s.maxzoom=i[11]),a&4096&&(s.hoverCursor=i[12]),a&8192&&(s.manageHoverState=i[13]),a&16384&&(s.eventsIfTopMost=i[14]),a&32768&&(s.interactive=i[15]),a&16777216&&(s.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,s.hovered=i[0],de(()=>r=!1)),e.$set(s)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){$(e.$$.fragment,i),t=!1},d(i){N(e,i)}}}function rr(n,e,r){let{$$slots:t={},$$scope:o}=e,{id:l=Rn("symbol")}=e,{source:i=void 0}=e,{sourceLayer:a=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:f=void 0}=e,{paint:u=void 0}=e,{layout:d=void 0}=e,{filter:c=void 0}=e,{applyToClusters:m=void 0}=e,{minzoom:p=void 0}=e,{maxzoom:y=void 0}=e,{hoverCursor:E=void 0}=e,{manageHoverState:k=!1}=e,{hovered:h=null}=e,{eventsIfTopMost:O=!1}=e,{interactive:j=!0}=e;function A(M){h=M,r(0,h)}function C(M){be.call(this,n,M)}function z(M){be.call(this,n,M)}function q(M){be.call(this,n,M)}function B(M){be.call(this,n,M)}function W(M){be.call(this,n,M)}function Z(M){be.call(this,n,M)}return n.$$set=M=>{"id"in M&&r(1,l=M.id),"source"in M&&r(2,i=M.source),"sourceLayer"in M&&r(3,a=M.sourceLayer),"beforeId"in M&&r(4,s=M.beforeId),"beforeLayerType"in M&&r(5,f=M.beforeLayerType),"paint"in M&&r(6,u=M.paint),"layout"in M&&r(7,d=M.layout),"filter"in M&&r(8,c=M.filter),"applyToClusters"in M&&r(9,m=M.applyToClusters),"minzoom"in M&&r(10,p=M.minzoom),"maxzoom"in M&&r(11,y=M.maxzoom),"hoverCursor"in M&&r(12,E=M.hoverCursor),"manageHoverState"in M&&r(13,k=M.manageHoverState),"hovered"in M&&r(0,h=M.hovered),"eventsIfTopMost"in M&&r(14,O=M.eventsIfTopMost),"interactive"in M&&r(15,j=M.interactive),"$$scope"in M&&r(24,o=M.$$scope)},[h,l,i,a,s,f,u,d,c,m,p,y,E,k,O,j,t,A,C,z,q,B,W,Z,o]}class tt extends le{constructor(e){super(),ie(this,e,rr,nr,re,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}const or=n=>({}),at=n=>({}),lr=n=>({}),ut=n=>({});function ir(n){let e,r,t,o;const l=n[3].sidebar,i=Ie(l,n,n[2],ut),a=n[3].map,s=Ie(a,n,n[2],at);return{c(){e=b("div"),i&&i.c(),r=L(),t=b("div"),s&&s.c()},m(f,u){v(f,e,u),i&&i.m(e,null),n[4](e),v(f,r,u),v(f,t,u),s&&s.m(t,null),n[5](t),o=!0},p(f,[u]){i&&i.p&&(!o||u&4)&&Ne(i,l,f,f[2],o?De(l,f[2],u,lr):Ee(f[2]),ut),s&&s.p&&(!o||u&4)&&Ne(s,a,f,f[2],o?De(a,f[2],u,or):Ee(f[2]),at)},i(f){o||(_(i,f),_(s,f),o=!0)},o(f){$(i,f),$(s,f),o=!1},d(f){f&&(w(e),w(r),w(t)),i&&i.d(f),n[4](null),s&&s.d(f),n[5](null)}}}function sr(n,e,r){let t,o;x(n,ot,f=>r(0,t=f)),x(n,lt,f=>r(1,o=f));let{$$slots:l={},$$scope:i}=e;function a(f){oe[f?"unshift":"push"](()=>{t=f,ot.set(t)})}function s(f){oe[f?"unshift":"push"](()=>{o=f,lt.set(o)})}return n.$$set=f=>{"$$scope"in f&&r(2,i=f.$$scope)},[t,o,i,l,a,s]}class Me extends le{constructor(e){super(),ie(this,e,sr,ir,re,{})}}let ot=Ve(null),lt=Ve(null);const Mn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAACmlBMVEXo6uzn6e3o6u7n6ezn6uzm6Ozn6evo6ezm6evo6e3p6u7p6+3p6u3o6u3n6u3n6evn6evn6ezo6uzo6u3n6evn6ezn6ezn6ezn6ezn6ezn6ezn6ezn6ezo6uzo6uzo6u3n6ezn6ezn6ezn6ezn6ezn6ezn6ezo6+3n6ezn6ezn6u3o6u3o6u3o6u3o6u3o6u3o6u3o6u3o6u3o6u3n6ezn6ezn6e3n6e3o6u3o6u3o6u3o6u3o6u3o6u3o6u3o6u3o6u3o6u3o6u3o6u3o6e3o6u3o6uzo6uzo6u3o6u3o6u3n6u3n6ezn6ezn6ezn6ezn6ezn6ezn6ezn6ezn6uzn6ezn6e3o6u3o6u3o6u3o6u3o6u3n6u3n6ezo6u3o6u3o6uzn6uzn6ezo6ezo6uzn6ezo6u3o6u3o6u3n6u3n6Ozm6ezn6ezo6u3o6u3o6uzo6u3n6u3o6e3o6u3o6u3o6u3n6u3n6ezo6uzo6u3o6u3n6+3o6uzo6u3o6u3o6uzo6uzn6uzn6uzn6ezn6ezn6ezn6ezo6u3n6ezo6ezn6ezn6ezn6ezn6ezn6e3o6u3o6e3n6ezn6ezo6uzn6evo6uzo6uzn6evn6ezo6u3n6ezn6uzo6u3n6ezn6ezo6u3n6u3n6ezo6u3o6u3n6ezn6u3o6u3o6u3n6ezo6u3n6u3n6ezn6ezo6u3n6ezo6u3n6e3n6uzn6ezn6ezn6ezn6ezn6ezn6ezo6u3o6u3n6ezn6ezo6u3o6e3o6u3n6e3o6u3n6u3n6uzo6u3o6u3o6u3o6u3o6u3o6u3o6u3n6ezn6evo6u3o6u3o6u3n6uvn6ezo6u3n6uzn6ezn6ezn6ezo6u3n6uzn6uzo6u3n6u3n6uzo6+zm6uzjK5F0AAAA3nRSTlMAAAAAAAAAAAAAAAAAAAAIDxIUFBMDKEVdbn2IjpOWlpCJb15HKgUACXqjwtrt/P/u3MSmSg0gc7vz4dnSz83U5fT3vnciCnPV8MCdg2JYUk5LU1pmdoyoy/rYdApBt31IIyMjIyyI0LY/AABh366lq19s6GnraXg8PHsAAwOEeF0MKiEiCymqnFmeqXsncN6sOTuuDYzPTlCJCHhyOjyxcGfmkhotgqFcrYIrHONkymEKEC8mLg9jzMhNmr1XVVi/mCSz79ddrI6v3FooDSsAQ6OCFReFoi48GTwtAAD3GpCFAAADBklEQVR4nKWUh1IUQRCGZ+nx8JRZMcspoiKekfbMomDABAaSCbNwxhPMgmLOCTFnxZxzzlkxY86+i927BxzeUmWVf+1O1c5+09Pd09NCaJoWAFJCOQAb0GuzQSAPAOXppVlhD6hQMUgIJpUECUxpviCAxoOuKlRUShikMmYMk5WCK1epWi24UgloDwhSBOqKSTtNVa9Rs1aIo3ad0LphofXqOxqEN4xoxLDBKaGcTiU0pRo3bNK0WfMWkehVZEtXq9aONm1Ne0oXQHuT0XbtO3Sk3y2jOnWOjomJ7tK8azf67B7boydTJMFeBIpevftgXHzffiH9ByQkJiUlJqcMHDR4yNBUHDZ8hG5IlCMBjByF0aPHjE1Loyfd7U5Lc7vd6eOSx0/AiZN0jSUmTyaTnikZmDnVQtPQNZ0ou10JMy8zWmAZmjmLIyeLdkMExloKZ8/x+lgEpmZlz/XXvMjZc3IM+YA2ofxkDVqQ/wn+69bzF/jLClxoqUi/9JSVcD+LGGUpfzB10WILzfPfmqKGJUuXcXkaguURK0BYgysdq1avCTRQCSlr163PVdbghjzEjZvoflJJbd6C6ArRLcGt2yjI7TvMq7qzM33s2u0DFtVj6h7YG4WYuY8sKoD9+YgZB2A9gdKQFzx4CA8fOXos8/gJ8+g0CD9+8tTpM2F49hyAAZotYedQPH/h4qXLV6D4mHOvXltx/QbevMX/PR4vmHsb8U7W3XuldD/rAeLDR5wrqixza0h+jPjk6V+KQ8xPgKLUeslneVYn7Uqhm2UD7lFgNizFYMHzUnqB+PIVJ4uyYGdQY98ZXPX6jY/eFpggo+yjt64NsIZPceuni0GW6WehzfbufXzsh48l2ZGeT59j47+MNHowg4WFheahff327Ts5UwQScCT7x0/JfYdbrDA8oBauSUkhUUP1ngx4aJEOimbNJsVBM6dLyUFpmtcesHFdCiWVMkGbzNFB1xWBupPnDFzzcDJotXJKJ22kCeJyqFupXyaoVCAw+JuzrGi5cOqSurf2B4tMU69Bi01ZAAAAAElFTkSuQmCC";function ke(){return["","2","1","0","Critical"]}let Ce=["#66C5CC","#F6CF71","#F89C74","#DCB0F2","#87C55F","#9EB9F3","#FE88B1","#C9DB74","#8BE0A4","#B497E7","#D3B484","#B3B3B3"];function ar(n){let e,r;const t=n[4].default,o=Ie(t,n,n[6],null);return{c(){e=b("span"),o&&o.c(),P(e,"class","dot svelte-117v9mi"),Ue(e,"outline",n[3]),Y(e,"background-color",n[3]?void 0:n[1]),Y(e,"border-color",n[3]?n[1]:void 0),Y(e,"width",n[2]),Y(e,"height",n[2])},m(l,i){v(l,e,i),o&&o.m(e,null),r=!0},p(l,i){o&&o.p&&(!r||i&64)&&Ne(o,t,l,l[6],r?De(t,l[6],i,null):Ee(l[6]),null),(!r||i&8)&&Ue(e,"outline",l[3]),i&10&&Y(e,"background-color",l[3]?void 0:l[1]),i&10&&Y(e,"border-color",l[3]?l[1]:void 0),i&4&&Y(e,"width",l[2]),i&4&&Y(e,"height",l[2])},i(l){r||(_(o,l),r=!0)},o(l){$(o,l),r=!1},d(l){l&&w(e),o&&o.d(l)}}}function ur(n){let e,r,t;function o(i){n[5](i)}let l={draggable:!0,$$slots:{default:[ar]},$$scope:{ctx:n}};return n[0]!==void 0&&(l.lngLat=n[0]),e=new Be({props:l}),oe.push(()=>fe(e,"lngLat",o)),{c(){T(e.$$.fragment)},m(i,a){I(e,i,a),t=!0},p(i,[a]){const s={};a&78&&(s.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,s.lngLat=i[0],de(()=>r=!1)),e.$set(s)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){$(e.$$.fragment,i),t=!1},d(i){N(e,i)}}}function cr(n,e,r){let{$$slots:t={},$$scope:o}=e,{lngLat:l}=e,{color:i}=e,{radius:a="30px"}=e,{outline:s=!1}=e;function f(u){l=u,r(0,l)}return n.$$set=u=>{"lngLat"in u&&r(0,l=u.lngLat),"color"in u&&r(1,i=u.color),"radius"in u&&r(2,a=u.radius),"outline"in u&&r(3,s=u.outline),"$$scope"in u&&r(6,o=u.$$scope)},[l,i,a,s,t,f,o]}class it extends le{constructor(e){super(),ie(this,e,cr,ur,re,{lngLat:0,color:1,radius:2,outline:3})}}function ct(n,e,r){const t=n.slice();return t[10]=e[r][0],t[11]=e[r][1],t}function ft(n,e,r){const t=n.slice();return t[10]=e[r][0],t[11]=e[r][1],t}function fr(n){let e,r,t,o,l,i,a=Q(n[3]),s=[];for(let f=0;f<a.length;f+=1)s[f]=dt(ct(n,a,f));return{c(){e=b("label"),r=R(n[2]),t=L(),o=b("select");for(let f=0;f<s.length;f+=1)s[f].c();n[0]===void 0&&Hn(()=>n[9].call(o))},m(f,u){v(f,e,u),g(e,r),g(e,t),g(e,o);for(let d=0;d<s.length;d+=1)s[d]&&s[d].m(o,null);st(o,n[0],!0),l||(i=[J(o,"change",n[9]),J(o,"change",n[6])],l=!0)},p(f,u){if(u&4&&se(r,f[2]),u&8){a=Q(f[3]);let d;for(d=0;d<a.length;d+=1){const c=ct(f,a,d);s[d]?s[d].p(c,u):(s[d]=dt(c),s[d].c(),s[d].m(o,null))}for(;d<s.length;d+=1)s[d].d(1);s.length=a.length}u&9&&st(o,f[0])},d(f){f&&w(e),me(s,f),l=!1,$e(i)}}}function dr(n){let e,r,t,o,l=Q(n[3]),i=[];for(let a=0;a<l.length;a+=1)i[a]=mt(ft(n,l,a));return{c(){e=b("fieldset"),r=R(n[2]),t=L(),o=b("div");for(let a=0;a<i.length;a+=1)i[a].c();P(o,"class","svelte-1vb210n"),Ue(o,"horiz_radio",n[1]=="horiz-radio")},m(a,s){v(a,e,s),g(e,r),g(e,t),g(e,o);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(o,null)},p(a,s){if(s&4&&se(r,a[2]),s&9){l=Q(a[3]);let f;for(f=0;f<l.length;f+=1){const u=ft(a,l,f);i[f]?i[f].p(u,s):(i[f]=mt(u),i[f].c(),i[f].m(o,null))}for(;f<i.length;f+=1)i[f].d(1);i.length=l.length}s&2&&Ue(o,"horiz_radio",a[1]=="horiz-radio")},d(a){a&&w(e),me(i,a)}}}function dt(n){let e,r=n[11]+"",t;return{c(){e=b("option"),t=R(r),e.__value=n[10],_e(e,e.__value)},m(o,l){v(o,e,l),g(e,t)},p:te,d(o){o&&w(e)}}}function mt(n){let e,r,t,o=n[11]+"",l,i,a,s,f;return a=Kn(n[8][0]),{c(){e=b("label"),r=b("input"),t=L(),l=R(o),i=L(),P(r,"type","radio"),r.__value=n[10],_e(r,r.__value),a.p(r)},m(u,d){v(u,e,d),g(e,r),r.checked=r.__value===n[0],g(e,t),g(e,l),g(e,i),s||(f=[J(r,"change",n[7]),J(r,"change",n[5])],s=!0)},p(u,d){d&9&&(r.checked=r.__value===u[0])},d(u){u&&w(e),a.r(),s=!1,$e(f)}}}function mr(n){let e;function r(l,i){if(l[1]=="horiz-radio"||l[1]=="vert-radio")return dr;if(l[1]=="dropdown")return fr}let t=r(n),o=t&&t(n);return{c(){o&&o.c(),e=Ge()},m(l,i){o&&o.m(l,i),v(l,e,i)},p(l,[i]){t===(t=r(l))&&o?o.p(l,i):(o&&o.d(1),o=t&&t(l),o&&(o.c(),o.m(e.parentNode,e)))},i:te,o:te,d(l){l&&w(e),o&&o.d(l)}}}function pr(n,e,r){let{k:t}=e,{label:o}=e,{value:l}=e,{choices:i}=e,a=i[0].length==2?i:i.map(m=>[m,m]);const s=[[]];function f(m){be.call(this,n,m)}function u(m){be.call(this,n,m)}function d(){l=this.__value,r(0,l),r(3,a)}function c(){l=Gn(this),r(0,l),r(3,a)}return n.$$set=m=>{"k"in m&&r(1,t=m.k),"label"in m&&r(2,o=m.label),"value"in m&&r(0,l=m.value),"choices"in m&&r(4,i=m.choices)},[l,t,o,a,i,f,u,d,s,c]}class ze extends le{constructor(e){super(),ie(this,e,pr,mr,re,{k:1,label:2,value:0,choices:4})}}let Re=Ve(void 0),U=Ve(gr());function ne(n){return{type:"FeatureCollection",features:n}}let K=Ve({kind:"neutral"});function gr(){try{let n=JSON.parse(window.localStorage.getItem("tmp-rcv2")||"");if("links"in n&&"jats"in n&&"crossings"in n&&"side_roads"in n)return n}catch{}return{links:[],jats:[],bus_stops:[],crossings:[],side_roads:[]}}function pt(n){let e,r;return e=new ge({props:{data:ne(n[2].links),$$slots:{default:[_r]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&4&&(l.data=ne(t[2].links)),o&10&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function _r(n){let e,r;return e=new Ae({props:{paint:{"line-color":n[1]?["get","color"]:"black","line-width":6}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&2&&(l.paint={"line-color":t[1]?["get","color"]:"black","line-width":6}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function gt(n){let e,r;return e=new ge({props:{data:ne(n[2].bus_stops),$$slots:{default:[hr]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&4&&(l.data=ne(t[2].bus_stops)),o&8&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function hr(n){let e,r;return e=new tt({props:{layout:{"icon-image":"bus_stop","icon-size":3},paint:{"icon-color":"black"}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p:te,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function _t(n){let e,r;return e=new ge({props:{data:ne(n[2].crossings),$$slots:{default:[$r]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&4&&(l.data=ne(t[2].crossings)),o&8&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function $r(n){let e,r;return e=new Se({props:{paint:{"circle-color":"black","circle-radius":10}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p:te,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function ht(n){let e,r;return e=new ge({props:{data:ne(n[2].jats),$$slots:{default:[kr]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&4&&(l.data=ne(t[2].jats)),o&8&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function kr(n){let e,r;return e=new Se({props:{paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":"black","circle-radius":20}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p:te,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function $t(n){let e,r;return e=new ge({props:{data:ne(n[2].side_roads),$$slots:{default:[br]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&4&&(l.data=ne(t[2].side_roads)),o&8&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function br(n){let e,r;return e=new Ae({props:{paint:{"line-color":"black","line-width":3}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p:te,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function vr(n){let e,r,t,o,l,i,a=n[0]!="links"&&pt(n),s=n[0]!="bus_stops"&&gt(n),f=n[0]!="crossings"&&_t(n),u=n[0]!="jats"&&ht(n),d=n[0]!="side_roads"&&$t(n);return{c(){a&&a.c(),e=L(),s&&s.c(),r=L(),f&&f.c(),t=L(),u&&u.c(),o=L(),d&&d.c(),l=Ge()},m(c,m){a&&a.m(c,m),v(c,e,m),s&&s.m(c,m),v(c,r,m),f&&f.m(c,m),v(c,t,m),u&&u.m(c,m),v(c,o,m),d&&d.m(c,m),v(c,l,m),i=!0},p(c,[m]){c[0]!="links"?a?(a.p(c,m),m&1&&_(a,1)):(a=pt(c),a.c(),_(a,1),a.m(e.parentNode,e)):a&&(ae(),$(a,1,1,()=>{a=null}),ue()),c[0]!="bus_stops"?s?(s.p(c,m),m&1&&_(s,1)):(s=gt(c),s.c(),_(s,1),s.m(r.parentNode,r)):s&&(ae(),$(s,1,1,()=>{s=null}),ue()),c[0]!="crossings"?f?(f.p(c,m),m&1&&_(f,1)):(f=_t(c),f.c(),_(f,1),f.m(t.parentNode,t)):f&&(ae(),$(f,1,1,()=>{f=null}),ue()),c[0]!="jats"?u?(u.p(c,m),m&1&&_(u,1)):(u=ht(c),u.c(),_(u,1),u.m(o.parentNode,o)):u&&(ae(),$(u,1,1,()=>{u=null}),ue()),c[0]!="side_roads"?d?(d.p(c,m),m&1&&_(d,1)):(d=$t(c),d.c(),_(d,1),d.m(l.parentNode,l)):d&&(ae(),$(d,1,1,()=>{d=null}),ue())},i(c){i||(_(a),_(s),_(f),_(u),_(d),i=!0)},o(c){$(a),$(s),$(f),$(u),$(d),i=!1},d(c){c&&(w(e),w(r),w(t),w(o),w(l)),a&&a.d(c),s&&s.d(c),f&&f.d(c),u&&u.d(c),d&&d.d(c)}}}function wr(n,e,r){let t;x(n,U,i=>r(2,t=i));let{except:o}=e,{showLinkColor:l=!1}=e;return n.$$set=i=>{"except"in i&&r(0,o=i.except),"showLinkColor"in i&&r(1,l=i.showLinkColor)},[o,l,t]}class Fe extends le{constructor(e){super(),ie(this,e,wr,vr,re,{except:0,showLinkColor:1})}}const{window:yr}=He;function jr(n){let e,r,t,o,l,i,a,s,f,u,d,c,m,p;function y(k){n[8](k)}let E={k:"horiz-radio",label:"ST20: bus stops",choices:ke()};return n[1].bus_stops[n[0]].properties.st20!==void 0&&(E.value=n[1].bus_stops[n[0]].properties.st20),u=new ze({props:E}),oe.push(()=>fe(u,"value",y)),{c(){e=b("div"),r=b("button"),r.textContent="Done",t=L(),o=b("button"),o.textContent="Delete bus stop",l=L(),i=b("label"),a=R(`Name:
      `),s=b("input"),f=L(),T(u.$$.fragment),P(s,"type","text"),P(e,"slot","sidebar")},m(k,h){v(k,e,h),g(e,r),g(e,t),g(e,o),g(e,l),g(e,i),g(i,a),g(i,s),_e(s,n[1].bus_stops[n[0]].properties.name),g(e,f),I(u,e,null),c=!0,m||(p=[J(r,"click",n[6]),J(o,"click",n[4]),J(s,"input",n[7])],m=!0)},p(k,h){h&3&&s.value!==k[1].bus_stops[k[0]].properties.name&&_e(s,k[1].bus_stops[k[0]].properties.name);const O={};!d&&h&3&&(d=!0,O.value=k[1].bus_stops[k[0]].properties.st20,de(()=>d=!1)),u.$set(O)},i(k){c||(_(u.$$.fragment,k),c=!0)},o(k){$(u.$$.fragment,k),c=!1},d(k){k&&w(e),N(u),m=!1,$e(p)}}}function Cr(n){let e,r;return e=new tt({props:{filter:["!=",["id"],n[0]],layout:{"icon-image":"bus_stop","icon-size":3},paint:{"icon-color":"black"}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&1&&(l.filter=["!=",["id"],t[0]]),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function Ar(n){let e,r;return{c(){e=b("img"),xe(e.src,r=Mn)||P(e,"src",r)},m(t,o){v(t,e,o)},p:te,d(t){t&&w(e)}}}function zr(n){let e,r,t,o,l,i,a,s;r=new Fe({props:{except:"bus_stops"}}),o=new ge({props:{data:ne(n[1].bus_stops),generateId:!0,$$slots:{default:[Cr]},$$scope:{ctx:n}}});function f(d){n[5](d)}let u={color:n[1].bus_stops[n[0]].properties.color,$$slots:{default:[Ar]},$$scope:{ctx:n}};return n[1].bus_stops[n[0]].geometry.coordinates!==void 0&&(u.lngLat=n[1].bus_stops[n[0]].geometry.coordinates),i=new it({props:u}),oe.push(()=>fe(i,"lngLat",f)),{c(){e=b("div"),T(r.$$.fragment),t=L(),T(o.$$.fragment),l=L(),T(i.$$.fragment),P(e,"slot","map")},m(d,c){v(d,e,c),I(r,e,null),g(e,t),I(o,e,null),g(e,l),I(i,e,null),s=!0},p(d,c){const m={};c&2&&(m.data=ne(d[1].bus_stops)),c&513&&(m.$$scope={dirty:c,ctx:d}),o.$set(m);const p={};c&3&&(p.color=d[1].bus_stops[d[0]].properties.color),c&512&&(p.$$scope={dirty:c,ctx:d}),!a&&c&3&&(a=!0,p.lngLat=d[1].bus_stops[d[0]].geometry.coordinates,de(()=>a=!1)),i.$set(p)},i(d){s||(_(r.$$.fragment,d),_(o.$$.fragment,d),_(i.$$.fragment,d),s=!0)},o(d){$(r.$$.fragment,d),$(o.$$.fragment,d),$(i.$$.fragment,d),s=!1},d(d){d&&w(e),N(r),N(o),N(i)}}}function Lr(n){let e,r,t,o;return e=new Me({props:{$$slots:{map:[zr],sidebar:[jr]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},m(l,i){I(e,l,i),r=!0,t||(o=J(yr,"keydown",n[3]),t=!0)},p(l,[i]){const a={};i&519&&(a.$$scope={dirty:i,ctx:l}),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){$(e.$$.fragment,l),r=!1},d(l){N(e,l),t=!1,o()}}}function Sr(n,e,r){let t,o;x(n,U,c=>r(1,t=c)),x(n,K,c=>r(2,o=c));let{idx:l}=e;function i(c){c.key=="Escape"&&G(K,o={kind:"neutral"},o)}async function a(){window.confirm("Really delete this bus stop?")&&(G(K,o={kind:"neutral"},o),await qe(),t.bus_stops.splice(l,1),U.set(t))}function s(c){n.$$.not_equal(t.bus_stops[l].geometry.coordinates,c)&&(t.bus_stops[l].geometry.coordinates=c,U.set(t))}const f=()=>G(K,o={kind:"neutral"},o);function u(){t.bus_stops[l].properties.name=this.value,U.set(t)}function d(c){n.$$.not_equal(t.bus_stops[l].properties.st20,c)&&(t.bus_stops[l].properties.st20=c,U.set(t))}return n.$$set=c=>{"idx"in c&&r(0,l=c.idx)},[l,t,o,i,a,s,f,u,d]}class Mr extends le{constructor(e){super(),ie(this,e,Sr,Lr,re,{idx:0})}}const{window:Tr}=He;function Ir(n){let e,r,t,o,l,i,a,s,f,u,d,c,m,p;function y(k){n[8](k)}let E={k:"horiz-radio",label:"SA10: pedestrian crossing speed",choices:ke()};return n[1].crossings[n[0]].properties.sa10!==void 0&&(E.value=n[1].crossings[n[0]].properties.sa10),u=new ze({props:E}),oe.push(()=>fe(u,"value",y)),{c(){e=b("div"),r=b("button"),r.textContent="Done",t=L(),o=b("button"),o.textContent="Delete crossing",l=L(),i=b("label"),a=R(`Name:
      `),s=b("input"),f=L(),T(u.$$.fragment),P(s,"type","text"),P(e,"slot","sidebar")},m(k,h){v(k,e,h),g(e,r),g(e,t),g(e,o),g(e,l),g(e,i),g(i,a),g(i,s),_e(s,n[1].crossings[n[0]].properties.name),g(e,f),I(u,e,null),c=!0,m||(p=[J(r,"click",n[6]),J(o,"click",n[4]),J(s,"input",n[7])],m=!0)},p(k,h){h&3&&s.value!==k[1].crossings[k[0]].properties.name&&_e(s,k[1].crossings[k[0]].properties.name);const O={};!d&&h&3&&(d=!0,O.value=k[1].crossings[k[0]].properties.sa10,de(()=>d=!1)),u.$set(O)},i(k){c||(_(u.$$.fragment,k),c=!0)},o(k){$(u.$$.fragment,k),c=!1},d(k){k&&w(e),N(u),m=!1,$e(p)}}}function Nr(n){let e,r;return e=new Se({props:{filter:["!=",["id"],n[0]],paint:{"circle-color":"black","circle-radius":10}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&1&&(l.filter=["!=",["id"],t[0]]),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function Er(n){let e,r,t,o,l,i,a,s;r=new Fe({props:{except:"crossings"}}),o=new ge({props:{data:ne(n[1].crossings),generateId:!0,$$slots:{default:[Nr]},$$scope:{ctx:n}}});function f(d){n[5](d)}let u={color:n[1].crossings[n[0]].properties.color};return n[1].crossings[n[0]].geometry.coordinates!==void 0&&(u.lngLat=n[1].crossings[n[0]].geometry.coordinates),i=new it({props:u}),oe.push(()=>fe(i,"lngLat",f)),{c(){e=b("div"),T(r.$$.fragment),t=L(),T(o.$$.fragment),l=L(),T(i.$$.fragment),P(e,"slot","map")},m(d,c){v(d,e,c),I(r,e,null),g(e,t),I(o,e,null),g(e,l),I(i,e,null),s=!0},p(d,c){const m={};c&2&&(m.data=ne(d[1].crossings)),c&513&&(m.$$scope={dirty:c,ctx:d}),o.$set(m);const p={};c&3&&(p.color=d[1].crossings[d[0]].properties.color),!a&&c&3&&(a=!0,p.lngLat=d[1].crossings[d[0]].geometry.coordinates,de(()=>a=!1)),i.$set(p)},i(d){s||(_(r.$$.fragment,d),_(o.$$.fragment,d),_(i.$$.fragment,d),s=!0)},o(d){$(r.$$.fragment,d),$(o.$$.fragment,d),$(i.$$.fragment,d),s=!1},d(d){d&&w(e),N(r),N(o),N(i)}}}function Dr(n){let e,r,t,o;return e=new Me({props:{$$slots:{map:[Er],sidebar:[Ir]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},m(l,i){I(e,l,i),r=!0,t||(o=J(Tr,"keydown",n[3]),t=!0)},p(l,[i]){const a={};i&519&&(a.$$scope={dirty:i,ctx:l}),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){$(e.$$.fragment,l),r=!1},d(l){N(e,l),t=!1,o()}}}function qr(n,e,r){let t,o;x(n,U,c=>r(1,t=c)),x(n,K,c=>r(2,o=c));let{idx:l}=e;function i(c){c.key=="Escape"&&G(K,o={kind:"neutral"},o)}async function a(){window.confirm("Really delete this crossing?")&&(G(K,o={kind:"neutral"},o),await qe(),t.crossings.splice(l,1),U.set(t))}function s(c){n.$$.not_equal(t.crossings[l].geometry.coordinates,c)&&(t.crossings[l].geometry.coordinates=c,U.set(t))}const f=()=>G(K,o={kind:"neutral"},o);function u(){t.crossings[l].properties.name=this.value,U.set(t)}function d(c){n.$$.not_equal(t.crossings[l].properties.sa10,c)&&(t.crossings[l].properties.sa10=c,U.set(t))}return n.$$set=c=>{"idx"in c&&r(0,l=c.idx)},[l,t,o,i,a,s,f,u,d]}class Fr extends le{constructor(e){super(),ie(this,e,qr,Dr,re,{idx:0})}}let kt="MZEJTanw3WpxRvt7qDfo";async function Pr(n){return n?{version:8,sources:{"raster-tiles":{type:"raster",tiles:[`https://tile.googleapis.com/v1/2dtiles/{z}/{x}/{y}?session=${await Or(n)}&key=${n}`],tileSize:256,attribution:"Google (detailed attributions not wired up)"}},layers:[{id:"raster-basemap",type:"raster",source:"raster-tiles"}],glyphs:`https://api.maptiler.com/fonts/{fontstack}/{range}.pbf?key=${kt}`}:`https://api.maptiler.com/maps/dataviz/style.json?key=${kt}`}async function Or(n){try{let r=await(await fetch(`https://tile.googleapis.com/v1/createSession?key=${n}`,{method:"POST",body:JSON.stringify({mapType:"satellite",language:"en-GB",region:"GB"})})).json();return"session"in r?r.session:(console.error(`Couldn't get Google tile session key: ${JSON.stringify(r)}`),"")}catch(e){return console.error(`Couldn't get Google tile session key: ${e}`),""}}const Br="/route-element/assets/right-arrow-d8c7892c.svg";function bt(n){let e,r;const t=n[4].default,o=Ie(t,n,n[3],null);return{c(){e=b("div"),o&&o.c(),P(e,"class","section svelte-zax3q3")},m(l,i){v(l,e,i),o&&o.m(e,null),r=!0},p(l,i){o&&o.p&&(!r||i&8)&&Ne(o,t,l,l[3],r?De(t,l[3],i,null):Ee(l[3]),null)},i(l){r||(_(o,l),r=!0)},o(l){$(o,l),r=!1},d(l){l&&w(e),o&&o.d(l)}}}function Ur(n){let e,r,t,o,l,i,a,s,f,u,d,c,m=n[2]&&bt(n);return{c(){e=b("button"),r=b("div"),t=b("span"),o=R(n[0]),l=L(),i=b("img"),f=L(),m&&m.c(),P(i,"class","arrow svelte-zax3q3"),xe(i.src,a=Br)||P(i,"src",a),P(i,"alt",s="Select "+n[0]),P(r,"class","top-section section svelte-zax3q3"),Ue(r,"bordered",n[2]),P(e,"class","clickable-card svelte-zax3q3"),e.disabled=n[1]},m(p,y){v(p,e,y),g(e,r),g(r,t),g(t,o),g(r,l),g(r,i),g(e,f),m&&m.m(e,null),u=!0,d||(c=[J(e,"click",n[5]),J(e,"mouseenter",n[6]),J(e,"mouseleave",n[7])],d=!0)},p(p,[y]){(!u||y&1)&&se(o,p[0]),(!u||y&1&&s!==(s="Select "+p[0]))&&P(i,"alt",s),(!u||y&4)&&Ue(r,"bordered",p[2]),p[2]?m?(m.p(p,y),y&4&&_(m,1)):(m=bt(p),m.c(),_(m,1),m.m(e,null)):m&&(ae(),$(m,1,1,()=>{m=null}),ue()),(!u||y&2)&&(e.disabled=p[1])},i(p){u||(_(m),u=!0)},o(p){$(m),u=!1},d(p){p&&w(e),m&&m.d(),d=!1,$e(c)}}}function Jr(n,e,r){let{$$slots:t={},$$scope:o}=e,{name:l}=e,{disabled:i=!1}=e,{hasSlot:a=!0}=e;function s(d){be.call(this,n,d)}function f(d){be.call(this,n,d)}function u(d){be.call(this,n,d)}return n.$$set=d=>{"name"in d&&r(0,l=d.name),"disabled"in d&&r(1,i=d.disabled),"hasSlot"in d&&r(2,a=d.hasSlot),"$$scope"in d&&r(3,o=d.$$scope)},[l,i,a,o,t,s,f,u]}class Tn extends le{constructor(e){super(),ie(this,e,Jr,Ur,re,{name:0,disabled:1,hasSlot:2})}}let Le={critical:{background:"#232323",font:"white"},red:{background:"#b73d25",font:"white"},amber:{background:"#ffd833",font:"black"},green:{background:"#006853",font:"white"},notApplicable:{background:"white",font:"black"}};const Rr=n=>({dialog:n&1}),vt=n=>({dialog:n[0]});function Gr(n){let e,r,t,o,l;const i=n[4].default,a=Ie(i,n,n[3],vt);return{c(){e=b("dialog"),r=b("article"),a&&a.c(),e.open=!0},m(s,f){v(s,e,f),g(e,r),a&&a.m(r,null),n[6](e),t=!0,o||(l=[J(window,"click",n[1]),J(window,"keydown",n[2]),J(e,"close",n[5])],o=!0)},p(s,[f]){a&&a.p&&(!t||f&9)&&Ne(a,i,s,s[3],t?De(i,s[3],f,Rr):Ee(s[3]),vt)},i(s){t||(_(a,s),t=!0)},o(s){$(a,s),t=!1},d(s){s&&w(e),a&&a.d(s),n[6](null),o=!1,$e(l)}}}function Hr(n,e,r){let{$$slots:t={},$$scope:o}=e,l;function i(u){l.open&&u.target==l&&l.close()}function a(u){(u.key=="Escape"||u.key=="Enter")&&(u.stopPropagation(),l.close())}function s(u){be.call(this,n,u)}function f(u){oe[u?"unshift":"push"](()=>{l=u,r(0,l)})}return n.$$set=u=>{"$$scope"in u&&r(3,o=u.$$scope)},[l,i,a,o,t,s,f]}class In extends le{constructor(e){super(),ie(this,e,Hr,Gr,re,{})}}function Kr(n,e){let r=document.createElement("a");r.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),r.setAttribute("download",n),document.body.appendChild(r),r.click(),document.body.removeChild(r)}const Pe={"Any type of junction":{"All movements":{scoreZero:["Cycle movement in potential conflict with heavy motor traffic flow.","Cycle movement mixed with or crossing traffic with 85th percentile speed exceeding 60kph, or where vehicles accelerate rapidly.","Necessary to cross more than one traffic lane (without refuge or protection) to complete cycle movement unless traffic flows are low.","Cycle movement crosses wide junction entry or exit: e.g. with merge or diverge taper or slip lane.","Pinch points on junction entry or exit (lane width 3.2m-3.9m).","Cycle movement affected by very poor surface quality utility reinstatement, gully positioning, debris."],scoreOne:["Cycle movement in potential conflict with moderate traffic flow.","Cycle lanes through junction meeting appropriate desirable minimum width requirements for the movement under consideration.","Raised table at junction crossed by traffic in potential conflict with cycle movement.","Cycle movement made by transiting onto section of shared use footway."],scoreTwo:["Low traffic speed and volume in mixed traffic environment (e.g. access-only streets in a residential area).","Cycle movement separated physically and/or in time from motor traffic and also separated from pedestrians.","Cycle movement bypasses junction completely, including via good quality grade separation."]}},"Simple priority T-junction":{"Right turn from minor arm":{scoreZero:["Heavy traffic movements and/or high bus and HGV flows in potential conflict with cycle movement, with no physical refuge in the centre of the major road (including ghost island junction)."],scoreOne:["Central refuge allowing two-stage cycle movement crossing one traffic lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm with dedicated cycle signals or cycle priority."]},"Left turn from major arm":{scoreZero:[],scoreOne:["Side road entry treatment (table across minor arm)."],scoreTwo:["Continuous footway and cycle track across minor arm."]},"Right turn from major arm":{scoreZero:["Heavy traffic movements and/or high bus and HGV flows in potential conflict with no physical refuge in the centre of major road (including ghost island junction)."],scoreOne:["Protected turning refuge allowing two stage cycle movement, crossing one lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm via dedicated cycle signals or cycle priority."]},"Ahead on major arm, crossing minor arm":{scoreZero:["Congested conditions causing poor visibility for right-turning motor vehicles from major arm.","Junction corner radius ≥9m, including where off-carriageway cycle track crosses minor arm."],scoreOne:["Junction free from queueing traffic and cycle lane on major arm meeting desirable minimum width requirements.","Junction corner radius <9m, including where off-carriageway cycle track crosses minor arm without priority.","Side road entry treatment (table across minor arm)."],scoreTwo:["Off-carriageway cycle track or stepped cycle track alongside major arm, crossing minor arm with priority over turning traffic."]}},Crossroads:{"Ahead from minor arm":{scoreZero:["Heavy opposing traffic movements with no physical refuge (including ghost island junction)."],scoreOne:["Protected pocket refuge for ahead cycles allowing two stage movement, crossing one lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm via dedicated cycle signals or cycle priority."]}},"Traffic Signals":{"All movements":{scoreZero:["Single or multiple queuing lanes with no cycle lanes or tracks on approaches.","Junctions with unsignalised left turn merge/diverge and signalised ahead lanes."],scoreOne:["Advance Cycle Stop lines, at least 5m deep and where the signals on the approach are on green for <30% of the cycle time.","Signal timings adjusted to provide extended intergreen to suit cycle movement under consideration.","Cycle/pedestrian scramble (toucan crossings with all-red stage).","Early release for cycles, with enough time to clear junction for cycle movement being considered."],scoreTwo:["Cycle movement has no potential conflict with motor traffic, e.g. dedicated cycle stage, conflicting traffic movement held or banned."]},"Right turn":{scoreZero:[],scoreOne:["Two-stage right turn via ASL or marked area in front of stop line."],scoreTwo:["Two-stage right turn with physically protected waiting area."]}},Roundabout:{"All movements":{scoreZero:["Any type of roundabout with high traffic throughput.","Normal roundabout with multi-lane flared approaches.","Any type of roundabout with annular cycle lane marked on the circulatory carriageway."],scoreOne:["Compact roundabout or raised mini roundabout with no more than moderate traffic throughput","Off-carriageway cycle track with crossings of entries and exits without cycle priority, crossing single traffic lanes with traffic flows < 4000 vehicles per day or 400 HGV/bus flow. "],scoreTwo:["Off-carriageway cycle track with crossings of entries and exits with signals or cycle priority."]}}},Nn=Object.keys(Pe);function et(n){return Object.keys(Pe[n])}const Te="All movements";function wt(n,e){let r=[],t=Pe[n][e];t&&r.push({junctionType:n,movementType:e,...t});let o=Pe[n][Te];if(o&&e!=Te&&r.push({junctionType:n,movementType:Te,...o}),n=="Crossroads"){let l=Pe["Simple priority T-junction"][Te];l&&r.push({junctionType:"Simple priority T-junction",movementType:Te,...l})}if(n!="Any type of junction"){let l=Pe["Any type of junction"][Te];l&&r.push({junctionType:"Any type of junction",movementType:Te,...l})}return r}function yt(n,e,r){const t=n.slice();return t[9]=e[r],t}function jt(n,e,r){const t=n.slice();return t[12]=e[r],t}function Ct(n,e,r){const t=n.slice();return t[12]=e[r],t}function At(n,e,r){const t=n.slice();return t[12]=e[r],t}function zt(n){let e,r;return e=new In({props:{$$slots:{default:[Xr]},$$scope:{ctx:n}}}),e.$on("close",n[8]),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&524295&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function Lt(n){let e,r,t;function o(i){n[6](i)}let l={k:"vert-radio",label:"Type of movement",choices:et(n[1])};return n[2]!==void 0&&(l.value=n[2]),e=new ze({props:l}),oe.push(()=>fe(e,"value",o)),{c(){T(e.$$.fragment)},m(i,a){I(e,i,a),t=!0},p(i,a){const s={};a&2&&(s.choices=et(i[1])),!r&&a&4&&(r=!0,s.value=i[2],de(()=>r=!1)),e.$set(s)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){$(e.$$.fragment,i),t=!1},d(i){N(e,i)}}}function St(n){let e,r=n[12]+"",t;return{c(){e=b("li"),t=R(r)},m(o,l){v(o,e,l),g(e,t)},p(o,l){l&6&&r!==(r=o[12]+"")&&se(t,r)},d(o){o&&w(e)}}}function Mt(n){let e,r=n[12]+"",t;return{c(){e=b("li"),t=R(r)},m(o,l){v(o,e,l),g(e,t)},p(o,l){l&6&&r!==(r=o[12]+"")&&se(t,r)},d(o){o&&w(e)}}}function Tt(n){let e,r=n[12]+"",t;return{c(){e=b("li"),t=R(r)},m(o,l){v(o,e,l),g(e,t)},p(o,l){l&6&&r!==(r=o[12]+"")&&se(t,r)},d(o){o&&w(e)}}}function It(n){let e,r,t=n[9].junctionType+"",o,l,i,a,s,f,u=n[9].movementType+"",d,c,m,p,y,E,k,h,O,j,A,C=Q(n[9].scoreZero),z=[];for(let M=0;M<C.length;M+=1)z[M]=St(At(n,C,M));let q=Q(n[9].scoreOne),B=[];for(let M=0;M<q.length;M+=1)B[M]=Mt(Ct(n,q,M));let W=Q(n[9].scoreTwo),Z=[];for(let M=0;M<W.length;M+=1)Z[M]=Tt(jt(n,W,M));return{c(){e=b("tr"),r=b("td"),o=R(t),l=L(),i=b("br"),a=L(),s=b("br"),f=L(),d=R(u),c=L(),m=b("td"),p=b("ul");for(let M=0;M<z.length;M+=1)z[M].c();y=L(),E=b("td"),k=b("ul");for(let M=0;M<B.length;M+=1)B[M].c();h=L(),O=b("td"),j=b("ul");for(let M=0;M<Z.length;M+=1)Z[M].c();A=L(),P(r,"class","type-row svelte-k4kgn3"),P(m,"class","score-zero svelte-k4kgn3"),P(E,"class","score-one svelte-k4kgn3"),P(O,"class","score-two svelte-k4kgn3")},m(M,H){v(M,e,H),g(e,r),g(r,o),g(r,l),g(r,i),g(r,a),g(r,s),g(r,f),g(r,d),g(e,c),g(e,m),g(m,p);for(let S=0;S<z.length;S+=1)z[S]&&z[S].m(p,null);g(e,y),g(e,E),g(E,k);for(let S=0;S<B.length;S+=1)B[S]&&B[S].m(k,null);g(e,h),g(e,O),g(O,j);for(let S=0;S<Z.length;S+=1)Z[S]&&Z[S].m(j,null);g(e,A)},p(M,H){if(H&6&&t!==(t=M[9].junctionType+"")&&se(o,t),H&6&&u!==(u=M[9].movementType+"")&&se(d,u),H&6){C=Q(M[9].scoreZero);let S;for(S=0;S<C.length;S+=1){const he=At(M,C,S);z[S]?z[S].p(he,H):(z[S]=St(he),z[S].c(),z[S].m(p,null))}for(;S<z.length;S+=1)z[S].d(1);z.length=C.length}if(H&6){q=Q(M[9].scoreOne);let S;for(S=0;S<q.length;S+=1){const he=Ct(M,q,S);B[S]?B[S].p(he,H):(B[S]=Mt(he),B[S].c(),B[S].m(k,null))}for(;S<B.length;S+=1)B[S].d(1);B.length=q.length}if(H&6){W=Q(M[9].scoreTwo);let S;for(S=0;S<W.length;S+=1){const he=jt(M,W,S);Z[S]?Z[S].p(he,H):(Z[S]=Tt(he),Z[S].c(),Z[S].m(j,null))}for(;S<Z.length;S+=1)Z[S].d(1);Z.length=W.length}},d(M){M&&w(e),me(z,M),me(B,M),me(Z,M)}}}function Xr(n){let e,r,t,o,l,i,a,s,f=n[1],u,d,c,m,p,y,E,k,h;function O(q){n[5](q)}let j={k:"vert-radio",label:"Type of junction",choices:Nn};n[1]!==void 0&&(j.value=n[1]),i=new ze({props:j}),oe.push(()=>fe(i,"value",O)),i.$on("change",n[3]);let A=Lt(n),C=Q(wt(n[1],n[2])),z=[];for(let q=0;q<C.length;q+=1)z[q]=It(yt(n,C,q));return{c(){e=b("h1"),e.textContent="LTN 1/20 scoring guidance",r=L(),t=b("p"),t.innerHTML=`Guidance from <a target="_blank" href="https://assets.publishing.service.gov.uk/media/5ffa1f96d3bf7f65d9e35825/cycle-infrastructure-design-ltn-1-20.pdf">LTN 1/20 appendix B</a>
      .`,o=L(),l=b("div"),T(i.$$.fragment),s=L(),A.c(),u=L(),d=b("table"),c=b("tr"),c.innerHTML=`<th class="type-header svelte-k4kgn3">Type of junction and movement</th> <th class="score-zero-header svelte-k4kgn3"><p class="svelte-k4kgn3"><b>Score = 0</b></p> <p class="svelte-k4kgn3">Suitable only for confident existing cyclists, and may be avoided by
            some experienced cyclists</p> <p class="svelte-k4kgn3">Conditions are most likely to give rise to the most common collision
            types</p></th> <th class="score-one-header svelte-k4kgn3"><p class="svelte-k4kgn3"><b>Score = 1</b></p> <p class="svelte-k4kgn3">Likely to be more acceptable to most cyclists, but may still pose
            problems for less confident or new cyclists</p> <p class="svelte-k4kgn3">The risk of collisions has been reduced by design layout or traffic
            management interventions</p></th> <th class="score-two-header svelte-k4kgn3"><p class="svelte-k4kgn3"><b>Score = 2</b></p> <p class="svelte-k4kgn3">Suitable for all potential and existing cyclists</p> <p class="svelte-k4kgn3">The potential for collisions has been removed, or managed to a high
            standard of safety for cyclists</p></th>`,m=L();for(let q=0;q<z.length;q+=1)z[q].c();p=L(),y=b("button"),y.textContent="OK",Y(l,"display","flex"),Y(l,"justify-content","space-between")},m(q,B){v(q,e,B),v(q,r,B),v(q,t,B),v(q,o,B),v(q,l,B),I(i,l,null),g(l,s),A.m(l,null),v(q,u,B),v(q,d,B),g(d,c),g(d,m);for(let W=0;W<z.length;W+=1)z[W]&&z[W].m(d,null);v(q,p,B),v(q,y,B),E=!0,k||(h=J(y,"click",n[7]),k=!0)},p(q,B){const W={};if(!a&&B&2&&(a=!0,W.value=q[1],de(()=>a=!1)),i.$set(W),B&2&&re(f,f=q[1])?(ae(),$(A,1,1,te),ue(),A=Lt(q),A.c(),_(A,1),A.m(l,null)):A.p(q,B),B&6){C=Q(wt(q[1],q[2]));let Z;for(Z=0;Z<C.length;Z+=1){const M=yt(q,C,Z);z[Z]?z[Z].p(M,B):(z[Z]=It(M),z[Z].c(),z[Z].m(d,null))}for(;Z<z.length;Z+=1)z[Z].d(1);z.length=C.length}},i(q){E||(_(i.$$.fragment,q),_(A),E=!0)},o(q){$(i.$$.fragment,q),$(A),E=!1},d(q){q&&(w(e),w(r),w(t),w(o),w(l),w(u),w(d),w(p),w(y)),N(i),A.d(q),me(z,q),k=!1,h()}}}function Zr(n){let e,r,t,o,l,i,a=n[0]&&zt(n);return{c(){e=b("button"),e.textContent="LTN 1/20 scoring guidance",r=L(),a&&a.c(),t=Ge(),P(e,"class","secondary")},m(s,f){v(s,e,f),v(s,r,f),a&&a.m(s,f),v(s,t,f),o=!0,l||(i=J(e,"click",n[4]),l=!0)},p(s,[f]){s[0]?a?(a.p(s,f),f&1&&_(a,1)):(a=zt(s),a.c(),_(a,1),a.m(t.parentNode,t)):a&&(ae(),$(a,1,1,()=>{a=null}),ue())},i(s){o||(_(a),o=!0)},o(s){$(a),o=!1},d(s){s&&(w(e),w(r),w(t)),a&&a.d(s),l=!1,i()}}}function Vr(n,e,r){let t=!1,o=Nn[0],l=et(o)[0];function i(){r(2,l=et(o)[0])}const a=()=>r(0,t=!0);function s(c){o=c,r(1,o)}function f(c){l=c,r(2,l)}return[t,o,l,i,a,s,f,()=>r(0,t=!1),()=>r(0,t=!1)]}class Wr extends le{constructor(e){super(),ie(this,e,Vr,Zr,re,{})}}function Nt(n){let e,r;return e=new Wr({}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function Qr(n){let e,r,t,o,l,i,a,s,f,u,d,c,m,p,y,E,k;function h(z){n[6](z)}let O={k:"horiz-radio",label:"User",choices:[["cycling","Cycling"],["walking & wheeling","Walking & Wheeling"]]};n[3].jats[n[0]].properties[n[1]].movements[n[2]].kind!==void 0&&(O.value=n[3].jats[n[0]].properties[n[1]].movements[n[2]].kind),l=new ze({props:O}),oe.push(()=>fe(l,"value",h));let j=n[3].jats[n[0]].properties[n[1]].movements[n[2]].kind=="cycling"&&Nt();function A(z){n[7](z)}let C={k:"horiz-radio",label:"Score",choices:n[4]};return n[3].jats[n[0]].properties[n[1]].movements[n[2]].score!==void 0&&(C.value=n[3].jats[n[0]].properties[n[1]].movements[n[2]].score),f=new ze({props:C}),oe.push(()=>fe(f,"value",A)),{c(){e=b("label"),r=R(`Name
  `),t=b("input"),o=L(),T(l.$$.fragment),a=L(),j&&j.c(),s=L(),T(f.$$.fragment),d=L(),c=b("label"),m=R(`Comments
  `),p=b("textarea"),P(t,"type","text")},m(z,q){v(z,e,q),g(e,r),g(e,t),_e(t,n[3].jats[n[0]].properties[n[1]].movements[n[2]].name),v(z,o,q),I(l,z,q),v(z,a,q),j&&j.m(z,q),v(z,s,q),I(f,z,q),v(z,d,q),v(z,c,q),g(c,m),g(c,p),_e(p,n[3].jats[n[0]].properties[n[1]].movements[n[2]].notes),y=!0,E||(k=[J(t,"input",n[5]),J(p,"input",n[8])],E=!0)},p(z,[q]){q&15&&t.value!==z[3].jats[z[0]].properties[z[1]].movements[z[2]].name&&_e(t,z[3].jats[z[0]].properties[z[1]].movements[z[2]].name);const B={};!i&&q&15&&(i=!0,B.value=z[3].jats[z[0]].properties[z[1]].movements[z[2]].kind,de(()=>i=!1)),l.$set(B),z[3].jats[z[0]].properties[z[1]].movements[z[2]].kind=="cycling"?j?q&15&&_(j,1):(j=Nt(),j.c(),_(j,1),j.m(s.parentNode,s)):j&&(ae(),$(j,1,1,()=>{j=null}),ue());const W={};!u&&q&15&&(u=!0,W.value=z[3].jats[z[0]].properties[z[1]].movements[z[2]].score,de(()=>u=!1)),f.$set(W),q&15&&_e(p,z[3].jats[z[0]].properties[z[1]].movements[z[2]].notes)},i(z){y||(_(l.$$.fragment,z),_(j),_(f.$$.fragment,z),y=!0)},o(z){$(l.$$.fragment,z),$(j),$(f.$$.fragment,z),y=!1},d(z){z&&(w(e),w(o),w(a),w(s),w(d),w(c)),N(l,z),j&&j.d(z),N(f,z),E=!1,$e(k)}}}function Yr(n,e,r){let t;x(n,U,c=>r(3,t=c));let{junctionIdx:o}=e,{stage:l}=e,{idx:i}=e,a=[["X","X - black"],["0","0 - red"],["1","1 - amber"],["2","2 - green"]];function s(){t.jats[o].properties[l].movements[i].name=this.value,U.set(t)}function f(c){n.$$.not_equal(t.jats[o].properties[l].movements[i].kind,c)&&(t.jats[o].properties[l].movements[i].kind=c,U.set(t))}function u(c){n.$$.not_equal(t.jats[o].properties[l].movements[i].score,c)&&(t.jats[o].properties[l].movements[i].score=c,U.set(t))}function d(){t.jats[o].properties[l].movements[i].notes=this.value,U.set(t)}return n.$$set=c=>{"junctionIdx"in c&&r(0,o=c.junctionIdx),"stage"in c&&r(1,l=c.stage),"idx"in c&&r(2,i=c.idx)},[o,l,i,t,a,s,f,u,d]}class xr extends le{constructor(e){super(),ie(this,e,Yr,Qr,re,{junctionIdx:0,stage:1,idx:2})}}function eo(n){return n%(2*Math.PI)*180/Math.PI}function Qe(n){return n%360*Math.PI/180}function Et(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function En(n,e,r={}){if(r.final===!0)return to(n,e);const t=Et(n),o=Et(e),l=Qe(t[0]),i=Qe(o[0]),a=Qe(t[1]),s=Qe(o[1]),f=Math.sin(i-l)*Math.cos(s),u=Math.cos(a)*Math.sin(s)-Math.sin(a)*Math.cos(s)*Math.cos(i-l);return eo(Math.atan2(f,u))}function to(n,e){let r=En(e,n);return r=(r+180)%360,r}var Oe=En;function no(n,e,r={}){const t={type:"Feature"};return(r.id===0||r.id)&&(t.id=r.id),r.bbox&&(t.bbox=r.bbox),t.properties=e||{},t.geometry=n,t}function ro(n,e,r={}){if(!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Dt(n[0])||!Dt(n[1]))throw new Error("coordinates must contain numbers");return no({type:"Point",coordinates:n},e,r)}function Dt(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function oo(n,e={}){const r=Xn(n),t=(r[0]+r[2])/2,o=(r[1]+r[3])/2;return ro([t,o],e.properties,e)}var lo=oo,ve=63710088e-1,io={centimeters:ve*100,centimetres:ve*100,degrees:360/(2*Math.PI),feet:ve*3.28084,inches:ve*39.37,kilometers:ve/1e3,kilometres:ve/1e3,meters:ve,metres:ve,miles:ve/1609.344,millimeters:ve*1e3,millimetres:ve*1e3,nauticalmiles:ve/1852,radians:1,yards:ve*1.0936};function so(n,e,r={}){const t={type:"Feature"};return(r.id===0||r.id)&&(t.id=r.id),r.bbox&&(t.bbox=r.bbox),t.properties=e||{},t.geometry=n,t}function ao(n,e,r={}){if(!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ft(n[0])||!Ft(n[1]))throw new Error("coordinates must contain numbers");return so({type:"Point",coordinates:n},e,r)}function uo(n,e="kilometers"){const r=io[e];if(!r)throw new Error(e+" units is invalid");return n/r}function qt(n){return n%(2*Math.PI)*180/Math.PI}function rt(n){return n%360*Math.PI/180}function Ft(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function co(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function fo(n,e,r,t={}){const o=co(n),l=rt(o[0]),i=rt(o[1]),a=rt(r),s=uo(e,t.units),f=Math.asin(Math.sin(i)*Math.cos(s)+Math.cos(i)*Math.sin(s)*Math.cos(a)),u=l+Math.atan2(Math.sin(a)*Math.sin(s)*Math.cos(i),Math.cos(s)-Math.sin(i)*Math.sin(f)),d=qt(u),c=qt(f);return ao([d,c],t.properties)}var Ze=fo,we=63710088e-1,mo={centimeters:we*100,centimetres:we*100,degrees:360/(2*Math.PI),feet:we*3.28084,inches:we*39.37,kilometers:we/1e3,kilometres:we/1e3,meters:we,metres:we,miles:we/1609.344,millimeters:we*1e3,millimetres:we*1e3,nauticalmiles:we/1852,radians:1,yards:we*1.0936};function po(n,e="kilometers"){const r=mo[e];if(!r)throw new Error(e+" units is invalid");return n*r}function Ye(n){return n%360*Math.PI/180}function Pt(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function go(n,e,r={}){var t=Pt(n),o=Pt(e),l=Ye(o[1]-t[1]),i=Ye(o[0]-t[0]),a=Ye(t[1]),s=Ye(o[1]),f=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(a)*Math.cos(s);return po(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),r.units)}var _o=go;function ho(n){let e=lo({type:"FeatureCollection",features:n.map(t=>({type:"Feature",geometry:{type:"Point",coordinates:t.point},properties:{}}))}).geometry.coordinates;n.sort((t,o)=>Ot(Oe(e,o.point))-Ot(Oe(e,t.point)));let r=[];for(let t=0;t<n.length;t++){let o=n[t],l=Oe(o.point,e),i=1;for(let a of ko(t,n.length)){let s=n[a],f=Oe(e,s.point),u=$o(o.point,e,i++),d=_o(o.point,e),c=Ze(u,.5*d,l).geometry.coordinates,m=Ze(c,.2*d,f).geometry.coordinates;r.push({point1:u,point2:c,point3:m,kind:"cycling",score:"X",name:`${o.name} to ${s.name}`,notes:""})}}return r}function $o(n,e,r){let t=.003,l=Oe(n,e)-90,i=t*r;return Ze(n,i,l).geometry.coordinates}function Ot(n){return(n+360)%360}function ko(n,e){let r=[];for(let t=n+1;t<e;t++)r.push(t);for(let t=0;t<n;t++)r.push(t);return r}const bo="/route-element/assets/movement-aa45473c.svg",vo="/route-element/assets/pan-fbcec4cd.svg";function Bt(n,e,r){const t=n.slice();return t[31]=e[r],t[32]=e,t[33]=r,t}function Ut(n,e,r){const t=n.slice();return t[34]=e[r],t[35]=e,t[33]=r,t}function Jt(n){let e,r,t,o,l,i,a,s,f,u,d,c,m,p,y,E,k,h,O;function j(H,S){return H[0].mode=="select"?yo:wo}let A=j(n),C=A(n);function z(H,S){return H[0].mode=="new-arm"?Co:jo}let q=z(n),B=q(n);function W(H,S){return H[0].mode=="new-movement"?zo:Ao}let Z=W(n),M=Z(n);return{c(){e=b("div"),r=b("button"),t=b("img"),l=L(),C.c(),i=L(),a=b("button"),s=nt("svg"),f=nt("circle"),u=nt("text"),d=R("A"),c=L(),B.c(),m=L(),p=b("button"),y=b("img"),k=L(),M.c(),xe(t.src,o=vo)||P(t,"src",o),P(t,"alt","Move map"),Y(t,"vertical-align","middle"),P(r,"class","outline"),P(f,"cx","12"),P(f,"cy","12"),P(f,"r","12"),P(f,"fill","white"),P(u,"x","6"),P(u,"y","16"),P(u,"fill","#4472c4"),P(s,"width","24"),P(s,"height","24"),P(s,"xmlns","http://www.w3.org/2000/svg"),Y(s,"vertical-align","middle"),P(a,"class","outline"),xe(y.src,E=bo)||P(y,"src",E),P(y,"alt","New movement"),Y(y,"vertical-align","middle"),P(p,"class","outline"),P(e,"class","control-panel svelte-l1e6xi")},m(H,S){v(H,e,S),g(e,r),g(r,t),g(r,l),C.m(r,null),g(e,i),g(e,a),g(a,s),g(s,f),g(s,u),g(u,d),g(a,c),B.m(a,null),g(e,m),g(e,p),g(p,y),g(p,k),M.m(p,null),h||(O=[J(r,"click",function(){Zn(n[4])&&n[4].apply(this,arguments)}),J(a,"click",n[12]),J(p,"click",n[13])],h=!0)},p(H,S){n=H,A!==(A=j(n))&&(C.d(1),C=A(n),C&&(C.c(),C.m(r,null))),q!==(q=z(n))&&(B.d(1),B=q(n),B&&(B.c(),B.m(a,null))),Z!==(Z=W(n))&&(M.d(1),M=Z(n),M&&(M.c(),M.m(p,null)))},d(H){H&&w(e),C.d(),B.d(),M.d(),h=!1,$e(O)}}}function wo(n){let e;return{c(){e=R("Move map")},m(r,t){v(r,e,t)},d(r){r&&w(e)}}}function yo(n){let e;return{c(){e=b("b"),e.textContent="Move map"},m(r,t){v(r,e,t)},d(r){r&&w(e)}}}function jo(n){let e;return{c(){e=R("New arm")},m(r,t){v(r,e,t)},d(r){r&&w(e)}}}function Co(n){let e;return{c(){e=b("b"),e.textContent="New arm"},m(r,t){v(r,e,t)},d(r){r&&w(e)}}}function Ao(n){let e;return{c(){e=R("New movement")},m(r,t){v(r,e,t)},d(r){r&&w(e)}}}function zo(n){let e;return{c(){e=b("b"),e.textContent="New movement"},m(r,t){v(r,e,t)},d(r){r&&w(e)}}}function Lo(n){let e;return{c(){e=b("span"),e.textContent=`${Bo(n[33])}`,P(e,"class","dot svelte-l1e6xi"),Y(e,"color","#4472c4"),Y(e,"background-color","white")},m(r,t){v(r,e,t)},p:te,d(r){r&&w(e)}}}function Rt(n){let e,r,t;function o(s){n[14](s,n[34])}function l(){return n[15](n[33])}function i(){return n[16](n[33])}let a={draggable:!0,$$slots:{default:[Lo]},$$scope:{ctx:n}};return n[34].point!==void 0&&(a.lngLat=n[34].point),e=new Be({props:a}),oe.push(()=>fe(e,"lngLat",o)),e.$on("dragend",l),e.$on("click",i),{c(){T(e.$$.fragment)},m(s,f){I(e,s,f),t=!0},p(s,f){n=s;const u={};f[1]&32&&(u.$$scope={dirty:f,ctx:n}),!r&&f[0]&38&&(r=!0,u.lngLat=n[34].point,de(()=>r=!1)),e.$set(u)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){N(e,s)}}}function So(n){let e;return{c(){e=b("span"),P(e,"class","dot svelte-l1e6xi"),Y(e,"background-color",n[7][n[31].score]),Y(e,"opacity",n[31].kind=="walking & wheeling"?"0%":"100%")},m(r,t){v(r,e,t)},p(r,t){t[0]&38&&Y(e,"background-color",r[7][r[31].score]),t[0]&38&&Y(e,"opacity",r[31].kind=="walking & wheeling"?"0%":"100%")},d(r){r&&w(e)}}}function Mo(n){let e;return{c(){e=b("span"),P(e,"class","dot svelte-l1e6xi"),Y(e,"background-color",n[7][n[31].score])},m(r,t){v(r,e,t)},p(r,t){t[0]&38&&Y(e,"background-color",r[7][r[31].score])},d(r){r&&w(e)}}}function To(n){let e;return{c(){e=b("span"),P(e,"class","dot svelte-l1e6xi"),Y(e,"background-color",n[7][n[31].score]),Y(e,"opacity","0%")},m(r,t){v(r,e,t)},p(r,t){t[0]&38&&Y(e,"background-color",r[7][r[31].score])},d(r){r&&w(e)}}}function Gt(n){let e,r,t,o,l,i,a,s,f;function u(C){n[17](C,n[31])}function d(){return n[18](n[33])}function c(){return n[19](n[33])}let m={draggable:!0,$$slots:{default:[So]},$$scope:{ctx:n}};n[31].point1!==void 0&&(m.lngLat=n[31].point1),e=new Be({props:m}),oe.push(()=>fe(e,"lngLat",u)),e.$on("dragend",d),e.$on("click",c);function p(C){n[20](C,n[31])}function y(){return n[21](n[33])}function E(){return n[22](n[33])}let k={draggable:!0,$$slots:{default:[Mo]},$$scope:{ctx:n}};n[31].point2!==void 0&&(k.lngLat=n[31].point2),o=new Be({props:k}),oe.push(()=>fe(o,"lngLat",p)),o.$on("dragend",y),o.$on("click",E);function h(C){n[23](C,n[31])}function O(){return n[24](n[33])}function j(){return n[25](n[33])}let A={draggable:!0,$$slots:{default:[To]},$$scope:{ctx:n}};return n[31].point3!==void 0&&(A.lngLat=n[31].point3),a=new Be({props:A}),oe.push(()=>fe(a,"lngLat",h)),a.$on("dragend",O),a.$on("click",j),{c(){T(e.$$.fragment),t=L(),T(o.$$.fragment),i=L(),T(a.$$.fragment)},m(C,z){I(e,C,z),v(C,t,z),I(o,C,z),v(C,i,z),I(a,C,z),f=!0},p(C,z){n=C;const q={};z[0]&38|z[1]&32&&(q.$$scope={dirty:z,ctx:n}),!r&&z[0]&38&&(r=!0,q.lngLat=n[31].point1,de(()=>r=!1)),e.$set(q);const B={};z[0]&38|z[1]&32&&(B.$$scope={dirty:z,ctx:n}),!l&&z[0]&38&&(l=!0,B.lngLat=n[31].point2,de(()=>l=!1)),o.$set(B);const W={};z[0]&38|z[1]&32&&(W.$$scope={dirty:z,ctx:n}),!s&&z[0]&38&&(s=!0,W.lngLat=n[31].point3,de(()=>s=!1)),a.$set(W)},i(C){f||(_(e.$$.fragment,C),_(o.$$.fragment,C),_(a.$$.fragment,C),f=!0)},o(C){$(e.$$.fragment,C),$(o.$$.fragment,C),$(a.$$.fragment,C),f=!1},d(C){C&&(w(t),w(i)),N(e,C),N(o,C),N(a,C)}}}function Io(n){let e=(n[30].name||"Untitled movement")+"",r;return{c(){r=R(e)},m(t,o){v(t,r,o)},p(t,o){o[0]&1073741824&&e!==(e=(t[30].name||"Untitled movement")+"")&&se(r,e)},d(t){t&&w(r)}}}function No(n){let e,r;return e=new Ln({props:{$$slots:{default:[Io,({props:t})=>({30:t}),({props:t})=>[t?1073741824:0]]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o[0]&1073741824|o[1]&32&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function Eo(n){let e=(n[30].name||"Untitled movement")+"",r;return{c(){r=R(e)},m(t,o){v(t,r,o)},p(t,o){o[0]&1073741824&&e!==(e=(t[30].name||"Untitled movement")+"")&&se(r,e)},d(t){t&&w(r)}}}function Do(n){let e,r;return e=new Ln({props:{$$slots:{default:[Eo,({props:t})=>({30:t}),({props:t})=>[t?1073741824:0]]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o[0]&1073741824|o[1]&32&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function qo(n){let e,r,t,o,l,i;return e=new Ae({props:{id:"jat-cycling",manageHoverState:!0,paint:{"line-width":Je(6,10),"line-color":["get","color"]},filter:["==",["get","kind"],"cycling"],$$slots:{default:[No]},$$scope:{ctx:n}}}),e.$on("click",n[9]),t=new Ae({props:{id:"jat-walking-wheeling",manageHoverState:!0,paint:{"line-width":Je(6,8),"line-color":["get","color"],"line-dasharray":[3,2]},filter:["==",["get","kind"],"walking & wheeling"],$$slots:{default:[Do]},$$scope:{ctx:n}}}),t.$on("click",n[9]),l=new tt({props:{id:"jat-arrow",filter:["has","angle"],paint:{"text-color":["get","color"],"text-halo-color":"white","text-halo-width":3},layout:{"text-field":"⬆","text-overlap":"always","text-rotate":["get","angle"],"text-size":70}}}),{c(){T(e.$$.fragment),r=L(),T(t.$$.fragment),o=L(),T(l.$$.fragment)},m(a,s){I(e,a,s),v(a,r,s),I(t,a,s),v(a,o,s),I(l,a,s),i=!0},p(a,s){const f={};s[1]&32&&(f.$$scope={dirty:s,ctx:a}),e.$set(f);const u={};s[1]&32&&(u.$$scope={dirty:s,ctx:a}),t.$set(u)},i(a){i||(_(e.$$.fragment,a),_(t.$$.fragment,a),_(l.$$.fragment,a),i=!0)},o(a){$(e.$$.fragment,a),$(t.$$.fragment,a),$(l.$$.fragment,a),i=!1},d(a){a&&(w(r),w(o)),N(e,a),N(t,a),N(l,a)}}}function Fo(n){let e,r,t,o;return e=new Ae({props:{paint:{"line-width":5,"line-color":"yellow","line-gap-width":45}}}),t=new Se({props:{filter:["==",["get","kind"],"arm"],paint:{"circle-radius":20,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){T(e.$$.fragment),r=L(),T(t.$$.fragment)},m(l,i){I(e,l,i),v(l,r,i),I(t,l,i),o=!0},p:te,i(l){o||(_(e.$$.fragment,l),_(t.$$.fragment,l),o=!0)},o(l){$(e.$$.fragment,l),$(t.$$.fragment,l),o=!1},d(l){l&&w(r),N(e,l),N(t,l)}}}function Po(n){let e,r,t,o,l,i,a,s,f;e=new Sn({}),e.$on("click",n[8]);let u=n[0].mode!="editing"&&Jt(n),d=Q(n[5].jats[n[1]].properties[n[2]].arms),c=[];for(let k=0;k<d.length;k+=1)c[k]=Rt(Ut(n,d,k));const m=k=>$(c[k],1,1,()=>{c[k]=null});let p=Q(n[5].jats[n[1]].properties[n[2]].movements),y=[];for(let k=0;k<p.length;k+=1)y[k]=Gt(Bt(n,p,k));const E=k=>$(y[k],1,1,()=>{y[k]=null});return i=new ge({props:{data:n[10](n[5]),$$slots:{default:[qo]},$$scope:{ctx:n}}}),s=new ge({props:{data:n[6],$$slots:{default:[Fo]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment),r=L(),u&&u.c(),t=L();for(let k=0;k<c.length;k+=1)c[k].c();o=L();for(let k=0;k<y.length;k+=1)y[k].c();l=L(),T(i.$$.fragment),a=L(),T(s.$$.fragment)},m(k,h){I(e,k,h),v(k,r,h),u&&u.m(k,h),v(k,t,h);for(let O=0;O<c.length;O+=1)c[O]&&c[O].m(k,h);v(k,o,h);for(let O=0;O<y.length;O+=1)y[O]&&y[O].m(k,h);v(k,l,h),I(i,k,h),v(k,a,h),I(s,k,h),f=!0},p(k,h){if(k[0].mode!="editing"?u?u.p(k,h):(u=Jt(k),u.c(),u.m(t.parentNode,t)):u&&(u.d(1),u=null),h[0]&46){d=Q(k[5].jats[k[1]].properties[k[2]].arms);let A;for(A=0;A<d.length;A+=1){const C=Ut(k,d,A);c[A]?(c[A].p(C,h),_(c[A],1)):(c[A]=Rt(C),c[A].c(),_(c[A],1),c[A].m(o.parentNode,o))}for(ae(),A=d.length;A<c.length;A+=1)m(A);ue()}if(h[0]&174){p=Q(k[5].jats[k[1]].properties[k[2]].movements);let A;for(A=0;A<p.length;A+=1){const C=Bt(k,p,A);y[A]?(y[A].p(C,h),_(y[A],1)):(y[A]=Gt(C),y[A].c(),_(y[A],1),y[A].m(l.parentNode,l))}for(ae(),A=p.length;A<y.length;A+=1)E(A);ue()}const O={};h[0]&32&&(O.data=k[10](k[5])),h[1]&32&&(O.$$scope={dirty:h,ctx:k}),i.$set(O);const j={};h[0]&64&&(j.data=k[6]),h[1]&32&&(j.$$scope={dirty:h,ctx:k}),s.$set(j)},i(k){if(!f){_(e.$$.fragment,k);for(let h=0;h<d.length;h+=1)_(c[h]);for(let h=0;h<p.length;h+=1)_(y[h]);_(i.$$.fragment,k),_(s.$$.fragment,k),f=!0}},o(k){$(e.$$.fragment,k),c=c.filter(Boolean);for(let h=0;h<c.length;h+=1)$(c[h]);y=y.filter(Boolean);for(let h=0;h<y.length;h+=1)$(y[h]);$(i.$$.fragment,k),$(s.$$.fragment,k),f=!1},d(k){k&&(w(r),w(t),w(o),w(l),w(a)),N(e,k),u&&u.d(k),me(c,k),me(y,k),N(i,k),N(s,k)}}}function Oo(n,e){return{type:"Feature",id:e,properties:{kind:"arm"},geometry:{type:"Point",coordinates:n.point}}}function Bo(n){return String.fromCharCode(n+"A".charCodeAt(0))}function Uo(n,e,r){let t,o,l;x(n,U,F=>r(5,o=F)),x(n,Re,F=>r(26,l=F));let{junctionIdx:i}=e,{stage:a}=e,{mode:s}=e,{hoveringSidebar:f}=e,{select:u}=e,{stopEditing:d}=e,c={0:Le.red.background,1:Le.amber.background,2:Le.green.background,X:Le.critical.background};function m(F,X,je){let ce={type:"FeatureCollection",features:[]},D=X.mode=="editing"?X.id:je;return D!=null&&(D.kind=="arm"?ce.features.push(Oo(F.jats[i].properties[a].arms[D.idx],D.idx)):ce.features.push(k(F.jats[i].properties[a].movements[D.idx],D.idx))),ce}async function p(F){if(l){for(let X of l.queryRenderedFeatures(F.detail.point,{layers:["jat-cycling","jat-walking-wheeling"]}))return;if(s.mode!="select"){if(s.mode=="editing"){await d();return}s.mode=="new-arm"?(G(U,o.jats[i].properties[a].arms=[...o.jats[i].properties[a].arms,{point:F.detail.lngLat.toArray(),name:""}],o),await u({kind:"arm",idx:o.jats[i].properties[a].arms.length-1})):(G(U,o.jats[i].properties[a].movements=[...o.jats[i].properties[a].movements,{point1:F.detail.lngLat.toArray(),point2:Ze(F.detail.lngLat.toArray(),.005,0).geometry.coordinates,point3:Ze(F.detail.lngLat.toArray(),.01,0).geometry.coordinates,kind:"cycling",score:"X",name:"",notes:""}],o),await u({kind:"movement",idx:o.jats[i].properties[a].movements.length-1}))}}}async function y(F){await u({kind:"movement",idx:F.detail.features[0].id})}function E(F){let X={type:"FeatureCollection",features:F.jats[i].properties[a].movements.map((je,ce)=>k(je,ce))};for(let je of F.jats[i].properties[a].movements)if(X.features.push(h(je,X.features.length)),je.kind=="walking & wheeling"){let ce={...je,point1:je.point3,point3:je.point1};X.features.push(h(ce,X.features.length))}return X}function k(F,X){return{type:"Feature",id:X,properties:{name:F.name,kind:F.kind,color:c[F.score]},geometry:{type:"LineString",coordinates:[F.point1,F.point2,F.point3]}}}function h(F,X){return{type:"Feature",id:X,properties:{kind:F.kind,color:c[F.score],angle:Oe(F.point2,F.point3)},geometry:{type:"Point",coordinates:F.point3}}}const O=()=>r(0,s={mode:"new-arm"}),j=()=>r(0,s={mode:"new-movement"});function A(F,X){n.$$.not_equal(X.point,F)&&(X.point=F,U.set(o))}const C=F=>u({kind:"arm",idx:F}),z=F=>u({kind:"arm",idx:F});function q(F,X){n.$$.not_equal(X.point1,F)&&(X.point1=F,U.set(o))}const B=F=>u({kind:"movement",idx:F}),W=F=>u({kind:"movement",idx:F});function Z(F,X){n.$$.not_equal(X.point2,F)&&(X.point2=F,U.set(o))}const M=F=>u({kind:"movement",idx:F}),H=F=>u({kind:"movement",idx:F});function S(F,X){n.$$.not_equal(X.point3,F)&&(X.point3=F,U.set(o))}const he=F=>u({kind:"movement",idx:F}),pe=F=>u({kind:"movement",idx:F});return n.$$set=F=>{"junctionIdx"in F&&r(1,i=F.junctionIdx),"stage"in F&&r(2,a=F.stage),"mode"in F&&r(0,s=F.mode),"hoveringSidebar"in F&&r(11,f=F.hoveringSidebar),"select"in F&&r(3,u=F.select),"stopEditing"in F&&r(4,d=F.stopEditing)},n.$$.update=()=>{n.$$.dirty[0]&2081&&r(6,t=m(o,s,f))},[s,i,a,u,d,o,t,c,p,y,E,f,O,j,A,C,z,q,B,W,Z,M,H,S,he,pe]}class Jo extends le{constructor(e){super(),ie(this,e,Uo,Po,re,{junctionIdx:1,stage:2,mode:0,hoveringSidebar:11,select:3,stopEditing:4},null,[-1,-1])}}function Ht(n){if(n.movements.length==0)return"No movements added";let e=0,r=0;for(let o of n.movements)e+={0:0,1:1,2:2,X:0}[o.score],r+=2;let t=e/r*100;return`${Math.round(t)}%`}const{window:Ro}=He;function Kt(n,e,r){const t=n.slice();t[27]=e[r],t[30]=r;const o=t[14][t[27].score];return t[28]=o,t}function Xt(n,e,r){const t=n.slice();return t[31]=e[r],t[30]=r,t}function Go(n){let e,r,t,o,l,i,a,s,f;return{c(){e=b("button"),e.textContent="Done",r=L(),t=b("button"),t.textContent="Delete",o=L(),l=b("label"),i=R(`Arm name
        `),a=b("input"),P(a,"type","text")},m(u,d){v(u,e,d),v(u,r,d),v(u,t,d),v(u,o,d),v(u,l,d),g(l,i),g(l,a),_e(a,n[5].jats[n[0]].properties[n[1]].arms[n[2].id.idx].name),s||(f=[J(e,"click",n[23]),J(t,"click",n[10]),J(a,"input",n[24])],s=!0)},p(u,d){d[0]&39&&a.value!==u[5].jats[u[0]].properties[u[1]].arms[u[2].id.idx].name&&_e(a,u[5].jats[u[0]].properties[u[1]].arms[u[2].id.idx].name)},i:te,o:te,d(u){u&&(w(e),w(r),w(t),w(o),w(l)),s=!1,$e(f)}}}function Ho(n){let e,r,t,o,l,i,a,s;return e=new xr({props:{junctionIdx:n[0],stage:n[1],idx:n[2].id.idx}}),{c(){T(e.$$.fragment),r=L(),t=b("button"),t.textContent="Save",o=L(),l=b("button"),l.textContent="Delete"},m(f,u){I(e,f,u),v(f,r,u),v(f,t,u),v(f,o,u),v(f,l,u),i=!0,a||(s=[J(t,"click",n[9]),J(l,"click",n[10])],a=!0)},p(f,u){const d={};u[0]&1&&(d.junctionIdx=f[0]),u[0]&2&&(d.stage=f[1]),u[0]&4&&(d.idx=f[2].id.idx),e.$set(d)},i(f){i||(_(e.$$.fragment,f),i=!0)},o(f){$(e.$$.fragment,f),i=!1},d(f){f&&(w(r),w(t),w(o),w(l)),N(e,f),a=!1,$e(s)}}}function Ko(n){let e,r,t,o,l,i,a,s,f,u,d,c,m,p=n[5].jats[n[0]].properties.name+"",y,E,k=Ht(n[5].jats[n[0]].properties[n[1]])+"",h,O,j,A,C,z,q,B,W,Z,M,H=Q(n[5].jats[n[0]].properties[n[1]].arms),S=[];for(let D=0;D<H.length;D+=1)S[D]=Zt(Xt(n,H,D));const he=D=>$(S[D],1,1,()=>{S[D]=null});let pe=n[5].jats[n[0]].properties[n[7]].arms.length>0&&Vt(n),F=Q(n[5].jats[n[0]].properties[n[1]].movements),X=[];for(let D=0;D<F.length;D+=1)X[D]=Wt(Kt(n,F,D));const je=D=>$(X[D],1,1,()=>{X[D]=null});let ce=n[5].jats[n[0]].properties[n[7]].movements.length>0&&Qt(n);return{c(){e=b("button"),e.textContent="Done",r=L(),t=b("h3"),t.textContent="Arms",o=L();for(let D=0;D<S.length;D+=1)S[D].c();l=L(),pe&&pe.c(),i=L(),a=b("h3"),a.textContent="Movements",s=L(),f=b("p"),u=R("Total JAT score for "),d=R(n[1]),c=R(` junction
        `),m=b("i"),y=R(p),E=R(`
        : `),h=R(k),O=L(),j=b("button"),A=R("Generate cycling movements between all arms"),z=L();for(let D=0;D<X.length;D+=1)X[D].c();q=L(),ce&&ce.c(),B=Ge(),P(j,"class","secondary"),j.disabled=C=n[5].jats[n[0]].properties[n[1]].arms.length<2},m(D,V){v(D,e,V),v(D,r,V),v(D,t,V),v(D,o,V);for(let ee=0;ee<S.length;ee+=1)S[ee]&&S[ee].m(D,V);v(D,l,V),pe&&pe.m(D,V),v(D,i,V),v(D,a,V),v(D,s,V),v(D,f,V),g(f,u),g(f,d),g(f,c),g(f,m),g(m,y),g(f,E),g(f,h),v(D,O,V),v(D,j,V),g(j,A),v(D,z,V);for(let ee=0;ee<X.length;ee+=1)X[ee]&&X[ee].m(D,V);v(D,q,V),ce&&ce.m(D,V),v(D,B,V),W=!0,Z||(M=[J(e,"click",n[16]),J(j,"click",n[15])],Z=!0)},p(D,V){if(V[0]&299){H=Q(D[5].jats[D[0]].properties[D[1]].arms);let ee;for(ee=0;ee<H.length;ee+=1){const Xe=Xt(D,H,ee);S[ee]?(S[ee].p(Xe,V),_(S[ee],1)):(S[ee]=Zt(Xe),S[ee].c(),_(S[ee],1),S[ee].m(l.parentNode,l))}for(ae(),ee=H.length;ee<S.length;ee+=1)he(ee);ue()}if(D[5].jats[D[0]].properties[D[7]].arms.length>0?pe?pe.p(D,V):(pe=Vt(D),pe.c(),pe.m(i.parentNode,i)):pe&&(pe.d(1),pe=null),(!W||V[0]&2)&&se(d,D[1]),(!W||V[0]&33)&&p!==(p=D[5].jats[D[0]].properties.name+"")&&se(y,p),(!W||V[0]&35)&&k!==(k=Ht(D[5].jats[D[0]].properties[D[1]])+"")&&se(h,k),(!W||V[0]&35&&C!==(C=D[5].jats[D[0]].properties[D[1]].arms.length<2))&&(j.disabled=C),V[0]&16683){F=Q(D[5].jats[D[0]].properties[D[1]].movements);let ee;for(ee=0;ee<F.length;ee+=1){const Xe=Kt(D,F,ee);X[ee]?(X[ee].p(Xe,V),_(X[ee],1)):(X[ee]=Wt(Xe),X[ee].c(),_(X[ee],1),X[ee].m(q.parentNode,q))}for(ae(),ee=F.length;ee<X.length;ee+=1)je(ee);ue()}D[5].jats[D[0]].properties[D[7]].movements.length>0?ce?ce.p(D,V):(ce=Qt(D),ce.c(),ce.m(B.parentNode,B)):ce&&(ce.d(1),ce=null)},i(D){if(!W){for(let V=0;V<H.length;V+=1)_(S[V]);for(let V=0;V<F.length;V+=1)_(X[V]);W=!0}},o(D){S=S.filter(Boolean);for(let V=0;V<S.length;V+=1)$(S[V]);X=X.filter(Boolean);for(let V=0;V<X.length;V+=1)$(X[V]);W=!1},d(D){D&&(w(e),w(r),w(t),w(o),w(l),w(i),w(a),w(s),w(f),w(O),w(j),w(z),w(q),w(B)),me(S,D),pe&&pe.d(D),me(X,D),ce&&ce.d(D),Z=!1,$e(M)}}}function Zt(n){let e,r;function t(){return n[17](n[30])}function o(){return n[18](n[30])}return e=new Tn({props:{name:`${Yt(n[30])} - ${n[31].name||"Unnamed arm"}`,hasSlot:!1}}),e.$on("click",t),e.$on("mouseenter",o),e.$on("mouseleave",n[19]),{c(){T(e.$$.fragment)},m(l,i){I(e,l,i),r=!0},p(l,i){n=l;const a={};i[0]&35&&(a.name=`${Yt(n[30])} - ${n[31].name||"Unnamed arm"}`),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){$(e.$$.fragment,l),r=!1},d(l){N(e,l)}}}function Vt(n){let e,r,t;return{c(){e=b("button"),e.textContent=`Copy arms from ${n[7]}`,P(e,"class","secondary")},m(o,l){v(o,e,l),r||(t=J(e,"click",n[12]),r=!0)},p:te,d(o){o&&w(e),r=!1,t()}}}function Xo(n){let e,r,t,o=n[27].score+"",l,i,a,s=xt(n[27].kind)+"",f;return{c(){e=b("div"),r=b("span"),t=R("Score: "),l=R(o),i=L(),a=b("span"),f=R(s),Y(r,"padding","4px"),Y(r,"color",n[28].font),Y(r,"background-color",n[28].background),Y(e,"width","100%"),Y(e,"display","flex"),Y(e,"justify-content","space-between")},m(u,d){v(u,e,d),g(e,r),g(r,t),g(r,l),g(e,i),g(e,a),g(a,f)},p(u,d){d[0]&35&&o!==(o=u[27].score+"")&&se(l,o),d[0]&35&&Y(r,"color",u[28].font),d[0]&35&&Y(r,"background-color",u[28].background),d[0]&35&&s!==(s=xt(u[27].kind)+"")&&se(f,s)},d(u){u&&w(e)}}}function Wt(n){let e,r;function t(){return n[20](n[30])}function o(){return n[21](n[30])}return e=new Tn({props:{name:n[27].name||"Unnamed movement",$$slots:{default:[Xo]},$$scope:{ctx:n}}}),e.$on("click",t),e.$on("mouseenter",o),e.$on("mouseleave",n[22]),{c(){T(e.$$.fragment)},m(l,i){I(e,l,i),r=!0},p(l,i){n=l;const a={};i[0]&35&&(a.name=n[27].name||"Unnamed movement"),i[0]&35|i[1]&4&&(a.$$scope={dirty:i,ctx:n}),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){$(e.$$.fragment,l),r=!1},d(l){N(e,l)}}}function Qt(n){let e,r,t;return{c(){e=b("button"),e.textContent=`Copy movements from ${n[7]}`,P(e,"class","secondary")},m(o,l){v(o,e,l),r||(t=J(e,"click",n[13]),r=!0)},p:te,d(o){o&&w(e),r=!1,t()}}}function Zo(n){let e,r,t,o,l=n[5].jats[n[0]].properties.name+"",i,a,s,f,u;const d=[Ko,Ho,Go],c=[];function m(p,y){return p[2].mode!="editing"?0:p[2].id.kind=="movement"?1:2}return s=m(n),f=c[s]=d[s](n),{c(){e=b("div"),r=b("h2"),t=R(n[1]),o=R(" JAT for "),i=R(l),a=L(),f.c(),P(e,"slot","sidebar")},m(p,y){v(p,e,y),g(e,r),g(r,t),g(r,o),g(r,i),g(e,a),c[s].m(e,null),n[25](e),u=!0},p(p,y){(!u||y[0]&2)&&se(t,p[1]),(!u||y[0]&33)&&l!==(l=p[5].jats[p[0]].properties.name+"")&&se(i,l);let E=s;s=m(p),s===E?c[s].p(p,y):(ae(),$(c[E],1,1,()=>{c[E]=null}),ue(),f=c[s],f?f.p(p,y):(f=c[s]=d[s](p),f.c()),_(f,1),f.m(e,null))},i(p){u||(_(f),u=!0)},o(p){$(f),u=!1},d(p){p&&w(e),c[s].d(),n[25](null)}}}function Vo(n){let e,r;return e=new Se({props:{filter:["!=",["id"],n[0]],paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":"black","circle-radius":20}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o[0]&1&&(l.filter=["!=",["id"],t[0]]),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function Wo(n){let e,r,t,o,l,i,a;return r=new Fe({props:{except:"jats"}}),o=new ge({props:{data:ne(n[5].jats),generateId:!0,$$slots:{default:[Vo]},$$scope:{ctx:n}}}),i=new Jo({props:{junctionIdx:n[0],stage:n[1],mode:n[2],hoveringSidebar:n[3],select:n[8],stopEditing:n[9]}}),{c(){e=b("div"),T(r.$$.fragment),t=L(),T(o.$$.fragment),l=L(),T(i.$$.fragment),P(e,"slot","map")},m(s,f){v(s,e,f),I(r,e,null),g(e,t),I(o,e,null),g(e,l),I(i,e,null),a=!0},p(s,f){const u={};f[0]&32&&(u.data=ne(s[5].jats)),f[0]&1|f[1]&4&&(u.$$scope={dirty:f,ctx:s}),o.$set(u);const d={};f[0]&1&&(d.junctionIdx=s[0]),f[0]&2&&(d.stage=s[1]),f[0]&4&&(d.mode=s[2]),f[0]&8&&(d.hoveringSidebar=s[3]),i.$set(d)},i(s){a||(_(r.$$.fragment,s),_(o.$$.fragment,s),_(i.$$.fragment,s),a=!0)},o(s){$(r.$$.fragment,s),$(o.$$.fragment,s),$(i.$$.fragment,s),a=!1},d(s){s&&w(e),N(r),N(o),N(i)}}}function Qo(n){let e,r,t,o;return e=new Me({props:{$$slots:{map:[Wo],sidebar:[Zo]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},m(l,i){I(e,l,i),r=!0,t||(o=J(Ro,"keydown",n[11]),t=!0)},p(l,i){const a={};i[0]&127|i[1]&4&&(a.$$scope={dirty:i,ctx:l}),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){$(e.$$.fragment,l),r=!1},d(l){N(e,l),t=!1,o()}}}function Yt(n){return String.fromCharCode(n+"A".charCodeAt(0))}function xt(n){return n.split(" ").map(e=>e.length>0?e[0].toUpperCase()+e.substr(1):e).join(" ")}function Yo(n,e,r){let t,o;x(n,U,S=>r(5,t=S)),x(n,K,S=>r(6,o=S));let{junctionIdx:l}=e,{stage:i}=e,a=i=="existing"?"proposed":"existing",s={mode:"select"},f=null,u=null,d;async function c(S){f=d.scrollTop,r(2,s={mode:"editing",id:S}),r(3,u=null),await qe(),r(4,d.scrollTop=0,d)}async function m(){r(2,s={mode:"select"}),f!=null&&(await qe(),r(4,d.scrollTop=f,d),f=null)}function p(){s.mode=="editing"&&window.confirm(`Delete this ${s.id.kind}?`)&&(s.id.kind=="movement"?(t.jats[l].properties[i].movements.splice(s.id.idx,1),U.set(t)):(t.jats[l].properties[i].arms.splice(s.id.idx,1),U.set(t)),m())}function y(S){if(s.mode!="editing")return;let he=S.target.tagName,pe=he=="INPUT"||he=="TEXTAREA";S.key=="Escape"||S.key=="Enter"&&!pe?(S.stopPropagation(),m()):S.key=="Delete"&&!pe&&(S.stopPropagation(),p())}function E(){t.jats[l].properties[i].arms.length>0&&!window.confirm("Overwrite arms?")||(G(U,t.jats[l].properties[i].arms=JSON.parse(JSON.stringify(t.jats[l].properties[a].arms)),t),U.set(t))}function k(){t.jats[l].properties[i].movements.length>0&&!window.confirm("Overwrite movements?")||(G(U,t.jats[l].properties[i].movements=JSON.parse(JSON.stringify(t.jats[l].properties[a].movements)),t),U.set(t))}let h={0:Le.red,1:Le.amber,2:Le.green,X:Le.critical};function O(){if(t.jats[l].properties[i].movements.length>0&&!window.confirm("Overwrite all cycling movements?"))return;let S=t.jats[l].properties[i].movements.filter(he=>he.kind=="walking & wheeling");G(U,t.jats[l].properties[i].movements=[...S,...ho(t.jats[l].properties[i].arms)],t)}const j=()=>G(K,o={kind:"edit-jat",idx:l},o),A=S=>c({kind:"arm",idx:S}),C=S=>r(3,u={kind:"arm",idx:S}),z=()=>r(3,u=null),q=S=>c({kind:"movement",idx:S}),B=S=>r(3,u={kind:"movement",idx:S}),W=()=>r(3,u=null),Z=()=>r(2,s={mode:"select"});function M(){t.jats[l].properties[i].arms[s.id.idx].name=this.value,U.set(t)}function H(S){oe[S?"unshift":"push"](()=>{d=S,r(4,d)})}return n.$$set=S=>{"junctionIdx"in S&&r(0,l=S.junctionIdx),"stage"in S&&r(1,i=S.stage)},[l,i,s,u,d,t,o,a,c,m,p,y,E,k,h,O,j,A,C,z,q,B,W,Z,M,H]}class xo extends le{constructor(e){super(),ie(this,e,Yo,Qo,re,{junctionIdx:0,stage:1},null,[-1,-1])}}const{window:el}=He;function tl(n){let e,r,t,o,l,i,a,s,f,u,d,c,m,p;return{c(){e=b("div"),r=b("button"),r.textContent="Done",t=L(),o=b("button"),o.textContent="Delete JAT",l=L(),i=b("label"),a=R(`Name:
      `),s=b("input"),f=L(),u=b("button"),u.textContent="Existing",d=L(),c=b("button"),c.textContent="Proposed",P(s,"type","text"),P(e,"slot","sidebar")},m(y,E){v(y,e,E),g(e,r),g(e,t),g(e,o),g(e,l),g(e,i),g(i,a),g(i,s),_e(s,n[1].jats[n[0]].properties.name),g(e,f),g(e,u),g(e,d),g(e,c),m||(p=[J(r,"click",n[6]),J(o,"click",n[4]),J(s,"input",n[7]),J(u,"click",n[8]),J(c,"click",n[9])],m=!0)},p(y,E){E&3&&s.value!==y[1].jats[y[0]].properties.name&&_e(s,y[1].jats[y[0]].properties.name)},d(y){y&&w(e),m=!1,$e(p)}}}function nl(n){let e,r;return e=new Se({props:{filter:["!=",["id"],n[0]],paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":"black","circle-radius":20}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&1&&(l.filter=["!=",["id"],t[0]]),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function rl(n){let e,r,t,o,l,i,a,s;r=new Fe({props:{except:"jats"}}),o=new ge({props:{data:ne(n[1].jats),generateId:!0,$$slots:{default:[nl]},$$scope:{ctx:n}}});function f(d){n[5](d)}let u={radius:"50px",outline:!0,color:n[1].jats[n[0]].properties.color};return n[1].jats[n[0]].geometry.coordinates!==void 0&&(u.lngLat=n[1].jats[n[0]].geometry.coordinates),i=new it({props:u}),oe.push(()=>fe(i,"lngLat",f)),{c(){e=b("div"),T(r.$$.fragment),t=L(),T(o.$$.fragment),l=L(),T(i.$$.fragment),P(e,"slot","map")},m(d,c){v(d,e,c),I(r,e,null),g(e,t),I(o,e,null),g(e,l),I(i,e,null),s=!0},p(d,c){const m={};c&2&&(m.data=ne(d[1].jats)),c&1025&&(m.$$scope={dirty:c,ctx:d}),o.$set(m);const p={};c&3&&(p.color=d[1].jats[d[0]].properties.color),!a&&c&3&&(a=!0,p.lngLat=d[1].jats[d[0]].geometry.coordinates,de(()=>a=!1)),i.$set(p)},i(d){s||(_(r.$$.fragment,d),_(o.$$.fragment,d),_(i.$$.fragment,d),s=!0)},o(d){$(r.$$.fragment,d),$(o.$$.fragment,d),$(i.$$.fragment,d),s=!1},d(d){d&&w(e),N(r),N(o),N(i)}}}function ol(n){let e,r,t,o;return e=new Me({props:{$$slots:{map:[rl],sidebar:[tl]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},m(l,i){I(e,l,i),r=!0,t||(o=J(el,"keydown",n[3]),t=!0)},p(l,[i]){const a={};i&1031&&(a.$$scope={dirty:i,ctx:l}),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){$(e.$$.fragment,l),r=!1},d(l){N(e,l),t=!1,o()}}}function ll(n,e,r){let t,o;x(n,U,m=>r(1,t=m)),x(n,K,m=>r(2,o=m));let{idx:l}=e;function i(m){m.key=="Escape"&&G(K,o={kind:"neutral"},o)}async function a(){window.confirm("Really delete this JAT?")&&(G(K,o={kind:"neutral"},o),await qe(),t.jats.splice(l,1),U.set(t))}function s(m){n.$$.not_equal(t.jats[l].geometry.coordinates,m)&&(t.jats[l].geometry.coordinates=m,U.set(t))}const f=()=>G(K,o={kind:"neutral"},o);function u(){t.jats[l].properties.name=this.value,U.set(t)}const d=()=>G(K,o={kind:"edit-jat-detail",idx:l,stage:"existing"},o),c=()=>G(K,o={kind:"edit-jat-detail",idx:l,stage:"proposed"},o);return n.$$set=m=>{"idx"in m&&r(0,l=m.idx)},[l,t,o,i,a,s,f,u,d,c]}class il extends le{constructor(e){super(),ie(this,e,ll,ol,re,{idx:0})}}function en(n,e,r){const t=n.slice();return t[3]=e[r],t[4]=e,t[5]=r,t}function sl(n){let e,r;return{c(){e=b("span"),r=L(),P(e,"class","dot svelte-jgyhla")},m(t,o){v(t,e,o),v(t,r,o)},p:te,d(t){t&&(w(e),w(r))}}}function tn(n){let e,r,t;function o(i){n[2](i,n[3],n[4],n[5])}let l={draggable:!0,$$slots:{default:[sl]},$$scope:{ctx:n}};return n[3]!==void 0&&(l.lngLat=n[3]),e=new Be({props:l}),oe.push(()=>fe(e,"lngLat",o)),{c(){T(e.$$.fragment)},m(i,a){I(e,i,a),t=!0},p(i,a){n=i;const s={};a&64&&(s.$$scope={dirty:a,ctx:n}),!r&&a&1&&(r=!0,s.lngLat=n[3],de(()=>r=!1)),e.$set(s)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){$(e.$$.fragment,i),t=!1},d(i){N(e,i)}}}function al(n){let e,r,t,o;e=new Sn({}),e.$on("click",n[1]);let l=Q(n[0].geometry.coordinates),i=[];for(let s=0;s<l.length;s+=1)i[s]=tn(en(n,l,s));const a=s=>$(i[s],1,1,()=>{i[s]=null});return{c(){T(e.$$.fragment),r=L();for(let s=0;s<i.length;s+=1)i[s].c();t=Ge()},m(s,f){I(e,s,f),v(s,r,f);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(s,f);v(s,t,f),o=!0},p(s,[f]){if(f&1){l=Q(s[0].geometry.coordinates);let u;for(u=0;u<l.length;u+=1){const d=en(s,l,u);i[u]?(i[u].p(d,f),_(i[u],1)):(i[u]=tn(d),i[u].c(),_(i[u],1),i[u].m(t.parentNode,t))}for(ae(),u=l.length;u<i.length;u+=1)a(u);ue()}},i(s){if(!o){_(e.$$.fragment,s);for(let f=0;f<l.length;f+=1)_(i[f]);o=!0}},o(s){$(e.$$.fragment,s),i=i.filter(Boolean);for(let f=0;f<i.length;f+=1)$(i[f]);o=!1},d(s){s&&(w(r),w(t)),N(e,s),me(i,s)}}}function ul(n,e,r){let{f:t}=e;function o(i){t.geometry.coordinates.push(i.detail.lngLat.toArray()),r(0,t)}function l(i,a,s,f){s[f]=i,r(0,t)}return n.$$set=i=>{"f"in i&&r(0,t=i.f)},[t,o,l]}class Dn extends le{constructor(e){super(),ie(this,e,ul,al,re,{f:0})}}function cl(n){return{type:"Feature",geometry:{type:"LineString",coordinates:[]},properties:{name:"Untitled link",color:Ce[n%Ce.length],answers:Array(ye.length).fill("")}}}let ye=[{name:"Street or path check",description:"Is this on-carriageway or a traffic-free path?",choices:["","Street check","Path check"]},{name:"SA03",description:"lane widths",choices:ke()},{name:"SA04",description:"trip hazards",choices:ke()},{name:"SA05",description:"kerbside activity",choices:ke()},{name:"SA08",description:"motor traffic speed",choices:ke()},{name:"SA09",description:"motor traffic volume",choices:ke()},{name:"SA11",description:"footway widths",choices:ke()},{name:"SA12",description:"effective width next to tram lines",choices:ke()},{name:"SA13",description:"crossing angle of tram/train rails",choices:ke()},{name:"SA14",description:"cycling surface and maintenance defects",choices:ke()},{name:"SA15",description:"WW surface and maintenance defects",choices:ke()},{name:"SA16",description:"guard railing",choices:ke()}];const{window:fl}=He;function nn(n,e,r){const t=n.slice();return t[10]=e[r],t[11]=e,t[12]=r,t}function rn(n){let e;return{c(){e=b("p"),e.textContent="A link needs at least two points"},m(r,t){v(r,e,t)},d(r){r&&w(e)}}}function on(n){let e,r,t;function o(i){n[9](i,n[12])}let l={k:"horiz-radio",label:`${n[10].name}: ${n[10].description}`,choices:n[10].choices};return n[1].links[n[0]].properties.answers[n[12]]!==void 0&&(l.value=n[1].links[n[0]].properties.answers[n[12]]),e=new ze({props:l}),oe.push(()=>fe(e,"value",o)),{c(){T(e.$$.fragment)},m(i,a){I(e,i,a),t=!0},p(i,a){n=i;const s={};!r&&a&3&&(r=!0,s.value=n[1].links[n[0]].properties.answers[n[12]],de(()=>r=!1)),e.$set(s)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){$(e.$$.fragment,i),t=!1},d(i){N(e,i)}}}function dl(n){let e,r,t,o,l,i,a,s,f,u,d,c,m,p,y,E=!n[2]&&rn(),k=Q(ye),h=[];for(let j=0;j<k.length;j+=1)h[j]=on(nn(n,k,j));const O=j=>$(h[j],1,1,()=>{h[j]=null});return{c(){e=b("div"),r=b("button"),t=R("Done"),l=L(),i=b("button"),i.textContent="Delete link",a=L(),E&&E.c(),s=L(),f=b("label"),u=R(`Name:
      `),d=b("input"),c=L();for(let j=0;j<h.length;j+=1)h[j].c();r.disabled=o=!n[2],P(d,"type","text"),P(e,"slot","sidebar")},m(j,A){v(j,e,A),g(e,r),g(r,t),g(e,l),g(e,i),g(e,a),E&&E.m(e,null),g(e,s),g(e,f),g(f,u),g(f,d),_e(d,n[1].links[n[0]].properties.name),g(e,c);for(let C=0;C<h.length;C+=1)h[C]&&h[C].m(e,null);m=!0,p||(y=[J(r,"click",n[7]),J(i,"click",n[5]),J(d,"input",n[8])],p=!0)},p(j,A){if((!m||A&4&&o!==(o=!j[2]))&&(r.disabled=o),j[2]?E&&(E.d(1),E=null):E||(E=rn(),E.c(),E.m(e,s)),A&3&&d.value!==j[1].links[j[0]].properties.name&&_e(d,j[1].links[j[0]].properties.name),A&3){k=Q(ye);let C;for(C=0;C<k.length;C+=1){const z=nn(j,k,C);h[C]?(h[C].p(z,A),_(h[C],1)):(h[C]=on(z),h[C].c(),_(h[C],1),h[C].m(e,null))}for(ae(),C=k.length;C<h.length;C+=1)O(C);ue()}},i(j){if(!m){for(let A=0;A<k.length;A+=1)_(h[A]);m=!0}},o(j){h=h.filter(Boolean);for(let A=0;A<h.length;A+=1)$(h[A]);m=!1},d(j){j&&w(e),E&&E.d(),me(h,j),p=!1,$e(y)}}}function ml(n){let e,r;return e=new Ae({props:{paint:{"line-color":["case",["==",["id"],n[0]],["get","color"],"black"],"line-width":6}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&1&&(l.paint={"line-color":["case",["==",["id"],t[0]],["get","color"],"black"],"line-width":6}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function pl(n){let e,r,t,o,l,i,a,s;r=new Fe({props:{except:"links"}}),o=new ge({props:{data:ne(n[1].links),generateId:!0,$$slots:{default:[ml]},$$scope:{ctx:n}}});function f(d){n[6](d)}let u={};return n[1].links[n[0]]!==void 0&&(u.f=n[1].links[n[0]]),i=new Dn({props:u}),oe.push(()=>fe(i,"f",f)),{c(){e=b("div"),T(r.$$.fragment),t=L(),T(o.$$.fragment),l=L(),T(i.$$.fragment),P(e,"slot","map")},m(d,c){v(d,e,c),I(r,e,null),g(e,t),I(o,e,null),g(e,l),I(i,e,null),s=!0},p(d,c){const m={};c&2&&(m.data=ne(d[1].links)),c&8193&&(m.$$scope={dirty:c,ctx:d}),o.$set(m);const p={};!a&&c&3&&(a=!0,p.f=d[1].links[d[0]],de(()=>a=!1)),i.$set(p)},i(d){s||(_(r.$$.fragment,d),_(o.$$.fragment,d),_(i.$$.fragment,d),s=!0)},o(d){$(r.$$.fragment,d),$(o.$$.fragment,d),$(i.$$.fragment,d),s=!1},d(d){d&&w(e),N(r),N(o),N(i)}}}function gl(n){let e,r,t,o;return e=new Me({props:{$$slots:{map:[pl],sidebar:[dl]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},m(l,i){I(e,l,i),r=!0,t||(o=J(fl,"keydown",n[4]),t=!0)},p(l,[i]){const a={};i&8207&&(a.$$scope={dirty:i,ctx:l}),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){$(e.$$.fragment,l),r=!1},d(l){N(e,l),t=!1,o()}}}function _l(n,e,r){let t,o,l;x(n,U,m=>r(1,o=m)),x(n,K,m=>r(3,l=m));let{idx:i}=e;function a(m){m.key=="Escape"&&t&&G(K,l={kind:"neutral"},l)}async function s(){window.confirm("Really delete this link?")&&(G(K,l={kind:"neutral"},l),await qe(),o.links.splice(i,1),U.set(o))}function f(m){n.$$.not_equal(o.links[i],m)&&(o.links[i]=m,U.set(o))}const u=()=>G(K,l={kind:"neutral"},l);function d(){o.links[i].properties.name=this.value,U.set(o)}function c(m,p){n.$$.not_equal(o.links[i].properties.answers[p],m)&&(o.links[i].properties.answers[p]=m,U.set(o))}return n.$$set=m=>{"idx"in m&&r(0,i=m.idx)},n.$$.update=()=>{n.$$.dirty&3&&r(2,t=o.links[i].geometry.coordinates.length>=2)},[i,o,t,l,a,s,f,u,d,c]}class hl extends le{constructor(e){super(),ie(this,e,_l,gl,re,{idx:0})}}function ln(n,e,r){const t=n.slice();return t[6]=e[r],t[7]=e,t[8]=r,t}function sn(n){let e,r,t=n[6].properties.name+"",o,l,i,a,s,f;function u(c){n[5](c,n[6])}let d={k:"horiz-radio",label:"",choices:ye[n[0]].choices};return n[6].properties.answers[n[0]]!==void 0&&(d.value=n[6].properties.answers[n[0]]),i=new ze({props:d}),oe.push(()=>fe(i,"value",u)),{c(){e=b("li"),r=b("span"),o=R(t),l=L(),T(i.$$.fragment),s=L(),Y(r,"color",n[6].properties.color)},m(c,m){v(c,e,m),g(e,r),g(r,o),g(e,l),I(i,e,null),g(e,s),f=!0},p(c,m){n=c,(!f||m&4)&&t!==(t=n[6].properties.name+"")&&se(o,t),m&4&&Y(r,"color",n[6].properties.color);const p={};m&1&&(p.choices=ye[n[0]].choices),!a&&m&5&&(a=!0,p.value=n[6].properties.answers[n[0]],de(()=>a=!1)),i.$set(p)},i(c){f||(_(i.$$.fragment,c),f=!0)},o(c){$(i.$$.fragment,c),f=!1},d(c){c&&w(e),N(i)}}}function $l(n){let e,r,t,o,l=ye[n[0]].name+"",i,a,s=ye[n[0]].description+"",f,u,d,c,m,p,y=Q(n[2].links),E=[];for(let h=0;h<y.length;h+=1)E[h]=sn(ln(n,y,h));const k=h=>$(E[h],1,1,()=>{E[h]=null});return{c(){e=b("div"),r=b("button"),r.textContent="Done",t=L(),o=b("h2"),i=R(l),a=R(": "),f=R(s),u=L(),d=b("ol");for(let h=0;h<E.length;h+=1)E[h].c();P(e,"slot","sidebar")},m(h,O){v(h,e,O),g(e,r),g(e,t),g(e,o),g(o,i),g(o,a),g(o,f),g(e,u),g(e,d);for(let j=0;j<E.length;j+=1)E[j]&&E[j].m(d,null);c=!0,m||(p=J(r,"click",n[4]),m=!0)},p(h,O){if((!c||O&1)&&l!==(l=ye[h[0]].name+"")&&se(i,l),(!c||O&1)&&s!==(s=ye[h[0]].description+"")&&se(f,s),O&5){y=Q(h[2].links);let j;for(j=0;j<y.length;j+=1){const A=ln(h,y,j);E[j]?(E[j].p(A,O),_(E[j],1)):(E[j]=sn(A),E[j].c(),_(E[j],1),E[j].m(d,null))}for(ae(),j=y.length;j<E.length;j+=1)k(j);ue()}},i(h){if(!c){for(let O=0;O<y.length;O+=1)_(E[O]);c=!0}},o(h){E=E.filter(Boolean);for(let O=0;O<E.length;O+=1)$(E[O]);c=!1},d(h){h&&w(e),me(E,h),m=!1,p()}}}function kl(n){let e,r,t;return r=new Fe({props:{showLinkColor:!0,except:""}}),{c(){e=b("div"),T(r.$$.fragment),P(e,"slot","map")},m(o,l){v(o,e,l),I(r,e,null),t=!0},p:te,i(o){t||(_(r.$$.fragment,o),t=!0)},o(o){$(r.$$.fragment,o),t=!1},d(o){o&&w(e),N(r)}}}function bl(n){let e,r,t,o;return e=new Me({props:{$$slots:{map:[kl],sidebar:[$l]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},m(l,i){I(e,l,i),r=!0,t||(o=J(window,"keydown",n[3]),t=!0)},p(l,[i]){const a={};i&519&&(a.$$scope={dirty:i,ctx:l}),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){$(e.$$.fragment,l),r=!1},d(l){N(e,l),t=!1,o()}}}function vl(n,e,r){let t,o;x(n,K,f=>r(1,t=f)),x(n,U,f=>r(2,o=f));let{qIdx:l}=e;function i(f){f.key=="Escape"&&G(K,t={kind:"neutral"},t)}const a=()=>G(K,t={kind:"neutral"},t);function s(f,u){n.$$.not_equal(u.properties.answers[l],f)&&(u.properties.answers[l]=f,U.set(o))}return n.$$set=f=>{"qIdx"in f&&r(0,l=f.qIdx)},[l,t,o,i,a,s]}class wl extends le{constructor(e){super(),ie(this,e,vl,bl,re,{qIdx:0})}}function yl(n){let e,r,t,o;const l=n[2].default,i=Ie(l,n,n[1],null);return{c(){e=b("a"),i&&i.c(),P(e,"href","#"),Y(e,"color",n[0])},m(a,s){v(a,e,s),i&&i.m(e,null),r=!0,t||(o=J(e,"click",Vn(n[3])),t=!0)},p(a,[s]){i&&i.p&&(!r||s&2)&&Ne(i,l,a,a[1],r?De(l,a[1],s,null):Ee(a[1]),null),s&1&&Y(e,"color",a[0])},i(a){r||(_(i,a),r=!0)},o(a){$(i,a),r=!1},d(a){a&&w(e),i&&i.d(a),t=!1,o()}}}function jl(n,e,r){let{$$slots:t={},$$scope:o}=e,{color:l=void 0}=e;function i(a){be.call(this,n,a)}return n.$$set=a=>{"color"in a&&r(0,l=a.color),"$$scope"in a&&r(1,o=a.$$scope)},[l,o,t,i]}class Ke extends le{constructor(e){super(),ie(this,e,jl,yl,re,{color:0})}}function Cl(n,e){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{name:"Untitled bus stop",color:Ce[n%Ce.length],st20:""}}}function an(n,e,r){const t=n.slice();return t[5]=e[r],t[7]=r,t}function Al(n){let e=n[5].properties.name+"",r;return{c(){r=R(e)},m(t,o){v(t,r,o)},p(t,o){o&1&&e!==(e=t[5].properties.name+"")&&se(r,e)},d(t){t&&w(r)}}}function un(n){let e,r,t,o;function l(){return n[3](n[7])}return r=new Ke({props:{color:n[5].properties.color,$$slots:{default:[Al]},$$scope:{ctx:n}}}),r.$on("click",l),{c(){e=b("li"),T(r.$$.fragment),t=L()},m(i,a){v(i,e,a),I(r,e,null),g(e,t),o=!0},p(i,a){n=i;const s={};a&1&&(s.color=n[5].properties.color),a&257&&(s.$$scope={dirty:a,ctx:n}),r.$set(s)},i(i){o||(_(r.$$.fragment,i),o=!0)},o(i){$(r.$$.fragment,i),o=!1},d(i){i&&w(e),N(r)}}}function zl(n){let e,r,t,o,l,i,a,s,f=Q(n[0].bus_stops),u=[];for(let c=0;c<f.length;c+=1)u[c]=un(an(n,f,c));const d=c=>$(u[c],1,1,()=>{u[c]=null});return{c(){e=R(`Bus stops:

`),r=b("div"),t=b("button"),t.textContent="New bus stop",o=L(),l=b("ol");for(let c=0;c<u.length;c+=1)u[c].c()},m(c,m){v(c,e,m),v(c,r,m),g(r,t),v(c,o,m),v(c,l,m);for(let p=0;p<u.length;p+=1)u[p]&&u[p].m(l,null);i=!0,a||(s=J(t,"click",n[2]),a=!0)},p(c,[m]){if(m&3){f=Q(c[0].bus_stops);let p;for(p=0;p<f.length;p+=1){const y=an(c,f,p);u[p]?(u[p].p(y,m),_(u[p],1)):(u[p]=un(y),u[p].c(),_(u[p],1),u[p].m(l,null))}for(ae(),p=f.length;p<u.length;p+=1)d(p);ue()}},i(c){if(!i){for(let m=0;m<f.length;m+=1)_(u[m]);i=!0}},o(c){u=u.filter(Boolean);for(let m=0;m<u.length;m+=1)$(u[m]);i=!1},d(c){c&&(w(e),w(r),w(o),w(l)),me(u,c),a=!1,s()}}}function Ll(n,e,r){let t,o,l;x(n,U,s=>r(0,t=s)),x(n,K,s=>r(1,o=s)),x(n,Re,s=>r(4,l=s));function i(){if(!l)return;let s=Cl(t.bus_stops.length,l.getCenter().toArray());G(U,t.bus_stops=[...t.bus_stops,s],t),G(K,o={kind:"edit-bus-stop",idx:t.bus_stops.length-1},o)}return[t,o,i,s=>G(K,o={kind:"edit-bus-stop",idx:s},o)]}let Sl=class extends le{constructor(e){super(),ie(this,e,Ll,zl,re,{})}};function Ml(n,e){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{name:"Untitled crossing",color:Ce[n%Ce.length],sa10:""}}}function cn(n,e,r){const t=n.slice();return t[5]=e[r],t[7]=r,t}function Tl(n){let e=n[5].properties.name+"",r;return{c(){r=R(e)},m(t,o){v(t,r,o)},p(t,o){o&1&&e!==(e=t[5].properties.name+"")&&se(r,e)},d(t){t&&w(r)}}}function fn(n){let e,r,t,o;function l(){return n[3](n[7])}return r=new Ke({props:{color:n[5].properties.color,$$slots:{default:[Tl]},$$scope:{ctx:n}}}),r.$on("click",l),{c(){e=b("li"),T(r.$$.fragment),t=L()},m(i,a){v(i,e,a),I(r,e,null),g(e,t),o=!0},p(i,a){n=i;const s={};a&1&&(s.color=n[5].properties.color),a&257&&(s.$$scope={dirty:a,ctx:n}),r.$set(s)},i(i){o||(_(r.$$.fragment,i),o=!0)},o(i){$(r.$$.fragment,i),o=!1},d(i){i&&w(e),N(r)}}}function Il(n){let e,r,t,o,l,i,a,s,f=Q(n[0].crossings),u=[];for(let c=0;c<f.length;c+=1)u[c]=fn(cn(n,f,c));const d=c=>$(u[c],1,1,()=>{u[c]=null});return{c(){e=R(`Crossings:

`),r=b("div"),t=b("button"),t.textContent="New crossing",o=L(),l=b("ol");for(let c=0;c<u.length;c+=1)u[c].c()},m(c,m){v(c,e,m),v(c,r,m),g(r,t),v(c,o,m),v(c,l,m);for(let p=0;p<u.length;p+=1)u[p]&&u[p].m(l,null);i=!0,a||(s=J(t,"click",n[2]),a=!0)},p(c,[m]){if(m&3){f=Q(c[0].crossings);let p;for(p=0;p<f.length;p+=1){const y=cn(c,f,p);u[p]?(u[p].p(y,m),_(u[p],1)):(u[p]=fn(y),u[p].c(),_(u[p],1),u[p].m(l,null))}for(ae(),p=f.length;p<u.length;p+=1)d(p);ue()}},i(c){if(!i){for(let m=0;m<f.length;m+=1)_(u[m]);i=!0}},o(c){u=u.filter(Boolean);for(let m=0;m<u.length;m+=1)$(u[m]);i=!1},d(c){c&&(w(e),w(r),w(o),w(l)),me(u,c),a=!1,s()}}}function Nl(n,e,r){let t,o,l;x(n,U,s=>r(0,t=s)),x(n,K,s=>r(1,o=s)),x(n,Re,s=>r(4,l=s));function i(){if(!l)return;let s=Ml(t.crossings.length,l.getCenter().toArray());G(U,t.crossings=[...t.crossings,s],t),G(K,o={kind:"edit-crossing",idx:t.crossings.length-1},o)}return[t,o,i,s=>G(K,o={kind:"edit-crossing",idx:s},o)]}let El=class extends le{constructor(e){super(),ie(this,e,Nl,Il,re,{})}};function Dl(n,e){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{name:"Untitled JAT",color:Ce[n%Ce.length],existing:{arms:[],movements:[],notes:""},proposed:{arms:[],movements:[],notes:""}}}}function dn(n,e,r){const t=n.slice();return t[5]=e[r],t[7]=r,t}function ql(n){let e=n[5].properties.name+"",r;return{c(){r=R(e)},m(t,o){v(t,r,o)},p(t,o){o&1&&e!==(e=t[5].properties.name+"")&&se(r,e)},d(t){t&&w(r)}}}function mn(n){let e,r,t,o;function l(){return n[3](n[7])}return r=new Ke({props:{color:n[5].properties.color,$$slots:{default:[ql]},$$scope:{ctx:n}}}),r.$on("click",l),{c(){e=b("li"),T(r.$$.fragment),t=L()},m(i,a){v(i,e,a),I(r,e,null),g(e,t),o=!0},p(i,a){n=i;const s={};a&1&&(s.color=n[5].properties.color),a&257&&(s.$$scope={dirty:a,ctx:n}),r.$set(s)},i(i){o||(_(r.$$.fragment,i),o=!0)},o(i){$(r.$$.fragment,i),o=!1},d(i){i&&w(e),N(r)}}}function Fl(n){let e,r,t,o,l,i,a,s,f=Q(n[0].jats),u=[];for(let c=0;c<f.length;c+=1)u[c]=mn(dn(n,f,c));const d=c=>$(u[c],1,1,()=>{u[c]=null});return{c(){e=R(`JATs:

`),r=b("div"),t=b("button"),t.textContent="New JAT",o=L(),l=b("ol");for(let c=0;c<u.length;c+=1)u[c].c()},m(c,m){v(c,e,m),v(c,r,m),g(r,t),v(c,o,m),v(c,l,m);for(let p=0;p<u.length;p+=1)u[p]&&u[p].m(l,null);i=!0,a||(s=J(t,"click",n[2]),a=!0)},p(c,[m]){if(m&3){f=Q(c[0].jats);let p;for(p=0;p<f.length;p+=1){const y=dn(c,f,p);u[p]?(u[p].p(y,m),_(u[p],1)):(u[p]=mn(y),u[p].c(),_(u[p],1),u[p].m(l,null))}for(ae(),p=f.length;p<u.length;p+=1)d(p);ue()}},i(c){if(!i){for(let m=0;m<f.length;m+=1)_(u[m]);i=!0}},o(c){u=u.filter(Boolean);for(let m=0;m<u.length;m+=1)$(u[m]);i=!1},d(c){c&&(w(e),w(r),w(o),w(l)),me(u,c),a=!1,s()}}}function Pl(n,e,r){let t,o,l;x(n,U,s=>r(0,t=s)),x(n,K,s=>r(1,o=s)),x(n,Re,s=>r(4,l=s));function i(){if(!l)return;let s=Dl(t.jats.length,l.getCenter().toArray());G(U,t.jats=[...t.jats,s],t),G(K,o={kind:"edit-jat",idx:t.jats.length-1},o)}return[t,o,i,s=>G(K,o={kind:"edit-jat",idx:s},o)]}let Ol=class extends le{constructor(e){super(),ie(this,e,Pl,Fl,re,{})}};function pn(n,e,r){const t=n.slice();return t[2]=e[r],t[4]=r,t}function gn(n,e,r){const t=n.slice();t[5]=e[r];const o=t[5].properties.answers[t[4]];return t[6]=o,t}function _n(n,e,r){const t=n.slice();return t[5]=e[r],t}function hn(n){let e,r=n[5].properties.name+"",t;return{c(){e=b("th"),t=R(r),Y(e,"color",n[5].properties.color)},m(o,l){v(o,e,l),g(e,t)},p(o,l){l&1&&r!==(r=o[5].properties.name+"")&&se(t,r),l&1&&Y(e,"color",o[5].properties.color)},d(o){o&&w(e)}}}function $n(n){let e,r=n[6]+"",t;return{c(){e=b("td"),t=R(r),Y(e,"background",n[6]==""?"red":"green")},m(o,l){v(o,e,l),g(e,t)},p(o,l){l&1&&r!==(r=o[6]+"")&&se(t,r),l&1&&Y(e,"background",o[6]==""?"red":"green")},d(o){o&&w(e)}}}function kn(n){let e,r,t,o,l=Q(n[0].links),i=[];for(let a=0;a<l.length;a+=1)i[a]=$n(gn(n,l,a));return{c(){e=b("tr"),r=b("th"),r.textContent=`${n[2].name}`,t=L();for(let a=0;a<i.length;a+=1)i[a].c();o=L()},m(a,s){v(a,e,s),g(e,r),g(e,t);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(e,null);g(e,o)},p(a,s){if(s&1){l=Q(a[0].links);let f;for(f=0;f<l.length;f+=1){const u=gn(a,l,f);i[f]?i[f].p(u,s):(i[f]=$n(u),i[f].c(),i[f].m(e,o))}for(;f<i.length;f+=1)i[f].d(1);i.length=l.length}},d(a){a&&w(e),me(i,a)}}}function Bl(n){let e,r,t,o,l,i,a,s=Q(n[0].links),f=[];for(let c=0;c<s.length;c+=1)f[c]=hn(_n(n,s,c));let u=Q(ye),d=[];for(let c=0;c<u.length;c+=1)d[c]=kn(pn(n,u,c));return{c(){e=b("table"),r=b("thead"),t=b("tr"),o=b("th"),l=L();for(let c=0;c<f.length;c+=1)f[c].c();i=L(),a=b("tbody");for(let c=0;c<d.length;c+=1)d[c].c()},m(c,m){v(c,e,m),g(e,r),g(r,t),g(t,o),g(t,l);for(let p=0;p<f.length;p+=1)f[p]&&f[p].m(t,null);g(e,i),g(e,a);for(let p=0;p<d.length;p+=1)d[p]&&d[p].m(a,null)},p(c,m){if(m&1){s=Q(c[0].links);let p;for(p=0;p<s.length;p+=1){const y=_n(c,s,p);f[p]?f[p].p(y,m):(f[p]=hn(y),f[p].c(),f[p].m(t,null))}for(;p<f.length;p+=1)f[p].d(1);f.length=s.length}if(m&1){u=Q(ye);let p;for(p=0;p<u.length;p+=1){const y=pn(c,u,p);d[p]?d[p].p(y,m):(d[p]=kn(y),d[p].c(),d[p].m(a,null))}for(;p<d.length;p+=1)d[p].d(1);d.length=u.length}},d(c){c&&w(e),me(f,c),me(d,c)}}}function Ul(n){let e,r;return e=new In({props:{$$slots:{default:[Bl]},$$scope:{ctx:n}}}),e.$on("close",n[1]),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,[o]){const l={};o&2049&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function Jl(n,e,r){let t;x(n,U,l=>r(0,t=l));function o(l){be.call(this,n,l)}return[t,o]}class Rl extends le{constructor(e){super(),ie(this,e,Jl,Ul,re,{})}}function bn(n,e,r){const t=n.slice();return t[9]=e[r],t[11]=r,t}function vn(n,e,r){const t=n.slice();return t[12]=e[r],t[11]=r,t}function wn(n){let e,r;return e=new Rl({}),e.$on("close",n[4]),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p:te,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function Gl(n){let e=n[12].properties.name+"",r;return{c(){r=R(e)},m(t,o){v(t,r,o)},p(t,o){o&2&&e!==(e=t[12].properties.name+"")&&se(r,e)},d(t){t&&w(r)}}}function yn(n){let e,r,t,o;function l(){return n[6](n[11])}return r=new Ke({props:{color:n[12].properties.color,$$slots:{default:[Gl]},$$scope:{ctx:n}}}),r.$on("click",l),{c(){e=b("li"),T(r.$$.fragment),t=L()},m(i,a){v(i,e,a),I(r,e,null),g(e,t),o=!0},p(i,a){n=i;const s={};a&2&&(s.color=n[12].properties.color),a&16386&&(s.$$scope={dirty:a,ctx:n}),r.$set(s)},i(i){o||(_(r.$$.fragment,i),o=!0)},o(i){$(r.$$.fragment,i),o=!1},d(i){i&&w(e),N(r)}}}function Hl(n){let e=n[9].name+"",r,t;return{c(){r=R(e),t=L()},m(o,l){v(o,r,l),v(o,t,l)},p:te,d(o){o&&(w(r),w(t))}}}function jn(n){let e,r,t,o,l,i,a,s;function f(){return n[7](n[11])}r=new Ke({props:{$$slots:{default:[Hl]},$$scope:{ctx:n}}}),r.$on("click",f);function u(...d){return n[8](n[11],...d)}return{c(){e=b("li"),T(r.$$.fragment),t=R(`:
      `),o=b("progress"),a=L(),o.value=l=n[1].links.filter(u).length,P(o,"max",i=n[1].links.length),P(o,"class","svelte-zadug4")},m(d,c){v(d,e,c),I(r,e,null),g(e,t),g(e,o),g(e,a),s=!0},p(d,c){n=d;const m={};c&16384&&(m.$$scope={dirty:c,ctx:n}),r.$set(m),(!s||c&2&&l!==(l=n[1].links.filter(u).length))&&(o.value=l),(!s||c&2&&i!==(i=n[1].links.length))&&P(o,"max",i)},i(d){s||(_(r.$$.fragment,d),s=!0)},o(d){$(r.$$.fragment,d),s=!1},d(d){d&&w(e),N(r)}}}function Kl(n){let e,r,t,o,l,i,a,s,f,u,d,c,m=n[0]&&wn(n),p=Q(n[1].links),y=[];for(let j=0;j<p.length;j+=1)y[j]=yn(vn(n,p,j));const E=j=>$(y[j],1,1,()=>{y[j]=null});let k=Q(ye),h=[];for(let j=0;j<k.length;j+=1)h[j]=jn(bn(n,k,j));const O=j=>$(h[j],1,1,()=>{h[j]=null});return{c(){m&&m.c(),e=L(),r=b("div"),t=b("button"),t.textContent="New link",o=L(),l=b("button"),l.textContent="Table of questions",i=R(`

Links:
`),a=b("ol");for(let j=0;j<y.length;j+=1)y[j].c();s=R(`

Questions:
`),f=b("ol");for(let j=0;j<h.length;j+=1)h[j].c()},m(j,A){m&&m.m(j,A),v(j,e,A),v(j,r,A),g(r,t),g(r,o),g(r,l),v(j,i,A),v(j,a,A);for(let C=0;C<y.length;C+=1)y[C]&&y[C].m(a,null);v(j,s,A),v(j,f,A);for(let C=0;C<h.length;C+=1)h[C]&&h[C].m(f,null);u=!0,d||(c=[J(t,"click",n[3]),J(l,"click",n[5])],d=!0)},p(j,[A]){if(j[0]?m?(m.p(j,A),A&1&&_(m,1)):(m=wn(j),m.c(),_(m,1),m.m(e.parentNode,e)):m&&(ae(),$(m,1,1,()=>{m=null}),ue()),A&6){p=Q(j[1].links);let C;for(C=0;C<p.length;C+=1){const z=vn(j,p,C);y[C]?(y[C].p(z,A),_(y[C],1)):(y[C]=yn(z),y[C].c(),_(y[C],1),y[C].m(a,null))}for(ae(),C=p.length;C<y.length;C+=1)E(C);ue()}if(A&6){k=Q(ye);let C;for(C=0;C<k.length;C+=1){const z=bn(j,k,C);h[C]?(h[C].p(z,A),_(h[C],1)):(h[C]=jn(z),h[C].c(),_(h[C],1),h[C].m(f,null))}for(ae(),C=k.length;C<h.length;C+=1)O(C);ue()}},i(j){if(!u){_(m);for(let A=0;A<p.length;A+=1)_(y[A]);for(let A=0;A<k.length;A+=1)_(h[A]);u=!0}},o(j){$(m),y=y.filter(Boolean);for(let A=0;A<y.length;A+=1)$(y[A]);h=h.filter(Boolean);for(let A=0;A<h.length;A+=1)$(h[A]);u=!1},d(j){j&&(w(e),w(r),w(i),w(a),w(s),w(f)),m&&m.d(j),me(y,j),me(h,j),d=!1,$e(c)}}}function Xl(n,e,r){let t,o;x(n,U,c=>r(1,t=c)),x(n,K,c=>r(2,o=c));let l=!1;function i(){let c=cl(t.links.length);G(U,t.links=[...t.links,c],t),G(K,o={kind:"edit-link",idx:t.links.length-1},o)}return[l,t,o,i,()=>r(0,l=!1),()=>r(0,l=!0),c=>G(K,o={kind:"edit-link",idx:c},o),c=>G(K,o={kind:"edit-question",idx:c},o),(c,m)=>m.properties.answers[c]!=""]}let Zl=class extends le{constructor(e){super(),ie(this,e,Xl,Kl,re,{})}};function Vl(n){return{type:"Feature",geometry:{type:"LineString",coordinates:[]},properties:{name:"Untitled side road",color:Ce[n%Ce.length],sa01:""}}}function Cn(n,e,r){const t=n.slice();return t[4]=e[r],t[6]=r,t}function Wl(n){let e=n[4].properties.name+"",r;return{c(){r=R(e)},m(t,o){v(t,r,o)},p(t,o){o&1&&e!==(e=t[4].properties.name+"")&&se(r,e)},d(t){t&&w(r)}}}function An(n){let e,r,t,o;function l(){return n[3](n[6])}return r=new Ke({props:{color:n[4].properties.color,$$slots:{default:[Wl]},$$scope:{ctx:n}}}),r.$on("click",l),{c(){e=b("li"),T(r.$$.fragment),t=L()},m(i,a){v(i,e,a),I(r,e,null),g(e,t),o=!0},p(i,a){n=i;const s={};a&1&&(s.color=n[4].properties.color),a&129&&(s.$$scope={dirty:a,ctx:n}),r.$set(s)},i(i){o||(_(r.$$.fragment,i),o=!0)},o(i){$(r.$$.fragment,i),o=!1},d(i){i&&w(e),N(r)}}}function Ql(n){let e,r,t,o,l,i,a,s,f=Q(n[0].side_roads),u=[];for(let c=0;c<f.length;c+=1)u[c]=An(Cn(n,f,c));const d=c=>$(u[c],1,1,()=>{u[c]=null});return{c(){e=R(`Side roads:

`),r=b("div"),t=b("button"),t.textContent="New side road",o=L(),l=b("ol");for(let c=0;c<u.length;c+=1)u[c].c()},m(c,m){v(c,e,m),v(c,r,m),g(r,t),v(c,o,m),v(c,l,m);for(let p=0;p<u.length;p+=1)u[p]&&u[p].m(l,null);i=!0,a||(s=J(t,"click",n[2]),a=!0)},p(c,[m]){if(m&3){f=Q(c[0].side_roads);let p;for(p=0;p<f.length;p+=1){const y=Cn(c,f,p);u[p]?(u[p].p(y,m),_(u[p],1)):(u[p]=An(y),u[p].c(),_(u[p],1),u[p].m(l,null))}for(ae(),p=f.length;p<u.length;p+=1)d(p);ue()}},i(c){if(!i){for(let m=0;m<f.length;m+=1)_(u[m]);i=!0}},o(c){u=u.filter(Boolean);for(let m=0;m<u.length;m+=1)$(u[m]);i=!1},d(c){c&&(w(e),w(r),w(o),w(l)),me(u,c),a=!1,s()}}}function Yl(n,e,r){let t,o;x(n,U,a=>r(0,t=a)),x(n,K,a=>r(1,o=a));function l(){let a=Vl(t.side_roads.length);G(U,t.side_roads=[...t.side_roads,a],t),G(K,o={kind:"edit-side-road",idx:t.side_roads.length-1},o)}return[t,o,l,a=>G(K,o={kind:"edit-side-road",idx:a},o)]}class xl extends le{constructor(e){super(),ie(this,e,Yl,Ql,re,{})}}function ei(n){let e,r,t,o,l,i,a,s,f,u,d,c,m,p,y,E,k,h,O,j,A,C,z,q,B,W,Z,M;return f=new Zl({}),m=new Ol({}),k=new Sl({}),A=new El({}),B=new xl({}),{c(){e=b("div"),r=b("div"),t=b("button"),t.textContent="Download",o=L(),l=b("button"),l.textContent="Clear",i=L(),a=b("hr"),s=L(),T(f.$$.fragment),u=L(),d=b("hr"),c=L(),T(m.$$.fragment),p=L(),y=b("hr"),E=L(),T(k.$$.fragment),h=L(),O=b("hr"),j=L(),T(A.$$.fragment),C=L(),z=b("hr"),q=L(),T(B.$$.fragment),P(t,"class","secondary"),P(l,"class","secondary"),P(e,"slot","sidebar")},m(H,S){v(H,e,S),g(e,r),g(r,t),g(r,o),g(r,l),g(e,i),g(e,a),g(e,s),I(f,e,null),g(e,u),g(e,d),g(e,c),I(m,e,null),g(e,p),g(e,y),g(e,E),I(k,e,null),g(e,h),g(e,O),g(e,j),I(A,e,null),g(e,C),g(e,z),g(e,q),I(B,e,null),W=!0,Z||(M=[J(t,"click",n[8]),J(l,"click",n[2])],Z=!0)},p:te,i(H){W||(_(f.$$.fragment,H),_(m.$$.fragment,H),_(k.$$.fragment,H),_(A.$$.fragment,H),_(B.$$.fragment,H),W=!0)},o(H){$(f.$$.fragment,H),$(m.$$.fragment,H),$(k.$$.fragment,H),$(A.$$.fragment,H),$(B.$$.fragment,H),W=!1},d(H){H&&w(e),N(f),N(m),N(k),N(A),N(B),Z=!1,$e(M)}}}function ti(n){let e,r;return e=new Ae({props:{manageHoverState:!0,paint:{"line-color":["get","color"],"line-width":Je(6,9)},hoverCursor:"pointer"}}),e.$on("click",n[3]),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p:te,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function ni(n){let e,r;return e=new Se({props:{manageHoverState:!0,paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":["get","color"],"circle-radius":Je(20,25)},hoverCursor:"pointer"}}),e.$on("click",n[4]),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p:te,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function ri(n){let e,r;return e=new tt({props:{manageHoverState:!0,layout:{"icon-image":"bus_stop","icon-size":3},paint:{"icon-color":["get","color"]},hoverCursor:"pointer"}}),e.$on("click",n[5]),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p:te,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function oi(n){let e,r;return e=new Se({props:{manageHoverState:!0,paint:{"circle-color":["get","color"],"circle-radius":Je(10,15)},hoverCursor:"pointer"}}),e.$on("click",n[6]),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p:te,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function li(n){let e,r;return e=new Ae({props:{manageHoverState:!0,paint:{"line-color":["get","color"],"line-width":Je(3,6)},hoverCursor:"pointer"}}),e.$on("click",n[7]),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p:te,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function ii(n){let e,r,t,o,l,i,a,s,f,u,d;return r=new ge({props:{data:ne(n[0].links),generateId:!0,$$slots:{default:[ti]},$$scope:{ctx:n}}}),o=new ge({props:{data:ne(n[0].jats),generateId:!0,$$slots:{default:[ni]},$$scope:{ctx:n}}}),i=new ge({props:{data:ne(n[0].bus_stops),generateId:!0,$$slots:{default:[ri]},$$scope:{ctx:n}}}),s=new ge({props:{data:ne(n[0].crossings),generateId:!0,$$slots:{default:[oi]},$$scope:{ctx:n}}}),u=new ge({props:{data:ne(n[0].side_roads),generateId:!0,$$slots:{default:[li]},$$scope:{ctx:n}}}),{c(){e=b("div"),T(r.$$.fragment),t=L(),T(o.$$.fragment),l=L(),T(i.$$.fragment),a=L(),T(s.$$.fragment),f=L(),T(u.$$.fragment),P(e,"slot","map")},m(c,m){v(c,e,m),I(r,e,null),g(e,t),I(o,e,null),g(e,l),I(i,e,null),g(e,a),I(s,e,null),g(e,f),I(u,e,null),d=!0},p(c,m){const p={};m&1&&(p.data=ne(c[0].links)),m&514&&(p.$$scope={dirty:m,ctx:c}),r.$set(p);const y={};m&1&&(y.data=ne(c[0].jats)),m&514&&(y.$$scope={dirty:m,ctx:c}),o.$set(y);const E={};m&1&&(E.data=ne(c[0].bus_stops)),m&514&&(E.$$scope={dirty:m,ctx:c}),i.$set(E);const k={};m&1&&(k.data=ne(c[0].crossings)),m&514&&(k.$$scope={dirty:m,ctx:c}),s.$set(k);const h={};m&1&&(h.data=ne(c[0].side_roads)),m&514&&(h.$$scope={dirty:m,ctx:c}),u.$set(h)},i(c){d||(_(r.$$.fragment,c),_(o.$$.fragment,c),_(i.$$.fragment,c),_(s.$$.fragment,c),_(u.$$.fragment,c),d=!0)},o(c){$(r.$$.fragment,c),$(o.$$.fragment,c),$(i.$$.fragment,c),$(s.$$.fragment,c),$(u.$$.fragment,c),d=!1},d(c){c&&w(e),N(r),N(o),N(i),N(s),N(u)}}}function si(n){let e,r;return e=new Me({props:{$$slots:{map:[ii],sidebar:[ei]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,[o]){const l={};o&515&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function ai(n,e,r){let t,o;x(n,U,c=>r(0,t=c)),x(n,K,c=>r(1,o=c));function l(){G(U,t.links=[],t),G(U,t.jats=[],t),G(U,t.bus_stops=[],t),G(U,t.crossings=[],t),G(U,t.side_roads=[],t)}return[t,o,l,c=>G(K,o={kind:"edit-link",idx:c.detail.features[0].id},o),c=>G(K,o={kind:"edit-jat",idx:c.detail.features[0].id},o),c=>G(K,o={kind:"edit-bus-stop",idx:c.detail.features[0].id},o),c=>G(K,o={kind:"edit-crossing",idx:c.detail.features[0].id},o),c=>G(K,o={kind:"edit-side-road",idx:c.detail.features[0].id},o),()=>Kr("rcv2.geojson",JSON.stringify(t))]}class ui extends le{constructor(e){super(),ie(this,e,ai,si,re,{})}}const{window:ci}=He;function zn(n){let e;return{c(){e=b("p"),e.textContent="A side road needs at least two points"},m(r,t){v(r,e,t)},d(r){r&&w(e)}}}function fi(n){let e,r,t,o,l,i,a,s,f,u,d,c,m,p,y,E,k,h=!n[2]&&zn();function O(A){n[9](A)}let j={k:"horiz-radio",label:"SA01: conflict at side roads and priority junctions",choices:ke()};return n[1].side_roads[n[0]].properties.sa01!==void 0&&(j.value=n[1].side_roads[n[0]].properties.sa01),m=new ze({props:j}),oe.push(()=>fe(m,"value",O)),{c(){e=b("div"),r=b("button"),t=R("Done"),l=L(),i=b("button"),i.textContent="Delete side road",a=L(),h&&h.c(),s=L(),f=b("label"),u=R(`Name:
      `),d=b("input"),c=L(),T(m.$$.fragment),r.disabled=o=!n[2],P(d,"type","text"),P(e,"slot","sidebar")},m(A,C){v(A,e,C),g(e,r),g(r,t),g(e,l),g(e,i),g(e,a),h&&h.m(e,null),g(e,s),g(e,f),g(f,u),g(f,d),_e(d,n[1].side_roads[n[0]].properties.name),g(e,c),I(m,e,null),y=!0,E||(k=[J(r,"click",n[7]),J(i,"click",n[5]),J(d,"input",n[8])],E=!0)},p(A,C){(!y||C&4&&o!==(o=!A[2]))&&(r.disabled=o),A[2]?h&&(h.d(1),h=null):h||(h=zn(),h.c(),h.m(e,s)),C&3&&d.value!==A[1].side_roads[A[0]].properties.name&&_e(d,A[1].side_roads[A[0]].properties.name);const z={};!p&&C&3&&(p=!0,z.value=A[1].side_roads[A[0]].properties.sa01,de(()=>p=!1)),m.$set(z)},i(A){y||(_(m.$$.fragment,A),y=!0)},o(A){$(m.$$.fragment,A),y=!1},d(A){A&&w(e),h&&h.d(),N(m),E=!1,$e(k)}}}function di(n){let e,r;return e=new Ae({props:{paint:{"line-color":["case",["==",["id"],n[0]],["get","color"],"black"],"line-width":3}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&1&&(l.paint={"line-color":["case",["==",["id"],t[0]],["get","color"],"black"],"line-width":3}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function mi(n){let e,r,t,o,l,i,a,s;r=new Fe({props:{except:"side_roads"}}),o=new ge({props:{data:ne(n[1].side_roads),generateId:!0,$$slots:{default:[di]},$$scope:{ctx:n}}});function f(d){n[6](d)}let u={};return n[1].side_roads[n[0]]!==void 0&&(u.f=n[1].side_roads[n[0]]),i=new Dn({props:u}),oe.push(()=>fe(i,"f",f)),{c(){e=b("div"),T(r.$$.fragment),t=L(),T(o.$$.fragment),l=L(),T(i.$$.fragment),P(e,"slot","map")},m(d,c){v(d,e,c),I(r,e,null),g(e,t),I(o,e,null),g(e,l),I(i,e,null),s=!0},p(d,c){const m={};c&2&&(m.data=ne(d[1].side_roads)),c&1025&&(m.$$scope={dirty:c,ctx:d}),o.$set(m);const p={};!a&&c&3&&(a=!0,p.f=d[1].side_roads[d[0]],de(()=>a=!1)),i.$set(p)},i(d){s||(_(r.$$.fragment,d),_(o.$$.fragment,d),_(i.$$.fragment,d),s=!0)},o(d){$(r.$$.fragment,d),$(o.$$.fragment,d),$(i.$$.fragment,d),s=!1},d(d){d&&w(e),N(r),N(o),N(i)}}}function pi(n){let e,r,t,o;return e=new Me({props:{$$slots:{map:[mi],sidebar:[fi]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},m(l,i){I(e,l,i),r=!0,t||(o=J(ci,"keydown",n[4]),t=!0)},p(l,[i]){const a={};i&1039&&(a.$$scope={dirty:i,ctx:l}),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){$(e.$$.fragment,l),r=!1},d(l){N(e,l),t=!1,o()}}}function gi(n,e,r){let t,o,l;x(n,U,m=>r(1,o=m)),x(n,K,m=>r(3,l=m));let{idx:i}=e;function a(m){m.key=="Escape"&&G(K,l={kind:"neutral"},l)}async function s(){window.confirm("Really delete this side road?")&&(G(K,l={kind:"neutral"},l),await qe(),o.side_roads.splice(i,1),U.set(o))}function f(m){n.$$.not_equal(o.side_roads[i],m)&&(o.side_roads[i]=m,U.set(o))}const u=()=>G(K,l={kind:"neutral"},l);function d(){o.side_roads[i].properties.name=this.value,U.set(o)}function c(m){n.$$.not_equal(o.side_roads[i].properties.sa01,m)&&(o.side_roads[i].properties.sa01=m,U.set(o))}return n.$$set=m=>{"idx"in m&&r(0,i=m.idx)},n.$$.update=()=>{n.$$.dirty&3&&r(2,t=o.side_roads[i].geometry.coordinates.length>=2)},[i,o,t,l,a,s,f,u,d,c]}class _i extends le{constructor(e){super(),ie(this,e,gi,pi,re,{idx:0})}}function hi(n){let e,r;return{c(){e=b("div"),r=b("div"),P(e,"slot","left")},m(t,o){v(t,e,o),g(e,r),n[9](r)},p:te,d(t){t&&w(e),n[9](null)}}}function $i(n){return{c:te,m:te,p:te,i:te,o:te,d:te}}function ki(n){let e,r,t;function o(i){n[8](i)}let l={style:n[10],standardControls:!0,hash:!0,images:[{id:"bus_stop",url:Mn,options:{sdf:!0}}],$$slots:{default:[Li]},$$scope:{ctx:n}};return n[2]!==void 0&&(l.map=n[2]),e=new Qn({props:l}),oe.push(()=>fe(e,"map",o)),{c(){T(e.$$.fragment)},m(i,a){I(e,i,a),t=!0},p(i,a){const s={};a&2058&&(s.$$scope={dirty:a,ctx:i}),!r&&a&4&&(r=!0,s.map=i[2],de(()=>r=!1)),e.$set(s)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){$(e.$$.fragment,i),t=!1},d(i){N(e,i)}}}function bi(n){let e,r;return e=new wl({props:{qIdx:n[3].idx}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.qIdx=t[3].idx),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function vi(n){let e,r;return e=new _i({props:{idx:n[3].idx}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.idx=t[3].idx),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function wi(n){let e,r;return e=new Fr({props:{idx:n[3].idx}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.idx=t[3].idx),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function yi(n){let e,r;return e=new Mr({props:{idx:n[3].idx}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.idx=t[3].idx),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function ji(n){let e,r;return e=new xo({props:{junctionIdx:n[3].idx,stage:n[3].stage}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.junctionIdx=t[3].idx),o&8&&(l.stage=t[3].stage),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function Ci(n){let e,r;return e=new il({props:{idx:n[3].idx}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.idx=t[3].idx),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function Ai(n){let e,r;return e=new hl({props:{idx:n[3].idx}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.idx=t[3].idx),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function zi(n){let e,r;return e=new ui({}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p:te,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function Li(n){let e,r,t,o,l,i;const a=[zi,Ai,Ci,ji,yi,wi,vi,bi],s=[];function f(u,d){return u[3].kind=="neutral"?0:u[3].kind=="edit-link"?1:u[3].kind=="edit-jat"?2:u[3].kind=="edit-jat-detail"?3:u[3].kind=="edit-bus-stop"?4:u[3].kind=="edit-crossing"?5:u[3].kind=="edit-side-road"?6:u[3].kind=="edit-question"?7:-1}return~(t=f(n))&&(o=s[t]=a[t](n)),{c(){e=b("div"),r=L(),o&&o.c(),l=Ge()},m(u,d){v(u,e,d),n[7](e),v(u,r,d),~t&&s[t].m(u,d),v(u,l,d),i=!0},p(u,d){let c=t;t=f(u),t===c?~t&&s[t].p(u,d):(o&&(ae(),$(s[c],1,1,()=>{s[c]=null}),ue()),~t?(o=s[t],o?o.p(u,d):(o=s[t]=a[t](u),o.c()),_(o,1),o.m(l.parentNode,l)):o=null)},i(u){i||(_(o),i=!0)},o(u){$(o),i=!1},d(u){u&&(w(e),w(r),w(l)),n[7](null),~t&&s[t].d(u)}}}function Si(n){return{c:te,m:te,p:te,i:te,o:te,d:te}}function Mi(n){let e,r,t={ctx:n,current:null,token:null,hasCatch:!1,pending:Si,then:ki,catch:$i,value:10,blocks:[,,,]};return Yn(Pr(new URLSearchParams(window.location.search).get("google")||""),t),{c(){e=b("div"),t.block.c(),P(e,"slot","main"),Y(e,"position","relative"),Y(e,"width","100%"),Y(e,"height","100vh")},m(o,l){v(o,e,l),t.block.m(e,t.anchor=null),t.mount=()=>e,t.anchor=null,r=!0},p(o,l){n=o,xn(t,n,l)},i(o){r||(_(t.block),r=!0)},o(o){for(let l=0;l<3;l+=1){const i=t.blocks[l];$(i)}r=!1},d(o){o&&w(e),t.block.d(),t.token=null,t=null}}}function Ti(n){let e,r;return e=new Wn({props:{$$slots:{main:[Mi],left:[hi]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},m(t,o){I(e,t,o),r=!0},p(t,[o]){const l={};o&2063&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function Ii(n,e,r){let t,o,l,i,a;x(n,lt,m=>r(4,t=m)),x(n,ot,m=>r(5,o=m)),x(n,U,m=>r(6,l=m)),x(n,Re,m=>r(2,i=m)),x(n,K,m=>r(3,a=m));let s,f;function u(m){oe[m?"unshift":"push"](()=>{f=m,r(1,f),r(4,t)})}function d(m){i=m,Re.set(i)}function c(m){oe[m?"unshift":"push"](()=>{s=m,r(0,s),r(5,o)})}return n.$$.update=()=>{n.$$.dirty&64&&window.localStorage.setItem("tmp-rcv2",JSON.stringify(l)),n.$$.dirty&33&&s&&o&&(r(0,s.innerHTML="",s),s.appendChild(o)),n.$$.dirty&18&&f&&t&&(r(1,f.innerHTML="",f),f.appendChild(t))},[s,f,i,a,t,o,l,u,d,c]}class Ni extends le{constructor(e){super(),ie(this,e,Ii,Ti,re,{})}}new Ni({target:document.getElementById("app")});
