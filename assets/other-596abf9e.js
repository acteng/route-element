import{W as sr,X as ar,Y as xe,v as se,e as k,w as ae,t as _,Z as cr,S as oe,i as le,s as re,h as Ce,z as b,B as F,_ as Ae,r as h,u as je,j as ze,k as Se,x as $,$ as Vn,a0 as ee,a1 as ut,b as ue,a2 as mt,Q as g,R as Q,l as ke,a3 as ur,L as fr,a as me,c as B,m as L,d as pe,f as M,g as Yn,q as Te,a4 as pt,a5 as dr,a6 as mr,a7 as H,a8 as pr,a9 as gr,C as V,aa as _r,A as z,ab as Ye,M as Qe,V as X,ac as hr,p as Y,ad as $r,ae as gt,y as fe,T as $e,H as q,O as he,N as kr,G as _e,E as Le,F as Fe,af as Je,ag as qe,ah as Xe,I as ne,ai as br,P as We,aj as wr,ak as _t,al as vr,am as yr,an as lt,ao as Ar,D as Ze,ap as Cr,J as jr,U as zr}from"./Layout-4fa052ac.js";function Sr(n,e){const r=e.token={};function t(o,l,i,s){if(e.token!==r)return;e.resolved=s;let a=e.ctx;i!==void 0&&(a=a.slice(),a[i]=s);const u=o&&(e.current=o)(a);let c=!1;e.block&&(e.blocks?e.blocks.forEach((d,f)=>{f!==l&&d&&(se(),k(d,1,1,()=>{e.blocks[f]===d&&(e.blocks[f]=null)}),ae())}):e.block.d(1),u.c(),_(u,1),u.m(e.mount(),e.anchor),c=!0),e.block=u,e.blocks&&(e.blocks[l]=u),c&&cr()}if(sr(n)){const o=ar();if(n.then(l=>{xe(o),t(e.then,1,e.value,l),xe(null)},l=>{if(xe(o),t(e.catch,2,e.error,l),xe(null),!e.hasCatch)throw l}),e.current!==e.pending)return t(e.pending,0),!0}else{if(e.current!==e.then)return t(e.then,1,e.value,n),!0;e.resolved=n}}function Br(n,e,r){const t=e.slice(),{resolved:o}=n;n.current===n.then&&(t[n.value]=o),n.current===n.catch&&(t[n.error]=o),n.block.p(t,r)}function Lr(n){let e,r;const t=n[7].default,o=Ce(t,n,n[6],null);return{c(){e=b("div"),o&&o.c(),F(e,"class",n[1]),Ae(e,"maplibregl-ctrl",n[0])},m(l,i){h(l,e,i),o&&o.m(e,null),n[8](e),r=!0},p(l,[i]){o&&o.p&&(!r||i&64)&&je(o,t,l,l[6],r?Se(t,l[6],i,null):ze(l[6]),null),(!r||i&2)&&F(e,"class",l[1]),(!r||i&3)&&Ae(e,"maplibregl-ctrl",l[0])},i(l){r||(_(o,l),r=!0)},o(l){k(o,l),r=!1},d(l){l&&$(e),o&&o.d(l),n[8](null)}}}function Mr(n,e,r){let t,{$$slots:o={},$$scope:l}=e,{defaultStyling:i=!0}=e,{position:s="top-right"}=e,{class:a=void 0}=e;const{map:u}=Vn();ee(n,u,m=>r(5,t=m));let c,d={onAdd(){return c},onRemove(){var m;(m=c==null?void 0:c.parentNode)==null||m.removeChild(c)}};ut(()=>{t==null||t.removeControl(d)});function f(m){ue[m?"unshift":"push"](()=>{c=m,r(2,c)})}return n.$$set=m=>{"defaultStyling"in m&&r(0,i=m.defaultStyling),"position"in m&&r(4,s=m.position),"class"in m&&r(1,a=m.class),"$$scope"in m&&r(6,l=m.$$scope)},n.$$.update=()=>{n.$$.dirty&52&&t&&c&&t.addControl(d,s)},[i,a,c,u,s,t,l,o,f]}class Tr extends oe{constructor(e){super(),le(this,e,Mr,Lr,re,{defaultStyling:0,position:4,class:1})}}function Ir(n){let e,r,t,o,l,i;const s=n[4].default,a=Ce(s,n,n[3],null);return{c(){e=b("button"),r=b("div"),a&&a.c(),F(r,"class",t=mt(n[2])+" svelte-1s83zbq"),Ae(r,"maplibregl-ctrl-icon",n[0]),Ae(r,"ctrl-btn-center",n[1]),F(e,"type","button")},m(u,c){h(u,e,c),g(e,r),a&&a.m(r,null),o=!0,l||(i=Q(e,"click",n[5]),l=!0)},p(u,[c]){a&&a.p&&(!o||c&8)&&je(a,s,u,u[3],o?Se(s,u[3],c,null):ze(u[3]),null),(!o||c&4&&t!==(t=mt(u[2])+" svelte-1s83zbq"))&&F(r,"class",t),(!o||c&5)&&Ae(r,"maplibregl-ctrl-icon",u[0]),(!o||c&6)&&Ae(r,"ctrl-btn-center",u[1])},i(u){o||(_(a,u),o=!0)},o(u){k(a,u),o=!1},d(u){u&&$(e),a&&a.d(u),l=!1,i()}}}function Er(n,e,r){let{$$slots:t={},$$scope:o}=e,{icon:l=!0}=e,{center:i=!0}=e,{class:s=void 0}=e;function a(u){ke.call(this,n,u)}return n.$$set=u=>{"icon"in u&&r(0,l=u.icon),"center"in u&&r(1,i=u.center),"class"in u&&r(2,s=u.class),"$$scope"in u&&r(3,o=u.$$scope)},[l,i,s,o,t,a]}class Wn extends oe{constructor(e){super(),le(this,e,Er,Ir,re,{icon:0,center:1,class:2})}}function Dr(n,e,r){let t;const o=ur();let{layer:l=void 0}=e;const{map:i}=Vn();ee(n,i,c=>r(2,t=c));function s(c){o(c.type,{...c,map:i})}const a=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu","mouseover","mouseout"],u=["click","dblclick","contextmenu","mousemove","movestart","moveend","zoomstart","zoom","zoomend"];return ut(()=>{if(t)if(l)for(const c of a)t.off(c,l,s);else for(const c of u)t.off(c,s)}),n.$$set=c=>{"layer"in c&&r(1,l=c.layer)},n.$$.update=()=>{if(n.$$.dirty&6&&t)if(l)for(const c of a)t.on(c,l,s);else for(const c of u)t.on(c,s)},[i,l,t]}class ft extends oe{constructor(e){super(),le(this,e,Dr,null,re,{layer:1})}}function Nr(n){let e;const r=n[16].default,t=Ce(r,n,n[24],null);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l&16777216)&&je(t,r,o,o[24],e?Se(r,o[24],l,null):ze(o[24]),null)},i(o){e||(_(t,o),e=!0)},o(o){k(t,o),e=!1},d(o){t&&t.d(o)}}}function Or(n){let e,r,t;function o(i){n[17](i)}let l={id:n[1],type:"symbol",source:n[2],sourceLayer:n[3],beforeId:n[4],beforeLayerType:n[5],paint:n[6],layout:n[7],filter:n[8],applyToClusters:n[9],minzoom:n[10],maxzoom:n[11],hoverCursor:n[12],manageHoverState:n[13],eventsIfTopMost:n[14],interactive:n[15],$$slots:{default:[Nr]},$$scope:{ctx:n}};return n[0]!==void 0&&(l.hovered=n[0]),e=new fr({props:l}),ue.push(()=>me(e,"hovered",o)),e.$on("click",n[18]),e.$on("dblclick",n[19]),e.$on("contextmenu",n[20]),e.$on("mouseenter",n[21]),e.$on("mousemove",n[22]),e.$on("mouseleave",n[23]),{c(){B(e.$$.fragment)},m(i,s){L(e,i,s),t=!0},p(i,[s]){const a={};s&2&&(a.id=i[1]),s&4&&(a.source=i[2]),s&8&&(a.sourceLayer=i[3]),s&16&&(a.beforeId=i[4]),s&32&&(a.beforeLayerType=i[5]),s&64&&(a.paint=i[6]),s&128&&(a.layout=i[7]),s&256&&(a.filter=i[8]),s&512&&(a.applyToClusters=i[9]),s&1024&&(a.minzoom=i[10]),s&2048&&(a.maxzoom=i[11]),s&4096&&(a.hoverCursor=i[12]),s&8192&&(a.manageHoverState=i[13]),s&16384&&(a.eventsIfTopMost=i[14]),s&32768&&(a.interactive=i[15]),s&16777216&&(a.$$scope={dirty:s,ctx:i}),!r&&s&1&&(r=!0,a.hovered=i[0],pe(()=>r=!1)),e.$set(a)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){k(e.$$.fragment,i),t=!1},d(i){M(e,i)}}}function qr(n,e,r){let{$$slots:t={},$$scope:o}=e,{id:l=Yn("symbol")}=e,{source:i=void 0}=e,{sourceLayer:s=void 0}=e,{beforeId:a=void 0}=e,{beforeLayerType:u=void 0}=e,{paint:c=void 0}=e,{layout:d=void 0}=e,{filter:f=void 0}=e,{applyToClusters:m=void 0}=e,{minzoom:p=void 0}=e,{maxzoom:C=void 0}=e,{hoverCursor:N=void 0}=e,{manageHoverState:A=!1}=e,{hovered:v=null}=e,{eventsIfTopMost:D=!1}=e,{interactive:y=!0}=e;function S(T){v=T,r(0,v)}function w(T){ke.call(this,n,T)}function j(T){ke.call(this,n,T)}function I(T){ke.call(this,n,T)}function O(T){ke.call(this,n,T)}function R(T){ke.call(this,n,T)}function J(T){ke.call(this,n,T)}return n.$$set=T=>{"id"in T&&r(1,l=T.id),"source"in T&&r(2,i=T.source),"sourceLayer"in T&&r(3,s=T.sourceLayer),"beforeId"in T&&r(4,a=T.beforeId),"beforeLayerType"in T&&r(5,u=T.beforeLayerType),"paint"in T&&r(6,c=T.paint),"layout"in T&&r(7,d=T.layout),"filter"in T&&r(8,f=T.filter),"applyToClusters"in T&&r(9,m=T.applyToClusters),"minzoom"in T&&r(10,p=T.minzoom),"maxzoom"in T&&r(11,C=T.maxzoom),"hoverCursor"in T&&r(12,N=T.hoverCursor),"manageHoverState"in T&&r(13,A=T.manageHoverState),"hovered"in T&&r(0,v=T.hovered),"eventsIfTopMost"in T&&r(14,D=T.eventsIfTopMost),"interactive"in T&&r(15,y=T.interactive),"$$scope"in T&&r(24,o=T.$$scope)},[v,l,i,s,a,u,c,d,f,m,p,C,N,A,D,y,t,S,w,j,I,O,R,J,o]}class Pe extends oe{constructor(e){super(),le(this,e,qr,Or,re,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}function ht(n){let e=n[0],r,t,o=$t(n);return{c(){o.c(),r=Te()},m(l,i){o.m(l,i),h(l,r,i),t=!0},p(l,i){i&1&&re(e,e=l[0])?(se(),k(o,1,1,V),ae(),o=$t(l),o.c(),_(o,1),o.m(r.parentNode,r)):o.p(l,i)},i(l){t||(_(o),t=!0)},o(l){k(o),t=!1},d(l){l&&$(r),o.d(l)}}}function $t(n){let e;const r=n[15].default,t=Ce(r,n,n[14],null);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l&16384)&&je(t,r,o,o[14],e?Se(r,o[14],l,null):ze(o[14]),null)},i(o){e||(_(t,o),e=!0)},o(o){k(t,o),e=!1},d(o){t&&t.d(o)}}}function Fr(n){let e,r,t=n[0]&&ht(n);return{c(){t&&t.c(),e=Te()},m(o,l){t&&t.m(o,l),h(o,e,l),r=!0},p(o,[l]){o[0]?t?(t.p(o,l),l&1&&_(t,1)):(t=ht(o),t.c(),_(t,1),t.m(e.parentNode,e)):t&&(se(),k(t,1,1,()=>{t=null}),ae())},i(o){r||(_(t),r=!0)},o(o){k(t),r=!1},d(o){o&&$(e),t&&t.d(o)}}}function Pr(n,e,r){let t,o,{$$slots:l={},$$scope:i}=e,{id:s=Yn("vector")}=e,{url:a=null}=e,{tiles:u=null}=e,{promoteId:c=null}=e,{bounds:d=null}=e,{scheme:f=null}=e,{attribution:m=null}=e,{minzoom:p=null}=e,{maxzoom:C=null}=e,{volatile:N=null}=e;if(a&&a.includes("pmtiles://")&&!pt.config.REGISTERED_PROTOCOLS.hasOwnProperty("pmtiles")){let y=new _r;pt.addProtocol("pmtiles",y.tile)}const{map:A,self:v}=dr();ee(n,A,y=>r(13,o=y)),ee(n,v,y=>r(0,t=y));let D;return ut(()=>{t&&o&&(mr(A,t,D),H(v,t=null,t),D=void 0)}),n.$$set=y=>{"id"in y&&r(3,s=y.id),"url"in y&&r(4,a=y.url),"tiles"in y&&r(5,u=y.tiles),"promoteId"in y&&r(6,c=y.promoteId),"bounds"in y&&r(7,d=y.bounds),"scheme"in y&&r(8,f=y.scheme),"attribution"in y&&r(9,m=y.attribution),"minzoom"in y&&r(10,p=y.minzoom),"maxzoom"in y&&r(11,C=y.maxzoom),"volatile"in y&&r(12,N=y.volatile),"$$scope"in y&&r(14,i=y.$$scope)},n.$$.update=()=>{n.$$.dirty&16377&&o&&t!==s&&(H(v,t=s,t),pr(o,t,gr({type:"vector",url:a,tiles:u,promoteId:c,bounds:d,scheme:f,attribution:m,minzoom:p,maxzoom:C,volatile:N}),y=>o&&y===t,()=>{t&&(D=o==null?void 0:o.getSource(t))})),n.$$.dirty&8200&&(o==null||o.on("style.load",()=>{D=o==null?void 0:o.getSource(s)}))},[t,A,v,s,a,u,c,d,f,m,p,C,N,o,i,l]}class xn extends oe{constructor(e){super(),le(this,e,Pr,Fr,re,{id:3,url:4,tiles:5,promoteId:6,bounds:7,scheme:8,attribution:9,minzoom:10,maxzoom:11,volatile:12})}}const Ur=n=>({}),kt=n=>({}),Gr=n=>({}),bt=n=>({});function Qr(n){let e,r,t,o;const l=n[3].sidebar,i=Ce(l,n,n[2],bt),s=n[3].map,a=Ce(s,n,n[2],kt);return{c(){e=b("div"),i&&i.c(),r=z(),t=b("div"),a&&a.c()},m(u,c){h(u,e,c),i&&i.m(e,null),n[4](e),h(u,r,c),h(u,t,c),a&&a.m(t,null),n[5](t),o=!0},p(u,[c]){i&&i.p&&(!o||c&4)&&je(i,l,u,u[2],o?Se(l,u[2],c,Gr):ze(u[2]),bt),a&&a.p&&(!o||c&4)&&je(a,s,u,u[2],o?Se(s,u[2],c,Ur):ze(u[2]),kt)},i(u){o||(_(i,u),_(a,u),o=!0)},o(u){k(i,u),k(a,u),o=!1},d(u){u&&($(e),$(r),$(t)),i&&i.d(u),n[4](null),a&&a.d(u),n[5](null)}}}function Hr(n,e,r){let t,o;ee(n,st,u=>r(0,t=u)),ee(n,at,u=>r(1,o=u));let{$$slots:l={},$$scope:i}=e;function s(u){ue[u?"unshift":"push"](()=>{t=u,st.set(t)})}function a(u){ue[u?"unshift":"push"](()=>{o=u,at.set(o)})}return n.$$set=u=>{"$$scope"in u&&r(2,i=u.$$scope)},[t,o,i,l,s,a]}class Ee extends oe{constructor(e){super(),le(this,e,Hr,Qr,re,{})}}let st=Ye(null),at=Ye(null);const er="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAACmlBMVEXo6uzn6e3o6u7n6ezn6uzm6Ozn6evo6ezm6evo6e3p6u7p6+3p6u3o6u3n6u3n6evn6evn6ezo6uzo6u3n6evn6ezn6ezn6ezn6ezn6ezn6ezn6ezn6ezo6uzo6uzo6u3n6ezn6ezn6ezn6ezn6ezn6ezn6ezo6+3n6ezn6ezn6u3o6u3o6u3o6u3o6u3o6u3o6u3o6u3o6u3o6u3n6ezn6ezn6e3n6e3o6u3o6u3o6u3o6u3o6u3o6u3o6u3o6u3o6u3o6u3o6u3o6u3o6e3o6u3o6uzo6uzo6u3o6u3o6u3n6u3n6ezn6ezn6ezn6ezn6ezn6ezn6ezn6ezn6uzn6ezn6e3o6u3o6u3o6u3o6u3o6u3n6u3n6ezo6u3o6u3o6uzn6uzn6ezo6ezo6uzn6ezo6u3o6u3o6u3n6u3n6Ozm6ezn6ezo6u3o6u3o6uzo6u3n6u3o6e3o6u3o6u3o6u3n6u3n6ezo6uzo6u3o6u3n6+3o6uzo6u3o6u3o6uzo6uzn6uzn6uzn6ezn6ezn6ezn6ezo6u3n6ezo6ezn6ezn6ezn6ezn6ezn6e3o6u3o6e3n6ezn6ezo6uzn6evo6uzo6uzn6evn6ezo6u3n6ezn6uzo6u3n6ezn6ezo6u3n6u3n6ezo6u3o6u3n6ezn6u3o6u3o6u3n6ezo6u3n6u3n6ezn6ezo6u3n6ezo6u3n6e3n6uzn6ezn6ezn6ezn6ezn6ezn6ezo6u3o6u3n6ezn6ezo6u3o6e3o6u3n6e3o6u3n6u3n6uzo6u3o6u3o6u3o6u3o6u3o6u3o6u3n6ezn6evo6u3o6u3o6u3n6uvn6ezo6u3n6uzn6ezn6ezn6ezo6u3n6uzn6uzo6u3n6u3n6uzo6+zm6uzjK5F0AAAA3nRSTlMAAAAAAAAAAAAAAAAAAAAIDxIUFBMDKEVdbn2IjpOWlpCJb15HKgUACXqjwtrt/P/u3MSmSg0gc7vz4dnSz83U5fT3vnciCnPV8MCdg2JYUk5LU1pmdoyoy/rYdApBt31IIyMjIyyI0LY/AABh366lq19s6GnraXg8PHsAAwOEeF0MKiEiCymqnFmeqXsncN6sOTuuDYzPTlCJCHhyOjyxcGfmkhotgqFcrYIrHONkymEKEC8mLg9jzMhNmr1XVVi/mCSz79ddrI6v3FooDSsAQ6OCFReFoi48GTwtAAD3GpCFAAADBklEQVR4nKWUh1IUQRCGZ+nx8JRZMcspoiKekfbMomDABAaSCbNwxhPMgmLOCTFnxZxzzlkxY86+i927BxzeUmWVf+1O1c5+09Pd09NCaJoWAFJCOQAb0GuzQSAPAOXppVlhD6hQMUgIJpUECUxpviCAxoOuKlRUShikMmYMk5WCK1epWi24UgloDwhSBOqKSTtNVa9Rs1aIo3ad0LphofXqOxqEN4xoxLDBKaGcTiU0pRo3bNK0WfMWkehVZEtXq9aONm1Ne0oXQHuT0XbtO3Sk3y2jOnWOjomJ7tK8azf67B7boydTJMFeBIpevftgXHzffiH9ByQkJiUlJqcMHDR4yNBUHDZ8hG5IlCMBjByF0aPHjE1Loyfd7U5Lc7vd6eOSx0/AiZN0jSUmTyaTnikZmDnVQtPQNZ0ou10JMy8zWmAZmjmLIyeLdkMExloKZ8/x+lgEpmZlz/XXvMjZc3IM+YA2ofxkDVqQ/wn+69bzF/jLClxoqUi/9JSVcD+LGGUpfzB10WILzfPfmqKGJUuXcXkaguURK0BYgysdq1avCTRQCSlr163PVdbghjzEjZvoflJJbd6C6ArRLcGt2yjI7TvMq7qzM33s2u0DFtVj6h7YG4WYuY8sKoD9+YgZB2A9gdKQFzx4CA8fOXos8/gJ8+g0CD9+8tTpM2F49hyAAZotYedQPH/h4qXLV6D4mHOvXltx/QbevMX/PR4vmHsb8U7W3XuldD/rAeLDR5wrqixza0h+jPjk6V+KQ8xPgKLUeslneVYn7Uqhm2UD7lFgNizFYMHzUnqB+PIVJ4uyYGdQY98ZXPX6jY/eFpggo+yjt64NsIZPceuni0GW6WehzfbufXzsh48l2ZGeT59j47+MNHowg4WFheahff327Ts5UwQScCT7x0/JfYdbrDA8oBauSUkhUUP1ngx4aJEOimbNJsVBM6dLyUFpmtcesHFdCiWVMkGbzNFB1xWBupPnDFzzcDJotXJKJ22kCeJyqFupXyaoVCAw+JuzrGi5cOqSurf2B4tMU69Bi01ZAAAAAElFTkSuQmCC",tr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAABlBMVEUAAAAAAAClZ7nPAAAAAnRSTlMA/1uRIrUAAAjuSURBVHic7dxLlqM2FAZgCOdEGUUZZtCntZPWlrKCiKwgW2IpZAdkxoBAbJCEHle27r3UoxNr0KdMoc9Y/HoArm6aV3mVV/m/lHYbeIDaFh6wbVvPqd/dgJEDyBswcwB9A1YOYG7AxgHu9Tmt2O3ASAfEDkx0QO4A4zSwAbUDjDDrHWAEYY8BJwhs4KhPT1JrgeHDgM4C4/cLCAuQe9PHA9IC5O74Al7AC/hswHc8IrGBj58XPn5ydUBPBdgLjE+wRtJ7fcYyT+0AY6HJXuqyV+vs64WWF8SGf8nDv+hSvLN4wYUn+9KXffHNv/xvmAfwKq/yKq/yKv+p0rImxua+TBt4B8Ccm++LLNZN4X15wAI0c4nVMBd5xzKRscw8Vrqc06CYS+1jlcg4jy33ckNwr5gUF9DMq0Z30UcG2FfOkgso7t0DwwTclTcZEFzANQG5O2ousDGBjgtILqC5gGECPkZUQHABFQK/EAATAr8SgC0EvuDrdxHwFQ/ICFB4QMdAjwa2GBiw9dsEGLGASAD0oKQSAB1GkwDoNcLGBLoUwC4yRApgFxk50OMAmQEDDlAZMOIAnQHIJOUAMkkmA5BByAFkEHIAGYQtB3ouMHCBkQvgggAAqCC4EfGfAEAFwQF/BwAqCA74KwBQQXDAHyHQ44G1DYEBD8wRMCIAO6aOEYAJggX6CMAE4QDWJgIwQehsvQjABME9mokATBCOaaFPgB4JrE0CDEhgSYERCcwpgAgCDCCCAAOIIEgQQAQBBhBBkLbNEqDnAgMXGLlAfRDUGwH1SXLRT4D6JBWA+iQVgPok6QLQc4GBC4woYAgAu/StDkIGCPcDFbBTVXUQTAq46ZoMuEUTHTC4IBi78wloXBByAJmkHJC4JG0ZILhAh4uiO2Un0HKBBpdlADBcQGOAFgAUF0B9KWevt8aA4AIdF2gxQAcADRswXEBjgSUBFBdwiw4yIBCAgIBdHRlAiwXO9Nimu/80cADDBe5B6DnAPQh19c/HlBEg6yfXFFjccdVO7z500aze1o/qKWA/ev3ElAH9vllXz+4ZMOybu+olkoKB+uIBt7IZKcAYANj72jIFsPe1T8CESWIA2NvSJ6CjJOGA4f6TipJUXUQGDFSA+OC480ctuIB7TIBMUmsb/iffGbBJsqf+i48iNkm2yhdyksxx0N/ISdJHs2lykuRx4kzvgzDgAHHUuP1DTFJ7fOgbQP0DBnNMKyM1Se44JnKS9tIFF4yk7+OIezVikiywkpO0F3mvRkySA8hJ2ovagiCMBEBvzCDsXYoTBLO/LyMIW3jngAiwktQe1ehJsmMzPUl2dqAnyU5w9CSJoxo9SXaxR0+SWzGTk6Q2ZhD0FgWBCARBQANmi4PQ04AzCAMWcNWo39BrXTVqkvy9K2qSOn/gxCR1vumISRIe0LQgSH/2iUk6AWKSlH9bYpK0bzlikk7ABQGZJHOefA5w3sRCRzGopClRDG/jqg8Bzr7kk4TrDGdf8knCASIAXJJQwNkV0jshBAD7gGQvKqxjCN1Rhe2mCYAOAUUAgr7kG2QgA4IARB0wjCUOsENAiweSZyp4IDloE3HvAiTtrqlAb1+q8JxUFRkD+D97jvqSOyDMmBb1JdemGEBzARPXaGPvPYCoL9GBKXldXz97PokFsgEgzhUBMEggG8OIwFlBJ+CzIrlA0pcuAFTSqM9K0peoQND7VBKsZ8WkgEQCSV+6AEA9NYae9dOAMQWqx7R8NkYOivl6gAb0KVA9pmV9CTsoZl2BDyAHxawv0YCozbNWeViyvoQdFLOucBkw1NWHvjejCcBIBqCVrco3lQu0tr4IqBzT8r6EHBQlkFsUAPQl3KAI9KV3BoC+hBsUDfBuKADoS6hRFfwOGmZQBK/RMAB8lQhko1Tg69T3BKC+hBoUob6EAqC+hBpVoa6AGhTZANSXUIMi1JdQANSXMEDh+5zlQbENT7BeQkAFvcIB7q813d95JIBZwr6UA3MjZxiwh2Pm8EZgCIgE6IqAYAG3Dxn0pRBwg6JYQMDl7rZzJdAWAVurIQH3/9b7qLWmgBsUuxUElhPQdUBTBMzmNxzWET+br6dAH/alEGgeA/7k9sBN9RjwkXkMTBlwHNlt98dA1BkBoC8AvotFExsM9Me+ugCEN9UjQL8tMB4b5er/qq4MDMe+qgCIEqBwQIMEhgRYc0AmgIQA9RTYv6FTASxFoIOB/jkgEkBAgF794FkGphpgygE7ihaABgTMFhxOCnQQYFwSxwJwG1TDZwY5sJWB9hGwpsCQA83xowfah0BfAO4T1yNgcwMKBBgLLACwpEADAHpvGxXsDAH9OVyngNrb5iHQPgTk/tF08HlPYA4Ac4IxIOx3Os4Wh4BjbpwhoLXfKnkAdJudnUHg9nLatwHAGe9jfTCBwP4fOZyx1QVA+iRnT6x/O/YuA+L+U+eTDD3y7rYtmBg8MAZA8B6PAQUCc9jOR/1o4S5gYPC/Xe6/mMqAPAGZA3LfWfjLCgDQ0d4AANyBiwADA+dBAfcAI2CLPnAKqC2+sMuBcCItAMNDQBSA5gTGh4AKgC4H9BnKArBHa3oIzI+AY8TNgTUA0iaPNqkQaGFgKwPdn9sTwARnGQLs6zkDlhAYa4GmAMxFIP12Vg4cv38KLBkwRxV8ElyFtQCYApBVqAZKFUqvT2CiAboEpI3mB5m3A8ZjQ1cJnL3/8wDDsUHUAv3xUpaAuQSYNwP8hkrAv+HnAZoYmEqAjoEuBVQC+P9uKwXGq4GVCLQpoGuB6WpgSX4/loD0M6aAqQXmq4GZCpirAbf/8AxYEmCqBWQC6IuBthpYE2CkAupiwO/f29+LFEg3OGB4BpRE+WmA/tn+pQ3irYCmBKQf0gHuE9UDrtU+C5BOCxXAeLxuYWAtAu0bAQsZaGJA1wPTtcBMB36PAGN/66/yfDAGt8VtmK8FJjrwLQK2emC5FhjpwFcQmMtA2kwR0CKANQIGOvDzpUCHALYI6BNgKgM6AX68FBAYoA+Bhg78cCkgM0C5LeNDIHu/sQz4LUPzKq/yKq9yefkXR6tlrDrSxQ4AAAAASUVORK5CYII=";function be(){return["","2","1","0","Critical"]}let Me=["#66C5CC","#F6CF71","#F89C74","#DCB0F2","#87C55F","#9EB9F3","#FE88B1","#C9DB74","#8BE0A4","#B497E7","#D3B484","#B3B3B3"];function Jr(n){let e,r;const t=n[4].default,o=Ce(t,n,n[6],null);return{c(){e=b("span"),o&&o.c(),F(e,"class","dot svelte-117v9mi"),Ae(e,"outline",n[3]),X(e,"background-color",n[3]?void 0:n[1]),X(e,"border-color",n[3]?n[1]:void 0),X(e,"width",n[2]),X(e,"height",n[2])},m(l,i){h(l,e,i),o&&o.m(e,null),r=!0},p(l,i){o&&o.p&&(!r||i&64)&&je(o,t,l,l[6],r?Se(t,l[6],i,null):ze(l[6]),null),(!r||i&8)&&Ae(e,"outline",l[3]),i&10&&X(e,"background-color",l[3]?void 0:l[1]),i&10&&X(e,"border-color",l[3]?l[1]:void 0),i&4&&X(e,"width",l[2]),i&4&&X(e,"height",l[2])},i(l){r||(_(o,l),r=!0)},o(l){k(o,l),r=!1},d(l){l&&$(e),o&&o.d(l)}}}function Rr(n){let e,r,t;function o(i){n[5](i)}let l={draggable:!0,$$slots:{default:[Jr]},$$scope:{ctx:n}};return n[0]!==void 0&&(l.lngLat=n[0]),e=new Qe({props:l}),ue.push(()=>me(e,"lngLat",o)),{c(){B(e.$$.fragment)},m(i,s){L(e,i,s),t=!0},p(i,[s]){const a={};s&78&&(a.$$scope={dirty:s,ctx:i}),!r&&s&1&&(r=!0,a.lngLat=i[0],pe(()=>r=!1)),e.$set(a)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){k(e.$$.fragment,i),t=!1},d(i){M(e,i)}}}function Kr(n,e,r){let{$$slots:t={},$$scope:o}=e,{lngLat:l}=e,{color:i}=e,{radius:s="30px"}=e,{outline:a=!1}=e;function u(c){l=c,r(0,l)}return n.$$set=c=>{"lngLat"in c&&r(0,l=c.lngLat),"color"in c&&r(1,i=c.color),"radius"in c&&r(2,s=c.radius),"outline"in c&&r(3,a=c.outline),"$$scope"in c&&r(6,o=c.$$scope)},[l,i,s,a,t,u,o]}class dt extends oe{constructor(e){super(),le(this,e,Kr,Rr,re,{lngLat:0,color:1,radius:2,outline:3})}}function wt(n,e,r){const t=n.slice();return t[11]=e[r][0],t[12]=e[r][1],t}function vt(n,e,r){const t=n.slice();return t[11]=e[r][0],t[12]=e[r][1],t}function Xr(n){let e,r,t,o,l,i;const s=n[5].default,a=Ce(s,n,n[4],null);let u=Y(n[2]),c=[];for(let d=0;d<u.length;d+=1)c[d]=yt(wt(n,u,d));return{c(){e=b("label"),a&&a.c(),r=z(),t=b("select");for(let d=0;d<c.length;d+=1)c[d].c();n[0]===void 0&&$r(()=>n[10].call(t))},m(d,f){h(d,e,f),a&&a.m(e,null),g(e,r),g(e,t);for(let m=0;m<c.length;m+=1)c[m]&&c[m].m(t,null);gt(t,n[0],!0),o=!0,l||(i=[Q(t,"change",n[10]),Q(t,"change",n[7])],l=!0)},p(d,f){if(a&&a.p&&(!o||f&16)&&je(a,s,d,d[4],o?Se(s,d[4],f,null):ze(d[4]),null),f&4){u=Y(d[2]);let m;for(m=0;m<u.length;m+=1){const p=wt(d,u,m);c[m]?c[m].p(p,f):(c[m]=yt(p),c[m].c(),c[m].m(t,null))}for(;m<c.length;m+=1)c[m].d(1);c.length=u.length}f&5&&gt(t,d[0])},i(d){o||(_(a,d),o=!0)},o(d){k(a,d),o=!1},d(d){d&&$(e),a&&a.d(d),fe(c,d),l=!1,$e(i)}}}function Zr(n){let e,r,t,o;const l=n[5].default,i=Ce(l,n,n[4],null);let s=Y(n[2]),a=[];for(let u=0;u<s.length;u+=1)a[u]=At(vt(n,s,u));return{c(){e=b("fieldset"),i&&i.c(),r=z(),t=b("div");for(let u=0;u<a.length;u+=1)a[u].c();F(t,"class","svelte-1vb210n"),Ae(t,"horiz_radio",n[1]=="horiz-radio")},m(u,c){h(u,e,c),i&&i.m(e,null),g(e,r),g(e,t);for(let d=0;d<a.length;d+=1)a[d]&&a[d].m(t,null);o=!0},p(u,c){if(i&&i.p&&(!o||c&16)&&je(i,l,u,u[4],o?Se(l,u[4],c,null):ze(u[4]),null),c&5){s=Y(u[2]);let d;for(d=0;d<s.length;d+=1){const f=vt(u,s,d);a[d]?a[d].p(f,c):(a[d]=At(f),a[d].c(),a[d].m(t,null))}for(;d<a.length;d+=1)a[d].d(1);a.length=s.length}(!o||c&2)&&Ae(t,"horiz_radio",u[1]=="horiz-radio")},i(u){o||(_(i,u),o=!0)},o(u){k(i,u),o=!1},d(u){u&&$(e),i&&i.d(u),fe(a,u)}}}function yt(n){let e,r=n[12]+"",t;return{c(){e=b("option"),t=q(r),e.__value=n[11],he(e,e.__value)},m(o,l){h(o,e,l),g(e,t)},p:V,d(o){o&&$(e)}}}function At(n){let e,r,t,o=n[12]+"",l,i,s,a,u;return s=kr(n[9][0]),{c(){e=b("label"),r=b("input"),t=z(),l=q(o),i=z(),F(r,"type","radio"),r.__value=n[11],he(r,r.__value),s.p(r)},m(c,d){h(c,e,d),g(e,r),r.checked=r.__value===n[0],g(e,t),g(e,l),g(e,i),a||(u=[Q(r,"change",n[8]),Q(r,"change",n[6])],a=!0)},p(c,d){d&5&&(r.checked=r.__value===c[0])},d(c){c&&$(e),s.r(),a=!1,$e(u)}}}function Vr(n){let e,r,t,o;const l=[Zr,Xr],i=[];function s(a,u){return a[1]=="horiz-radio"||a[1]=="vert-radio"?0:a[1]=="dropdown"?1:-1}return~(e=s(n))&&(r=i[e]=l[e](n)),{c(){r&&r.c(),t=Te()},m(a,u){~e&&i[e].m(a,u),h(a,t,u),o=!0},p(a,[u]){let c=e;e=s(a),e===c?~e&&i[e].p(a,u):(r&&(se(),k(i[c],1,1,()=>{i[c]=null}),ae()),~e?(r=i[e],r?r.p(a,u):(r=i[e]=l[e](a),r.c()),_(r,1),r.m(t.parentNode,t)):r=null)},i(a){o||(_(r),o=!0)},o(a){k(r),o=!1},d(a){a&&$(t),~e&&i[e].d(a)}}}function Yr(n,e,r){let{$$slots:t={},$$scope:o}=e,{k:l}=e,{value:i}=e,{choices:s}=e,a=s[0].length==2?s:s.map(p=>[p,p]);const u=[[]];function c(p){ke.call(this,n,p)}function d(p){ke.call(this,n,p)}function f(){i=this.__value,r(0,i),r(2,a)}function m(){i=hr(this),r(0,i),r(2,a)}return n.$$set=p=>{"k"in p&&r(1,l=p.k),"value"in p&&r(0,i=p.value),"choices"in p&&r(3,s=p.choices),"$$scope"in p&&r(4,o=p.$$scope)},[i,l,a,s,o,t,c,d,f,u,m]}class Ie extends oe{constructor(e){super(),le(this,e,Yr,Vr,re,{k:1,value:0,choices:3})}}let ct=Ye(void 0),G=Ye(Wr());function ce(n){return{type:"FeatureCollection",features:n}}let K=Ye({kind:"neutral"});function nr(n){return"links"in n&&"jats"in n&&"bus_stops"&&"crossings"in n&&"side_roads"in n}function Wr(){try{let n=JSON.parse(window.localStorage.getItem("tmp-rcv2")||"");if(nr(n))return n}catch{}return{links:[],jats:[],bus_stops:[],crossings:[],side_roads:[]}}function Ct(n){let e,r;return e=new _e({props:{data:ce(n[2].links),$$slots:{default:[xr]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&4&&(l.data=ce(t[2].links)),o&10&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function xr(n){let e,r;return e=new Le({props:{paint:{"line-color":n[1]?["get","color"]:"black","line-width":6}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&2&&(l.paint={"line-color":t[1]?["get","color"]:"black","line-width":6}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function jt(n){let e,r;return e=new _e({props:{data:ce(n[2].bus_stops),$$slots:{default:[eo]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&4&&(l.data=ce(t[2].bus_stops)),o&8&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function eo(n){let e,r;return e=new Pe({props:{layout:{"icon-image":"bus_stop","icon-size":3},paint:{"icon-color":"black"}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function zt(n){let e,r;return e=new _e({props:{data:ce(n[2].crossings),$$slots:{default:[to]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&4&&(l.data=ce(t[2].crossings)),o&8&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function to(n){let e,r;return e=new Pe({props:{layout:{"icon-image":"crossing","icon-size":.1},paint:{"icon-color":"black"}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function St(n){let e,r;return e=new _e({props:{data:ce(n[2].jats),$$slots:{default:[no]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&4&&(l.data=ce(t[2].jats)),o&8&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function no(n){let e,r;return e=new Fe({props:{paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":"black","circle-radius":20}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function Bt(n){let e,r;return e=new _e({props:{data:ce(n[2].side_roads),$$slots:{default:[ro]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&4&&(l.data=ce(t[2].side_roads)),o&8&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function ro(n){let e,r;return e=new Le({props:{paint:{"line-color":"black","line-width":3}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function oo(n){let e,r,t,o,l,i,s=n[0]!="links"&&Ct(n),a=n[0]!="bus_stops"&&jt(n),u=n[0]!="crossings"&&zt(n),c=n[0]!="jats"&&St(n),d=n[0]!="side_roads"&&Bt(n);return{c(){s&&s.c(),e=z(),a&&a.c(),r=z(),u&&u.c(),t=z(),c&&c.c(),o=z(),d&&d.c(),l=Te()},m(f,m){s&&s.m(f,m),h(f,e,m),a&&a.m(f,m),h(f,r,m),u&&u.m(f,m),h(f,t,m),c&&c.m(f,m),h(f,o,m),d&&d.m(f,m),h(f,l,m),i=!0},p(f,[m]){f[0]!="links"?s?(s.p(f,m),m&1&&_(s,1)):(s=Ct(f),s.c(),_(s,1),s.m(e.parentNode,e)):s&&(se(),k(s,1,1,()=>{s=null}),ae()),f[0]!="bus_stops"?a?(a.p(f,m),m&1&&_(a,1)):(a=jt(f),a.c(),_(a,1),a.m(r.parentNode,r)):a&&(se(),k(a,1,1,()=>{a=null}),ae()),f[0]!="crossings"?u?(u.p(f,m),m&1&&_(u,1)):(u=zt(f),u.c(),_(u,1),u.m(t.parentNode,t)):u&&(se(),k(u,1,1,()=>{u=null}),ae()),f[0]!="jats"?c?(c.p(f,m),m&1&&_(c,1)):(c=St(f),c.c(),_(c,1),c.m(o.parentNode,o)):c&&(se(),k(c,1,1,()=>{c=null}),ae()),f[0]!="side_roads"?d?(d.p(f,m),m&1&&_(d,1)):(d=Bt(f),d.c(),_(d,1),d.m(l.parentNode,l)):d&&(se(),k(d,1,1,()=>{d=null}),ae())},i(f){i||(_(s),_(a),_(u),_(c),_(d),i=!0)},o(f){k(s),k(a),k(u),k(c),k(d),i=!1},d(f){f&&($(e),$(r),$(t),$(o),$(l)),s&&s.d(f),a&&a.d(f),u&&u.d(f),c&&c.d(f),d&&d.d(f)}}}function lo(n,e,r){let t;ee(n,G,i=>r(2,t=i));let{except:o}=e,{showLinkColor:l=!1}=e;return n.$$set=i=>{"except"in i&&r(0,o=i.except),"showLinkColor"in i&&r(1,l=i.showLinkColor)},[o,l,t]}class Ne extends oe{constructor(e){super(),le(this,e,lo,oo,re,{except:0,showLinkColor:1})}}const{window:io}=Je;function so(n){let e;return{c(){e=q("ST20: bus stops")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function ao(n){let e,r,t,o,l,i,s,a,u,c,d,f,m,p;function C(A){n[8](A)}let N={k:"horiz-radio",choices:be(),$$slots:{default:[so]},$$scope:{ctx:n}};return n[1].bus_stops[n[0]].properties.st20!==void 0&&(N.value=n[1].bus_stops[n[0]].properties.st20),c=new Ie({props:N}),ue.push(()=>me(c,"value",C)),{c(){e=b("div"),r=b("button"),r.textContent="Done",t=z(),o=b("button"),o.textContent="Delete bus stop",l=z(),i=b("label"),s=q(`Name:
      `),a=b("input"),u=z(),B(c.$$.fragment),F(a,"type","text"),F(e,"slot","sidebar")},m(A,v){h(A,e,v),g(e,r),g(e,t),g(e,o),g(e,l),g(e,i),g(i,s),g(i,a),he(a,n[1].bus_stops[n[0]].properties.name),g(e,u),L(c,e,null),f=!0,m||(p=[Q(r,"click",n[6]),Q(o,"click",n[4]),Q(a,"input",n[7])],m=!0)},p(A,v){v&3&&a.value!==A[1].bus_stops[A[0]].properties.name&&he(a,A[1].bus_stops[A[0]].properties.name);const D={};v&512&&(D.$$scope={dirty:v,ctx:A}),!d&&v&3&&(d=!0,D.value=A[1].bus_stops[A[0]].properties.st20,pe(()=>d=!1)),c.$set(D)},i(A){f||(_(c.$$.fragment,A),f=!0)},o(A){k(c.$$.fragment,A),f=!1},d(A){A&&$(e),M(c),m=!1,$e(p)}}}function co(n){let e,r;return e=new Pe({props:{filter:["!=",["id"],n[0]],layout:{"icon-image":"bus_stop","icon-size":3},paint:{"icon-color":"black"}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&1&&(l.filter=["!=",["id"],t[0]]),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function uo(n){let e,r;return{c(){e=b("img"),Xe(e.src,r=er)||F(e,"src",r)},m(t,o){h(t,e,o)},p:V,d(t){t&&$(e)}}}function fo(n){let e,r,t,o,l,i,s,a;r=new Ne({props:{except:"bus_stops"}}),o=new _e({props:{data:ce(n[1].bus_stops),generateId:!0,$$slots:{default:[co]},$$scope:{ctx:n}}});function u(d){n[5](d)}let c={color:n[1].bus_stops[n[0]].properties.color,$$slots:{default:[uo]},$$scope:{ctx:n}};return n[1].bus_stops[n[0]].geometry.coordinates!==void 0&&(c.lngLat=n[1].bus_stops[n[0]].geometry.coordinates),i=new dt({props:c}),ue.push(()=>me(i,"lngLat",u)),{c(){e=b("div"),B(r.$$.fragment),t=z(),B(o.$$.fragment),l=z(),B(i.$$.fragment),F(e,"slot","map")},m(d,f){h(d,e,f),L(r,e,null),g(e,t),L(o,e,null),g(e,l),L(i,e,null),a=!0},p(d,f){const m={};f&2&&(m.data=ce(d[1].bus_stops)),f&513&&(m.$$scope={dirty:f,ctx:d}),o.$set(m);const p={};f&3&&(p.color=d[1].bus_stops[d[0]].properties.color),f&512&&(p.$$scope={dirty:f,ctx:d}),!s&&f&3&&(s=!0,p.lngLat=d[1].bus_stops[d[0]].geometry.coordinates,pe(()=>s=!1)),i.$set(p)},i(d){a||(_(r.$$.fragment,d),_(o.$$.fragment,d),_(i.$$.fragment,d),a=!0)},o(d){k(r.$$.fragment,d),k(o.$$.fragment,d),k(i.$$.fragment,d),a=!1},d(d){d&&$(e),M(r),M(o),M(i)}}}function mo(n){let e,r,t,o;return e=new Ee({props:{$$slots:{map:[fo],sidebar:[ao]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(l,i){L(e,l,i),r=!0,t||(o=Q(io,"keydown",n[3]),t=!0)},p(l,[i]){const s={};i&519&&(s.$$scope={dirty:i,ctx:l}),e.$set(s)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){k(e.$$.fragment,l),r=!1},d(l){M(e,l),t=!1,o()}}}function po(n,e,r){let t,o;ee(n,G,f=>r(1,t=f)),ee(n,K,f=>r(2,o=f));let{idx:l}=e;function i(f){f.key=="Escape"&&H(K,o={kind:"neutral"},o)}async function s(){window.confirm("Really delete this bus stop?")&&(H(K,o={kind:"neutral"},o),await qe(),t.bus_stops.splice(l,1),G.set(t))}function a(f){n.$$.not_equal(t.bus_stops[l].geometry.coordinates,f)&&(t.bus_stops[l].geometry.coordinates=f,G.set(t))}const u=()=>H(K,o={kind:"neutral"},o);function c(){t.bus_stops[l].properties.name=this.value,G.set(t)}function d(f){n.$$.not_equal(t.bus_stops[l].properties.st20,f)&&(t.bus_stops[l].properties.st20=f,G.set(t))}return n.$$set=f=>{"idx"in f&&r(0,l=f.idx)},[l,t,o,i,s,a,u,c,d]}class go extends oe{constructor(e){super(),le(this,e,po,mo,re,{idx:0})}}function Lt(n,e,r){const t=n.slice();return t[1]=e[r][0],t[2]=e[r][1],t}function Mt(n){let e,r,t,o=n[1]+"",l,i;return{c(){e=b("li"),r=b("span"),t=z(),l=q(o),i=z(),F(r,"class","svelte-kzgqtg"),X(r,"background",n[2])},m(s,a){h(s,e,a),g(e,r),g(e,t),g(e,l),g(e,i)},p(s,a){a&1&&X(r,"background",s[2]),a&1&&o!==(o=s[1]+"")&&ne(l,o)},d(s){s&&$(e)}}}function _o(n){let e,r=Y(n[0]),t=[];for(let o=0;o<r.length;o+=1)t[o]=Mt(Lt(n,r,o));return{c(){e=b("ul");for(let o=0;o<t.length;o+=1)t[o].c()},m(o,l){h(o,e,l);for(let i=0;i<t.length;i+=1)t[i]&&t[i].m(e,null)},p(o,[l]){if(l&1){r=Y(o[0]);let i;for(i=0;i<r.length;i+=1){const s=Lt(o,r,i);t[i]?t[i].p(s,l):(t[i]=Mt(s),t[i].c(),t[i].m(e,null))}for(;i<t.length;i+=1)t[i].d(1);t.length=r.length}},i:V,o:V,d(o){o&&$(e),fe(t,o)}}}function ho(n,e,r){let{rows:t}=e;return n.$$set=o=>{"rows"in o&&r(0,t=o.rows)},[t]}class $o extends oe{constructor(e){super(),le(this,e,ho,_o,re,{rows:0})}}const ko=n=>({dialog:n&1}),Tt=n=>({dialog:n[0]});function bo(n){let e,r,t,o,l;const i=n[4].default,s=Ce(i,n,n[3],Tt);return{c(){e=b("dialog"),r=b("article"),s&&s.c(),e.open=!0},m(a,u){h(a,e,u),g(e,r),s&&s.m(r,null),n[6](e),t=!0,o||(l=[Q(window,"click",n[1]),Q(window,"keydown",n[2]),Q(e,"close",n[5])],o=!0)},p(a,[u]){s&&s.p&&(!t||u&9)&&je(s,i,a,a[3],t?Se(i,a[3],u,ko):ze(a[3]),Tt)},i(a){t||(_(s,a),t=!0)},o(a){k(s,a),t=!1},d(a){a&&$(e),s&&s.d(a),n[6](null),o=!1,$e(l)}}}function wo(n,e,r){let{$$slots:t={},$$scope:o}=e,l;function i(c){l.open&&c.target==l&&l.close()}function s(c){(c.key=="Escape"||c.key=="Enter")&&(c.stopPropagation(),l.close())}function a(c){ke.call(this,n,c)}function u(c){ue[c?"unshift":"push"](()=>{l=c,r(0,l)})}return n.$$set=c=>{"$$scope"in c&&r(3,o=c.$$scope)},[l,i,s,o,t,a,u]}class rt extends oe{constructor(e){super(),le(this,e,wo,bo,re,{})}}function It(n,e,r){const t=n.slice();return t[3]=e[r],t}function Et(n,e,r){const t=n.slice();return t[6]=e[r],t}function Dt(n){let e,r;return{c(){e=b("span"),r=q(` 
    `),X(e,"background",n[6]),X(e,"width","100%"),X(e,"border","1px solid black")},m(t,o){h(t,e,o),g(e,r)},p(t,o){o&1&&X(e,"background",t[6])},d(t){t&&$(e)}}}function vo(n){let e,r=n[3]+"",t;return{c(){e=b("span"),t=q(r)},m(o,l){h(o,e,l),g(e,t)},p(o,l){l&2&&r!==(r=o[3]+"")&&ne(t,r)},d(o){o&&$(e)}}}function yo(n){let e,r=n[3].toFixed(n[2])+"",t;return{c(){e=b("span"),t=q(r)},m(o,l){h(o,e,l),g(e,t)},p(o,l){l&6&&r!==(r=o[3].toFixed(o[2])+"")&&ne(t,r)},d(o){o&&$(e)}}}function Nt(n){let e;function r(l,i){return l[2]>0?yo:vo}let t=r(n),o=t(n);return{c(){o.c(),e=Te()},m(l,i){o.m(l,i),h(l,e,i)},p(l,i){t===(t=r(l))&&o?o.p(l,i):(o.d(1),o=t(l),o&&(o.c(),o.m(e.parentNode,e)))},d(l){l&&$(e),o.d(l)}}}function Ao(n){let e,r,t,o=Y(n[0]),l=[];for(let a=0;a<o.length;a+=1)l[a]=Dt(Et(n,o,a));let i=Y(n[1]),s=[];for(let a=0;a<i.length;a+=1)s[a]=Nt(It(n,i,a));return{c(){e=b("div");for(let a=0;a<l.length;a+=1)l[a].c();r=z(),t=b("div");for(let a=0;a<s.length;a+=1)s[a].c();X(e,"display","flex"),X(t,"display","flex"),X(t,"justify-content","space-between")},m(a,u){h(a,e,u);for(let c=0;c<l.length;c+=1)l[c]&&l[c].m(e,null);h(a,r,u),h(a,t,u);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(t,null)},p(a,[u]){if(u&1){o=Y(a[0]);let c;for(c=0;c<o.length;c+=1){const d=Et(a,o,c);l[c]?l[c].p(d,u):(l[c]=Dt(d),l[c].c(),l[c].m(e,null))}for(;c<l.length;c+=1)l[c].d(1);l.length=o.length}if(u&6){i=Y(a[1]);let c;for(c=0;c<i.length;c+=1){const d=It(a,i,c);s[c]?s[c].p(d,u):(s[c]=Nt(d),s[c].c(),s[c].m(t,null))}for(;c<s.length;c+=1)s[c].d(1);s.length=i.length}},i:V,o:V,d(a){a&&($(e),$(r),$(t)),fe(l,a),fe(s,a)}}}function Co(n,e,r){let{colorScale:t}=e,{limits:o}=e,{decimalPlaces:l=0}=e;return n.$$set=i=>{"colorScale"in i&&r(0,t=i.colorScale),"limits"in i&&r(1,o=i.limits),"decimalPlaces"in i&&r(2,l=i.decimalPlaces)},[t,o,l]}class jo extends oe{constructor(e){super(),le(this,e,Co,Ao,re,{colorScale:0,limits:1,decimalPlaces:2})}}function zo(n,e){let r=document.createElement("a");r.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),r.setAttribute("download",n),document.body.appendChild(r),r.click(),document.body.removeChild(r)}function So(n){let e;return{c(){e=q("Bus stops")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Ot(n){let e,r,t,o,l;return o=new jo({props:{colorScale:n[1],limits:n[2]}}),{c(){e=b("div"),r=b("p"),r.textContent="Peak hourly frequency:",t=z(),B(o.$$.fragment),F(e,"class","svelte-yxmabo")},m(i,s){h(i,e,s),g(e,r),g(e,t),L(o,e,null),l=!0},p:V,i(i){l||(_(o.$$.fragment,i),l=!0)},o(i){k(o.$$.fragment,i),l=!1},d(i){i&&$(e),M(o)}}}function Bo(n){let e,r,t,o=n[4].stop_name+"",l,i,s,a,u,c=n[4].peak+"",d,f,m,p,C,N=n[4].peak_description+"",A,v,D,y,S,w=n[4].total+"",j,I,O=n[4].total_description+"",R,J;return{c(){e=b("p"),r=q("Stop name: "),t=b("b"),l=q(o),i=z(),s=b("p"),a=q("Peak: "),u=b("b"),d=q(c),f=q(`
        buses during the busiest hour of any day`),m=z(),p=b("p"),C=q("The peak hour is "),A=q(N),v=z(),D=b("p"),y=q("Total buses per day: "),S=b("b"),j=q(w),I=q(`
        (for `),R=q(O),J=q(", the busiest day of the week)")},m(T,Z){h(T,e,Z),g(e,r),g(e,t),g(t,l),h(T,i,Z),h(T,s,Z),g(s,a),g(s,u),g(u,d),g(s,f),h(T,m,Z),h(T,p,Z),g(p,C),g(p,A),h(T,v,Z),h(T,D,Z),g(D,y),g(D,S),g(S,j),g(D,I),g(D,R),g(D,J)},p(T,Z){Z&16&&o!==(o=T[4].stop_name+"")&&ne(l,o),Z&16&&c!==(c=T[4].peak+"")&&ne(d,c),Z&16&&N!==(N=T[4].peak_description+"")&&ne(A,N),Z&16&&w!==(w=T[4].total+"")&&ne(j,w),Z&16&&O!==(O=T[4].total_description+"")&&ne(R,O)},d(T){T&&($(e),$(i),$(s),$(m),$(p),$(v),$(D))}}}function Lo(n){let e,r;return e=new We({props:{$$slots:{default:[Bo,({props:t})=>({4:t}),({props:t})=>t?16:0]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&48&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function Mo(n){let e,r;return e=new Fe({props:{sourceLayer:"bus_stops",paint:{"circle-color":br(["get","peak"],n[2],n[1]),"circle-radius":["interpolate",["linear"],["zoom"],1,2,8,3,13,10]},layout:{visibility:n[0]?"visible":"none"},manageHoverState:!0,$$slots:{default:[Lo]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&1&&(l.layout={visibility:t[0]?"visible":"none"}),o&32&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function To(n){let e,r,t,o,l;e=new Wn({props:{$$slots:{default:[So]},$$scope:{ctx:n}}}),e.$on("click",n[3]);let i=n[0]&&Ot(n);return o=new xn({props:{url:"pmtiles://http://atip.uk/layers/v1/bus_stops.pmtiles",$$slots:{default:[Mo]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment),r=z(),i&&i.c(),t=z(),B(o.$$.fragment)},m(s,a){L(e,s,a),h(s,r,a),i&&i.m(s,a),h(s,t,a),L(o,s,a),l=!0},p(s,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:s}),e.$set(u),s[0]?i?(i.p(s,a),a&1&&_(i,1)):(i=Ot(s),i.c(),_(i,1),i.m(t.parentNode,t)):i&&(se(),k(i,1,1,()=>{i=null}),ae());const c={};a&33&&(c.$$scope={dirty:a,ctx:s}),o.$set(c)},i(s){l||(_(e.$$.fragment,s),_(i),_(o.$$.fragment,s),l=!0)},o(s){k(e.$$.fragment,s),k(i),k(o.$$.fragment,s),l=!1},d(s){s&&($(r),$(t)),M(e,s),i&&i.d(s),M(o,s)}}}function Io(n,e,r){let t=!1;return[t,["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],[0,3,10,20,30,100],()=>r(0,t=!t)]}class Eo extends oe{constructor(e){super(),le(this,e,Io,To,re,{})}}function Do(n){let e;return{c(){e=q("Crossings")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function qt(n){let e,r,t;return r=new $o({props:{rows:n[1]}}),{c(){e=b("div"),B(r.$$.fragment),F(e,"class","svelte-yxmabo")},m(o,l){h(o,e,l),L(r,e,null),t=!0},p:V,i(o){t||(_(r.$$.fragment,o),t=!0)},o(o){k(r.$$.fragment,o),t=!1},d(o){o&&$(e),M(r)}}}function No(n){let e,r=(n[3].class||"Unknown")+"",t,o;return{c(){e=b("p"),t=q(r),o=q(" crossing")},m(l,i){h(l,e,i),g(e,t),g(e,o)},p(l,i){i&8&&r!==(r=(l[3].class||"Unknown")+"")&&ne(t,r)},d(l){l&&$(e)}}}function Oo(n){let e,r;return e=new We({props:{$$slots:{default:[No,({props:t})=>({3:t}),({props:t})=>t?8:0]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&24&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function qo(n){let e,r=(n[3].class||"Unknown")+"",t,o;return{c(){e=b("p"),t=q(r),o=q(" crossing")},m(l,i){h(l,e,i),g(e,t),g(e,o)},p(l,i){i&8&&r!==(r=(l[3].class||"Unknown")+"")&&ne(t,r)},d(l){l&&$(e)}}}function Fo(n){let e,r;return e=new We({props:{$$slots:{default:[qo,({props:t})=>({3:t}),({props:t})=>t?8:0]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&24&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function Po(n){let e,r,t,o;return e=new Le({props:{sourceLayer:"crossings",filter:wr,paint:{"line-color":_t(["get","class"],Object.fromEntries(n[1]),"red"),"line-width":3},layout:{visibility:n[0]?"visible":"none"},hoverCursor:"pointer",$$slots:{default:[Oo]},$$scope:{ctx:n}}}),e.$on("click",Ft),t=new Fe({props:{sourceLayer:"crossings",filter:vr,paint:{"circle-color":_t(["get","class"],Object.fromEntries(n[1]),"red"),"circle-radius":["interpolate",["linear"],["zoom"],1,2,8,3,13,10]},layout:{visibility:n[0]?"visible":"none"},hoverCursor:"pointer",$$slots:{default:[Fo]},$$scope:{ctx:n}}}),t.$on("click",Ft),{c(){B(e.$$.fragment),r=z(),B(t.$$.fragment)},m(l,i){L(e,l,i),h(l,r,i),L(t,l,i),o=!0},p(l,i){const s={};i&1&&(s.layout={visibility:l[0]?"visible":"none"}),i&16&&(s.$$scope={dirty:i,ctx:l}),e.$set(s);const a={};i&1&&(a.layout={visibility:l[0]?"visible":"none"}),i&16&&(a.$$scope={dirty:i,ctx:l}),t.$set(a)},i(l){o||(_(e.$$.fragment,l),_(t.$$.fragment,l),o=!0)},o(l){k(e.$$.fragment,l),k(t.$$.fragment,l),o=!1},d(l){l&&$(r),M(e,l),M(t,l)}}}function Uo(n){let e,r,t,o,l;e=new Wn({props:{$$slots:{default:[Do]},$$scope:{ctx:n}}}),e.$on("click",n[2]);let i=n[0]&&qt(n);return o=new xn({props:{url:"pmtiles://http://atip.uk/layers/v1/crossings.pmtiles",$$slots:{default:[Po]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment),r=z(),i&&i.c(),t=z(),B(o.$$.fragment)},m(s,a){L(e,s,a),h(s,r,a),i&&i.m(s,a),h(s,t,a),L(o,s,a),l=!0},p(s,[a]){const u={};a&16&&(u.$$scope={dirty:a,ctx:s}),e.$set(u),s[0]?i?(i.p(s,a),a&1&&_(i,1)):(i=qt(s),i.c(),_(i,1),i.m(t.parentNode,t)):i&&(se(),k(i,1,1,()=>{i=null}),ae());const c={};a&17&&(c.$$scope={dirty:a,ctx:s}),o.$set(c)},i(s){l||(_(e.$$.fragment,s),_(i),_(o.$$.fragment,s),l=!0)},o(s){k(e.$$.fragment,s),k(i),k(o.$$.fragment,s),l=!1},d(s){s&&($(r),$(t)),M(e,s),i&&i.d(s),M(o,s)}}}function Ft(n){window.open(`https://www.openstreetmap.org/${n.detail.features[0].properties.osm}`,"_blank")}function Go(n,e,r){let t=!1;return[t,[["Zebra","#66C5CC"],["Parallel","#F6CF71"],["Pelican","#F89C74"],["Puffin","#DCB0F2"],["Toucan","#87C55F"],["Pegasus","#9EB9F3"],["Uncontrolled","#FE88B1"],["Signalised","#C9DB74"],["Unknown","red"]],()=>r(0,t=!t)]}class Qo extends oe{constructor(e){super(),le(this,e,Go,Uo,re,{})}}function Ho(n){let e,r,t,o,l;return r=new Eo({}),o=new Qo({}),{c(){e=b("div"),B(r.$$.fragment),t=z(),B(o.$$.fragment),X(e,"display","flex"),X(e,"flex-direction","column")},m(i,s){h(i,e,s),L(r,e,null),g(e,t),L(o,e,null),l=!0},p:V,i(i){l||(_(r.$$.fragment,i),_(o.$$.fragment,i),l=!0)},o(i){k(r.$$.fragment,i),k(o.$$.fragment,i),l=!1},d(i){i&&$(e),M(r),M(o)}}}function Jo(n){let e,r;return e=new Tr({props:{$$slots:{default:[Ho]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,[o]){const l={};o&1&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}class Ro extends oe{constructor(e){super(),le(this,e,null,Jo,re,{})}}let He={SA01:{description:"Pedestrian and cyclist conflict with motor traffic at side roads/priority junctions",green:"Side roads/priority junctions have entry treatments that offer greater protection for  pedestrian and cycle movements (e.g. exit only, continuous footways, zebra/parallel crossings as appropriate to context).",amber:"<2,500vpd cut across main walking, wheeling or cycling streams and side roads and priority junctions have entry treatments. ",red:"<2,500vpd cut across main walking, wheeling or cycling streams, but side roads and priority junctions are untreated.",critical:">2,500vpd cut across main walking, wheeling or cycling streams."},SA02:{description:"Pedestrian and cyclist conflict with motor traffic at roundabouts and signal-controlled junctions",green:"All pedestrian and cyclist movements are separated from all motor traffic movements at roundabouts and/or signal controlled junctions.",amber:"The principal pedestrian and cyclist movements are separated from motor traffic movements at roundabouts and/or signal controlled junctions.",red:"The principal pedestrian and/or cyclist movements are in conflict with motor traffic movements at roundabouts and/or signal controlled junctions.",critical:">2,500vpd cut across main walking, wheeling or cycling streams."},SA03:{description:"Effect of lane widths on conflict between cyclists and motor traffic",green:"Cyclists are protected from motor traffic or off-road entirely.",amber:`Cyclists are in cycle lanes with light protection or stepped cycle tracks under 1.8m wide (single direction).

Or, cyclists are in a protected bidirectional cycle facility under 2.5m wide.

Or, cyclists are mixed with traffic on quiet urban streets with no centre line.`,red:`Cyclists are mixed with traffic in lanes less than 3.25m wide or over 3.9m wide.

Or, cyclists are in unprotected cycle lanes and the combined width of the cycle lane and adjacent traffic lane is under 3.25m or over 3.9m. 

Or cyclists are mixed with traffic on busy urban streets with no centre line.

Or, there are speed cushions present.`,critical:`Cyclists are mixed with traffic in lanes between 3.25m and 3.9m wide. 

Or, cyclists are in unprotected cycle lanes and the combined width of the cycle lane and adjacent traffic lane is between 3.25m and 3.9m.`},SA04:{description:"Risk of pedestrians tripping due to hazards",green:"No trip hazards, level clear surface.",amber:"Few trip hazards.",red:"Many trip hazards.",critical:"There are level differences of greater than 13mm with no tactile information and colour contrast to help identify them."},SA05:{description:"Cyclist conflict with kerbside activity, including risk of 'dooring' ",green:"Kerbside activity is well-managed with no or minimal conflict with cyclists. ",amber:"Less frequent kerbside activity, and conflict with cyclists is well-managed.",red:"Frequent kerbside activity for cyclists to contend with. Conflict with cyclists is not well-managed.",critical:`Cycle facility next to parking/loading facility, without a buffer of at least 0.5m.

Or, an unprotected cycle lane is next to a frequently-used bus layby.`},SA06:{description:"Ability of pedestrians to cross the street safely on desire lines",green:`On very busy streets (>8,000vpd), controlled crossings (including zebra crossings) are provided every 50-100m. 

On quieter streets (<8,000vpd), there are controlled crossings or only one lane of traffic to cross.`,amber:`On very busy streets (>8,000vpd), controlled crossings (including zebra crossings) are provided every 100-200m.

On quieter streets (<8,000vpd), loading/parking is formalised with gaps for pedestrians to cross on desire lines.`,red:`On very busy streets (>8,000vpd), controlled crossings (including zebra crossings) are provided every 200-400m.

On quieter streets (<8,000vpd), loading/parking is formalised with gaps for pedestrians to cross.`,critical:`On very busy streets (>8,000vpd) controlled crossings (including zebra crossings) are not present or more than 400m apart.

On quieter streets (<8,000vpd), desire lines are blocked by parking and loading. `},SA07:{description:"Suitability of pedestrian crossings in context",green:`On very busy streets (>8,000vpd), signal crossings rest on green for pedestrians or have rapid response.

On quieter streets (<8,000vpd), crossing points are controlled crossings.`,amber:`On very busy streets (>8,000vpd), signal crossings are provided for pedestrians.

On quieter streets (<8,000vpd), crossing points have effective implied priority for pedestrians.`,red:`On very busy streets (>8,000vpd), there are uncontrolled crossings or zebra/parallel crossings.

On quieter streets (<8,000vpd), crossing points have no implied priority or there are no crossing points.`,critical:`On very busy streets (>8,000vpd), there are uncontrolled crossings of two or more lanes with no gaps in traffic.

At signal junctions there are arms with dropped kerbs and tactile paving but no green pedestrian symbol.`},SA08:{description:"85th percentile speed of motor traffic (where cyclists are not protected or pedestrians are crossing uncontrolled)",green:`85th percentile speed is under 20mph.

Or, cyclists are protected from motor traffic or off-road entirely and controlled crossings are provided for pedestrians wherever needed.`,amber:"85th percentile speed is between 20mph and 25mph.",red:"85th percentile speed is over 25mph.",critical:"85th percentile speed is over 30mph."},SA09:{description:"Volume of motor traffic at the busiest hour (where cyclists are not protected or pedestrians cross uncontrolled)",green:`<200 vehicles in the busiest hour.

Or, cyclists are protected from motor traffic or off-road entirely and controlled crossings are provided for pedestrians wherever needed.`,amber:`200-499 vehicles in the busiest hour.

And, less than 2% of traffic is HGVs.`,red:`500-1,000 vehicles in the busiest hour.

Or, 2-5% of traffic is HGVs where there are 200-499 vehicles in the busiest hour.`,critical:`>1,000 vehicles in the busiest hour.

Or, over 5% of traffic is HGVs where there are over 500 vehicles in the busiest hour.`},SA10:{description:"Required crossing speed at signal crossings (risk of pedestrians coming into conflict with traffic).",green:"There are detectors present on the crossing which extend crossing times based on a crossing speed of 1m/s.",amber:"There are detectors present on the crossing which extend crossing times based on a crossing speed of 1.2m/s.",red:"There are no detectors to extend crossing times, but pedestrians who start crossing at the end of the 'invitation to cross' can cross at a speed of 1.2m/s and get across the whole crossing in time.",critical:"Pedestrians who start crossing at the end of the 'invitation to cross' must cross at a speed of over 1.2m/s to get across the whole crossing in time."},SA11:{description:"Clear walking and wheeling spaces free of permanent obstructions and furniture, reducing risk of pedestrians walking in the carriageway.",green:">3m clear footway width and pedestrian comfort is good (PCL of A-C).",amber:`Where the footway is next to the carriageway, there is:
• 2m-3m clear footway width and pedestrian comfort is good (PCL of A-C).
• >3m clear footway width and pedestrian comfort is poor (PCL of D-E).

Where the footway is not next to the carriageway, the clear footway width is 1.5m-3m.`,red:`Where the footway is next to the carriageway, there is:
• <2m clear footway width but pedestrian comfort is good (PCL of A-C)
• 2m-3m clear footway width and pedestrian comfort is poor (PCL of D-E).

Where the footway is not next to the carriageway, the clear footway width is <1.5m.`,critical:`Where the footway is next to the carriageway, there is:
• <1m clear footway width on any footway
• <1.5m clear footway width for over 6m
• 1m-2m clear footway width with a Pedestrian Comfort Level of D-E

Or there is no footway.`},SA12:{description:"Effective width next to tram line on a straight run or a curve",green:"Physical protection is provided for cyclists.",amber:">2.4m from tramline edge to kerb.",red:"2.4m from tramline edge to kerb.",critical:`<2.4m from tramline edge to kerb on a straight run.

Insufficient clearance on a curve.`},SA13:{description:"Crossing angle (between cyclist desire line and tram or train rails).",green:"Crossing angle between 80 and 90 degrees with track filler creating a smooth crossing for cyclists.",amber:"Crossing angle between 80 and 90 degrees (or between 60 and 80 degrees with track filler creating a smooth crossing for cyclists).",red:"Crossing angle between 60 and 80 degrees.",critical:"Crossing angle less than 60 degrees."},SA14:{description:`Cycling surface and maintenance defects:
• sharp gradients (≥12.5%)
• non cycle friendly ironworks
• raised/sunken covers or gullies
• potholes
• loose/cracked surfaces
• poor drainage or slip risks
• overgrown vegetation`,green:"No defects.",amber:"Few minor defects.",red:"Many minor defects.",critical:"Major defects."},SA15:{description:`Walking/wheeling surface and maintenance defects:
• steep camber (horizontal gradient >2.5% )
• steep longitudinal gradients (≥8% if under 1m, ≥5% if 1m or over) 
• missing dropped kerbs
• non flush tables
• misleading tactile information
• loose/cracked surfaces
• poor drainage or slip risks
• overgrown vegetation
`,green:"No defects.",amber:"Few minor defects.",red:"Many minor defects.",critical:"Major defects."},SA16:{description:"Presence of guard railing",green:"No guard railing anywhere on the route.",amber:"Minimal guard railing, used to address a clear safety issue such as a level difference.",red:"Guard railing used to control behaviour in complex environments.",critical:"Guard railing used as standard without consideration of inherent safety risks."}};function Ko(n){let e,r,t,o=n[0].green+"",l,i,s,a,u,c=n[0].amber+"",d,f,m,p,C,N=n[0].red+"",A,v,D,y,S,w=n[0].critical+"",j;return{c(){e=b("p"),r=b("b"),r.textContent="2",t=q(`
  : `),l=q(o),i=z(),s=b("p"),a=b("b"),a.textContent="1",u=q(`
  : `),d=q(c),f=z(),m=b("p"),p=b("b"),p.textContent="0",C=q(`
  : `),A=q(N),v=z(),D=b("p"),y=b("b"),y.textContent="Critical",S=q(`
  : `),j=q(w)},m(I,O){h(I,e,O),g(e,r),g(e,t),g(e,l),h(I,i,O),h(I,s,O),g(s,a),g(s,u),g(s,d),h(I,f,O),h(I,m,O),g(m,p),g(m,C),g(m,A),h(I,v,O),h(I,D,O),g(D,y),g(D,S),g(D,j)},p(I,[O]){O&1&&o!==(o=I[0].green+"")&&ne(l,o),O&1&&c!==(c=I[0].amber+"")&&ne(d,c),O&1&&N!==(N=I[0].red+"")&&ne(A,N),O&1&&w!==(w=I[0].critical+"")&&ne(j,w)},i:V,o:V,d(I){I&&($(e),$(i),$(s),$(f),$(m),$(v),$(D))}}}function Xo(n,e,r){let{metric:t}=e;return n.$$set=o=>{"metric"in o&&r(0,t=o.metric)},[t]}class ot extends oe{constructor(e){super(),le(this,e,Xo,Ko,re,{metric:0})}}const{window:Zo}=Je;function Vo(n){let e;return{c(){e=q("SA10: pedestrian crossing speed")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Yo(n){let e,r,t,o,l,i,s,a,u,c,d,f,m,p,C,N,A,v;function D(S){n[9](S)}let y={k:"horiz-radio",choices:be(),$$slots:{default:[Vo]},$$scope:{ctx:n}};return n[1].crossings[n[0]].properties.sa10!==void 0&&(y.value=n[1].crossings[n[0]].properties.sa10),c=new Ie({props:y}),ue.push(()=>me(c,"value",D)),C=new ot({props:{metric:n[3]}}),{c(){e=b("div"),r=b("button"),r.textContent="Done",t=z(),o=b("button"),o.textContent="Delete crossing",l=z(),i=b("label"),s=q(`Name:
      `),a=b("input"),u=z(),B(c.$$.fragment),f=z(),m=b("p"),m.textContent=`${n[3].description}`,p=z(),B(C.$$.fragment),F(a,"type","text"),F(e,"slot","sidebar")},m(S,w){h(S,e,w),g(e,r),g(e,t),g(e,o),g(e,l),g(e,i),g(i,s),g(i,a),he(a,n[1].crossings[n[0]].properties.name),g(e,u),L(c,e,null),g(e,f),g(e,m),g(e,p),L(C,e,null),N=!0,A||(v=[Q(r,"click",n[7]),Q(o,"click",n[5]),Q(a,"input",n[8])],A=!0)},p(S,w){w&3&&a.value!==S[1].crossings[S[0]].properties.name&&he(a,S[1].crossings[S[0]].properties.name);const j={};w&1024&&(j.$$scope={dirty:w,ctx:S}),!d&&w&3&&(d=!0,j.value=S[1].crossings[S[0]].properties.sa10,pe(()=>d=!1)),c.$set(j)},i(S){N||(_(c.$$.fragment,S),_(C.$$.fragment,S),N=!0)},o(S){k(c.$$.fragment,S),k(C.$$.fragment,S),N=!1},d(S){S&&$(e),M(c),M(C),A=!1,$e(v)}}}function Wo(n){let e,r;return e=new Pe({props:{filter:["!=",["id"],n[0]],layout:{"icon-image":"crossing","icon-size":.1},paint:{"icon-color":"black"}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&1&&(l.filter=["!=",["id"],t[0]]),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function xo(n){let e,r;return{c(){e=b("img"),Xe(e.src,r=tr)||F(e,"src",r)},m(t,o){h(t,e,o)},p:V,d(t){t&&$(e)}}}function el(n){let e,r,t,o,l,i,s,a;r=new Ne({props:{except:"crossings"}}),o=new _e({props:{data:ce(n[1].crossings),generateId:!0,$$slots:{default:[Wo]},$$scope:{ctx:n}}});function u(d){n[6](d)}let c={color:n[1].crossings[n[0]].properties.color,$$slots:{default:[xo]},$$scope:{ctx:n}};return n[1].crossings[n[0]].geometry.coordinates!==void 0&&(c.lngLat=n[1].crossings[n[0]].geometry.coordinates),i=new dt({props:c}),ue.push(()=>me(i,"lngLat",u)),{c(){e=b("div"),B(r.$$.fragment),t=z(),B(o.$$.fragment),l=z(),B(i.$$.fragment),F(e,"slot","map")},m(d,f){h(d,e,f),L(r,e,null),g(e,t),L(o,e,null),g(e,l),L(i,e,null),a=!0},p(d,f){const m={};f&2&&(m.data=ce(d[1].crossings)),f&1025&&(m.$$scope={dirty:f,ctx:d}),o.$set(m);const p={};f&3&&(p.color=d[1].crossings[d[0]].properties.color),f&1024&&(p.$$scope={dirty:f,ctx:d}),!s&&f&3&&(s=!0,p.lngLat=d[1].crossings[d[0]].geometry.coordinates,pe(()=>s=!1)),i.$set(p)},i(d){a||(_(r.$$.fragment,d),_(o.$$.fragment,d),_(i.$$.fragment,d),a=!0)},o(d){k(r.$$.fragment,d),k(o.$$.fragment,d),k(i.$$.fragment,d),a=!1},d(d){d&&$(e),M(r),M(o),M(i)}}}function tl(n){let e,r,t,o;return e=new Ee({props:{$$slots:{map:[el],sidebar:[Yo]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(l,i){L(e,l,i),r=!0,t||(o=Q(Zo,"keydown",n[4]),t=!0)},p(l,[i]){const s={};i&1031&&(s.$$scope={dirty:i,ctx:l}),e.$set(s)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){k(e.$$.fragment,l),r=!1},d(l){M(e,l),t=!1,o()}}}function nl(n,e,r){let t,o;ee(n,G,m=>r(1,t=m)),ee(n,K,m=>r(2,o=m));let{idx:l}=e,i=He.SA10;function s(m){m.key=="Escape"&&H(K,o={kind:"neutral"},o)}async function a(){window.confirm("Really delete this crossing?")&&(H(K,o={kind:"neutral"},o),await qe(),t.crossings.splice(l,1),G.set(t))}function u(m){n.$$.not_equal(t.crossings[l].geometry.coordinates,m)&&(t.crossings[l].geometry.coordinates=m,G.set(t))}const c=()=>H(K,o={kind:"neutral"},o);function d(){t.crossings[l].properties.name=this.value,G.set(t)}function f(m){n.$$.not_equal(t.crossings[l].properties.sa10,m)&&(t.crossings[l].properties.sa10=m,G.set(t))}return n.$$set=m=>{"idx"in m&&r(0,l=m.idx)},[l,t,o,i,s,a,u,c,d,f]}class rl extends oe{constructor(e){super(),le(this,e,nl,tl,re,{idx:0})}}let Pt="MZEJTanw3WpxRvt7qDfo";async function ol(n){return n?{version:8,sources:{"raster-tiles":{type:"raster",tiles:[`https://tile.googleapis.com/v1/2dtiles/{z}/{x}/{y}?session=${await ll(n)}&key=${n}`],tileSize:256,attribution:"Google (detailed attributions not wired up)"}},layers:[{id:"raster-basemap",type:"raster",source:"raster-tiles"}],glyphs:`https://api.maptiler.com/fonts/{fontstack}/{range}.pbf?key=${Pt}`}:`https://api.maptiler.com/maps/dataviz/style.json?key=${Pt}`}async function ll(n){try{let r=await(await fetch(`https://tile.googleapis.com/v1/createSession?key=${n}`,{method:"POST",body:JSON.stringify({mapType:"satellite",language:"en-GB",region:"GB"})})).json();return"session"in r?r.session:(console.error(`Couldn't get Google tile session key: ${JSON.stringify(r)}`),"")}catch(e){return console.error(`Couldn't get Google tile session key: ${e}`),""}}const il="/route-element/assets/right-arrow-d8c7892c.svg";function Ut(n){let e,r;const t=n[4].default,o=Ce(t,n,n[3],null);return{c(){e=b("div"),o&&o.c(),F(e,"class","section svelte-zax3q3")},m(l,i){h(l,e,i),o&&o.m(e,null),r=!0},p(l,i){o&&o.p&&(!r||i&8)&&je(o,t,l,l[3],r?Se(t,l[3],i,null):ze(l[3]),null)},i(l){r||(_(o,l),r=!0)},o(l){k(o,l),r=!1},d(l){l&&$(e),o&&o.d(l)}}}function sl(n){let e,r,t,o,l,i,s,a,u,c,d,f,m=n[2]&&Ut(n);return{c(){e=b("button"),r=b("div"),t=b("span"),o=q(n[0]),l=z(),i=b("img"),u=z(),m&&m.c(),F(i,"class","arrow svelte-zax3q3"),Xe(i.src,s=il)||F(i,"src",s),F(i,"alt",a="Select "+n[0]),F(r,"class","top-section section svelte-zax3q3"),Ae(r,"bordered",n[2]),F(e,"class","clickable-card svelte-zax3q3"),e.disabled=n[1]},m(p,C){h(p,e,C),g(e,r),g(r,t),g(t,o),g(r,l),g(r,i),g(e,u),m&&m.m(e,null),c=!0,d||(f=[Q(e,"click",n[5]),Q(e,"mouseenter",n[6]),Q(e,"mouseleave",n[7])],d=!0)},p(p,[C]){(!c||C&1)&&ne(o,p[0]),(!c||C&1&&a!==(a="Select "+p[0]))&&F(i,"alt",a),(!c||C&4)&&Ae(r,"bordered",p[2]),p[2]?m?(m.p(p,C),C&4&&_(m,1)):(m=Ut(p),m.c(),_(m,1),m.m(e,null)):m&&(se(),k(m,1,1,()=>{m=null}),ae()),(!c||C&2)&&(e.disabled=p[1])},i(p){c||(_(m),c=!0)},o(p){k(m),c=!1},d(p){p&&$(e),m&&m.d(),d=!1,$e(f)}}}function al(n,e,r){let{$$slots:t={},$$scope:o}=e,{name:l}=e,{disabled:i=!1}=e,{hasSlot:s=!0}=e;function a(d){ke.call(this,n,d)}function u(d){ke.call(this,n,d)}function c(d){ke.call(this,n,d)}return n.$$set=d=>{"name"in d&&r(0,l=d.name),"disabled"in d&&r(1,i=d.disabled),"hasSlot"in d&&r(2,s=d.hasSlot),"$$scope"in d&&r(3,o=d.$$scope)},[l,i,s,o,t,a,u,c]}class rr extends oe{constructor(e){super(),le(this,e,al,sl,re,{name:0,disabled:1,hasSlot:2})}}let De={critical:{background:"#232323",font:"white"},red:{background:"#b73d25",font:"white"},amber:{background:"#ffd833",font:"black"},green:{background:"#006853",font:"white"},notApplicable:{background:"white",font:"black"}};const Ue={"Any type of junction":{"All movements":{scoreZero:["Cycle movement in potential conflict with heavy motor traffic flow.","Cycle movement mixed with or crossing traffic with 85th percentile speed exceeding 60kph, or where vehicles accelerate rapidly.","Necessary to cross more than one traffic lane (without refuge or protection) to complete cycle movement unless traffic flows are low.","Cycle movement crosses wide junction entry or exit: e.g. with merge or diverge taper or slip lane.","Pinch points on junction entry or exit (lane width 3.2m-3.9m).","Cycle movement affected by very poor surface quality utility reinstatement, gully positioning, debris."],scoreOne:["Cycle movement in potential conflict with moderate traffic flow.","Cycle lanes through junction meeting appropriate desirable minimum width requirements for the movement under consideration.","Raised table at junction crossed by traffic in potential conflict with cycle movement.","Cycle movement made by transiting onto section of shared use footway."],scoreTwo:["Low traffic speed and volume in mixed traffic environment (e.g. access-only streets in a residential area).","Cycle movement separated physically and/or in time from motor traffic and also separated from pedestrians.","Cycle movement bypasses junction completely, including via good quality grade separation."]}},"Simple priority T-junction":{"Right turn from minor arm":{scoreZero:["Heavy traffic movements and/or high bus and HGV flows in potential conflict with cycle movement, with no physical refuge in the centre of the major road (including ghost island junction)."],scoreOne:["Central refuge allowing two-stage cycle movement crossing one traffic lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm with dedicated cycle signals or cycle priority."]},"Left turn from major arm":{scoreZero:[],scoreOne:["Side road entry treatment (table across minor arm)."],scoreTwo:["Continuous footway and cycle track across minor arm."]},"Right turn from major arm":{scoreZero:["Heavy traffic movements and/or high bus and HGV flows in potential conflict with no physical refuge in the centre of major road (including ghost island junction)."],scoreOne:["Protected turning refuge allowing two stage cycle movement, crossing one lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm via dedicated cycle signals or cycle priority."]},"Ahead on major arm, crossing minor arm":{scoreZero:["Congested conditions causing poor visibility for right-turning motor vehicles from major arm.","Junction corner radius ≥9m, including where off-carriageway cycle track crosses minor arm."],scoreOne:["Junction free from queueing traffic and cycle lane on major arm meeting desirable minimum width requirements.","Junction corner radius <9m, including where off-carriageway cycle track crosses minor arm without priority.","Side road entry treatment (table across minor arm)."],scoreTwo:["Off-carriageway cycle track or stepped cycle track alongside major arm, crossing minor arm with priority over turning traffic."]}},Crossroads:{"Ahead from minor arm":{scoreZero:["Heavy opposing traffic movements with no physical refuge (including ghost island junction)."],scoreOne:["Protected pocket refuge for ahead cycles allowing two stage movement, crossing one lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm via dedicated cycle signals or cycle priority."]}},"Traffic Signals":{"All movements":{scoreZero:["Single or multiple queuing lanes with no cycle lanes or tracks on approaches.","Junctions with unsignalised left turn merge/diverge and signalised ahead lanes."],scoreOne:["Advance Cycle Stop lines, at least 5m deep and where the signals on the approach are on green for <30% of the cycle time.","Signal timings adjusted to provide extended intergreen to suit cycle movement under consideration.","Cycle/pedestrian scramble (toucan crossings with all-red stage).","Early release for cycles, with enough time to clear junction for cycle movement being considered."],scoreTwo:["Cycle movement has no potential conflict with motor traffic, e.g. dedicated cycle stage, conflicting traffic movement held or banned."]},"Right turn":{scoreZero:[],scoreOne:["Two-stage right turn via ASL or marked area in front of stop line."],scoreTwo:["Two-stage right turn with physically protected waiting area."]}},Roundabout:{"All movements":{scoreZero:["Any type of roundabout with high traffic throughput.","Normal roundabout with multi-lane flared approaches.","Any type of roundabout with annular cycle lane marked on the circulatory carriageway."],scoreOne:["Compact roundabout or raised mini roundabout with no more than moderate traffic throughput","Off-carriageway cycle track with crossings of entries and exits without cycle priority, crossing single traffic lanes with traffic flows < 4000 vehicles per day or 400 HGV/bus flow. "],scoreTwo:["Off-carriageway cycle track with crossings of entries and exits with signals or cycle priority."]}}},or=Object.keys(Ue);function nt(n){return Object.keys(Ue[n])}const Oe="All movements";function Gt(n,e){let r=[],t=Ue[n][e];t&&r.push({junctionType:n,movementType:e,...t});let o=Ue[n][Oe];if(o&&e!=Oe&&r.push({junctionType:n,movementType:Oe,...o}),n=="Crossroads"){let l=Ue["Simple priority T-junction"][Oe];l&&r.push({junctionType:"Simple priority T-junction",movementType:Oe,...l})}if(n!="Any type of junction"){let l=Ue["Any type of junction"][Oe];l&&r.push({junctionType:"Any type of junction",movementType:Oe,...l})}return r}function Qt(n,e,r){const t=n.slice();return t[9]=e[r],t}function Ht(n,e,r){const t=n.slice();return t[12]=e[r],t}function Jt(n,e,r){const t=n.slice();return t[12]=e[r],t}function Rt(n,e,r){const t=n.slice();return t[12]=e[r],t}function Kt(n){let e,r;return e=new rt({props:{$$slots:{default:[fl]},$$scope:{ctx:n}}}),e.$on("close",n[8]),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&524295&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function cl(n){let e;return{c(){e=q("Type of junction")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function ul(n){let e;return{c(){e=q("Type of movement")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Xt(n){let e,r,t;function o(i){n[6](i)}let l={k:"vert-radio",choices:nt(n[1]),$$slots:{default:[ul]},$$scope:{ctx:n}};return n[2]!==void 0&&(l.value=n[2]),e=new Ie({props:l}),ue.push(()=>me(e,"value",o)),{c(){B(e.$$.fragment)},m(i,s){L(e,i,s),t=!0},p(i,s){const a={};s&2&&(a.choices=nt(i[1])),s&524288&&(a.$$scope={dirty:s,ctx:i}),!r&&s&4&&(r=!0,a.value=i[2],pe(()=>r=!1)),e.$set(a)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){k(e.$$.fragment,i),t=!1},d(i){M(e,i)}}}function Zt(n){let e,r=n[12]+"",t;return{c(){e=b("li"),t=q(r)},m(o,l){h(o,e,l),g(e,t)},p(o,l){l&6&&r!==(r=o[12]+"")&&ne(t,r)},d(o){o&&$(e)}}}function Vt(n){let e,r=n[12]+"",t;return{c(){e=b("li"),t=q(r)},m(o,l){h(o,e,l),g(e,t)},p(o,l){l&6&&r!==(r=o[12]+"")&&ne(t,r)},d(o){o&&$(e)}}}function Yt(n){let e,r=n[12]+"",t;return{c(){e=b("li"),t=q(r)},m(o,l){h(o,e,l),g(e,t)},p(o,l){l&6&&r!==(r=o[12]+"")&&ne(t,r)},d(o){o&&$(e)}}}function Wt(n){let e,r,t=n[9].junctionType+"",o,l,i,s,a,u,c=n[9].movementType+"",d,f,m,p,C,N,A,v,D,y,S,w=Y(n[9].scoreZero),j=[];for(let T=0;T<w.length;T+=1)j[T]=Zt(Rt(n,w,T));let I=Y(n[9].scoreOne),O=[];for(let T=0;T<I.length;T+=1)O[T]=Vt(Jt(n,I,T));let R=Y(n[9].scoreTwo),J=[];for(let T=0;T<R.length;T+=1)J[T]=Yt(Ht(n,R,T));return{c(){e=b("tr"),r=b("td"),o=q(t),l=z(),i=b("br"),s=z(),a=b("br"),u=z(),d=q(c),f=z(),m=b("td"),p=b("ul");for(let T=0;T<j.length;T+=1)j[T].c();C=z(),N=b("td"),A=b("ul");for(let T=0;T<O.length;T+=1)O[T].c();v=z(),D=b("td"),y=b("ul");for(let T=0;T<J.length;T+=1)J[T].c();S=z(),F(r,"class","type-row svelte-k4kgn3"),F(m,"class","score-zero svelte-k4kgn3"),F(N,"class","score-one svelte-k4kgn3"),F(D,"class","score-two svelte-k4kgn3")},m(T,Z){h(T,e,Z),g(e,r),g(r,o),g(r,l),g(r,i),g(r,s),g(r,a),g(r,u),g(r,d),g(e,f),g(e,m),g(m,p);for(let E=0;E<j.length;E+=1)j[E]&&j[E].m(p,null);g(e,C),g(e,N),g(N,A);for(let E=0;E<O.length;E+=1)O[E]&&O[E].m(A,null);g(e,v),g(e,D),g(D,y);for(let E=0;E<J.length;E+=1)J[E]&&J[E].m(y,null);g(e,S)},p(T,Z){if(Z&6&&t!==(t=T[9].junctionType+"")&&ne(o,t),Z&6&&c!==(c=T[9].movementType+"")&&ne(d,c),Z&6){w=Y(T[9].scoreZero);let E;for(E=0;E<w.length;E+=1){const ie=Rt(T,w,E);j[E]?j[E].p(ie,Z):(j[E]=Zt(ie),j[E].c(),j[E].m(p,null))}for(;E<j.length;E+=1)j[E].d(1);j.length=w.length}if(Z&6){I=Y(T[9].scoreOne);let E;for(E=0;E<I.length;E+=1){const ie=Jt(T,I,E);O[E]?O[E].p(ie,Z):(O[E]=Vt(ie),O[E].c(),O[E].m(A,null))}for(;E<O.length;E+=1)O[E].d(1);O.length=I.length}if(Z&6){R=Y(T[9].scoreTwo);let E;for(E=0;E<R.length;E+=1){const ie=Ht(T,R,E);J[E]?J[E].p(ie,Z):(J[E]=Yt(ie),J[E].c(),J[E].m(y,null))}for(;E<J.length;E+=1)J[E].d(1);J.length=R.length}},d(T){T&&$(e),fe(j,T),fe(O,T),fe(J,T)}}}function fl(n){let e,r,t,o,l,i,s,a,u=n[1],c,d,f,m,p,C,N,A,v;function D(I){n[5](I)}let y={k:"vert-radio",choices:or,$$slots:{default:[cl]},$$scope:{ctx:n}};n[1]!==void 0&&(y.value=n[1]),i=new Ie({props:y}),ue.push(()=>me(i,"value",D)),i.$on("change",n[3]);let S=Xt(n),w=Y(Gt(n[1],n[2])),j=[];for(let I=0;I<w.length;I+=1)j[I]=Wt(Qt(n,w,I));return{c(){e=b("h1"),e.textContent="LTN 1/20 scoring guidance",r=z(),t=b("p"),t.innerHTML=`Guidance from <a target="_blank" href="https://assets.publishing.service.gov.uk/media/5ffa1f96d3bf7f65d9e35825/cycle-infrastructure-design-ltn-1-20.pdf">LTN 1/20 appendix B</a>
      .`,o=z(),l=b("div"),B(i.$$.fragment),a=z(),S.c(),c=z(),d=b("table"),f=b("tr"),f.innerHTML=`<th class="type-header svelte-k4kgn3">Type of junction and movement</th> <th class="score-zero-header svelte-k4kgn3"><p class="svelte-k4kgn3"><b>Score = 0</b></p> <p class="svelte-k4kgn3">Suitable only for confident existing cyclists, and may be avoided by
            some experienced cyclists</p> <p class="svelte-k4kgn3">Conditions are most likely to give rise to the most common collision
            types</p></th> <th class="score-one-header svelte-k4kgn3"><p class="svelte-k4kgn3"><b>Score = 1</b></p> <p class="svelte-k4kgn3">Likely to be more acceptable to most cyclists, but may still pose
            problems for less confident or new cyclists</p> <p class="svelte-k4kgn3">The risk of collisions has been reduced by design layout or traffic
            management interventions</p></th> <th class="score-two-header svelte-k4kgn3"><p class="svelte-k4kgn3"><b>Score = 2</b></p> <p class="svelte-k4kgn3">Suitable for all potential and existing cyclists</p> <p class="svelte-k4kgn3">The potential for collisions has been removed, or managed to a high
            standard of safety for cyclists</p></th>`,m=z();for(let I=0;I<j.length;I+=1)j[I].c();p=z(),C=b("button"),C.textContent="OK",X(l,"display","flex"),X(l,"justify-content","space-between")},m(I,O){h(I,e,O),h(I,r,O),h(I,t,O),h(I,o,O),h(I,l,O),L(i,l,null),g(l,a),S.m(l,null),h(I,c,O),h(I,d,O),g(d,f),g(d,m);for(let R=0;R<j.length;R+=1)j[R]&&j[R].m(d,null);h(I,p,O),h(I,C,O),N=!0,A||(v=Q(C,"click",n[7]),A=!0)},p(I,O){const R={};if(O&524288&&(R.$$scope={dirty:O,ctx:I}),!s&&O&2&&(s=!0,R.value=I[1],pe(()=>s=!1)),i.$set(R),O&2&&re(u,u=I[1])?(se(),k(S,1,1,V),ae(),S=Xt(I),S.c(),_(S,1),S.m(l,null)):S.p(I,O),O&6){w=Y(Gt(I[1],I[2]));let J;for(J=0;J<w.length;J+=1){const T=Qt(I,w,J);j[J]?j[J].p(T,O):(j[J]=Wt(T),j[J].c(),j[J].m(d,null))}for(;J<j.length;J+=1)j[J].d(1);j.length=w.length}},i(I){N||(_(i.$$.fragment,I),_(S),N=!0)},o(I){k(i.$$.fragment,I),k(S),N=!1},d(I){I&&($(e),$(r),$(t),$(o),$(l),$(c),$(d),$(p),$(C)),M(i),S.d(I),fe(j,I),A=!1,v()}}}function dl(n){let e,r,t,o,l,i,s=n[0]&&Kt(n);return{c(){e=b("button"),e.textContent="LTN 1/20 scoring guidance",r=z(),s&&s.c(),t=Te(),F(e,"class","secondary")},m(a,u){h(a,e,u),h(a,r,u),s&&s.m(a,u),h(a,t,u),o=!0,l||(i=Q(e,"click",n[4]),l=!0)},p(a,[u]){a[0]?s?(s.p(a,u),u&1&&_(s,1)):(s=Kt(a),s.c(),_(s,1),s.m(t.parentNode,t)):s&&(se(),k(s,1,1,()=>{s=null}),ae())},i(a){o||(_(s),o=!0)},o(a){k(s),o=!1},d(a){a&&($(e),$(r),$(t)),s&&s.d(a),l=!1,i()}}}function ml(n,e,r){let t=!1,o=or[0],l=nt(o)[0];function i(){r(2,l=nt(o)[0])}const s=()=>r(0,t=!0);function a(f){o=f,r(1,o)}function u(f){l=f,r(2,l)}return[t,o,l,i,s,a,u,()=>r(0,t=!1),()=>r(0,t=!1)]}class pl extends oe{constructor(e){super(),le(this,e,ml,dl,re,{})}}function gl(n){let e;return{c(){e=q("User")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function xt(n){let e,r;return e=new pl({}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function _l(n){let e;return{c(){e=q("Score")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function hl(n){let e,r,t,o,l,i,s,a,u,c,d,f,m,p,C,N,A;function v(j){n[6](j)}let D={k:"horiz-radio",choices:[["cycling","Cycling"],["walking & wheeling","Walking & Wheeling"]],$$slots:{default:[gl]},$$scope:{ctx:n}};n[3].jats[n[0]].properties[n[1]].movements[n[2]].kind!==void 0&&(D.value=n[3].jats[n[0]].properties[n[1]].movements[n[2]].kind),l=new Ie({props:D}),ue.push(()=>me(l,"value",v));let y=n[3].jats[n[0]].properties[n[1]].movements[n[2]].kind=="cycling"&&xt();function S(j){n[7](j)}let w={k:"horiz-radio",choices:n[4],$$slots:{default:[_l]},$$scope:{ctx:n}};return n[3].jats[n[0]].properties[n[1]].movements[n[2]].score!==void 0&&(w.value=n[3].jats[n[0]].properties[n[1]].movements[n[2]].score),u=new Ie({props:w}),ue.push(()=>me(u,"value",S)),{c(){e=b("label"),r=q(`Name
  `),t=b("input"),o=z(),B(l.$$.fragment),s=z(),y&&y.c(),a=z(),B(u.$$.fragment),d=z(),f=b("label"),m=q(`Comments
  `),p=b("textarea"),F(t,"type","text")},m(j,I){h(j,e,I),g(e,r),g(e,t),he(t,n[3].jats[n[0]].properties[n[1]].movements[n[2]].name),h(j,o,I),L(l,j,I),h(j,s,I),y&&y.m(j,I),h(j,a,I),L(u,j,I),h(j,d,I),h(j,f,I),g(f,m),g(f,p),he(p,n[3].jats[n[0]].properties[n[1]].movements[n[2]].notes),C=!0,N||(A=[Q(t,"input",n[5]),Q(p,"input",n[8])],N=!0)},p(j,[I]){I&15&&t.value!==j[3].jats[j[0]].properties[j[1]].movements[j[2]].name&&he(t,j[3].jats[j[0]].properties[j[1]].movements[j[2]].name);const O={};I&512&&(O.$$scope={dirty:I,ctx:j}),!i&&I&15&&(i=!0,O.value=j[3].jats[j[0]].properties[j[1]].movements[j[2]].kind,pe(()=>i=!1)),l.$set(O),j[3].jats[j[0]].properties[j[1]].movements[j[2]].kind=="cycling"?y?I&15&&_(y,1):(y=xt(),y.c(),_(y,1),y.m(a.parentNode,a)):y&&(se(),k(y,1,1,()=>{y=null}),ae());const R={};I&512&&(R.$$scope={dirty:I,ctx:j}),!c&&I&15&&(c=!0,R.value=j[3].jats[j[0]].properties[j[1]].movements[j[2]].score,pe(()=>c=!1)),u.$set(R),I&15&&he(p,j[3].jats[j[0]].properties[j[1]].movements[j[2]].notes)},i(j){C||(_(l.$$.fragment,j),_(y),_(u.$$.fragment,j),C=!0)},o(j){k(l.$$.fragment,j),k(y),k(u.$$.fragment,j),C=!1},d(j){j&&($(e),$(o),$(s),$(a),$(d),$(f)),M(l,j),y&&y.d(j),M(u,j),N=!1,$e(A)}}}function $l(n,e,r){let t;ee(n,G,f=>r(3,t=f));let{junctionIdx:o}=e,{stage:l}=e,{idx:i}=e,s=[["X","X - black"],["0","0 - red"],["1","1 - amber"],["2","2 - green"]];function a(){t.jats[o].properties[l].movements[i].name=this.value,G.set(t)}function u(f){n.$$.not_equal(t.jats[o].properties[l].movements[i].kind,f)&&(t.jats[o].properties[l].movements[i].kind=f,G.set(t))}function c(f){n.$$.not_equal(t.jats[o].properties[l].movements[i].score,f)&&(t.jats[o].properties[l].movements[i].score=f,G.set(t))}function d(){t.jats[o].properties[l].movements[i].notes=this.value,G.set(t)}return n.$$set=f=>{"junctionIdx"in f&&r(0,o=f.junctionIdx),"stage"in f&&r(1,l=f.stage),"idx"in f&&r(2,i=f.idx)},[o,l,i,t,s,a,u,c,d]}class kl extends oe{constructor(e){super(),le(this,e,$l,hl,re,{junctionIdx:0,stage:1,idx:2})}}function bl(n){return n%(2*Math.PI)*180/Math.PI}function et(n){return n%360*Math.PI/180}function en(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function lr(n,e,r={}){if(r.final===!0)return wl(n,e);const t=en(n),o=en(e),l=et(t[0]),i=et(o[0]),s=et(t[1]),a=et(o[1]),u=Math.sin(i-l)*Math.cos(a),c=Math.cos(s)*Math.sin(a)-Math.sin(s)*Math.cos(a)*Math.cos(i-l);return bl(Math.atan2(u,c))}function wl(n,e){let r=lr(e,n);return r=(r+180)%360,r}var Ge=lr;function vl(n,e,r={}){const t={type:"Feature"};return(r.id===0||r.id)&&(t.id=r.id),r.bbox&&(t.bbox=r.bbox),t.properties=e||{},t.geometry=n,t}function yl(n,e,r={}){if(!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!tn(n[0])||!tn(n[1]))throw new Error("coordinates must contain numbers");return vl({type:"Point",coordinates:n},e,r)}function tn(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function Al(n,e={}){const r=yr(n),t=(r[0]+r[2])/2,o=(r[1]+r[3])/2;return yl([t,o],e.properties,e)}var Cl=Al,ve=63710088e-1,jl={centimeters:ve*100,centimetres:ve*100,degrees:360/(2*Math.PI),feet:ve*3.28084,inches:ve*39.37,kilometers:ve/1e3,kilometres:ve/1e3,meters:ve,metres:ve,miles:ve/1609.344,millimeters:ve*1e3,millimetres:ve*1e3,nauticalmiles:ve/1852,radians:1,yards:ve*1.0936};function zl(n,e,r={}){const t={type:"Feature"};return(r.id===0||r.id)&&(t.id=r.id),r.bbox&&(t.bbox=r.bbox),t.properties=e||{},t.geometry=n,t}function Sl(n,e,r={}){if(!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!rn(n[0])||!rn(n[1]))throw new Error("coordinates must contain numbers");return zl({type:"Point",coordinates:n},e,r)}function Bl(n,e="kilometers"){const r=jl[e];if(!r)throw new Error(e+" units is invalid");return n/r}function nn(n){return n%(2*Math.PI)*180/Math.PI}function it(n){return n%360*Math.PI/180}function rn(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function Ll(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Ml(n,e,r,t={}){const o=Ll(n),l=it(o[0]),i=it(o[1]),s=it(r),a=Bl(e,t.units),u=Math.asin(Math.sin(i)*Math.cos(a)+Math.cos(i)*Math.sin(a)*Math.cos(s)),c=l+Math.atan2(Math.sin(s)*Math.sin(a)*Math.cos(i),Math.cos(a)-Math.sin(i)*Math.sin(u)),d=nn(c),f=nn(u);return Sl([d,f],t.properties)}var Ve=Ml,ye=63710088e-1,Tl={centimeters:ye*100,centimetres:ye*100,degrees:360/(2*Math.PI),feet:ye*3.28084,inches:ye*39.37,kilometers:ye/1e3,kilometres:ye/1e3,meters:ye,metres:ye,miles:ye/1609.344,millimeters:ye*1e3,millimetres:ye*1e3,nauticalmiles:ye/1852,radians:1,yards:ye*1.0936};function Il(n,e="kilometers"){const r=Tl[e];if(!r)throw new Error(e+" units is invalid");return n*r}function tt(n){return n%360*Math.PI/180}function on(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function El(n,e,r={}){var t=on(n),o=on(e),l=tt(o[1]-t[1]),i=tt(o[0]-t[0]),s=tt(t[1]),a=tt(o[1]),u=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(s)*Math.cos(a);return Il(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),r.units)}var Dl=El;function Nl(n){let e=Cl({type:"FeatureCollection",features:n.map(t=>({type:"Feature",geometry:{type:"Point",coordinates:t.point},properties:{}}))}).geometry.coordinates;n.sort((t,o)=>ln(Ge(e,o.point))-ln(Ge(e,t.point)));let r=[];for(let t=0;t<n.length;t++){let o=n[t],l=Ge(o.point,e),i=1;for(let s of ql(t,n.length)){let a=n[s],u=Ge(e,a.point),c=Ol(o.point,e,i++),d=Dl(o.point,e),f=Ve(c,.5*d,l).geometry.coordinates,m=Ve(f,.2*d,u).geometry.coordinates;r.push({point1:c,point2:f,point3:m,kind:"cycling",score:"X",name:`${o.name} to ${a.name}`,notes:""})}}return r}function Ol(n,e,r){let t=.003,l=Ge(n,e)-90,i=t*r;return Ve(n,i,l).geometry.coordinates}function ln(n){return(n+360)%360}function ql(n,e){let r=[];for(let t=n+1;t<e;t++)r.push(t);for(let t=0;t<n;t++)r.push(t);return r}const Fl="/route-element/assets/movement-aa45473c.svg",Pl="/route-element/assets/pan-fbcec4cd.svg";function sn(n,e,r){const t=n.slice();return t[31]=e[r],t[32]=e,t[33]=r,t}function an(n,e,r){const t=n.slice();return t[34]=e[r],t[35]=e,t[33]=r,t}function cn(n){let e,r,t,o,l,i,s,a,u,c,d,f,m,p,C,N,A,v,D;function y(Z,E){return Z[0].mode=="select"?Gl:Ul}let S=y(n),w=S(n);function j(Z,E){return Z[0].mode=="new-arm"?Hl:Ql}let I=j(n),O=I(n);function R(Z,E){return Z[0].mode=="new-movement"?Rl:Jl}let J=R(n),T=J(n);return{c(){e=b("div"),r=b("button"),t=b("img"),l=z(),w.c(),i=z(),s=b("button"),a=lt("svg"),u=lt("circle"),c=lt("text"),d=q("A"),f=z(),O.c(),m=z(),p=b("button"),C=b("img"),A=z(),T.c(),Xe(t.src,o=Pl)||F(t,"src",o),F(t,"alt","Move map"),X(t,"vertical-align","middle"),F(r,"class","outline"),F(u,"cx","12"),F(u,"cy","12"),F(u,"r","12"),F(u,"fill","white"),F(c,"x","6"),F(c,"y","16"),F(c,"fill","#4472c4"),F(a,"width","24"),F(a,"height","24"),F(a,"xmlns","http://www.w3.org/2000/svg"),X(a,"vertical-align","middle"),F(s,"class","outline"),Xe(C.src,N=Fl)||F(C,"src",N),F(C,"alt","New movement"),X(C,"vertical-align","middle"),F(p,"class","outline"),F(e,"class","control-panel svelte-l1e6xi")},m(Z,E){h(Z,e,E),g(e,r),g(r,t),g(r,l),w.m(r,null),g(e,i),g(e,s),g(s,a),g(a,u),g(a,c),g(c,d),g(s,f),O.m(s,null),g(e,m),g(e,p),g(p,C),g(p,A),T.m(p,null),v||(D=[Q(r,"click",function(){Ar(n[4])&&n[4].apply(this,arguments)}),Q(s,"click",n[12]),Q(p,"click",n[13])],v=!0)},p(Z,E){n=Z,S!==(S=y(n))&&(w.d(1),w=S(n),w&&(w.c(),w.m(r,null))),I!==(I=j(n))&&(O.d(1),O=I(n),O&&(O.c(),O.m(s,null))),J!==(J=R(n))&&(T.d(1),T=J(n),T&&(T.c(),T.m(p,null)))},d(Z){Z&&$(e),w.d(),O.d(),T.d(),v=!1,$e(D)}}}function Ul(n){let e;return{c(){e=q("Move map")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Gl(n){let e;return{c(){e=b("b"),e.textContent="Move map"},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Ql(n){let e;return{c(){e=q("New arm")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Hl(n){let e;return{c(){e=b("b"),e.textContent="New arm"},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Jl(n){let e;return{c(){e=q("New movement")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Rl(n){let e;return{c(){e=b("b"),e.textContent="New movement"},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Kl(n){let e;return{c(){e=b("span"),e.textContent=`${li(n[33])}`,F(e,"class","dot svelte-l1e6xi"),X(e,"color","#4472c4"),X(e,"background-color","white")},m(r,t){h(r,e,t)},p:V,d(r){r&&$(e)}}}function un(n){let e,r,t;function o(a){n[14](a,n[34])}function l(){return n[15](n[33])}function i(){return n[16](n[33])}let s={draggable:!0,$$slots:{default:[Kl]},$$scope:{ctx:n}};return n[34].point!==void 0&&(s.lngLat=n[34].point),e=new Qe({props:s}),ue.push(()=>me(e,"lngLat",o)),e.$on("dragend",l),e.$on("click",i),{c(){B(e.$$.fragment)},m(a,u){L(e,a,u),t=!0},p(a,u){n=a;const c={};u[1]&32&&(c.$$scope={dirty:u,ctx:n}),!r&&u[0]&38&&(r=!0,c.lngLat=n[34].point,pe(()=>r=!1)),e.$set(c)},i(a){t||(_(e.$$.fragment,a),t=!0)},o(a){k(e.$$.fragment,a),t=!1},d(a){M(e,a)}}}function Xl(n){let e;return{c(){e=b("span"),F(e,"class","dot svelte-l1e6xi"),X(e,"background-color",n[7][n[31].score]),X(e,"opacity",n[31].kind=="walking & wheeling"?"0%":"100%")},m(r,t){h(r,e,t)},p(r,t){t[0]&38&&X(e,"background-color",r[7][r[31].score]),t[0]&38&&X(e,"opacity",r[31].kind=="walking & wheeling"?"0%":"100%")},d(r){r&&$(e)}}}function Zl(n){let e;return{c(){e=b("span"),F(e,"class","dot svelte-l1e6xi"),X(e,"background-color",n[7][n[31].score])},m(r,t){h(r,e,t)},p(r,t){t[0]&38&&X(e,"background-color",r[7][r[31].score])},d(r){r&&$(e)}}}function Vl(n){let e;return{c(){e=b("span"),F(e,"class","dot svelte-l1e6xi"),X(e,"background-color",n[7][n[31].score]),X(e,"opacity","0%")},m(r,t){h(r,e,t)},p(r,t){t[0]&38&&X(e,"background-color",r[7][r[31].score])},d(r){r&&$(e)}}}function fn(n){let e,r,t,o,l,i,s,a,u;function c(w){n[17](w,n[31])}function d(){return n[18](n[33])}function f(){return n[19](n[33])}let m={draggable:!0,$$slots:{default:[Xl]},$$scope:{ctx:n}};n[31].point1!==void 0&&(m.lngLat=n[31].point1),e=new Qe({props:m}),ue.push(()=>me(e,"lngLat",c)),e.$on("dragend",d),e.$on("click",f);function p(w){n[20](w,n[31])}function C(){return n[21](n[33])}function N(){return n[22](n[33])}let A={draggable:!0,$$slots:{default:[Zl]},$$scope:{ctx:n}};n[31].point2!==void 0&&(A.lngLat=n[31].point2),o=new Qe({props:A}),ue.push(()=>me(o,"lngLat",p)),o.$on("dragend",C),o.$on("click",N);function v(w){n[23](w,n[31])}function D(){return n[24](n[33])}function y(){return n[25](n[33])}let S={draggable:!0,$$slots:{default:[Vl]},$$scope:{ctx:n}};return n[31].point3!==void 0&&(S.lngLat=n[31].point3),s=new Qe({props:S}),ue.push(()=>me(s,"lngLat",v)),s.$on("dragend",D),s.$on("click",y),{c(){B(e.$$.fragment),t=z(),B(o.$$.fragment),i=z(),B(s.$$.fragment)},m(w,j){L(e,w,j),h(w,t,j),L(o,w,j),h(w,i,j),L(s,w,j),u=!0},p(w,j){n=w;const I={};j[0]&38|j[1]&32&&(I.$$scope={dirty:j,ctx:n}),!r&&j[0]&38&&(r=!0,I.lngLat=n[31].point1,pe(()=>r=!1)),e.$set(I);const O={};j[0]&38|j[1]&32&&(O.$$scope={dirty:j,ctx:n}),!l&&j[0]&38&&(l=!0,O.lngLat=n[31].point2,pe(()=>l=!1)),o.$set(O);const R={};j[0]&38|j[1]&32&&(R.$$scope={dirty:j,ctx:n}),!a&&j[0]&38&&(a=!0,R.lngLat=n[31].point3,pe(()=>a=!1)),s.$set(R)},i(w){u||(_(e.$$.fragment,w),_(o.$$.fragment,w),_(s.$$.fragment,w),u=!0)},o(w){k(e.$$.fragment,w),k(o.$$.fragment,w),k(s.$$.fragment,w),u=!1},d(w){w&&($(t),$(i)),M(e,w),M(o,w),M(s,w)}}}function Yl(n){let e=(n[30].name||"Untitled movement")+"",r;return{c(){r=q(e)},m(t,o){h(t,r,o)},p(t,o){o[0]&1073741824&&e!==(e=(t[30].name||"Untitled movement")+"")&&ne(r,e)},d(t){t&&$(r)}}}function Wl(n){let e,r;return e=new We({props:{$$slots:{default:[Yl,({props:t})=>({30:t}),({props:t})=>[t?1073741824:0]]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o[0]&1073741824|o[1]&32&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function xl(n){let e=(n[30].name||"Untitled movement")+"",r;return{c(){r=q(e)},m(t,o){h(t,r,o)},p(t,o){o[0]&1073741824&&e!==(e=(t[30].name||"Untitled movement")+"")&&ne(r,e)},d(t){t&&$(r)}}}function ei(n){let e,r;return e=new We({props:{$$slots:{default:[xl,({props:t})=>({30:t}),({props:t})=>[t?1073741824:0]]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o[0]&1073741824|o[1]&32&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function ti(n){let e,r,t,o,l,i;return e=new Le({props:{id:"jat-cycling",manageHoverState:!0,paint:{"line-width":Ze(6,10),"line-color":["get","color"]},filter:["==",["get","kind"],"cycling"],$$slots:{default:[Wl]},$$scope:{ctx:n}}}),e.$on("click",n[9]),t=new Le({props:{id:"jat-walking-wheeling",manageHoverState:!0,paint:{"line-width":Ze(6,8),"line-color":["get","color"],"line-dasharray":[3,2]},filter:["==",["get","kind"],"walking & wheeling"],$$slots:{default:[ei]},$$scope:{ctx:n}}}),t.$on("click",n[9]),l=new Pe({props:{id:"jat-arrow",filter:["has","angle"],paint:{"text-color":["get","color"],"text-halo-color":"white","text-halo-width":3},layout:{"text-field":"⬆","text-overlap":"always","text-rotate":["get","angle"],"text-size":70}}}),{c(){B(e.$$.fragment),r=z(),B(t.$$.fragment),o=z(),B(l.$$.fragment)},m(s,a){L(e,s,a),h(s,r,a),L(t,s,a),h(s,o,a),L(l,s,a),i=!0},p(s,a){const u={};a[1]&32&&(u.$$scope={dirty:a,ctx:s}),e.$set(u);const c={};a[1]&32&&(c.$$scope={dirty:a,ctx:s}),t.$set(c)},i(s){i||(_(e.$$.fragment,s),_(t.$$.fragment,s),_(l.$$.fragment,s),i=!0)},o(s){k(e.$$.fragment,s),k(t.$$.fragment,s),k(l.$$.fragment,s),i=!1},d(s){s&&($(r),$(o)),M(e,s),M(t,s),M(l,s)}}}function ni(n){let e,r,t,o;return e=new Le({props:{paint:{"line-width":5,"line-color":"yellow","line-gap-width":45}}}),t=new Fe({props:{filter:["==",["get","kind"],"arm"],paint:{"circle-radius":20,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){B(e.$$.fragment),r=z(),B(t.$$.fragment)},m(l,i){L(e,l,i),h(l,r,i),L(t,l,i),o=!0},p:V,i(l){o||(_(e.$$.fragment,l),_(t.$$.fragment,l),o=!0)},o(l){k(e.$$.fragment,l),k(t.$$.fragment,l),o=!1},d(l){l&&$(r),M(e,l),M(t,l)}}}function ri(n){let e,r,t,o,l,i,s,a,u;e=new ft({}),e.$on("click",n[8]);let c=n[0].mode!="editing"&&cn(n),d=Y(n[5].jats[n[1]].properties[n[2]].arms),f=[];for(let A=0;A<d.length;A+=1)f[A]=un(an(n,d,A));const m=A=>k(f[A],1,1,()=>{f[A]=null});let p=Y(n[5].jats[n[1]].properties[n[2]].movements),C=[];for(let A=0;A<p.length;A+=1)C[A]=fn(sn(n,p,A));const N=A=>k(C[A],1,1,()=>{C[A]=null});return i=new _e({props:{data:n[10](n[5]),$$slots:{default:[ti]},$$scope:{ctx:n}}}),a=new _e({props:{data:n[6],$$slots:{default:[ni]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment),r=z(),c&&c.c(),t=z();for(let A=0;A<f.length;A+=1)f[A].c();o=z();for(let A=0;A<C.length;A+=1)C[A].c();l=z(),B(i.$$.fragment),s=z(),B(a.$$.fragment)},m(A,v){L(e,A,v),h(A,r,v),c&&c.m(A,v),h(A,t,v);for(let D=0;D<f.length;D+=1)f[D]&&f[D].m(A,v);h(A,o,v);for(let D=0;D<C.length;D+=1)C[D]&&C[D].m(A,v);h(A,l,v),L(i,A,v),h(A,s,v),L(a,A,v),u=!0},p(A,v){if(A[0].mode!="editing"?c?c.p(A,v):(c=cn(A),c.c(),c.m(t.parentNode,t)):c&&(c.d(1),c=null),v[0]&46){d=Y(A[5].jats[A[1]].properties[A[2]].arms);let S;for(S=0;S<d.length;S+=1){const w=an(A,d,S);f[S]?(f[S].p(w,v),_(f[S],1)):(f[S]=un(w),f[S].c(),_(f[S],1),f[S].m(o.parentNode,o))}for(se(),S=d.length;S<f.length;S+=1)m(S);ae()}if(v[0]&174){p=Y(A[5].jats[A[1]].properties[A[2]].movements);let S;for(S=0;S<p.length;S+=1){const w=sn(A,p,S);C[S]?(C[S].p(w,v),_(C[S],1)):(C[S]=fn(w),C[S].c(),_(C[S],1),C[S].m(l.parentNode,l))}for(se(),S=p.length;S<C.length;S+=1)N(S);ae()}const D={};v[0]&32&&(D.data=A[10](A[5])),v[1]&32&&(D.$$scope={dirty:v,ctx:A}),i.$set(D);const y={};v[0]&64&&(y.data=A[6]),v[1]&32&&(y.$$scope={dirty:v,ctx:A}),a.$set(y)},i(A){if(!u){_(e.$$.fragment,A);for(let v=0;v<d.length;v+=1)_(f[v]);for(let v=0;v<p.length;v+=1)_(C[v]);_(i.$$.fragment,A),_(a.$$.fragment,A),u=!0}},o(A){k(e.$$.fragment,A),f=f.filter(Boolean);for(let v=0;v<f.length;v+=1)k(f[v]);C=C.filter(Boolean);for(let v=0;v<C.length;v+=1)k(C[v]);k(i.$$.fragment,A),k(a.$$.fragment,A),u=!1},d(A){A&&($(r),$(t),$(o),$(l),$(s)),M(e,A),c&&c.d(A),fe(f,A),fe(C,A),M(i,A),M(a,A)}}}function oi(n,e){return{type:"Feature",id:e,properties:{kind:"arm"},geometry:{type:"Point",coordinates:n.point}}}function li(n){return String.fromCharCode(n+"A".charCodeAt(0))}function ii(n,e,r){let t,o,l;ee(n,G,U=>r(5,o=U)),ee(n,ct,U=>r(26,l=U));let{junctionIdx:i}=e,{stage:s}=e,{mode:a}=e,{hoveringSidebar:u}=e,{select:c}=e,{stopEditing:d}=e,f={0:De.red.background,1:De.amber.background,2:De.green.background,X:De.critical.background};function m(U,W,Be){let de={type:"FeatureCollection",features:[]},P=W.mode=="editing"?W.id:Be;return P!=null&&(P.kind=="arm"?de.features.push(oi(U.jats[i].properties[s].arms[P.idx],P.idx)):de.features.push(A(U.jats[i].properties[s].movements[P.idx],P.idx))),de}async function p(U){if(l){for(let W of l.queryRenderedFeatures(U.detail.point,{layers:["jat-cycling","jat-walking-wheeling"]}))return;if(a.mode!="select"){if(a.mode=="editing"){await d();return}a.mode=="new-arm"?(H(G,o.jats[i].properties[s].arms=[...o.jats[i].properties[s].arms,{point:U.detail.lngLat.toArray(),name:""}],o),await c({kind:"arm",idx:o.jats[i].properties[s].arms.length-1})):(H(G,o.jats[i].properties[s].movements=[...o.jats[i].properties[s].movements,{point1:U.detail.lngLat.toArray(),point2:Ve(U.detail.lngLat.toArray(),.005,0).geometry.coordinates,point3:Ve(U.detail.lngLat.toArray(),.01,0).geometry.coordinates,kind:"cycling",score:"X",name:"",notes:""}],o),await c({kind:"movement",idx:o.jats[i].properties[s].movements.length-1}))}}}async function C(U){await c({kind:"movement",idx:U.detail.features[0].id})}function N(U){let W={type:"FeatureCollection",features:U.jats[i].properties[s].movements.map((Be,de)=>A(Be,de))};for(let Be of U.jats[i].properties[s].movements)if(W.features.push(v(Be,W.features.length)),Be.kind=="walking & wheeling"){let de={...Be,point1:Be.point3,point3:Be.point1};W.features.push(v(de,W.features.length))}return W}function A(U,W){return{type:"Feature",id:W,properties:{name:U.name,kind:U.kind,color:f[U.score]},geometry:{type:"LineString",coordinates:[U.point1,U.point2,U.point3]}}}function v(U,W){return{type:"Feature",id:W,properties:{kind:U.kind,color:f[U.score],angle:Ge(U.point2,U.point3)},geometry:{type:"Point",coordinates:U.point3}}}const D=()=>r(0,a={mode:"new-arm"}),y=()=>r(0,a={mode:"new-movement"});function S(U,W){n.$$.not_equal(W.point,U)&&(W.point=U,G.set(o))}const w=U=>c({kind:"arm",idx:U}),j=U=>c({kind:"arm",idx:U});function I(U,W){n.$$.not_equal(W.point1,U)&&(W.point1=U,G.set(o))}const O=U=>c({kind:"movement",idx:U}),R=U=>c({kind:"movement",idx:U});function J(U,W){n.$$.not_equal(W.point2,U)&&(W.point2=U,G.set(o))}const T=U=>c({kind:"movement",idx:U}),Z=U=>c({kind:"movement",idx:U});function E(U,W){n.$$.not_equal(W.point3,U)&&(W.point3=U,G.set(o))}const ie=U=>c({kind:"movement",idx:U}),ge=U=>c({kind:"movement",idx:U});return n.$$set=U=>{"junctionIdx"in U&&r(1,i=U.junctionIdx),"stage"in U&&r(2,s=U.stage),"mode"in U&&r(0,a=U.mode),"hoveringSidebar"in U&&r(11,u=U.hoveringSidebar),"select"in U&&r(3,c=U.select),"stopEditing"in U&&r(4,d=U.stopEditing)},n.$$.update=()=>{n.$$.dirty[0]&2081&&r(6,t=m(o,a,u))},[a,i,s,c,d,o,t,f,p,C,N,u,D,y,S,w,j,I,O,R,J,T,Z,E,ie,ge]}class si extends oe{constructor(e){super(),le(this,e,ii,ri,re,{junctionIdx:1,stage:2,mode:0,hoveringSidebar:11,select:3,stopEditing:4},null,[-1,-1])}}function dn(n){if(n.movements.length==0)return"No movements added";let e=0,r=0;for(let o of n.movements)e+={0:0,1:1,2:2,X:0}[o.score],r+=2;let t=e/r*100;return`${Math.round(t)}%`}const{window:ai}=Je;function mn(n,e,r){const t=n.slice();t[27]=e[r],t[30]=r;const o=t[14][t[27].score];return t[28]=o,t}function pn(n,e,r){const t=n.slice();return t[31]=e[r],t[30]=r,t}function ci(n){let e,r,t,o,l,i,s,a,u;return{c(){e=b("button"),e.textContent="Done",r=z(),t=b("button"),t.textContent="Delete",o=z(),l=b("label"),i=q(`Arm name
        `),s=b("input"),F(s,"type","text")},m(c,d){h(c,e,d),h(c,r,d),h(c,t,d),h(c,o,d),h(c,l,d),g(l,i),g(l,s),he(s,n[5].jats[n[0]].properties[n[1]].arms[n[2].id.idx].name),a||(u=[Q(e,"click",n[23]),Q(t,"click",n[10]),Q(s,"input",n[24])],a=!0)},p(c,d){d[0]&39&&s.value!==c[5].jats[c[0]].properties[c[1]].arms[c[2].id.idx].name&&he(s,c[5].jats[c[0]].properties[c[1]].arms[c[2].id.idx].name)},i:V,o:V,d(c){c&&($(e),$(r),$(t),$(o),$(l)),a=!1,$e(u)}}}function ui(n){let e,r,t,o,l,i,s,a;return e=new kl({props:{junctionIdx:n[0],stage:n[1],idx:n[2].id.idx}}),{c(){B(e.$$.fragment),r=z(),t=b("button"),t.textContent="Save",o=z(),l=b("button"),l.textContent="Delete"},m(u,c){L(e,u,c),h(u,r,c),h(u,t,c),h(u,o,c),h(u,l,c),i=!0,s||(a=[Q(t,"click",n[9]),Q(l,"click",n[10])],s=!0)},p(u,c){const d={};c[0]&1&&(d.junctionIdx=u[0]),c[0]&2&&(d.stage=u[1]),c[0]&4&&(d.idx=u[2].id.idx),e.$set(d)},i(u){i||(_(e.$$.fragment,u),i=!0)},o(u){k(e.$$.fragment,u),i=!1},d(u){u&&($(r),$(t),$(o),$(l)),M(e,u),s=!1,$e(a)}}}function fi(n){let e,r,t,o,l,i,s,a,u,c,d,f,m,p=n[5].jats[n[0]].properties.name+"",C,N,A=dn(n[5].jats[n[0]].properties[n[1]])+"",v,D,y,S,w,j,I,O,R,J,T,Z=Y(n[5].jats[n[0]].properties[n[1]].arms),E=[];for(let P=0;P<Z.length;P+=1)E[P]=gn(pn(n,Z,P));const ie=P=>k(E[P],1,1,()=>{E[P]=null});let ge=n[5].jats[n[0]].properties[n[7]].arms.length>0&&_n(n),U=Y(n[5].jats[n[0]].properties[n[1]].movements),W=[];for(let P=0;P<U.length;P+=1)W[P]=hn(mn(n,U,P));const Be=P=>k(W[P],1,1,()=>{W[P]=null});let de=n[5].jats[n[0]].properties[n[7]].movements.length>0&&$n(n);return{c(){e=b("button"),e.textContent="Done",r=z(),t=b("h3"),t.textContent="Arms",o=z();for(let P=0;P<E.length;P+=1)E[P].c();l=z(),ge&&ge.c(),i=z(),s=b("h3"),s.textContent="Movements",a=z(),u=b("p"),c=q("Total JAT score for "),d=q(n[1]),f=q(` junction
        `),m=b("i"),C=q(p),N=q(`
        : `),v=q(A),D=z(),y=b("button"),S=q("Generate cycling movements between all arms"),j=z();for(let P=0;P<W.length;P+=1)W[P].c();I=z(),de&&de.c(),O=Te(),F(y,"class","secondary"),y.disabled=w=n[5].jats[n[0]].properties[n[1]].arms.length<2},m(P,x){h(P,e,x),h(P,r,x),h(P,t,x),h(P,o,x);for(let te=0;te<E.length;te+=1)E[te]&&E[te].m(P,x);h(P,l,x),ge&&ge.m(P,x),h(P,i,x),h(P,s,x),h(P,a,x),h(P,u,x),g(u,c),g(u,d),g(u,f),g(u,m),g(m,C),g(u,N),g(u,v),h(P,D,x),h(P,y,x),g(y,S),h(P,j,x);for(let te=0;te<W.length;te+=1)W[te]&&W[te].m(P,x);h(P,I,x),de&&de.m(P,x),h(P,O,x),R=!0,J||(T=[Q(e,"click",n[16]),Q(y,"click",n[15])],J=!0)},p(P,x){if(x[0]&299){Z=Y(P[5].jats[P[0]].properties[P[1]].arms);let te;for(te=0;te<Z.length;te+=1){const Ke=pn(P,Z,te);E[te]?(E[te].p(Ke,x),_(E[te],1)):(E[te]=gn(Ke),E[te].c(),_(E[te],1),E[te].m(l.parentNode,l))}for(se(),te=Z.length;te<E.length;te+=1)ie(te);ae()}if(P[5].jats[P[0]].properties[P[7]].arms.length>0?ge?ge.p(P,x):(ge=_n(P),ge.c(),ge.m(i.parentNode,i)):ge&&(ge.d(1),ge=null),(!R||x[0]&2)&&ne(d,P[1]),(!R||x[0]&33)&&p!==(p=P[5].jats[P[0]].properties.name+"")&&ne(C,p),(!R||x[0]&35)&&A!==(A=dn(P[5].jats[P[0]].properties[P[1]])+"")&&ne(v,A),(!R||x[0]&35&&w!==(w=P[5].jats[P[0]].properties[P[1]].arms.length<2))&&(y.disabled=w),x[0]&16683){U=Y(P[5].jats[P[0]].properties[P[1]].movements);let te;for(te=0;te<U.length;te+=1){const Ke=mn(P,U,te);W[te]?(W[te].p(Ke,x),_(W[te],1)):(W[te]=hn(Ke),W[te].c(),_(W[te],1),W[te].m(I.parentNode,I))}for(se(),te=U.length;te<W.length;te+=1)Be(te);ae()}P[5].jats[P[0]].properties[P[7]].movements.length>0?de?de.p(P,x):(de=$n(P),de.c(),de.m(O.parentNode,O)):de&&(de.d(1),de=null)},i(P){if(!R){for(let x=0;x<Z.length;x+=1)_(E[x]);for(let x=0;x<U.length;x+=1)_(W[x]);R=!0}},o(P){E=E.filter(Boolean);for(let x=0;x<E.length;x+=1)k(E[x]);W=W.filter(Boolean);for(let x=0;x<W.length;x+=1)k(W[x]);R=!1},d(P){P&&($(e),$(r),$(t),$(o),$(l),$(i),$(s),$(a),$(u),$(D),$(y),$(j),$(I),$(O)),fe(E,P),ge&&ge.d(P),fe(W,P),de&&de.d(P),J=!1,$e(T)}}}function gn(n){let e,r;function t(){return n[17](n[30])}function o(){return n[18](n[30])}return e=new rr({props:{name:`${kn(n[30])} - ${n[31].name||"Unnamed arm"}`,hasSlot:!1}}),e.$on("click",t),e.$on("mouseenter",o),e.$on("mouseleave",n[19]),{c(){B(e.$$.fragment)},m(l,i){L(e,l,i),r=!0},p(l,i){n=l;const s={};i[0]&35&&(s.name=`${kn(n[30])} - ${n[31].name||"Unnamed arm"}`),e.$set(s)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){k(e.$$.fragment,l),r=!1},d(l){M(e,l)}}}function _n(n){let e,r,t;return{c(){e=b("button"),e.textContent=`Copy arms from ${n[7]}`,F(e,"class","secondary")},m(o,l){h(o,e,l),r||(t=Q(e,"click",n[12]),r=!0)},p:V,d(o){o&&$(e),r=!1,t()}}}function di(n){let e,r,t,o=n[27].score+"",l,i,s,a=bn(n[27].kind)+"",u;return{c(){e=b("div"),r=b("span"),t=q("Score: "),l=q(o),i=z(),s=b("span"),u=q(a),X(r,"padding","4px"),X(r,"color",n[28].font),X(r,"background-color",n[28].background),X(e,"width","100%"),X(e,"display","flex"),X(e,"justify-content","space-between")},m(c,d){h(c,e,d),g(e,r),g(r,t),g(r,l),g(e,i),g(e,s),g(s,u)},p(c,d){d[0]&35&&o!==(o=c[27].score+"")&&ne(l,o),d[0]&35&&X(r,"color",c[28].font),d[0]&35&&X(r,"background-color",c[28].background),d[0]&35&&a!==(a=bn(c[27].kind)+"")&&ne(u,a)},d(c){c&&$(e)}}}function hn(n){let e,r;function t(){return n[20](n[30])}function o(){return n[21](n[30])}return e=new rr({props:{name:n[27].name||"Unnamed movement",$$slots:{default:[di]},$$scope:{ctx:n}}}),e.$on("click",t),e.$on("mouseenter",o),e.$on("mouseleave",n[22]),{c(){B(e.$$.fragment)},m(l,i){L(e,l,i),r=!0},p(l,i){n=l;const s={};i[0]&35&&(s.name=n[27].name||"Unnamed movement"),i[0]&35|i[1]&4&&(s.$$scope={dirty:i,ctx:n}),e.$set(s)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){k(e.$$.fragment,l),r=!1},d(l){M(e,l)}}}function $n(n){let e,r,t;return{c(){e=b("button"),e.textContent=`Copy movements from ${n[7]}`,F(e,"class","secondary")},m(o,l){h(o,e,l),r||(t=Q(e,"click",n[13]),r=!0)},p:V,d(o){o&&$(e),r=!1,t()}}}function mi(n){let e,r,t,o,l=n[5].jats[n[0]].properties.name+"",i,s,a,u,c;const d=[fi,ui,ci],f=[];function m(p,C){return p[2].mode!="editing"?0:p[2].id.kind=="movement"?1:2}return a=m(n),u=f[a]=d[a](n),{c(){e=b("div"),r=b("h2"),t=q(n[1]),o=q(" JAT for "),i=q(l),s=z(),u.c(),F(e,"slot","sidebar")},m(p,C){h(p,e,C),g(e,r),g(r,t),g(r,o),g(r,i),g(e,s),f[a].m(e,null),n[25](e),c=!0},p(p,C){(!c||C[0]&2)&&ne(t,p[1]),(!c||C[0]&33)&&l!==(l=p[5].jats[p[0]].properties.name+"")&&ne(i,l);let N=a;a=m(p),a===N?f[a].p(p,C):(se(),k(f[N],1,1,()=>{f[N]=null}),ae(),u=f[a],u?u.p(p,C):(u=f[a]=d[a](p),u.c()),_(u,1),u.m(e,null))},i(p){c||(_(u),c=!0)},o(p){k(u),c=!1},d(p){p&&$(e),f[a].d(),n[25](null)}}}function pi(n){let e,r;return e=new Fe({props:{filter:["!=",["id"],n[0]],paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":"black","circle-radius":20}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o[0]&1&&(l.filter=["!=",["id"],t[0]]),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function gi(n){let e,r,t,o,l,i,s;return r=new Ne({props:{except:"jats"}}),o=new _e({props:{data:ce(n[5].jats),generateId:!0,$$slots:{default:[pi]},$$scope:{ctx:n}}}),i=new si({props:{junctionIdx:n[0],stage:n[1],mode:n[2],hoveringSidebar:n[3],select:n[8],stopEditing:n[9]}}),{c(){e=b("div"),B(r.$$.fragment),t=z(),B(o.$$.fragment),l=z(),B(i.$$.fragment),F(e,"slot","map")},m(a,u){h(a,e,u),L(r,e,null),g(e,t),L(o,e,null),g(e,l),L(i,e,null),s=!0},p(a,u){const c={};u[0]&32&&(c.data=ce(a[5].jats)),u[0]&1|u[1]&4&&(c.$$scope={dirty:u,ctx:a}),o.$set(c);const d={};u[0]&1&&(d.junctionIdx=a[0]),u[0]&2&&(d.stage=a[1]),u[0]&4&&(d.mode=a[2]),u[0]&8&&(d.hoveringSidebar=a[3]),i.$set(d)},i(a){s||(_(r.$$.fragment,a),_(o.$$.fragment,a),_(i.$$.fragment,a),s=!0)},o(a){k(r.$$.fragment,a),k(o.$$.fragment,a),k(i.$$.fragment,a),s=!1},d(a){a&&$(e),M(r),M(o),M(i)}}}function _i(n){let e,r,t,o;return e=new Ee({props:{$$slots:{map:[gi],sidebar:[mi]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(l,i){L(e,l,i),r=!0,t||(o=Q(ai,"keydown",n[11]),t=!0)},p(l,i){const s={};i[0]&127|i[1]&4&&(s.$$scope={dirty:i,ctx:l}),e.$set(s)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){k(e.$$.fragment,l),r=!1},d(l){M(e,l),t=!1,o()}}}function kn(n){return String.fromCharCode(n+"A".charCodeAt(0))}function bn(n){return n.split(" ").map(e=>e.length>0?e[0].toUpperCase()+e.substr(1):e).join(" ")}function hi(n,e,r){let t,o;ee(n,G,E=>r(5,t=E)),ee(n,K,E=>r(6,o=E));let{junctionIdx:l}=e,{stage:i}=e,s=i=="existing"?"proposed":"existing",a={mode:"select"},u=null,c=null,d;async function f(E){u=d.scrollTop,r(2,a={mode:"editing",id:E}),r(3,c=null),await qe(),r(4,d.scrollTop=0,d)}async function m(){r(2,a={mode:"select"}),u!=null&&(await qe(),r(4,d.scrollTop=u,d),u=null)}function p(){a.mode=="editing"&&window.confirm(`Delete this ${a.id.kind}?`)&&(a.id.kind=="movement"?(t.jats[l].properties[i].movements.splice(a.id.idx,1),G.set(t)):(t.jats[l].properties[i].arms.splice(a.id.idx,1),G.set(t)),m())}function C(E){if(a.mode!="editing")return;let ie=E.target.tagName,ge=ie=="INPUT"||ie=="TEXTAREA";E.key=="Escape"||E.key=="Enter"&&!ge?(E.stopPropagation(),m()):E.key=="Delete"&&!ge&&(E.stopPropagation(),p())}function N(){t.jats[l].properties[i].arms.length>0&&!window.confirm("Overwrite arms?")||(H(G,t.jats[l].properties[i].arms=JSON.parse(JSON.stringify(t.jats[l].properties[s].arms)),t),G.set(t))}function A(){t.jats[l].properties[i].movements.length>0&&!window.confirm("Overwrite movements?")||(H(G,t.jats[l].properties[i].movements=JSON.parse(JSON.stringify(t.jats[l].properties[s].movements)),t),G.set(t))}let v={0:De.red,1:De.amber,2:De.green,X:De.critical};function D(){if(t.jats[l].properties[i].movements.length>0&&!window.confirm("Overwrite all cycling movements?"))return;let E=t.jats[l].properties[i].movements.filter(ie=>ie.kind=="walking & wheeling");H(G,t.jats[l].properties[i].movements=[...E,...Nl(t.jats[l].properties[i].arms)],t)}const y=()=>H(K,o={kind:"edit-jat",idx:l},o),S=E=>f({kind:"arm",idx:E}),w=E=>r(3,c={kind:"arm",idx:E}),j=()=>r(3,c=null),I=E=>f({kind:"movement",idx:E}),O=E=>r(3,c={kind:"movement",idx:E}),R=()=>r(3,c=null),J=()=>r(2,a={mode:"select"});function T(){t.jats[l].properties[i].arms[a.id.idx].name=this.value,G.set(t)}function Z(E){ue[E?"unshift":"push"](()=>{d=E,r(4,d)})}return n.$$set=E=>{"junctionIdx"in E&&r(0,l=E.junctionIdx),"stage"in E&&r(1,i=E.stage)},[l,i,a,c,d,t,o,s,f,m,p,C,N,A,v,D,y,S,w,j,I,O,R,J,T,Z]}class $i extends oe{constructor(e){super(),le(this,e,hi,_i,re,{junctionIdx:0,stage:1},null,[-1,-1])}}const{window:ki}=Je;function bi(n){let e,r,t,o,l,i,s,a,u,c,d,f,m,p;return{c(){e=b("div"),r=b("button"),r.textContent="Done",t=z(),o=b("button"),o.textContent="Delete JAT",l=z(),i=b("label"),s=q(`Name:
      `),a=b("input"),u=z(),c=b("button"),c.textContent="Existing",d=z(),f=b("button"),f.textContent="Proposed",F(a,"type","text"),F(e,"slot","sidebar")},m(C,N){h(C,e,N),g(e,r),g(e,t),g(e,o),g(e,l),g(e,i),g(i,s),g(i,a),he(a,n[1].jats[n[0]].properties.name),g(e,u),g(e,c),g(e,d),g(e,f),m||(p=[Q(r,"click",n[6]),Q(o,"click",n[4]),Q(a,"input",n[7]),Q(c,"click",n[8]),Q(f,"click",n[9])],m=!0)},p(C,N){N&3&&a.value!==C[1].jats[C[0]].properties.name&&he(a,C[1].jats[C[0]].properties.name)},d(C){C&&$(e),m=!1,$e(p)}}}function wi(n){let e,r;return e=new Fe({props:{filter:["!=",["id"],n[0]],paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":"black","circle-radius":20}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&1&&(l.filter=["!=",["id"],t[0]]),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function vi(n){let e,r,t,o,l,i,s,a;r=new Ne({props:{except:"jats"}}),o=new _e({props:{data:ce(n[1].jats),generateId:!0,$$slots:{default:[wi]},$$scope:{ctx:n}}});function u(d){n[5](d)}let c={radius:"50px",outline:!0,color:n[1].jats[n[0]].properties.color};return n[1].jats[n[0]].geometry.coordinates!==void 0&&(c.lngLat=n[1].jats[n[0]].geometry.coordinates),i=new dt({props:c}),ue.push(()=>me(i,"lngLat",u)),{c(){e=b("div"),B(r.$$.fragment),t=z(),B(o.$$.fragment),l=z(),B(i.$$.fragment),F(e,"slot","map")},m(d,f){h(d,e,f),L(r,e,null),g(e,t),L(o,e,null),g(e,l),L(i,e,null),a=!0},p(d,f){const m={};f&2&&(m.data=ce(d[1].jats)),f&1025&&(m.$$scope={dirty:f,ctx:d}),o.$set(m);const p={};f&3&&(p.color=d[1].jats[d[0]].properties.color),!s&&f&3&&(s=!0,p.lngLat=d[1].jats[d[0]].geometry.coordinates,pe(()=>s=!1)),i.$set(p)},i(d){a||(_(r.$$.fragment,d),_(o.$$.fragment,d),_(i.$$.fragment,d),a=!0)},o(d){k(r.$$.fragment,d),k(o.$$.fragment,d),k(i.$$.fragment,d),a=!1},d(d){d&&$(e),M(r),M(o),M(i)}}}function yi(n){let e,r,t,o;return e=new Ee({props:{$$slots:{map:[vi],sidebar:[bi]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(l,i){L(e,l,i),r=!0,t||(o=Q(ki,"keydown",n[3]),t=!0)},p(l,[i]){const s={};i&1031&&(s.$$scope={dirty:i,ctx:l}),e.$set(s)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){k(e.$$.fragment,l),r=!1},d(l){M(e,l),t=!1,o()}}}function Ai(n,e,r){let t,o;ee(n,G,m=>r(1,t=m)),ee(n,K,m=>r(2,o=m));let{idx:l}=e;function i(m){m.key=="Escape"&&H(K,o={kind:"neutral"},o)}async function s(){window.confirm("Really delete this JAT?")&&(H(K,o={kind:"neutral"},o),await qe(),t.jats.splice(l,1),G.set(t))}function a(m){n.$$.not_equal(t.jats[l].geometry.coordinates,m)&&(t.jats[l].geometry.coordinates=m,G.set(t))}const u=()=>H(K,o={kind:"neutral"},o);function c(){t.jats[l].properties.name=this.value,G.set(t)}const d=()=>H(K,o={kind:"edit-jat-detail",idx:l,stage:"existing"},o),f=()=>H(K,o={kind:"edit-jat-detail",idx:l,stage:"proposed"},o);return n.$$set=m=>{"idx"in m&&r(0,l=m.idx)},[l,t,o,i,s,a,u,c,d,f]}class Ci extends oe{constructor(e){super(),le(this,e,Ai,yi,re,{idx:0})}}function wn(n,e,r){const t=n.slice();return t[3]=e[r],t[4]=e,t[5]=r,t}function ji(n){let e,r;return{c(){e=b("span"),r=z(),F(e,"class","dot svelte-jgyhla")},m(t,o){h(t,e,o),h(t,r,o)},p:V,d(t){t&&($(e),$(r))}}}function vn(n){let e,r,t;function o(i){n[2](i,n[3],n[4],n[5])}let l={draggable:!0,$$slots:{default:[ji]},$$scope:{ctx:n}};return n[3]!==void 0&&(l.lngLat=n[3]),e=new Qe({props:l}),ue.push(()=>me(e,"lngLat",o)),{c(){B(e.$$.fragment)},m(i,s){L(e,i,s),t=!0},p(i,s){n=i;const a={};s&64&&(a.$$scope={dirty:s,ctx:n}),!r&&s&1&&(r=!0,a.lngLat=n[3],pe(()=>r=!1)),e.$set(a)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){k(e.$$.fragment,i),t=!1},d(i){M(e,i)}}}function zi(n){let e,r,t,o;e=new ft({}),e.$on("click",n[1]);let l=Y(n[0].geometry.coordinates),i=[];for(let a=0;a<l.length;a+=1)i[a]=vn(wn(n,l,a));const s=a=>k(i[a],1,1,()=>{i[a]=null});return{c(){B(e.$$.fragment),r=z();for(let a=0;a<i.length;a+=1)i[a].c();t=Te()},m(a,u){L(e,a,u),h(a,r,u);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(a,u);h(a,t,u),o=!0},p(a,[u]){if(u&1){l=Y(a[0].geometry.coordinates);let c;for(c=0;c<l.length;c+=1){const d=wn(a,l,c);i[c]?(i[c].p(d,u),_(i[c],1)):(i[c]=vn(d),i[c].c(),_(i[c],1),i[c].m(t.parentNode,t))}for(se(),c=l.length;c<i.length;c+=1)s(c);ae()}},i(a){if(!o){_(e.$$.fragment,a);for(let u=0;u<l.length;u+=1)_(i[u]);o=!0}},o(a){k(e.$$.fragment,a),i=i.filter(Boolean);for(let u=0;u<i.length;u+=1)k(i[u]);o=!1},d(a){a&&($(r),$(t)),M(e,a),fe(i,a)}}}function Si(n,e,r){let{f:t}=e;function o(i){t.geometry.coordinates.push(i.detail.lngLat.toArray()),r(0,t)}function l(i,s,a,u){a[u]=i,r(0,t)}return n.$$set=i=>{"f"in i&&r(0,t=i.f)},[t,o,l]}class ir extends oe{constructor(e){super(),le(this,e,Si,zi,re,{f:0})}}function Bi(n){return{type:"Feature",geometry:{type:"LineString",coordinates:[]},properties:{name:"Untitled link",color:Me[n%Me.length],answers:Array(we.length).fill("")}}}let we=[{name:"Street or path check",description:"Is this on-carriageway or a traffic-free path?",choices:["","Street check","Path check"]},{name:"SA03",description:"lane widths",choices:be()},{name:"SA04",description:"trip hazards",choices:be()},{name:"SA05",description:"kerbside activity",choices:be()},{name:"SA08",description:"motor traffic speed",choices:be()},{name:"SA09",description:"motor traffic volume",choices:be()},{name:"SA11",description:"footway widths",choices:be()},{name:"SA12",description:"effective width next to tram lines",choices:be()},{name:"SA13",description:"crossing angle of tram/train rails",choices:be()},{name:"SA14",description:"cycling surface and maintenance defects",choices:be()},{name:"SA15",description:"WW surface and maintenance defects",choices:be()},{name:"SA16",description:"guard railing",choices:be()}];const{window:Li}=Je;function yn(n,e,r){const t=n.slice();return t[13]=e[r],t[14]=e,t[15]=r,t}function An(n){let e;return{c(){e=b("p"),e.textContent="A link needs at least two points"},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Mi(n){let e,r,t;function o(){return n[10](n[13])}return{c(){e=b("button"),e.textContent="?",F(e,"class","outline")},m(l,i){h(l,e,i),r||(t=Q(e,"click",o),r=!0)},p(l,i){n=l},d(l){l&&$(e),r=!1,t()}}}function Ti(n){let e=n[13].name+"",r,t,o=n[13].description+"",l,i,s,a=He[n[13].name]&&Mi(n);return{c(){r=q(e),t=q(": "),l=q(o),i=z(),a&&a.c(),s=z()},m(u,c){h(u,r,c),h(u,t,c),h(u,l,c),h(u,i,c),a&&a.m(u,c),h(u,s,c)},p(u,c){He[u[13].name]&&a.p(u,c)},d(u){u&&($(r),$(t),$(l),$(i),$(s)),a&&a.d(u)}}}function Cn(n){let e,r,t;function o(i){n[11](i,n[15])}let l={k:"horiz-radio",choices:n[13].choices,$$slots:{default:[Ti]},$$scope:{ctx:n}};return n[1].links[n[0]].properties.answers[n[15]]!==void 0&&(l.value=n[1].links[n[0]].properties.answers[n[15]]),e=new Ie({props:l}),ue.push(()=>me(e,"value",o)),{c(){B(e.$$.fragment)},m(i,s){L(e,i,s),t=!0},p(i,s){n=i;const a={};s&65540&&(a.$$scope={dirty:s,ctx:n}),!r&&s&3&&(r=!0,a.value=n[1].links[n[0]].properties.answers[n[15]],pe(()=>r=!1)),e.$set(a)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){k(e.$$.fragment,i),t=!1},d(i){M(e,i)}}}function Ii(n){let e,r,t,o,l,i,s,a,u,c,d,f,m,p,C,N=!n[3]&&An(),A=Y(we),v=[];for(let y=0;y<A.length;y+=1)v[y]=Cn(yn(n,A,y));const D=y=>k(v[y],1,1,()=>{v[y]=null});return{c(){e=b("div"),r=b("button"),t=q("Done"),l=z(),i=b("button"),i.textContent="Delete link",s=z(),N&&N.c(),a=z(),u=b("label"),c=q(`Name:
      `),d=b("input"),f=z();for(let y=0;y<v.length;y+=1)v[y].c();r.disabled=o=!n[3],F(d,"type","text"),F(e,"slot","sidebar")},m(y,S){h(y,e,S),g(e,r),g(r,t),g(e,l),g(e,i),g(e,s),N&&N.m(e,null),g(e,a),g(e,u),g(u,c),g(u,d),he(d,n[1].links[n[0]].properties.name),g(e,f);for(let w=0;w<v.length;w+=1)v[w]&&v[w].m(e,null);m=!0,p||(C=[Q(r,"click",n[8]),Q(i,"click",n[6]),Q(d,"input",n[9])],p=!0)},p(y,S){if((!m||S&8&&o!==(o=!y[3]))&&(r.disabled=o),y[3]?N&&(N.d(1),N=null):N||(N=An(),N.c(),N.m(e,a)),S&3&&d.value!==y[1].links[y[0]].properties.name&&he(d,y[1].links[y[0]].properties.name),S&7){A=Y(we);let w;for(w=0;w<A.length;w+=1){const j=yn(y,A,w);v[w]?(v[w].p(j,S),_(v[w],1)):(v[w]=Cn(j),v[w].c(),_(v[w],1),v[w].m(e,null))}for(se(),w=A.length;w<v.length;w+=1)D(w);ae()}},i(y){if(!m){for(let S=0;S<A.length;S+=1)_(v[S]);m=!0}},o(y){v=v.filter(Boolean);for(let S=0;S<v.length;S+=1)k(v[S]);m=!1},d(y){y&&$(e),N&&N.d(),fe(v,y),p=!1,$e(C)}}}function Ei(n){let e,r;return e=new Le({props:{paint:{"line-color":["case",["==",["id"],n[0]],["get","color"],"black"],"line-width":6}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&1&&(l.paint={"line-color":["case",["==",["id"],t[0]],["get","color"],"black"],"line-width":6}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function Di(n){let e,r,t,o,l,i,s,a;r=new Ne({props:{except:"links"}}),o=new _e({props:{data:ce(n[1].links),generateId:!0,$$slots:{default:[Ei]},$$scope:{ctx:n}}});function u(d){n[7](d)}let c={};return n[1].links[n[0]]!==void 0&&(c.f=n[1].links[n[0]]),i=new ir({props:c}),ue.push(()=>me(i,"f",u)),{c(){e=b("div"),B(r.$$.fragment),t=z(),B(o.$$.fragment),l=z(),B(i.$$.fragment),F(e,"slot","map")},m(d,f){h(d,e,f),L(r,e,null),g(e,t),L(o,e,null),g(e,l),L(i,e,null),a=!0},p(d,f){const m={};f&2&&(m.data=ce(d[1].links)),f&65537&&(m.$$scope={dirty:f,ctx:d}),o.$set(m);const p={};!s&&f&3&&(s=!0,p.f=d[1].links[d[0]],pe(()=>s=!1)),i.$set(p)},i(d){a||(_(r.$$.fragment,d),_(o.$$.fragment,d),_(i.$$.fragment,d),a=!0)},o(d){k(r.$$.fragment,d),k(o.$$.fragment,d),k(i.$$.fragment,d),a=!1},d(d){d&&$(e),M(r),M(o),M(i)}}}function jn(n){let e,r;return e=new rt({props:{$$slots:{default:[Ni]},$$scope:{ctx:n}}}),e.$on("close",n[12]),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&65540&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function Ni(n){let e,r=n[2].description+"",t,o,l,i;return l=new ot({props:{metric:n[2]}}),{c(){e=b("p"),t=q(r),o=z(),B(l.$$.fragment)},m(s,a){h(s,e,a),g(e,t),h(s,o,a),L(l,s,a),i=!0},p(s,a){(!i||a&4)&&r!==(r=s[2].description+"")&&ne(t,r);const u={};a&4&&(u.metric=s[2]),l.$set(u)},i(s){i||(_(l.$$.fragment,s),i=!0)},o(s){k(l.$$.fragment,s),i=!1},d(s){s&&($(e),$(o)),M(l,s)}}}function Oi(n){let e,r,t,o,l,i;e=new Ee({props:{$$slots:{map:[Di],sidebar:[Ii]},$$scope:{ctx:n}}});let s=n[2]&&jn(n);return{c(){B(e.$$.fragment),r=z(),s&&s.c(),t=Te()},m(a,u){L(e,a,u),h(a,r,u),s&&s.m(a,u),h(a,t,u),o=!0,l||(i=Q(Li,"keydown",n[5]),l=!0)},p(a,[u]){const c={};u&65567&&(c.$$scope={dirty:u,ctx:a}),e.$set(c),a[2]?s?(s.p(a,u),u&4&&_(s,1)):(s=jn(a),s.c(),_(s,1),s.m(t.parentNode,t)):s&&(se(),k(s,1,1,()=>{s=null}),ae())},i(a){o||(_(e.$$.fragment,a),_(s),o=!0)},o(a){k(e.$$.fragment,a),k(s),o=!1},d(a){a&&($(r),$(t)),M(e,a),s&&s.d(a),l=!1,i()}}}function qi(n,e,r){let t,o,l;ee(n,G,N=>r(1,o=N)),ee(n,K,N=>r(4,l=N));let{idx:i}=e,s=null;function a(N){N.key=="Escape"&&t&&H(K,l={kind:"neutral"},l)}async function u(){window.confirm("Really delete this link?")&&(H(K,l={kind:"neutral"},l),await qe(),o.links.splice(i,1),G.set(o))}function c(N){n.$$.not_equal(o.links[i],N)&&(o.links[i]=N,G.set(o))}const d=()=>H(K,l={kind:"neutral"},l);function f(){o.links[i].properties.name=this.value,G.set(o)}const m=N=>r(2,s=He[N.name]);function p(N,A){n.$$.not_equal(o.links[i].properties.answers[A],N)&&(o.links[i].properties.answers[A]=N,G.set(o))}const C=()=>r(2,s=null);return n.$$set=N=>{"idx"in N&&r(0,i=N.idx)},n.$$.update=()=>{n.$$.dirty&3&&r(3,t=o.links[i].geometry.coordinates.length>=2)},[i,o,s,t,l,a,u,c,d,f,m,p,C]}class Fi extends oe{constructor(e){super(),le(this,e,qi,Oi,re,{idx:0})}}function zn(n,e,r){const t=n.slice();return t[7]=e[r],t[8]=e,t[9]=r,t}function Pi(n){let e;return{c(){e=b("p"),e.textContent=`${n[3].description}`},m(r,t){h(r,e,t)},p:V,d(r){r&&$(e)}}}function Sn(n){let e,r,t=n[7].properties.name+"",o,l,i,s,a,u;function c(f){n[6](f,n[7])}let d={k:"horiz-radio",choices:we[n[0]].choices};return n[7].properties.answers[n[0]]!==void 0&&(d.value=n[7].properties.answers[n[0]]),i=new Ie({props:d}),ue.push(()=>me(i,"value",c)),{c(){e=b("li"),r=b("span"),o=q(t),l=z(),B(i.$$.fragment),a=z(),X(r,"color",n[7].properties.color)},m(f,m){h(f,e,m),g(e,r),g(r,o),g(e,l),L(i,e,null),g(e,a),u=!0},p(f,m){n=f,(!u||m&4)&&t!==(t=n[7].properties.name+"")&&ne(o,t),m&4&&X(r,"color",n[7].properties.color);const p={};m&1&&(p.choices=we[n[0]].choices),!s&&m&5&&(s=!0,p.value=n[7].properties.answers[n[0]],pe(()=>s=!1)),i.$set(p)},i(f){u||(_(i.$$.fragment,f),u=!0)},o(f){k(i.$$.fragment,f),u=!1},d(f){f&&$(e),M(i)}}}function Ui(n){let e,r;return e=new ot({props:{metric:n[3]}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function Gi(n){let e,r,t,o,l=we[n[0]].name+"",i,s,a=we[n[0]].description+"",u,c,d,f,m,p,C,N,A=n[3]&&Pi(n),v=Y(n[2].links),D=[];for(let w=0;w<v.length;w+=1)D[w]=Sn(zn(n,v,w));const y=w=>k(D[w],1,1,()=>{D[w]=null});let S=n[3]&&Ui(n);return{c(){e=b("div"),r=b("button"),r.textContent="Done",t=z(),o=b("h2"),i=q(l),s=q(": "),u=q(a),c=z(),A&&A.c(),d=z(),f=b("ol");for(let w=0;w<D.length;w+=1)D[w].c();m=z(),S&&S.c(),F(e,"slot","sidebar")},m(w,j){h(w,e,j),g(e,r),g(e,t),g(e,o),g(o,i),g(o,s),g(o,u),g(e,c),A&&A.m(e,null),g(e,d),g(e,f);for(let I=0;I<D.length;I+=1)D[I]&&D[I].m(f,null);g(e,m),S&&S.m(e,null),p=!0,C||(N=Q(r,"click",n[5]),C=!0)},p(w,j){if((!p||j&1)&&l!==(l=we[w[0]].name+"")&&ne(i,l),(!p||j&1)&&a!==(a=we[w[0]].description+"")&&ne(u,a),w[3]&&A.p(w,j),j&5){v=Y(w[2].links);let I;for(I=0;I<v.length;I+=1){const O=zn(w,v,I);D[I]?(D[I].p(O,j),_(D[I],1)):(D[I]=Sn(O),D[I].c(),_(D[I],1),D[I].m(f,null))}for(se(),I=v.length;I<D.length;I+=1)y(I);ae()}w[3]&&S.p(w,j)},i(w){if(!p){for(let j=0;j<v.length;j+=1)_(D[j]);_(S),p=!0}},o(w){D=D.filter(Boolean);for(let j=0;j<D.length;j+=1)k(D[j]);k(S),p=!1},d(w){w&&$(e),A&&A.d(),fe(D,w),S&&S.d(),C=!1,N()}}}function Qi(n){let e,r,t;return r=new Ne({props:{showLinkColor:!0,except:""}}),{c(){e=b("div"),B(r.$$.fragment),F(e,"slot","map")},m(o,l){h(o,e,l),L(r,e,null),t=!0},p:V,i(o){t||(_(r.$$.fragment,o),t=!0)},o(o){k(r.$$.fragment,o),t=!1},d(o){o&&$(e),M(r)}}}function Hi(n){let e,r,t,o;return e=new Ee({props:{$$slots:{map:[Qi],sidebar:[Gi]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(l,i){L(e,l,i),r=!0,t||(o=Q(window,"keydown",n[4]),t=!0)},p(l,[i]){const s={};i&1031&&(s.$$scope={dirty:i,ctx:l}),e.$set(s)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){k(e.$$.fragment,l),r=!1},d(l){M(e,l),t=!1,o()}}}function Ji(n,e,r){let t,o;ee(n,K,c=>r(1,t=c)),ee(n,G,c=>r(2,o=c));let{qIdx:l}=e,i=He[we[l].name];function s(c){c.key=="Escape"&&H(K,t={kind:"neutral"},t)}const a=()=>H(K,t={kind:"neutral"},t);function u(c,d){n.$$.not_equal(d.properties.answers[l],c)&&(d.properties.answers[l]=c,G.set(o))}return n.$$set=c=>{"qIdx"in c&&r(0,l=c.qIdx)},[l,t,o,i,s,a,u]}class Ri extends oe{constructor(e){super(),le(this,e,Ji,Hi,re,{qIdx:0})}}function Ki(n){let e,r,t,o;const l=n[2].default,i=Ce(l,n,n[1],null);return{c(){e=b("a"),i&&i.c(),F(e,"href","#"),X(e,"color",n[0])},m(s,a){h(s,e,a),i&&i.m(e,null),r=!0,t||(o=Q(e,"click",Cr(n[3])),t=!0)},p(s,[a]){i&&i.p&&(!r||a&2)&&je(i,l,s,s[1],r?Se(l,s[1],a,null):ze(s[1]),null),a&1&&X(e,"color",s[0])},i(s){r||(_(i,s),r=!0)},o(s){k(i,s),r=!1},d(s){s&&$(e),i&&i.d(s),t=!1,o()}}}function Xi(n,e,r){let{$$slots:t={},$$scope:o}=e,{color:l=void 0}=e;function i(s){ke.call(this,n,s)}return n.$$set=s=>{"color"in s&&r(0,l=s.color),"$$scope"in s&&r(1,o=s.$$scope)},[l,o,t,i]}class Re extends oe{constructor(e){super(),le(this,e,Xi,Ki,re,{color:0})}}function Bn(n,e,r){const t=n.slice();return t[4]=e[r],t[6]=r,t}function Zi(n){let e=n[4].properties.name+"",r;return{c(){r=q(e)},m(t,o){h(t,r,o)},p(t,o){o&2&&e!==(e=t[4].properties.name+"")&&ne(r,e)},d(t){t&&$(r)}}}function Ln(n){let e,r,t,o;function l(){return n[3](n[6])}return r=new Re({props:{color:n[4].properties.color,$$slots:{default:[Zi]},$$scope:{ctx:n}}}),r.$on("click",l),{c(){e=b("li"),B(r.$$.fragment),t=z()},m(i,s){h(i,e,s),L(r,e,null),g(e,t),o=!0},p(i,s){n=i;const a={};s&2&&(a.color=n[4].properties.color),s&130&&(a.$$scope={dirty:s,ctx:n}),r.$set(a)},i(i){o||(_(r.$$.fragment,i),o=!0)},o(i){k(r.$$.fragment,i),o=!1},d(i){i&&$(e),M(r)}}}function Vi(n){let e,r,t,o,l,i,s,a,u=Y(n[1].bus_stops),c=[];for(let f=0;f<u.length;f+=1)c[f]=Ln(Bn(n,u,f));const d=f=>k(c[f],1,1,()=>{c[f]=null});return{c(){e=q(`Bus stops:

`),r=b("div"),t=b("button"),t.textContent="New bus stop",o=z(),l=b("ol");for(let f=0;f<c.length;f+=1)c[f].c()},m(f,m){h(f,e,m),h(f,r,m),g(r,t),h(f,o,m),h(f,l,m);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(l,null);i=!0,s||(a=Q(t,"click",n[2]),s=!0)},p(f,[m]){if(m&3){u=Y(f[1].bus_stops);let p;for(p=0;p<u.length;p+=1){const C=Bn(f,u,p);c[p]?(c[p].p(C,m),_(c[p],1)):(c[p]=Ln(C),c[p].c(),_(c[p],1),c[p].m(l,null))}for(se(),p=u.length;p<c.length;p+=1)d(p);ae()}},i(f){if(!i){for(let m=0;m<u.length;m+=1)_(c[m]);i=!0}},o(f){c=c.filter(Boolean);for(let m=0;m<c.length;m+=1)k(c[m]);i=!1},d(f){f&&($(e),$(r),$(o),$(l)),fe(c,f),s=!1,a()}}}function Yi(n,e,r){let t,o;return ee(n,K,s=>r(0,t=s)),ee(n,G,s=>r(1,o=s)),[t,o,()=>H(K,t={kind:"new-point",obj:"bus stop"},t),s=>H(K,t={kind:"edit-bus-stop",idx:s},t)]}let Wi=class extends oe{constructor(e){super(),le(this,e,Yi,Vi,re,{})}};function Mn(n,e,r){const t=n.slice();return t[4]=e[r],t[6]=r,t}function xi(n){let e=n[4].properties.name+"",r;return{c(){r=q(e)},m(t,o){h(t,r,o)},p(t,o){o&2&&e!==(e=t[4].properties.name+"")&&ne(r,e)},d(t){t&&$(r)}}}function Tn(n){let e,r,t,o;function l(){return n[3](n[6])}return r=new Re({props:{color:n[4].properties.color,$$slots:{default:[xi]},$$scope:{ctx:n}}}),r.$on("click",l),{c(){e=b("li"),B(r.$$.fragment),t=z()},m(i,s){h(i,e,s),L(r,e,null),g(e,t),o=!0},p(i,s){n=i;const a={};s&2&&(a.color=n[4].properties.color),s&130&&(a.$$scope={dirty:s,ctx:n}),r.$set(a)},i(i){o||(_(r.$$.fragment,i),o=!0)},o(i){k(r.$$.fragment,i),o=!1},d(i){i&&$(e),M(r)}}}function es(n){let e,r,t,o,l,i,s,a,u=Y(n[1].crossings),c=[];for(let f=0;f<u.length;f+=1)c[f]=Tn(Mn(n,u,f));const d=f=>k(c[f],1,1,()=>{c[f]=null});return{c(){e=q(`Crossings:

`),r=b("div"),t=b("button"),t.textContent="New crossing",o=z(),l=b("ol");for(let f=0;f<c.length;f+=1)c[f].c()},m(f,m){h(f,e,m),h(f,r,m),g(r,t),h(f,o,m),h(f,l,m);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(l,null);i=!0,s||(a=Q(t,"click",n[2]),s=!0)},p(f,[m]){if(m&3){u=Y(f[1].crossings);let p;for(p=0;p<u.length;p+=1){const C=Mn(f,u,p);c[p]?(c[p].p(C,m),_(c[p],1)):(c[p]=Tn(C),c[p].c(),_(c[p],1),c[p].m(l,null))}for(se(),p=u.length;p<c.length;p+=1)d(p);ae()}},i(f){if(!i){for(let m=0;m<u.length;m+=1)_(c[m]);i=!0}},o(f){c=c.filter(Boolean);for(let m=0;m<c.length;m+=1)k(c[m]);i=!1},d(f){f&&($(e),$(r),$(o),$(l)),fe(c,f),s=!1,a()}}}function ts(n,e,r){let t,o;return ee(n,K,s=>r(0,t=s)),ee(n,G,s=>r(1,o=s)),[t,o,()=>H(K,t={kind:"new-point",obj:"crossing"},t),s=>H(K,t={kind:"edit-crossing",idx:s},t)]}let ns=class extends oe{constructor(e){super(),le(this,e,ts,es,re,{})}};function In(n,e,r){const t=n.slice();return t[4]=e[r],t[6]=r,t}function rs(n){let e=n[4].properties.name+"",r;return{c(){r=q(e)},m(t,o){h(t,r,o)},p(t,o){o&2&&e!==(e=t[4].properties.name+"")&&ne(r,e)},d(t){t&&$(r)}}}function En(n){let e,r,t,o;function l(){return n[3](n[6])}return r=new Re({props:{color:n[4].properties.color,$$slots:{default:[rs]},$$scope:{ctx:n}}}),r.$on("click",l),{c(){e=b("li"),B(r.$$.fragment),t=z()},m(i,s){h(i,e,s),L(r,e,null),g(e,t),o=!0},p(i,s){n=i;const a={};s&2&&(a.color=n[4].properties.color),s&130&&(a.$$scope={dirty:s,ctx:n}),r.$set(a)},i(i){o||(_(r.$$.fragment,i),o=!0)},o(i){k(r.$$.fragment,i),o=!1},d(i){i&&$(e),M(r)}}}function os(n){let e,r,t,o,l,i,s,a,u=Y(n[1].jats),c=[];for(let f=0;f<u.length;f+=1)c[f]=En(In(n,u,f));const d=f=>k(c[f],1,1,()=>{c[f]=null});return{c(){e=q(`JATs:

`),r=b("div"),t=b("button"),t.textContent="New JAT",o=z(),l=b("ol");for(let f=0;f<c.length;f+=1)c[f].c()},m(f,m){h(f,e,m),h(f,r,m),g(r,t),h(f,o,m),h(f,l,m);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(l,null);i=!0,s||(a=Q(t,"click",n[2]),s=!0)},p(f,[m]){if(m&3){u=Y(f[1].jats);let p;for(p=0;p<u.length;p+=1){const C=In(f,u,p);c[p]?(c[p].p(C,m),_(c[p],1)):(c[p]=En(C),c[p].c(),_(c[p],1),c[p].m(l,null))}for(se(),p=u.length;p<c.length;p+=1)d(p);ae()}},i(f){if(!i){for(let m=0;m<u.length;m+=1)_(c[m]);i=!0}},o(f){c=c.filter(Boolean);for(let m=0;m<c.length;m+=1)k(c[m]);i=!1},d(f){f&&($(e),$(r),$(o),$(l)),fe(c,f),s=!1,a()}}}function ls(n,e,r){let t,o;return ee(n,K,s=>r(0,t=s)),ee(n,G,s=>r(1,o=s)),[t,o,()=>H(K,t={kind:"new-point",obj:"jat"},t),s=>H(K,t={kind:"edit-jat",idx:s},t)]}let is=class extends oe{constructor(e){super(),le(this,e,ls,os,re,{})}};function Dn(n,e,r){const t=n.slice();return t[2]=e[r],t[4]=r,t}function Nn(n,e,r){const t=n.slice();t[5]=e[r];const o=t[5].properties.answers[t[4]];return t[6]=o,t}function On(n,e,r){const t=n.slice();return t[5]=e[r],t}function qn(n){let e,r=n[5].properties.name+"",t;return{c(){e=b("th"),t=q(r),X(e,"color",n[5].properties.color)},m(o,l){h(o,e,l),g(e,t)},p(o,l){l&1&&r!==(r=o[5].properties.name+"")&&ne(t,r),l&1&&X(e,"color",o[5].properties.color)},d(o){o&&$(e)}}}function Fn(n){let e,r=n[6]+"",t;return{c(){e=b("td"),t=q(r),X(e,"background",n[6]==""?"red":"green")},m(o,l){h(o,e,l),g(e,t)},p(o,l){l&1&&r!==(r=o[6]+"")&&ne(t,r),l&1&&X(e,"background",o[6]==""?"red":"green")},d(o){o&&$(e)}}}function Pn(n){let e,r,t,o,l=Y(n[0].links),i=[];for(let s=0;s<l.length;s+=1)i[s]=Fn(Nn(n,l,s));return{c(){e=b("tr"),r=b("th"),r.textContent=`${n[2].name}`,t=z();for(let s=0;s<i.length;s+=1)i[s].c();o=z()},m(s,a){h(s,e,a),g(e,r),g(e,t);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);g(e,o)},p(s,a){if(a&1){l=Y(s[0].links);let u;for(u=0;u<l.length;u+=1){const c=Nn(s,l,u);i[u]?i[u].p(c,a):(i[u]=Fn(c),i[u].c(),i[u].m(e,o))}for(;u<i.length;u+=1)i[u].d(1);i.length=l.length}},d(s){s&&$(e),fe(i,s)}}}function ss(n){let e,r,t,o,l,i,s,a=Y(n[0].links),u=[];for(let f=0;f<a.length;f+=1)u[f]=qn(On(n,a,f));let c=Y(we),d=[];for(let f=0;f<c.length;f+=1)d[f]=Pn(Dn(n,c,f));return{c(){e=b("table"),r=b("thead"),t=b("tr"),o=b("th"),l=z();for(let f=0;f<u.length;f+=1)u[f].c();i=z(),s=b("tbody");for(let f=0;f<d.length;f+=1)d[f].c()},m(f,m){h(f,e,m),g(e,r),g(r,t),g(t,o),g(t,l);for(let p=0;p<u.length;p+=1)u[p]&&u[p].m(t,null);g(e,i),g(e,s);for(let p=0;p<d.length;p+=1)d[p]&&d[p].m(s,null)},p(f,m){if(m&1){a=Y(f[0].links);let p;for(p=0;p<a.length;p+=1){const C=On(f,a,p);u[p]?u[p].p(C,m):(u[p]=qn(C),u[p].c(),u[p].m(t,null))}for(;p<u.length;p+=1)u[p].d(1);u.length=a.length}if(m&1){c=Y(we);let p;for(p=0;p<c.length;p+=1){const C=Dn(f,c,p);d[p]?d[p].p(C,m):(d[p]=Pn(C),d[p].c(),d[p].m(s,null))}for(;p<d.length;p+=1)d[p].d(1);d.length=c.length}},d(f){f&&$(e),fe(u,f),fe(d,f)}}}function as(n){let e,r;return e=new rt({props:{$$slots:{default:[ss]},$$scope:{ctx:n}}}),e.$on("close",n[1]),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,[o]){const l={};o&2049&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function cs(n,e,r){let t;ee(n,G,l=>r(0,t=l));function o(l){ke.call(this,n,l)}return[t,o]}class us extends oe{constructor(e){super(),le(this,e,cs,as,re,{})}}function Un(n,e,r){const t=n.slice();return t[9]=e[r],t[11]=r,t}function Gn(n,e,r){const t=n.slice();return t[12]=e[r],t[11]=r,t}function Qn(n){let e,r;return e=new us({}),e.$on("close",n[4]),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function fs(n){let e=n[12].properties.name+"",r;return{c(){r=q(e)},m(t,o){h(t,r,o)},p(t,o){o&2&&e!==(e=t[12].properties.name+"")&&ne(r,e)},d(t){t&&$(r)}}}function Hn(n){let e,r,t,o;function l(){return n[6](n[11])}return r=new Re({props:{color:n[12].properties.color,$$slots:{default:[fs]},$$scope:{ctx:n}}}),r.$on("click",l),{c(){e=b("li"),B(r.$$.fragment),t=z()},m(i,s){h(i,e,s),L(r,e,null),g(e,t),o=!0},p(i,s){n=i;const a={};s&2&&(a.color=n[12].properties.color),s&16386&&(a.$$scope={dirty:s,ctx:n}),r.$set(a)},i(i){o||(_(r.$$.fragment,i),o=!0)},o(i){k(r.$$.fragment,i),o=!1},d(i){i&&$(e),M(r)}}}function ds(n){let e=n[9].name+"",r,t;return{c(){r=q(e),t=z()},m(o,l){h(o,r,l),h(o,t,l)},p:V,d(o){o&&($(r),$(t))}}}function Jn(n){let e,r,t,o,l,i,s,a;function u(){return n[7](n[11])}r=new Re({props:{$$slots:{default:[ds]},$$scope:{ctx:n}}}),r.$on("click",u);function c(...d){return n[8](n[11],...d)}return{c(){e=b("li"),B(r.$$.fragment),t=q(`:
      `),o=b("progress"),s=z(),o.value=l=n[1].links.filter(c).length,F(o,"max",i=n[1].links.length),F(o,"class","svelte-zadug4")},m(d,f){h(d,e,f),L(r,e,null),g(e,t),g(e,o),g(e,s),a=!0},p(d,f){n=d;const m={};f&16384&&(m.$$scope={dirty:f,ctx:n}),r.$set(m),(!a||f&2&&l!==(l=n[1].links.filter(c).length))&&(o.value=l),(!a||f&2&&i!==(i=n[1].links.length))&&F(o,"max",i)},i(d){a||(_(r.$$.fragment,d),a=!0)},o(d){k(r.$$.fragment,d),a=!1},d(d){d&&$(e),M(r)}}}function ms(n){let e,r,t,o,l,i,s,a,u,c,d,f,m=n[0]&&Qn(n),p=Y(n[1].links),C=[];for(let y=0;y<p.length;y+=1)C[y]=Hn(Gn(n,p,y));const N=y=>k(C[y],1,1,()=>{C[y]=null});let A=Y(we),v=[];for(let y=0;y<A.length;y+=1)v[y]=Jn(Un(n,A,y));const D=y=>k(v[y],1,1,()=>{v[y]=null});return{c(){m&&m.c(),e=z(),r=b("div"),t=b("button"),t.textContent="New link",o=z(),l=b("button"),l.textContent="Table of questions",i=q(`

Links:
`),s=b("ol");for(let y=0;y<C.length;y+=1)C[y].c();a=q(`

Questions:
`),u=b("ol");for(let y=0;y<v.length;y+=1)v[y].c()},m(y,S){m&&m.m(y,S),h(y,e,S),h(y,r,S),g(r,t),g(r,o),g(r,l),h(y,i,S),h(y,s,S);for(let w=0;w<C.length;w+=1)C[w]&&C[w].m(s,null);h(y,a,S),h(y,u,S);for(let w=0;w<v.length;w+=1)v[w]&&v[w].m(u,null);c=!0,d||(f=[Q(t,"click",n[3]),Q(l,"click",n[5])],d=!0)},p(y,[S]){if(y[0]?m?(m.p(y,S),S&1&&_(m,1)):(m=Qn(y),m.c(),_(m,1),m.m(e.parentNode,e)):m&&(se(),k(m,1,1,()=>{m=null}),ae()),S&6){p=Y(y[1].links);let w;for(w=0;w<p.length;w+=1){const j=Gn(y,p,w);C[w]?(C[w].p(j,S),_(C[w],1)):(C[w]=Hn(j),C[w].c(),_(C[w],1),C[w].m(s,null))}for(se(),w=p.length;w<C.length;w+=1)N(w);ae()}if(S&6){A=Y(we);let w;for(w=0;w<A.length;w+=1){const j=Un(y,A,w);v[w]?(v[w].p(j,S),_(v[w],1)):(v[w]=Jn(j),v[w].c(),_(v[w],1),v[w].m(u,null))}for(se(),w=A.length;w<v.length;w+=1)D(w);ae()}},i(y){if(!c){_(m);for(let S=0;S<p.length;S+=1)_(C[S]);for(let S=0;S<A.length;S+=1)_(v[S]);c=!0}},o(y){k(m),C=C.filter(Boolean);for(let S=0;S<C.length;S+=1)k(C[S]);v=v.filter(Boolean);for(let S=0;S<v.length;S+=1)k(v[S]);c=!1},d(y){y&&($(e),$(r),$(i),$(s),$(a),$(u)),m&&m.d(y),fe(C,y),fe(v,y),d=!1,$e(f)}}}function ps(n,e,r){let t,o;ee(n,G,f=>r(1,t=f)),ee(n,K,f=>r(2,o=f));let l=!1;function i(){let f=Bi(t.links.length);H(G,t.links=[...t.links,f],t),H(K,o={kind:"edit-link",idx:t.links.length-1},o)}return[l,t,o,i,()=>r(0,l=!1),()=>r(0,l=!0),f=>H(K,o={kind:"edit-link",idx:f},o),f=>H(K,o={kind:"edit-question",idx:f},o),(f,m)=>m.properties.answers[f]!=""]}let gs=class extends oe{constructor(e){super(),le(this,e,ps,ms,re,{})}};function _s(n){return{type:"Feature",geometry:{type:"LineString",coordinates:[]},properties:{name:"Untitled side road",color:Me[n%Me.length],sa01:""}}}function Rn(n,e,r){const t=n.slice();return t[4]=e[r],t[6]=r,t}function hs(n){let e=n[4].properties.name+"",r;return{c(){r=q(e)},m(t,o){h(t,r,o)},p(t,o){o&1&&e!==(e=t[4].properties.name+"")&&ne(r,e)},d(t){t&&$(r)}}}function Kn(n){let e,r,t,o;function l(){return n[3](n[6])}return r=new Re({props:{color:n[4].properties.color,$$slots:{default:[hs]},$$scope:{ctx:n}}}),r.$on("click",l),{c(){e=b("li"),B(r.$$.fragment),t=z()},m(i,s){h(i,e,s),L(r,e,null),g(e,t),o=!0},p(i,s){n=i;const a={};s&1&&(a.color=n[4].properties.color),s&129&&(a.$$scope={dirty:s,ctx:n}),r.$set(a)},i(i){o||(_(r.$$.fragment,i),o=!0)},o(i){k(r.$$.fragment,i),o=!1},d(i){i&&$(e),M(r)}}}function $s(n){let e,r,t,o,l,i,s,a,u=Y(n[0].side_roads),c=[];for(let f=0;f<u.length;f+=1)c[f]=Kn(Rn(n,u,f));const d=f=>k(c[f],1,1,()=>{c[f]=null});return{c(){e=q(`Side roads:

`),r=b("div"),t=b("button"),t.textContent="New side road",o=z(),l=b("ol");for(let f=0;f<c.length;f+=1)c[f].c()},m(f,m){h(f,e,m),h(f,r,m),g(r,t),h(f,o,m),h(f,l,m);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(l,null);i=!0,s||(a=Q(t,"click",n[2]),s=!0)},p(f,[m]){if(m&3){u=Y(f[0].side_roads);let p;for(p=0;p<u.length;p+=1){const C=Rn(f,u,p);c[p]?(c[p].p(C,m),_(c[p],1)):(c[p]=Kn(C),c[p].c(),_(c[p],1),c[p].m(l,null))}for(se(),p=u.length;p<c.length;p+=1)d(p);ae()}},i(f){if(!i){for(let m=0;m<u.length;m+=1)_(c[m]);i=!0}},o(f){c=c.filter(Boolean);for(let m=0;m<c.length;m+=1)k(c[m]);i=!1},d(f){f&&($(e),$(r),$(o),$(l)),fe(c,f),s=!1,a()}}}function ks(n,e,r){let t,o;ee(n,G,s=>r(0,t=s)),ee(n,K,s=>r(1,o=s));function l(){let s=_s(t.side_roads.length);H(G,t.side_roads=[...t.side_roads,s],t),H(K,o={kind:"edit-side-road",idx:t.side_roads.length-1},o)}return[t,o,l,s=>H(K,o={kind:"edit-side-road",idx:s},o)]}class bs extends oe{constructor(e){super(),le(this,e,ks,$s,re,{})}}function ws(n){let e,r,t,o,l,i,s,a,u,c,d,f,m,p,C,N,A,v,D,y,S,w,j,I,O,R,J,T,Z,E;return d=new gs({}),C=new is({}),D=new Wi({}),j=new ns({}),J=new bs({}),{c(){e=b("div"),r=b("div"),t=b("button"),t.textContent="Load file",o=z(),l=b("button"),l.textContent="Download",i=z(),s=b("button"),s.textContent="Clear",a=z(),u=b("hr"),c=z(),B(d.$$.fragment),f=z(),m=b("hr"),p=z(),B(C.$$.fragment),N=z(),A=b("hr"),v=z(),B(D.$$.fragment),y=z(),S=b("hr"),w=z(),B(j.$$.fragment),I=z(),O=b("hr"),R=z(),B(J.$$.fragment),F(t,"class","secondary"),F(l,"class","secondary"),F(s,"class","secondary"),F(e,"slot","sidebar")},m(ie,ge){h(ie,e,ge),g(e,r),g(r,t),g(r,o),g(r,l),g(r,i),g(r,s),g(e,a),g(e,u),g(e,c),L(d,e,null),g(e,f),g(e,m),g(e,p),L(C,e,null),g(e,N),g(e,A),g(e,v),L(D,e,null),g(e,y),g(e,S),g(e,w),L(j,e,null),g(e,I),g(e,O),g(e,R),L(J,e,null),T=!0,Z||(E=[Q(t,"click",n[11]),Q(l,"click",n[12]),Q(s,"click",n[5])],Z=!0)},p:V,i(ie){T||(_(d.$$.fragment,ie),_(C.$$.fragment,ie),_(D.$$.fragment,ie),_(j.$$.fragment,ie),_(J.$$.fragment,ie),T=!0)},o(ie){k(d.$$.fragment,ie),k(C.$$.fragment,ie),k(D.$$.fragment,ie),k(j.$$.fragment,ie),k(J.$$.fragment,ie),T=!1},d(ie){ie&&$(e),M(d),M(C),M(D),M(j),M(J),Z=!1,$e(E)}}}function vs(n){let e,r;return e=new Le({props:{manageHoverState:!0,paint:{"line-color":["get","color"],"line-width":Ze(6,9)},hoverCursor:"pointer"}}),e.$on("click",n[6]),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function ys(n){let e,r;return e=new Fe({props:{manageHoverState:!0,paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":["get","color"],"circle-radius":Ze(20,25)},hoverCursor:"pointer"}}),e.$on("click",n[7]),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function As(n){let e,r;return e=new Pe({props:{manageHoverState:!0,layout:{"icon-image":"bus_stop","icon-size":3},paint:{"icon-color":["get","color"]},hoverCursor:"pointer"}}),e.$on("click",n[8]),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function Cs(n){let e,r;return e=new Pe({props:{manageHoverState:!0,layout:{"icon-image":"crossing","icon-size":.1},paint:{"icon-color":["get","color"]},hoverCursor:"pointer"}}),e.$on("click",n[9]),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function js(n){let e,r;return e=new Le({props:{manageHoverState:!0,paint:{"line-color":["get","color"],"line-width":Ze(3,6)},hoverCursor:"pointer"}}),e.$on("click",n[10]),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function zs(n){let e,r,t,o,l,i,s,a,u,c,d;return r=new _e({props:{data:ce(n[2].links),generateId:!0,$$slots:{default:[vs]},$$scope:{ctx:n}}}),o=new _e({props:{data:ce(n[2].jats),generateId:!0,$$slots:{default:[ys]},$$scope:{ctx:n}}}),i=new _e({props:{data:ce(n[2].bus_stops),generateId:!0,$$slots:{default:[As]},$$scope:{ctx:n}}}),a=new _e({props:{data:ce(n[2].crossings),generateId:!0,$$slots:{default:[Cs]},$$scope:{ctx:n}}}),c=new _e({props:{data:ce(n[2].side_roads),generateId:!0,$$slots:{default:[js]},$$scope:{ctx:n}}}),{c(){e=b("div"),B(r.$$.fragment),t=z(),B(o.$$.fragment),l=z(),B(i.$$.fragment),s=z(),B(a.$$.fragment),u=z(),B(c.$$.fragment),F(e,"slot","map")},m(f,m){h(f,e,m),L(r,e,null),g(e,t),L(o,e,null),g(e,l),L(i,e,null),g(e,s),L(a,e,null),g(e,u),L(c,e,null),d=!0},p(f,m){const p={};m&4&&(p.data=ce(f[2].links)),m&32776&&(p.$$scope={dirty:m,ctx:f}),r.$set(p);const C={};m&4&&(C.data=ce(f[2].jats)),m&32776&&(C.$$scope={dirty:m,ctx:f}),o.$set(C);const N={};m&4&&(N.data=ce(f[2].bus_stops)),m&32776&&(N.$$scope={dirty:m,ctx:f}),i.$set(N);const A={};m&4&&(A.data=ce(f[2].crossings)),m&32776&&(A.$$scope={dirty:m,ctx:f}),a.$set(A);const v={};m&4&&(v.data=ce(f[2].side_roads)),m&32776&&(v.$$scope={dirty:m,ctx:f}),c.$set(v)},i(f){d||(_(r.$$.fragment,f),_(o.$$.fragment,f),_(i.$$.fragment,f),_(a.$$.fragment,f),_(c.$$.fragment,f),d=!0)},o(f){k(r.$$.fragment,f),k(o.$$.fragment,f),k(i.$$.fragment,f),k(a.$$.fragment,f),k(c.$$.fragment,f),d=!1},d(f){f&&$(e),M(r),M(o),M(i),M(a),M(c)}}}function Xn(n){let e,r;return e=new rt({props:{$$slots:{default:[Ss]},$$scope:{ctx:n}}}),e.$on("close",n[14]),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&32770&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function Ss(n){let e,r,t,o,l;return{c(){e=b("h1"),e.textContent="Load a file previously downloaded from this tool",r=z(),t=b("input"),F(t,"type","file")},m(i,s){h(i,e,s),h(i,r,s),h(i,t,s),n[13](t),o||(l=Q(t,"change",n[4]),o=!0)},p:V,d(i){i&&($(e),$(r),$(t)),n[13](null),o=!1,l()}}}function Bs(n){let e,r,t,o;e=new Ee({props:{$$slots:{map:[zs],sidebar:[ws]},$$scope:{ctx:n}}});let l=n[0]&&Xn(n);return{c(){B(e.$$.fragment),r=z(),l&&l.c(),t=Te()},m(i,s){L(e,i,s),h(i,r,s),l&&l.m(i,s),h(i,t,s),o=!0},p(i,[s]){const a={};s&32781&&(a.$$scope={dirty:s,ctx:i}),e.$set(a),i[0]?l?(l.p(i,s),s&1&&_(l,1)):(l=Xn(i),l.c(),_(l,1),l.m(t.parentNode,t)):l&&(se(),k(l,1,1,()=>{l=null}),ae())},i(i){o||(_(e.$$.fragment,i),_(l),o=!0)},o(i){k(e.$$.fragment,i),k(l),o=!1},d(i){i&&($(r),$(t)),M(e,i),l&&l.d(i)}}}function Ls(n,e,r){let t,o;ee(n,G,v=>r(2,t=v)),ee(n,K,v=>r(3,o=v));let l=!1,i;async function s(v){try{let D=JSON.parse(await i.files[0].text());if(nr(D)){H(G,t=D,t),r(0,l=!1);return}}catch{}window.alert("Something's wrong with that file")}function a(){H(G,t.links=[],t),H(G,t.jats=[],t),H(G,t.bus_stops=[],t),H(G,t.crossings=[],t),H(G,t.side_roads=[],t)}const u=v=>H(K,o={kind:"edit-link",idx:v.detail.features[0].id},o),c=v=>H(K,o={kind:"edit-jat",idx:v.detail.features[0].id},o),d=v=>H(K,o={kind:"edit-bus-stop",idx:v.detail.features[0].id},o),f=v=>H(K,o={kind:"edit-crossing",idx:v.detail.features[0].id},o),m=v=>H(K,o={kind:"edit-side-road",idx:v.detail.features[0].id},o),p=()=>r(0,l=!0),C=()=>zo("rcv2.geojson",JSON.stringify(t));function N(v){ue[v?"unshift":"push"](()=>{i=v,r(1,i)})}return[l,i,t,o,s,a,u,c,d,f,m,p,C,N,()=>r(0,l=!1)]}class Ms extends oe{constructor(e){super(),le(this,e,Ls,Bs,re,{})}}function Ts(n,e){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{name:"Untitled bus stop",color:Me[n%Me.length],st20:""}}}function Is(n,e){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{name:"Untitled crossing",color:Me[n%Me.length],sa10:""}}}function Es(n,e){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{name:"Untitled JAT",color:Me[n%Me.length],existing:{arms:[],movements:[],notes:""},proposed:{arms:[],movements:[],notes:""}}}}function Ds(n){let e,r,t,o,l,i,s,a;return{c(){e=b("div"),r=b("h1"),t=q("Click map to create new "),o=q(n[0]),l=z(),i=b("button"),i.textContent="Cancel",F(e,"slot","sidebar")},m(u,c){h(u,e,c),g(e,r),g(r,t),g(r,o),g(e,l),g(e,i),s||(a=Q(i,"click",n[3]),s=!0)},p(u,c){c&1&&ne(o,u[0])},d(u){u&&$(e),s=!1,a()}}}function Ns(n){let e,r,t;return r=new Ne({props:{except:""}}),{c(){e=b("div"),B(r.$$.fragment),F(e,"slot","map")},m(o,l){h(o,e,l),L(r,e,null),t=!0},p:V,i(o){t||(_(r.$$.fragment,o),t=!0)},o(o){k(r.$$.fragment,o),t=!1},d(o){o&&$(e),M(r)}}}function Os(n){let e,r,t,o;return e=new ft({}),e.$on("click",n[2]),t=new Ee({props:{$$slots:{map:[Ns],sidebar:[Ds]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment),r=z(),B(t.$$.fragment)},m(l,i){L(e,l,i),h(l,r,i),L(t,l,i),o=!0},p(l,[i]){const s={};i&35&&(s.$$scope={dirty:i,ctx:l}),t.$set(s)},i(l){o||(_(e.$$.fragment,l),_(t.$$.fragment,l),o=!0)},o(l){k(e.$$.fragment,l),k(t.$$.fragment,l),o=!1},d(l){l&&$(r),M(e,l),M(t,l)}}}function qs(n,e,r){let t,o;ee(n,G,a=>r(4,t=a)),ee(n,K,a=>r(1,o=a));let{obj:l}=e;function i(a){let u=a.detail.lngLat.toArray();if(l=="jat"){let c=Es(t.jats.length,u);H(G,t.jats=[...t.jats,c],t),H(K,o={kind:"edit-jat",idx:t.jats.length-1},o)}else if(l=="crossing"){let c=Is(t.crossings.length,u);H(G,t.crossings=[...t.crossings,c],t),H(K,o={kind:"edit-crossing",idx:t.crossings.length-1},o)}else if(l=="bus stop"){let c=Ts(t.bus_stops.length,u);H(G,t.bus_stops=[...t.bus_stops,c],t),H(K,o={kind:"edit-bus-stop",idx:t.bus_stops.length-1},o)}}const s=()=>H(K,o={kind:"neutral"},o);return n.$$set=a=>{"obj"in a&&r(0,l=a.obj)},[l,o,i,s]}class Fs extends oe{constructor(e){super(),le(this,e,qs,Os,re,{obj:0})}}const{window:Ps}=Je;function Zn(n){let e;return{c(){e=b("p"),e.textContent="A side road needs at least two points"},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Us(n){let e;return{c(){e=q("SA01: conflict at side roads and priority junctions")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Gs(n){let e,r,t,o,l,i,s,a,u,c,d,f,m,p,C,N,A,v,D,y,S,w=!n[2]&&Zn();function j(O){n[10](O)}let I={k:"horiz-radio",choices:be(),$$slots:{default:[Us]},$$scope:{ctx:n}};return n[1].side_roads[n[0]].properties.sa01!==void 0&&(I.value=n[1].side_roads[n[0]].properties.sa01),m=new Ie({props:I}),ue.push(()=>me(m,"value",j)),v=new ot({props:{metric:n[4]}}),{c(){e=b("div"),r=b("button"),t=q("Done"),l=z(),i=b("button"),i.textContent="Delete side road",s=z(),w&&w.c(),a=z(),u=b("label"),c=q(`Name:
      `),d=b("input"),f=z(),B(m.$$.fragment),C=z(),N=b("p"),N.textContent=`${n[4].description}`,A=z(),B(v.$$.fragment),r.disabled=o=!n[2],F(d,"type","text"),F(e,"slot","sidebar")},m(O,R){h(O,e,R),g(e,r),g(r,t),g(e,l),g(e,i),g(e,s),w&&w.m(e,null),g(e,a),g(e,u),g(u,c),g(u,d),he(d,n[1].side_roads[n[0]].properties.name),g(e,f),L(m,e,null),g(e,C),g(e,N),g(e,A),L(v,e,null),D=!0,y||(S=[Q(r,"click",n[8]),Q(i,"click",n[6]),Q(d,"input",n[9])],y=!0)},p(O,R){(!D||R&4&&o!==(o=!O[2]))&&(r.disabled=o),O[2]?w&&(w.d(1),w=null):w||(w=Zn(),w.c(),w.m(e,a)),R&3&&d.value!==O[1].side_roads[O[0]].properties.name&&he(d,O[1].side_roads[O[0]].properties.name);const J={};R&2048&&(J.$$scope={dirty:R,ctx:O}),!p&&R&3&&(p=!0,J.value=O[1].side_roads[O[0]].properties.sa01,pe(()=>p=!1)),m.$set(J)},i(O){D||(_(m.$$.fragment,O),_(v.$$.fragment,O),D=!0)},o(O){k(m.$$.fragment,O),k(v.$$.fragment,O),D=!1},d(O){O&&$(e),w&&w.d(),M(m),M(v),y=!1,$e(S)}}}function Qs(n){let e,r;return e=new Le({props:{paint:{"line-color":["case",["==",["id"],n[0]],["get","color"],"black"],"line-width":3}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&1&&(l.paint={"line-color":["case",["==",["id"],t[0]],["get","color"],"black"],"line-width":3}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function Hs(n){let e,r,t,o,l,i,s,a;r=new Ne({props:{except:"side_roads"}}),o=new _e({props:{data:ce(n[1].side_roads),generateId:!0,$$slots:{default:[Qs]},$$scope:{ctx:n}}});function u(d){n[7](d)}let c={};return n[1].side_roads[n[0]]!==void 0&&(c.f=n[1].side_roads[n[0]]),i=new ir({props:c}),ue.push(()=>me(i,"f",u)),{c(){e=b("div"),B(r.$$.fragment),t=z(),B(o.$$.fragment),l=z(),B(i.$$.fragment),F(e,"slot","map")},m(d,f){h(d,e,f),L(r,e,null),g(e,t),L(o,e,null),g(e,l),L(i,e,null),a=!0},p(d,f){const m={};f&2&&(m.data=ce(d[1].side_roads)),f&2049&&(m.$$scope={dirty:f,ctx:d}),o.$set(m);const p={};!s&&f&3&&(s=!0,p.f=d[1].side_roads[d[0]],pe(()=>s=!1)),i.$set(p)},i(d){a||(_(r.$$.fragment,d),_(o.$$.fragment,d),_(i.$$.fragment,d),a=!0)},o(d){k(r.$$.fragment,d),k(o.$$.fragment,d),k(i.$$.fragment,d),a=!1},d(d){d&&$(e),M(r),M(o),M(i)}}}function Js(n){let e,r,t,o;return e=new Ee({props:{$$slots:{map:[Hs],sidebar:[Gs]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(l,i){L(e,l,i),r=!0,t||(o=Q(Ps,"keydown",n[5]),t=!0)},p(l,[i]){const s={};i&2063&&(s.$$scope={dirty:i,ctx:l}),e.$set(s)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){k(e.$$.fragment,l),r=!1},d(l){M(e,l),t=!1,o()}}}function Rs(n,e,r){let t,o,l;ee(n,G,p=>r(1,o=p)),ee(n,K,p=>r(3,l=p));let{idx:i}=e,s=He.SA01;function a(p){p.key=="Escape"&&H(K,l={kind:"neutral"},l)}async function u(){window.confirm("Really delete this side road?")&&(H(K,l={kind:"neutral"},l),await qe(),o.side_roads.splice(i,1),G.set(o))}function c(p){n.$$.not_equal(o.side_roads[i],p)&&(o.side_roads[i]=p,G.set(o))}const d=()=>H(K,l={kind:"neutral"},l);function f(){o.side_roads[i].properties.name=this.value,G.set(o)}function m(p){n.$$.not_equal(o.side_roads[i].properties.sa01,p)&&(o.side_roads[i].properties.sa01=p,G.set(o))}return n.$$set=p=>{"idx"in p&&r(0,i=p.idx)},n.$$.update=()=>{n.$$.dirty&3&&r(2,t=o.side_roads[i].geometry.coordinates.length>=2)},[i,o,t,l,s,a,u,c,d,f,m]}class Ks extends oe{constructor(e){super(),le(this,e,Rs,Js,re,{idx:0})}}function Xs(n){let e,r;return{c(){e=b("div"),r=b("div"),F(e,"slot","left")},m(t,o){h(t,e,o),g(e,r),n[9](r)},p:V,d(t){t&&$(e),n[9](null)}}}function Zs(n){return{c:V,m:V,p:V,i:V,o:V,d:V}}function Vs(n){let e,r,t;function o(i){n[8](i)}let l={style:n[10],standardControls:!0,hash:!0,images:[{id:"bus_stop",url:er,options:{sdf:!0}},{id:"crossing",url:tr,options:{sdf:!0}}],$$slots:{default:[ia]},$$scope:{ctx:n}};return n[2]!==void 0&&(l.map=n[2]),e=new zr({props:l}),ue.push(()=>me(e,"map",o)),{c(){B(e.$$.fragment)},m(i,s){L(e,i,s),t=!0},p(i,s){const a={};s&2058&&(a.$$scope={dirty:s,ctx:i}),!r&&s&4&&(r=!0,a.map=i[2],pe(()=>r=!1)),e.$set(a)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){k(e.$$.fragment,i),t=!1},d(i){M(e,i)}}}function Ys(n){let e,r;return e=new Ri({props:{qIdx:n[3].idx}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.qIdx=t[3].idx),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function Ws(n){let e,r;return e=new Ks({props:{idx:n[3].idx}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.idx=t[3].idx),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function xs(n){let e,r;return e=new rl({props:{idx:n[3].idx}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.idx=t[3].idx),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function ea(n){let e,r;return e=new go({props:{idx:n[3].idx}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.idx=t[3].idx),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function ta(n){let e,r;return e=new $i({props:{junctionIdx:n[3].idx,stage:n[3].stage}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.junctionIdx=t[3].idx),o&8&&(l.stage=t[3].stage),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function na(n){let e,r;return e=new Ci({props:{idx:n[3].idx}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.idx=t[3].idx),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function ra(n){let e,r;return e=new Fi({props:{idx:n[3].idx}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.idx=t[3].idx),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function oa(n){let e,r;return e=new Fs({props:{obj:n[3].obj}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.obj=t[3].obj),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function la(n){let e,r;return e=new Ms({}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function ia(n){let e,r,t,o,l,i,s;const a=[la,oa,ra,na,ta,ea,xs,Ws,Ys],u=[];function c(d,f){return d[3].kind=="neutral"?0:d[3].kind=="new-point"?1:d[3].kind=="edit-link"?2:d[3].kind=="edit-jat"?3:d[3].kind=="edit-jat-detail"?4:d[3].kind=="edit-bus-stop"?5:d[3].kind=="edit-crossing"?6:d[3].kind=="edit-side-road"?7:d[3].kind=="edit-question"?8:-1}return~(t=c(n))&&(o=u[t]=a[t](n)),i=new Ro({}),{c(){e=b("div"),r=z(),o&&o.c(),l=z(),B(i.$$.fragment)},m(d,f){h(d,e,f),n[7](e),h(d,r,f),~t&&u[t].m(d,f),h(d,l,f),L(i,d,f),s=!0},p(d,f){let m=t;t=c(d),t===m?~t&&u[t].p(d,f):(o&&(se(),k(u[m],1,1,()=>{u[m]=null}),ae()),~t?(o=u[t],o?o.p(d,f):(o=u[t]=a[t](d),o.c()),_(o,1),o.m(l.parentNode,l)):o=null)},i(d){s||(_(o),_(i.$$.fragment,d),s=!0)},o(d){k(o),k(i.$$.fragment,d),s=!1},d(d){d&&($(e),$(r),$(l)),n[7](null),~t&&u[t].d(d),M(i,d)}}}function sa(n){return{c:V,m:V,p:V,i:V,o:V,d:V}}function aa(n){let e,r,t={ctx:n,current:null,token:null,hasCatch:!1,pending:sa,then:Vs,catch:Zs,value:10,blocks:[,,,]};return Sr(ol(new URLSearchParams(window.location.search).get("google")||""),t),{c(){e=b("div"),t.block.c(),F(e,"slot","main"),X(e,"position","relative"),X(e,"width","100%"),X(e,"height","100vh")},m(o,l){h(o,e,l),t.block.m(e,t.anchor=null),t.mount=()=>e,t.anchor=null,r=!0},p(o,l){n=o,Br(t,n,l)},i(o){r||(_(t.block),r=!0)},o(o){for(let l=0;l<3;l+=1){const i=t.blocks[l];k(i)}r=!1},d(o){o&&$(e),t.block.d(),t.token=null,t=null}}}function ca(n){let e,r;return e=new jr({props:{$$slots:{main:[aa],left:[Xs]},$$scope:{ctx:n}}}),{c(){B(e.$$.fragment)},m(t,o){L(e,t,o),r=!0},p(t,[o]){const l={};o&2063&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function ua(n,e,r){let t,o,l,i,s;ee(n,at,m=>r(4,t=m)),ee(n,st,m=>r(5,o=m)),ee(n,G,m=>r(6,l=m)),ee(n,ct,m=>r(2,i=m)),ee(n,K,m=>r(3,s=m));let a,u;function c(m){ue[m?"unshift":"push"](()=>{u=m,r(1,u),r(4,t)})}function d(m){i=m,ct.set(i)}function f(m){ue[m?"unshift":"push"](()=>{a=m,r(0,a),r(5,o)})}return n.$$.update=()=>{n.$$.dirty&64&&window.localStorage.setItem("tmp-rcv2",JSON.stringify(l)),n.$$.dirty&33&&a&&o&&(r(0,a.innerHTML="",a),a.appendChild(o)),n.$$.dirty&18&&u&&t&&(r(1,u.innerHTML="",u),u.appendChild(t))},[a,u,i,s,t,o,l,c,d,f]}class fa extends oe{constructor(e){super(),le(this,e,ua,ca,re,{})}}new fa({target:document.getElementById("app")});
