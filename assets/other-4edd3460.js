import{V as An,W as Tn,X as ze,r as fe,e as M,v as me,t as C,Y as Ln,S as ae,i as ce,s as ue,Z as Sn,_ as Mn,$ as ne,a0 as In,L as Nn,b as de,a as we,c as G,m as H,d as ye,f as U,g as En,h as Me,u as Ie,j as Ne,k as Ee,l as be,y as k,z as I,q as v,w,a1 as Oe,o as V,p as We,x as oe,M as Se,A as B,B as ee,G as je,E as Fe,Q as W,a2 as lt,F as Z,O as m,N as se,R as ve,a3 as te,a4 as Ge,a5 as kn,a6 as bn,a7 as He,D as qe,H as re,U as x,a8 as xe,a9 as it,K as Ve,aa as qn,ab as Qe,ac as Dn,C as Ue,P as $n,ad as Pn,I as On,T as Fn}from"./Layout-a1b0c10e.js";function Jn(t,e){const l=e.token={};function n(r,o,i,a){if(e.token!==l)return;e.resolved=a;let s=e.ctx;i!==void 0&&(s=s.slice(),s[i]=a);const c=r&&(e.current=r)(s);let u=!1;e.block&&(e.blocks?e.blocks.forEach((f,d)=>{d!==o&&f&&(fe(),M(f,1,1,()=>{e.blocks[d]===f&&(e.blocks[d]=null)}),me())}):e.block.d(1),c.c(),C(c,1),c.m(e.mount(),e.anchor),u=!0),e.block=c,e.blocks&&(e.blocks[o]=c),u&&Ln()}if(An(t)){const r=Tn();if(t.then(o=>{ze(r),n(e.then,1,e.value,o),ze(null)},o=>{if(ze(r),n(e.catch,2,e.error,o),ze(null),!e.hasCatch)throw o}),e.current!==e.pending)return n(e.pending,0),!0}else{if(e.current!==e.then)return n(e.then,1,e.value,t),!0;e.resolved=t}}function zn(t,e,l){const n=e.slice(),{resolved:r}=t;t.current===t.then&&(n[t.value]=r),t.current===t.catch&&(n[t.error]=r),t.block.p(n,l)}function Bn(t,e,l){let n;const r=Sn();let{layer:o=void 0}=e;const{map:i}=Mn();ne(t,i,u=>l(2,n=u));function a(u){r(u.type,{...u,map:i})}const s=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu","mouseover","mouseout"],c=["click","dblclick","contextmenu","mousemove","movestart","moveend","zoomstart","zoom","zoomend"];return In(()=>{if(n)if(o)for(const u of s)n.off(u,o,a);else for(const u of c)n.off(u,a)}),t.$$set=u=>{"layer"in u&&l(1,o=u.layer)},t.$$.update=()=>{if(t.$$.dirty&6&&n)if(o)for(const u of s)n.on(u,o,a);else for(const u of c)n.on(u,a)},[i,o,n]}class vn extends ae{constructor(e){super(),ce(this,e,Bn,null,ue,{layer:1})}}function Rn(t){let e;const l=t[16].default,n=Me(l,t,t[24],null);return{c(){n&&n.c()},m(r,o){n&&n.m(r,o),e=!0},p(r,o){n&&n.p&&(!e||o&16777216)&&Ie(n,l,r,r[24],e?Ee(l,r[24],o,null):Ne(r[24]),null)},i(r){e||(C(n,r),e=!0)},o(r){M(n,r),e=!1},d(r){n&&n.d(r)}}}function Gn(t){let e,l,n;function r(i){t[17](i)}let o={id:t[1],type:"symbol",source:t[2],sourceLayer:t[3],beforeId:t[4],beforeLayerType:t[5],paint:t[6],layout:t[7],filter:t[8],applyToClusters:t[9],minzoom:t[10],maxzoom:t[11],hoverCursor:t[12],manageHoverState:t[13],eventsIfTopMost:t[14],interactive:t[15],$$slots:{default:[Rn]},$$scope:{ctx:t}};return t[0]!==void 0&&(o.hovered=t[0]),e=new Nn({props:o}),de.push(()=>we(e,"hovered",r)),e.$on("click",t[18]),e.$on("dblclick",t[19]),e.$on("contextmenu",t[20]),e.$on("mouseenter",t[21]),e.$on("mousemove",t[22]),e.$on("mouseleave",t[23]),{c(){G(e.$$.fragment)},m(i,a){H(e,i,a),n=!0},p(i,[a]){const s={};a&2&&(s.id=i[1]),a&4&&(s.source=i[2]),a&8&&(s.sourceLayer=i[3]),a&16&&(s.beforeId=i[4]),a&32&&(s.beforeLayerType=i[5]),a&64&&(s.paint=i[6]),a&128&&(s.layout=i[7]),a&256&&(s.filter=i[8]),a&512&&(s.applyToClusters=i[9]),a&1024&&(s.minzoom=i[10]),a&2048&&(s.maxzoom=i[11]),a&4096&&(s.hoverCursor=i[12]),a&8192&&(s.manageHoverState=i[13]),a&16384&&(s.eventsIfTopMost=i[14]),a&32768&&(s.interactive=i[15]),a&16777216&&(s.$$scope={dirty:a,ctx:i}),!l&&a&1&&(l=!0,s.hovered=i[0],ye(()=>l=!1)),e.$set(s)},i(i){n||(C(e.$$.fragment,i),n=!0)},o(i){M(e.$$.fragment,i),n=!1},d(i){U(e,i)}}}function Hn(t,e,l){let{$$slots:n={},$$scope:r}=e,{id:o=En("symbol")}=e,{source:i=void 0}=e,{sourceLayer:a=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:c=void 0}=e,{paint:u=void 0}=e,{layout:f=void 0}=e,{filter:d=void 0}=e,{applyToClusters:p=void 0}=e,{minzoom:_=void 0}=e,{maxzoom:g=void 0}=e,{hoverCursor:D=void 0}=e,{manageHoverState:b=!1}=e,{hovered:j=null}=e,{eventsIfTopMost:N=!1}=e,{interactive:R=!0}=e;function q(h){j=h,l(0,j)}function P(h){be.call(this,t,h)}function F(h){be.call(this,t,h)}function L(h){be.call(this,t,h)}function z(h){be.call(this,t,h)}function T(h){be.call(this,t,h)}function S(h){be.call(this,t,h)}return t.$$set=h=>{"id"in h&&l(1,o=h.id),"source"in h&&l(2,i=h.source),"sourceLayer"in h&&l(3,a=h.sourceLayer),"beforeId"in h&&l(4,s=h.beforeId),"beforeLayerType"in h&&l(5,c=h.beforeLayerType),"paint"in h&&l(6,u=h.paint),"layout"in h&&l(7,f=h.layout),"filter"in h&&l(8,d=h.filter),"applyToClusters"in h&&l(9,p=h.applyToClusters),"minzoom"in h&&l(10,_=h.minzoom),"maxzoom"in h&&l(11,g=h.maxzoom),"hoverCursor"in h&&l(12,D=h.hoverCursor),"manageHoverState"in h&&l(13,b=h.manageHoverState),"hovered"in h&&l(0,j=h.hovered),"eventsIfTopMost"in h&&l(14,N=h.eventsIfTopMost),"interactive"in h&&l(15,R=h.interactive),"$$scope"in h&&l(24,r=h.$$scope)},[j,o,i,a,s,c,u,f,d,p,_,g,D,b,N,R,n,q,P,F,L,z,T,S,r]}class Un extends ae{constructor(e){super(),ce(this,e,Hn,Gn,ue,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}const Zn=t=>({}),st=t=>({}),Kn=t=>({}),at=t=>({});function Xn(t){let e,l,n,r;const o=t[3].sidebar,i=Me(o,t,t[2],at),a=t[3].map,s=Me(a,t,t[2],st);return{c(){e=k("div"),i&&i.c(),l=I(),n=k("div"),s&&s.c()},m(c,u){v(c,e,u),i&&i.m(e,null),t[4](e),v(c,l,u),v(c,n,u),s&&s.m(n,null),t[5](n),r=!0},p(c,[u]){i&&i.p&&(!r||u&4)&&Ie(i,o,c,c[2],r?Ee(o,c[2],u,Kn):Ne(c[2]),at),s&&s.p&&(!r||u&4)&&Ie(s,a,c,c[2],r?Ee(a,c[2],u,Zn):Ne(c[2]),st)},i(c){r||(C(i,c),C(s,c),r=!0)},o(c){M(i,c),M(s,c),r=!1},d(c){c&&(w(e),w(l),w(n)),i&&i.d(c),t[4](null),s&&s.d(c),t[5](null)}}}function Wn(t,e,l){let n,r;ne(t,et,c=>l(0,n=c)),ne(t,tt,c=>l(1,r=c));let{$$slots:o={},$$scope:i}=e;function a(c){de[c?"unshift":"push"](()=>{n=c,et.set(n)})}function s(c){de[c?"unshift":"push"](()=>{r=c,tt.set(r)})}return t.$$set=c=>{"$$scope"in c&&l(2,i=c.$$scope)},[n,r,i,o,a,s]}class Je extends ae{constructor(e){super(),ce(this,e,Wn,Xn,ue,{})}}let et=Oe(null),tt=Oe(null);function ct(t,e,l){const n=t.slice();return n[3]=e[l],n[4]=e,n[5]=l,n}function Vn(t){let e,l;return{c(){e=k("span"),l=I(),B(e,"class","dot svelte-jgyhla")},m(n,r){v(n,e,r),v(n,l,r)},p:ee,d(n){n&&(w(e),w(l))}}}function ut(t){let e,l,n;function r(i){t[2](i,t[3],t[4],t[5])}let o={draggable:!0,$$slots:{default:[Vn]},$$scope:{ctx:t}};return t[3]!==void 0&&(o.lngLat=t[3]),e=new Se({props:o}),de.push(()=>we(e,"lngLat",r)),{c(){G(e.$$.fragment)},m(i,a){H(e,i,a),n=!0},p(i,a){t=i;const s={};a&64&&(s.$$scope={dirty:a,ctx:t}),!l&&a&1&&(l=!0,s.lngLat=t[3],ye(()=>l=!1)),e.$set(s)},i(i){n||(C(e.$$.fragment,i),n=!0)},o(i){M(e.$$.fragment,i),n=!1},d(i){U(e,i)}}}function Qn(t){let e,l,n,r;e=new vn({}),e.$on("click",t[1]);let o=V(t[0].geometry.coordinates),i=[];for(let s=0;s<o.length;s+=1)i[s]=ut(ct(t,o,s));const a=s=>M(i[s],1,1,()=>{i[s]=null});return{c(){G(e.$$.fragment),l=I();for(let s=0;s<i.length;s+=1)i[s].c();n=We()},m(s,c){H(e,s,c),v(s,l,c);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(s,c);v(s,n,c),r=!0},p(s,[c]){if(c&1){o=V(s[0].geometry.coordinates);let u;for(u=0;u<o.length;u+=1){const f=ct(s,o,u);i[u]?(i[u].p(f,c),C(i[u],1)):(i[u]=ut(f),i[u].c(),C(i[u],1),i[u].m(n.parentNode,n))}for(fe(),u=o.length;u<i.length;u+=1)a(u);me()}},i(s){if(!r){C(e.$$.fragment,s);for(let c=0;c<o.length;c+=1)C(i[c]);r=!0}},o(s){M(e.$$.fragment,s),i=i.filter(Boolean);for(let c=0;c<i.length;c+=1)M(i[c]);r=!1},d(s){s&&(w(l),w(n)),U(e,s),oe(i,s)}}}function Yn(t,e,l){let{f:n}=e;function r(i){n.geometry.coordinates.push(i.detail.lngLat.toArray()),l(0,n)}function o(i,a,s,c){s[c]=i,l(0,n)}return t.$$set=i=>{"f"in i&&l(0,n=i.f)},[n,r,o]}class xn extends ae{constructor(e){super(),ce(this,e,Yn,Qn,ue,{f:0})}}let Ze=Oe(void 0),Q=Oe(nl());function pe(t){return{type:"FeatureCollection",features:t}}let le=Oe({kind:"neutral"});function $e(){return["","2","1","0","Critical"]}let ke=[{name:"Street or path check",description:"Is this on-carriageway or a traffic-free path?",choices:["","Street check","Path check"]},{name:"SA03",description:"lane widths",choices:$e()},{name:"SA04",description:"trip hazards",choices:$e()},{name:"SA05",description:"kerbside activity",choices:$e()},{name:"SA08",description:"motor traffic speed",choices:$e()},{name:"SA09",description:"motor traffic volume",choices:$e()},{name:"SA11",description:"footway widths",choices:$e()},{name:"SA12",description:"effective width next to tram lines",choices:$e()},{name:"SA13",description:"crossing angle of tram/train rails",choices:$e()},{name:"SA14",description:"cycling surface and maintenance defects",choices:$e()},{name:"SA15",description:"WW surface and maintenance defects",choices:$e()},{name:"SA16",description:"guard railing",choices:$e()}],Ke=["#66C5CC","#F6CF71","#F89C74","#DCB0F2","#87C55F","#9EB9F3","#FE88B1","#C9DB74","#8BE0A4","#B497E7","#D3B484","#B3B3B3"];function el(t){return{type:"Feature",geometry:{type:"LineString",coordinates:[]},properties:{name:"Untitled link",color:Ke[t%Ke.length],answers:Array(ke.length).fill("")}}}function tl(t,e){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{name:"Untitled JAT",color:Ke[t%Ke.length],existing:{arms:[],movements:[],notes:""},proposed:{arms:[],movements:[],notes:""}}}}function nl(){try{let t=JSON.parse(window.localStorage.getItem("tmp-rcv2")||"");if("links"in t&&"jats"in t)return t}catch{}return{links:[],jats:[]}}function ll(t){let e,l;return e=new Fe({props:{paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":"black","circle-radius":20}}}),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p:ee,i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function rl(t){let e,l;return e=new je({props:{data:pe(t[0].jats),$$slots:{default:[ll]},$$scope:{ctx:t}}}),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p(n,[r]){const o={};r&1&&(o.data=pe(n[0].jats)),r&2&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function ol(t,e,l){let n;return ne(t,Q,r=>l(0,n=r)),[n]}class wn extends ae{constructor(e){super(),ce(this,e,ol,rl,ue,{})}}const{window:il}=lt;function ft(t,e,l){const n=t.slice();return n[10]=e[l],n[11]=e,n[12]=l,n}function sl(t,e,l){const n=t.slice();return n[13]=e[l],n}function mt(t){let e;return{c(){e=k("p"),e.textContent="A link needs at least two points"},m(l,n){v(l,e,n)},d(l){l&&w(e)}}}function al(t){let e;return{c(){e=k("option"),e.textContent=`${t[13]}`,e.__value=t[13],se(e,e.__value)},m(l,n){v(l,e,n)},p:ee,d(l){l&&w(e)}}}function dt(t){let e,l=t[10].name+"",n,r,o=t[10].description+"",i,a,s,c,u,f,d=V(t[10].choices),p=[];for(let g=0;g<d.length;g+=1)p[g]=al(sl(t,d,g));function _(){t[9].call(s,t[12])}return{c(){e=k("label"),n=Z(l),r=Z(": "),i=Z(o),a=I(),s=k("select");for(let g=0;g<p.length;g+=1)p[g].c();c=I(),t[1].links[t[0]].properties.answers[t[12]]===void 0&&bn(_)},m(g,D){v(g,e,D),m(e,n),m(e,r),m(e,i),m(e,a),m(e,s);for(let b=0;b<p.length;b+=1)p[b]&&p[b].m(s,null);He(s,t[1].links[t[0]].properties.answers[t[12]],!0),m(e,c),u||(f=W(s,"change",_),u=!0)},p(g,D){t=g,D&3&&He(s,t[1].links[t[0]].properties.answers[t[12]])},d(g){g&&w(e),oe(p,g),u=!1,f()}}}function cl(t){let e,l,n,r,o,i,a,s,c,u,f,d,p,_,g=!t[2]&&mt(),D=V(ke),b=[];for(let j=0;j<D.length;j+=1)b[j]=dt(ft(t,D,j));return{c(){e=k("div"),l=k("button"),n=Z("Done"),o=I(),i=k("button"),i.textContent="Delete link",a=I(),g&&g.c(),s=I(),c=k("label"),u=Z(`Name:
      `),f=k("input"),d=I();for(let j=0;j<b.length;j+=1)b[j].c();l.disabled=r=!t[2],B(f,"type","text"),B(e,"slot","sidebar")},m(j,N){v(j,e,N),m(e,l),m(l,n),m(e,o),m(e,i),m(e,a),g&&g.m(e,null),m(e,s),m(e,c),m(c,u),m(c,f),se(f,t[1].links[t[0]].properties.name),m(e,d);for(let R=0;R<b.length;R+=1)b[R]&&b[R].m(e,null);p||(_=[W(l,"click",t[7]),W(i,"click",t[5]),W(f,"input",t[8])],p=!0)},p(j,N){if(N&4&&r!==(r=!j[2])&&(l.disabled=r),j[2]?g&&(g.d(1),g=null):g||(g=mt(),g.c(),g.m(e,s)),N&3&&f.value!==j[1].links[j[0]].properties.name&&se(f,j[1].links[j[0]].properties.name),N&3){D=V(ke);let R;for(R=0;R<D.length;R+=1){const q=ft(j,D,R);b[R]?b[R].p(q,N):(b[R]=dt(q),b[R].c(),b[R].m(e,null))}for(;R<b.length;R+=1)b[R].d(1);b.length=D.length}},d(j){j&&w(e),g&&g.d(),oe(b,j),p=!1,ve(_)}}}function ul(t){let e,l;return e=new qe({props:{paint:{"line-color":["case",["==",["id"],t[0]],["get","color"],"black"],"line-width":6}}}),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p(n,r){const o={};r&1&&(o.paint={"line-color":["case",["==",["id"],n[0]],["get","color"],"black"],"line-width":6}),e.$set(o)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function fl(t){let e,l,n,r,o,i,a,s;l=new je({props:{data:pe(t[1].links),generateId:!0,$$slots:{default:[ul]},$$scope:{ctx:t}}}),r=new wn({});function c(f){t[6](f)}let u={};return t[1].links[t[0]]!==void 0&&(u.f=t[1].links[t[0]]),i=new xn({props:u}),de.push(()=>we(i,"f",c)),{c(){e=k("div"),G(l.$$.fragment),n=I(),G(r.$$.fragment),o=I(),G(i.$$.fragment),B(e,"slot","map")},m(f,d){v(f,e,d),H(l,e,null),m(e,n),H(r,e,null),m(e,o),H(i,e,null),s=!0},p(f,d){const p={};d&2&&(p.data=pe(f[1].links)),d&65537&&(p.$$scope={dirty:d,ctx:f}),l.$set(p);const _={};!a&&d&3&&(a=!0,_.f=f[1].links[f[0]],ye(()=>a=!1)),i.$set(_)},i(f){s||(C(l.$$.fragment,f),C(r.$$.fragment,f),C(i.$$.fragment,f),s=!0)},o(f){M(l.$$.fragment,f),M(r.$$.fragment,f),M(i.$$.fragment,f),s=!1},d(f){f&&w(e),U(l),U(r),U(i)}}}function ml(t){let e,l,n,r;return e=new Je({props:{$$slots:{map:[fl],sidebar:[cl]},$$scope:{ctx:t}}}),{c(){G(e.$$.fragment)},m(o,i){H(e,o,i),l=!0,n||(r=W(il,"keydown",t[4]),n=!0)},p(o,[i]){const a={};i&65551&&(a.$$scope={dirty:i,ctx:o}),e.$set(a)},i(o){l||(C(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){U(e,o),n=!1,r()}}}function dl(t,e,l){let n,r,o;ne(t,Q,p=>l(1,r=p)),ne(t,le,p=>l(3,o=p));let{idx:i}=e;function a(p){p.key=="Escape"&&n&&te(le,o={kind:"neutral"},o)}async function s(){window.confirm("Really delete this link?")&&(te(le,o={kind:"neutral"},o),await Ge(),r.links.splice(i,1),Q.set(r))}function c(p){t.$$.not_equal(r.links[i],p)&&(r.links[i]=p,Q.set(r))}const u=()=>te(le,o={kind:"neutral"},o);function f(){r.links[i].properties.name=this.value,Q.set(r)}function d(p){r.links[i].properties.answers[p]=kn(this),Q.set(r)}return t.$$set=p=>{"idx"in p&&l(0,i=p.idx)},t.$$.update=()=>{t.$$.dirty&3&&l(2,n=r.links[i].geometry.coordinates.length>=2)},[i,r,n,o,a,s,c,u,f,d]}class pl extends ae{constructor(e){super(),ce(this,e,dl,ml,ue,{idx:0})}}function _l(t){let e,l;return e=new qe({props:{paint:{"line-color":t[0]?["get","color"]:"black","line-width":6}}}),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p(n,r){const o={};r&1&&(o.paint={"line-color":n[0]?["get","color"]:"black","line-width":6}),e.$set(o)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function gl(t){let e,l;return e=new je({props:{data:pe(t[1].links),$$slots:{default:[_l]},$$scope:{ctx:t}}}),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p(n,[r]){const o={};r&2&&(o.data=pe(n[1].links)),r&5&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function hl(t,e,l){let n;ne(t,Q,o=>l(1,n=o));let{showColor:r=!1}=e;return t.$$set=o=>{"showColor"in o&&l(0,r=o.showColor)},[r,n]}class rt extends ae{constructor(e){super(),ce(this,e,hl,gl,ue,{showColor:0})}}function pt(t,e,l){const n=t.slice();return n[6]=e[l],n[7]=e,n[8]=l,n}function _t(t,e,l){const n=t.slice();return n[9]=e[l],n}function gt(t){let e,l=t[9]+"",n,r;return{c(){e=k("option"),n=Z(l),e.__value=r=t[9],se(e,e.__value)},m(o,i){v(o,e,i),m(e,n)},p(o,i){i&1&&l!==(l=o[9]+"")&&re(n,l),i&1&&r!==(r=o[9])&&(e.__value=r,se(e,e.__value))},d(o){o&&w(e)}}}function ht(t){let e,l,n=t[6].properties.name+"",r,o,i,a,s,c,u=V(ke[t[0]].choices),f=[];for(let p=0;p<u.length;p+=1)f[p]=gt(_t(t,u,p));function d(){t[5].call(i,t[7],t[8])}return{c(){e=k("li"),l=k("span"),r=Z(n),o=I(),i=k("select");for(let p=0;p<f.length;p+=1)f[p].c();a=I(),x(l,"color",t[6].properties.color),t[6].properties.answers[t[0]]===void 0&&bn(d)},m(p,_){v(p,e,_),m(e,l),m(l,r),m(e,o),m(e,i);for(let g=0;g<f.length;g+=1)f[g]&&f[g].m(i,null);He(i,t[6].properties.answers[t[0]],!0),m(e,a),s||(c=W(i,"change",d),s=!0)},p(p,_){if(t=p,_&4&&n!==(n=t[6].properties.name+"")&&re(r,n),_&4&&x(l,"color",t[6].properties.color),_&1){u=V(ke[t[0]].choices);let g;for(g=0;g<u.length;g+=1){const D=_t(t,u,g);f[g]?f[g].p(D,_):(f[g]=gt(D),f[g].c(),f[g].m(i,null))}for(;g<f.length;g+=1)f[g].d(1);f.length=u.length}_&5&&He(i,t[6].properties.answers[t[0]])},d(p){p&&w(e),oe(f,p),s=!1,c()}}}function kl(t){let e,l,n,r,o=ke[t[0]].name+"",i,a,s=ke[t[0]].description+"",c,u,f,d,p,_=V(t[2].links),g=[];for(let D=0;D<_.length;D+=1)g[D]=ht(pt(t,_,D));return{c(){e=k("div"),l=k("button"),l.textContent="Done",n=I(),r=k("h2"),i=Z(o),a=Z(": "),c=Z(s),u=I(),f=k("ol");for(let D=0;D<g.length;D+=1)g[D].c();B(e,"slot","sidebar")},m(D,b){v(D,e,b),m(e,l),m(e,n),m(e,r),m(r,i),m(r,a),m(r,c),m(e,u),m(e,f);for(let j=0;j<g.length;j+=1)g[j]&&g[j].m(f,null);d||(p=W(l,"click",t[4]),d=!0)},p(D,b){if(b&1&&o!==(o=ke[D[0]].name+"")&&re(i,o),b&1&&s!==(s=ke[D[0]].description+"")&&re(c,s),b&5){_=V(D[2].links);let j;for(j=0;j<_.length;j+=1){const N=pt(D,_,j);g[j]?g[j].p(N,b):(g[j]=ht(N),g[j].c(),g[j].m(f,null))}for(;j<g.length;j+=1)g[j].d(1);g.length=_.length}},d(D){D&&w(e),oe(g,D),d=!1,p()}}}function bl(t){let e,l,n,r,o;return l=new rt({props:{showColor:!0}}),r=new wn({}),{c(){e=k("div"),G(l.$$.fragment),n=I(),G(r.$$.fragment),B(e,"slot","map")},m(i,a){v(i,e,a),H(l,e,null),m(e,n),H(r,e,null),o=!0},p:ee,i(i){o||(C(l.$$.fragment,i),C(r.$$.fragment,i),o=!0)},o(i){M(l.$$.fragment,i),M(r.$$.fragment,i),o=!1},d(i){i&&w(e),U(l),U(r)}}}function $l(t){let e,l,n,r;return e=new Je({props:{$$slots:{map:[bl],sidebar:[kl]},$$scope:{ctx:t}}}),{c(){G(e.$$.fragment)},m(o,i){H(e,o,i),l=!0,n||(r=W(window,"keydown",t[3]),n=!0)},p(o,[i]){const a={};i&4103&&(a.$$scope={dirty:i,ctx:o}),e.$set(a)},i(o){l||(C(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){U(e,o),n=!1,r()}}}function vl(t,e,l){let n,r;ne(t,le,c=>l(1,n=c)),ne(t,Q,c=>l(2,r=c));let{qIdx:o}=e;function i(c){c.key=="Escape"&&te(le,n={kind:"neutral"},n)}const a=()=>te(le,n={kind:"neutral"},n);function s(c,u){c[u].properties.answers[o]=kn(this),Q.set(r),l(0,o)}return t.$$set=c=>{"qIdx"in c&&l(0,o=c.qIdx)},[o,n,r,i,a,s]}class wl extends ae{constructor(e){super(),ce(this,e,vl,$l,ue,{qIdx:0})}}let kt="MZEJTanw3WpxRvt7qDfo";async function yl(t){return t?{version:8,sources:{"raster-tiles":{type:"raster",tiles:[`https://tile.googleapis.com/v1/2dtiles/{z}/{x}/{y}?session=${await jl(t)}&key=${t}`],tileSize:256,attribution:"Google (detailed attributions not wired up)"}},layers:[{id:"raster-basemap",type:"raster",source:"raster-tiles"}],glyphs:`https://api.maptiler.com/fonts/{fontstack}/{range}.pbf?key=${kt}`}:`https://api.maptiler.com/maps/dataviz/style.json?key=${kt}`}async function jl(t){try{let l=await(await fetch(`https://tile.googleapis.com/v1/createSession?key=${t}`,{method:"POST",body:JSON.stringify({mapType:"satellite",language:"en-GB",region:"GB"})})).json();return"session"in l?l.session:(console.error(`Couldn't get Google tile session key: ${JSON.stringify(l)}`),"")}catch(e){return console.error(`Couldn't get Google tile session key: ${e}`),""}}const Cl="/route-element/assets/right-arrow-d8c7892c.svg";function bt(t){let e,l;const n=t[4].default,r=Me(n,t,t[3],null);return{c(){e=k("div"),r&&r.c(),B(e,"class","section svelte-zax3q3")},m(o,i){v(o,e,i),r&&r.m(e,null),l=!0},p(o,i){r&&r.p&&(!l||i&8)&&Ie(r,n,o,o[3],l?Ee(n,o[3],i,null):Ne(o[3]),null)},i(o){l||(C(r,o),l=!0)},o(o){M(r,o),l=!1},d(o){o&&w(e),r&&r.d(o)}}}function Al(t){let e,l,n,r,o,i,a,s,c,u,f,d,p=t[2]&&bt(t);return{c(){e=k("button"),l=k("div"),n=k("span"),r=Z(t[0]),o=I(),i=k("img"),c=I(),p&&p.c(),B(i,"class","arrow svelte-zax3q3"),xe(i.src,a=Cl)||B(i,"src",a),B(i,"alt",s="Select "+t[0]),B(l,"class","top-section section svelte-zax3q3"),it(l,"bordered",t[2]),B(e,"class","clickable-card svelte-zax3q3"),e.disabled=t[1]},m(_,g){v(_,e,g),m(e,l),m(l,n),m(n,r),m(l,o),m(l,i),m(e,c),p&&p.m(e,null),u=!0,f||(d=[W(e,"click",t[5]),W(e,"mouseenter",t[6]),W(e,"mouseleave",t[7])],f=!0)},p(_,[g]){(!u||g&1)&&re(r,_[0]),(!u||g&1&&s!==(s="Select "+_[0]))&&B(i,"alt",s),(!u||g&4)&&it(l,"bordered",_[2]),_[2]?p?(p.p(_,g),g&4&&C(p,1)):(p=bt(_),p.c(),C(p,1),p.m(e,null)):p&&(fe(),M(p,1,1,()=>{p=null}),me()),(!u||g&2)&&(e.disabled=_[1])},i(_){u||(C(p),u=!0)},o(_){M(p),u=!1},d(_){_&&w(e),p&&p.d(),f=!1,ve(d)}}}function Tl(t,e,l){let{$$slots:n={},$$scope:r}=e,{name:o}=e,{disabled:i=!1}=e,{hasSlot:a=!0}=e;function s(f){be.call(this,t,f)}function c(f){be.call(this,t,f)}function u(f){be.call(this,t,f)}return t.$$set=f=>{"name"in f&&l(0,o=f.name),"disabled"in f&&l(1,i=f.disabled),"hasSlot"in f&&l(2,a=f.hasSlot),"$$scope"in f&&l(3,r=f.$$scope)},[o,i,a,r,n,s,c,u]}class yn extends ae{constructor(e){super(),ce(this,e,Tl,Al,ue,{name:0,disabled:1,hasSlot:2})}}let Ce={critical:{background:"#232323",font:"white"},red:{background:"#b73d25",font:"white"},amber:{background:"#ffd833",font:"black"},green:{background:"#006853",font:"white"},notApplicable:{background:"white",font:"black"}};const Ll=t=>({dialog:t&1}),$t=t=>({dialog:t[0]});function Sl(t){let e,l,n,r,o;const i=t[4].default,a=Me(i,t,t[3],$t);return{c(){e=k("dialog"),l=k("article"),a&&a.c(),e.open=!0},m(s,c){v(s,e,c),m(e,l),a&&a.m(l,null),t[6](e),n=!0,r||(o=[W(window,"click",t[1]),W(window,"keydown",t[2]),W(e,"close",t[5])],r=!0)},p(s,[c]){a&&a.p&&(!n||c&9)&&Ie(a,i,s,s[3],n?Ee(i,s[3],c,Ll):Ne(s[3]),$t)},i(s){n||(C(a,s),n=!0)},o(s){M(a,s),n=!1},d(s){s&&w(e),a&&a.d(s),t[6](null),r=!1,ve(o)}}}function Ml(t,e,l){let{$$slots:n={},$$scope:r}=e,o;function i(u){o.open&&u.target==o&&o.close()}function a(u){(u.key=="Escape"||u.key=="Enter")&&(u.stopPropagation(),o.close())}function s(u){be.call(this,t,u)}function c(u){de[u?"unshift":"push"](()=>{o=u,l(0,o)})}return t.$$set=u=>{"$$scope"in u&&l(3,r=u.$$scope)},[o,i,a,r,n,s,c]}class jn extends ae{constructor(e){super(),ce(this,e,Ml,Sl,ue,{})}}function Il(t,e){let l=document.createElement("a");l.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),l.setAttribute("download",t),document.body.appendChild(l),l.click(),document.body.removeChild(l)}const Te={"Any type of junction":{"All movements":{scoreZero:["Cycle movement in potential conflict with heavy motor traffic flow.","Cycle movement mixed with or crossing traffic with 85th percentile speed exceeding 60kph, or where vehicles accelerate rapidly.","Necessary to cross more than one traffic lane (without refuge or protection) to complete cycle movement unless traffic flows are low.","Cycle movement crosses wide junction entry or exit: e.g. with merge or diverge taper or slip lane.","Pinch points on junction entry or exit (lane width 3.2m-3.9m).","Cycle movement affected by very poor surface quality utility reinstatement, gully positioning, debris."],scoreOne:["Cycle movement in potential conflict with moderate traffic flow.","Cycle lanes through junction meeting appropriate desirable minimum width requirements for the movement under consideration.","Raised table at junction crossed by traffic in potential conflict with cycle movement.","Cycle movement made by transiting onto section of shared use footway."],scoreTwo:["Low traffic speed and volume in mixed traffic environment (e.g. access-only streets in a residential area).","Cycle movement separated physically and/or in time from motor traffic and also separated from pedestrians.","Cycle movement bypasses junction completely, including via good quality grade separation."]}},"Simple priority T-junction":{"Right turn from minor arm":{scoreZero:["Heavy traffic movements and/or high bus and HGV flows in potential conflict with cycle movement, with no physical refuge in the centre of the major road (including ghost island junction)."],scoreOne:["Central refuge allowing two-stage cycle movement crossing one traffic lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm with dedicated cycle signals or cycle priority."]},"Left turn from major arm":{scoreZero:[],scoreOne:["Side road entry treatment (table across minor arm)."],scoreTwo:["Continuous footway and cycle track across minor arm."]},"Right turn from major arm":{scoreZero:["Heavy traffic movements and/or high bus and HGV flows in potential conflict with no physical refuge in the centre of major road (including ghost island junction)."],scoreOne:["Protected turning refuge allowing two stage cycle movement, crossing one lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm via dedicated cycle signals or cycle priority."]},"Ahead on major arm, crossing minor arm":{scoreZero:["Congested conditions causing poor visibility for right-turning motor vehicles from major arm.","Junction corner radius ≥9m, including where off-carriageway cycle track crosses minor arm."],scoreOne:["Junction free from queueing traffic and cycle lane on major arm meeting desirable minimum width requirements.","Junction corner radius <9m, including where off-carriageway cycle track crosses minor arm without priority.","Side road entry treatment (table across minor arm)."],scoreTwo:["Off-carriageway cycle track or stepped cycle track alongside major arm, crossing minor arm with priority over turning traffic."]}},Crossroads:{"Ahead from minor arm":{scoreZero:["Heavy opposing traffic movements with no physical refuge (including ghost island junction)."],scoreOne:["Protected pocket refuge for ahead cycles allowing two stage movement, crossing one lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm via dedicated cycle signals or cycle priority."]}},"Traffic Signals":{"All movements":{scoreZero:["Single or multiple queuing lanes with no cycle lanes or tracks on approaches.","Junctions with unsignalised left turn merge/diverge and signalised ahead lanes."],scoreOne:["Advance Cycle Stop lines, at least 5m deep and where the signals on the approach are on green for <30% of the cycle time.","Signal timings adjusted to provide extended intergreen to suit cycle movement under consideration.","Cycle/pedestrian scramble (toucan crossings with all-red stage).","Early release for cycles, with enough time to clear junction for cycle movement being considered."],scoreTwo:["Cycle movement has no potential conflict with motor traffic, e.g. dedicated cycle stage, conflicting traffic movement held or banned."]},"Right turn":{scoreZero:[],scoreOne:["Two-stage right turn via ASL or marked area in front of stop line."],scoreTwo:["Two-stage right turn with physically protected waiting area."]}},Roundabout:{"All movements":{scoreZero:["Any type of roundabout with high traffic throughput.","Normal roundabout with multi-lane flared approaches.","Any type of roundabout with annular cycle lane marked on the circulatory carriageway."],scoreOne:["Compact roundabout or raised mini roundabout with no more than moderate traffic throughput","Off-carriageway cycle track with crossings of entries and exits without cycle priority, crossing single traffic lanes with traffic flows < 4000 vehicles per day or 400 HGV/bus flow. "],scoreTwo:["Off-carriageway cycle track with crossings of entries and exits with signals or cycle priority."]}}},nt=Object.keys(Te);function Xe(t){return Object.keys(Te[t])}const Ae="All movements";function vt(t,e){let l=[],n=Te[t][e];n&&l.push({junctionType:t,movementType:e,...n});let r=Te[t][Ae];if(r&&e!=Ae&&l.push({junctionType:t,movementType:Ae,...r}),t=="Crossroads"){let o=Te["Simple priority T-junction"][Ae];o&&l.push({junctionType:"Simple priority T-junction",movementType:Ae,...o})}if(t!="Any type of junction"){let o=Te["Any type of junction"][Ae];o&&l.push({junctionType:"Any type of junction",movementType:Ae,...o})}return l}function wt(t,e,l){const n=t.slice();return n[10]=e[l],n}function yt(t,e,l){const n=t.slice();return n[13]=e[l],n}function jt(t,e,l){const n=t.slice();return n[13]=e[l],n}function Ct(t,e,l){const n=t.slice();return n[13]=e[l],n}function At(t,e,l){const n=t.slice();return n[20]=e[l],n}function Tt(t,e,l){const n=t.slice();return n[20]=e[l],n}function Lt(t){let e,l;return e=new jn({props:{$$slots:{default:[Nl]},$$scope:{ctx:t}}}),e.$on("close",t[9]),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p(n,r){const o={};r&33554439&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function St(t){let e,l,n,r,o,i,a,s;return i=Ve(t[6][1]),{c(){e=k("label"),l=k("input"),n=I(),r=Z(t[20]),o=I(),B(l,"type","radio"),l.__value=t[20],se(l,l.__value),i.p(l)},m(c,u){v(c,e,u),m(e,l),l.checked=l.__value===t[1],m(e,n),m(e,r),m(e,o),a||(s=[W(l,"change",t[5]),W(l,"change",t[3])],a=!0)},p(c,u){u&2&&(l.checked=l.__value===c[1])},d(c){c&&w(e),i.r(),a=!1,ve(s)}}}function Mt(t){let e,l,n,r=!1,o,i=t[20]+"",a,s,c,u,f;return c=Ve(t[6][0]),{c(){e=k("label"),l=k("input"),o=I(),a=Z(i),s=I(),B(l,"type","radio"),l.__value=n=t[20],se(l,l.__value),c.p(l)},m(d,p){v(d,e,p),m(e,l),l.checked=l.__value===t[2],m(e,o),m(e,a),m(e,s),u||(f=W(l,"change",t[7]),u=!0)},p(d,p){p&2&&n!==(n=d[20])&&(l.__value=n,se(l,l.__value),r=!0),(r||p&6)&&(l.checked=l.__value===d[2]),p&2&&i!==(i=d[20]+"")&&re(a,i)},d(d){d&&w(e),c.r(),u=!1,f()}}}function It(t){let e,l=t[13]+"",n;return{c(){e=k("li"),n=Z(l)},m(r,o){v(r,e,o),m(e,n)},p(r,o){o&6&&l!==(l=r[13]+"")&&re(n,l)},d(r){r&&w(e)}}}function Nt(t){let e,l=t[13]+"",n;return{c(){e=k("li"),n=Z(l)},m(r,o){v(r,e,o),m(e,n)},p(r,o){o&6&&l!==(l=r[13]+"")&&re(n,l)},d(r){r&&w(e)}}}function Et(t){let e,l=t[13]+"",n;return{c(){e=k("li"),n=Z(l)},m(r,o){v(r,e,o),m(e,n)},p(r,o){o&6&&l!==(l=r[13]+"")&&re(n,l)},d(r){r&&w(e)}}}function qt(t){let e,l,n=t[10].junctionType+"",r,o,i,a,s,c,u=t[10].movementType+"",f,d,p,_,g,D,b,j,N,R,q,P=V(t[10].scoreZero),F=[];for(let h=0;h<P.length;h+=1)F[h]=It(Ct(t,P,h));let L=V(t[10].scoreOne),z=[];for(let h=0;h<L.length;h+=1)z[h]=Nt(jt(t,L,h));let T=V(t[10].scoreTwo),S=[];for(let h=0;h<T.length;h+=1)S[h]=Et(yt(t,T,h));return{c(){e=k("tr"),l=k("td"),r=Z(n),o=I(),i=k("br"),a=I(),s=k("br"),c=I(),f=Z(u),d=I(),p=k("td"),_=k("ul");for(let h=0;h<F.length;h+=1)F[h].c();g=I(),D=k("td"),b=k("ul");for(let h=0;h<z.length;h+=1)z[h].c();j=I(),N=k("td"),R=k("ul");for(let h=0;h<S.length;h+=1)S[h].c();q=I(),B(l,"class","type-row svelte-k4kgn3"),B(p,"class","score-zero svelte-k4kgn3"),B(D,"class","score-one svelte-k4kgn3"),B(N,"class","score-two svelte-k4kgn3")},m(h,K){v(h,e,K),m(e,l),m(l,r),m(l,o),m(l,i),m(l,a),m(l,s),m(l,c),m(l,f),m(e,d),m(e,p),m(p,_);for(let $=0;$<F.length;$+=1)F[$]&&F[$].m(_,null);m(e,g),m(e,D),m(D,b);for(let $=0;$<z.length;$+=1)z[$]&&z[$].m(b,null);m(e,j),m(e,N),m(N,R);for(let $=0;$<S.length;$+=1)S[$]&&S[$].m(R,null);m(e,q)},p(h,K){if(K&6&&n!==(n=h[10].junctionType+"")&&re(r,n),K&6&&u!==(u=h[10].movementType+"")&&re(f,u),K&6){P=V(h[10].scoreZero);let $;for($=0;$<P.length;$+=1){const Y=Ct(h,P,$);F[$]?F[$].p(Y,K):(F[$]=It(Y),F[$].c(),F[$].m(_,null))}for(;$<F.length;$+=1)F[$].d(1);F.length=P.length}if(K&6){L=V(h[10].scoreOne);let $;for($=0;$<L.length;$+=1){const Y=jt(h,L,$);z[$]?z[$].p(Y,K):(z[$]=Nt(Y),z[$].c(),z[$].m(b,null))}for(;$<z.length;$+=1)z[$].d(1);z.length=L.length}if(K&6){T=V(h[10].scoreTwo);let $;for($=0;$<T.length;$+=1){const Y=yt(h,T,$);S[$]?S[$].p(Y,K):(S[$]=Et(Y),S[$].c(),S[$].m(R,null))}for(;$<S.length;$+=1)S[$].d(1);S.length=T.length}},d(h){h&&w(e),oe(F,h),oe(z,h),oe(S,h)}}}function Nl(t){let e,l,n,r,o,i,a,s,c,u,f,d,p,_,g,D,b,j=V(nt),N=[];for(let L=0;L<j.length;L+=1)N[L]=St(Tt(t,j,L));let R=V(Xe(t[1])),q=[];for(let L=0;L<R.length;L+=1)q[L]=Mt(At(t,R,L));let P=V(vt(t[1],t[2])),F=[];for(let L=0;L<P.length;L+=1)F[L]=qt(wt(t,P,L));return{c(){e=k("h1"),e.textContent="LTN 1/20 scoring guidance",l=I(),n=k("p"),n.innerHTML=`Guidance from <a target="_blank" href="https://assets.publishing.service.gov.uk/media/5ffa1f96d3bf7f65d9e35825/cycle-infrastructure-design-ltn-1-20.pdf">LTN 1/20 appendix B</a>
      .`,r=I(),o=k("div"),i=Z(`Type of junction:
      `),a=k("fieldset");for(let L=0;L<N.length;L+=1)N[L].c();s=Z(`

      Type of movement:
      `),c=k("fieldset");for(let L=0;L<q.length;L+=1)q[L].c();u=I(),f=k("table"),d=k("tr"),d.innerHTML=`<th class="type-header svelte-k4kgn3">Type of junction and movement</th> <th class="score-zero-header svelte-k4kgn3"><p class="svelte-k4kgn3"><b>Score = 0</b></p> <p class="svelte-k4kgn3">Suitable only for confident existing cyclists, and may be avoided by
            some experienced cyclists</p> <p class="svelte-k4kgn3">Conditions are most likely to give rise to the most common collision
            types</p></th> <th class="score-one-header svelte-k4kgn3"><p class="svelte-k4kgn3"><b>Score = 1</b></p> <p class="svelte-k4kgn3">Likely to be more acceptable to most cyclists, but may still pose
            problems for less confident or new cyclists</p> <p class="svelte-k4kgn3">The risk of collisions has been reduced by design layout or traffic
            management interventions</p></th> <th class="score-two-header svelte-k4kgn3"><p class="svelte-k4kgn3"><b>Score = 2</b></p> <p class="svelte-k4kgn3">Suitable for all potential and existing cyclists</p> <p class="svelte-k4kgn3">The potential for collisions has been removed, or managed to a high
            standard of safety for cyclists</p></th>`,p=I();for(let L=0;L<F.length;L+=1)F[L].c();_=I(),g=k("button"),g.textContent="OK",x(o,"display","flex"),x(o,"justify-content","space-between")},m(L,z){v(L,e,z),v(L,l,z),v(L,n,z),v(L,r,z),v(L,o,z),m(o,i),m(o,a);for(let T=0;T<N.length;T+=1)N[T]&&N[T].m(a,null);m(o,s),m(o,c);for(let T=0;T<q.length;T+=1)q[T]&&q[T].m(c,null);v(L,u,z),v(L,f,z),m(f,d),m(f,p);for(let T=0;T<F.length;T+=1)F[T]&&F[T].m(f,null);v(L,_,z),v(L,g,z),D||(b=W(g,"click",t[8]),D=!0)},p(L,z){if(z&10){j=V(nt);let T;for(T=0;T<j.length;T+=1){const S=Tt(L,j,T);N[T]?N[T].p(S,z):(N[T]=St(S),N[T].c(),N[T].m(a,null))}for(;T<N.length;T+=1)N[T].d(1);N.length=j.length}if(z&6){R=V(Xe(L[1]));let T;for(T=0;T<R.length;T+=1){const S=At(L,R,T);q[T]?q[T].p(S,z):(q[T]=Mt(S),q[T].c(),q[T].m(c,null))}for(;T<q.length;T+=1)q[T].d(1);q.length=R.length}if(z&6){P=V(vt(L[1],L[2]));let T;for(T=0;T<P.length;T+=1){const S=wt(L,P,T);F[T]?F[T].p(S,z):(F[T]=qt(S),F[T].c(),F[T].m(f,null))}for(;T<F.length;T+=1)F[T].d(1);F.length=P.length}},d(L){L&&(w(e),w(l),w(n),w(r),w(o),w(u),w(f),w(_),w(g)),oe(N,L),oe(q,L),oe(F,L),D=!1,b()}}}function El(t){let e,l,n,r,o,i,a=t[0]&&Lt(t);return{c(){e=k("button"),e.textContent="LTN 1/20 scoring guidance",l=I(),a&&a.c(),n=We(),B(e,"class","secondary")},m(s,c){v(s,e,c),v(s,l,c),a&&a.m(s,c),v(s,n,c),r=!0,o||(i=W(e,"click",t[4]),o=!0)},p(s,[c]){s[0]?a?(a.p(s,c),c&1&&C(a,1)):(a=Lt(s),a.c(),C(a,1),a.m(n.parentNode,n)):a&&(fe(),M(a,1,1,()=>{a=null}),me())},i(s){r||(C(a),r=!0)},o(s){M(a),r=!1},d(s){s&&(w(e),w(l),w(n)),a&&a.d(s),o=!1,i()}}}function ql(t,e,l){let n=!1,r=nt[0],o=Xe(r)[0];function i(){l(2,o=Xe(r)[0])}const a=[[],[]],s=()=>l(0,n=!0);function c(){r=this.__value,l(1,r)}function u(){o=this.__value,l(2,o)}return[n,r,o,i,s,c,a,u,()=>l(0,n=!1),()=>l(0,n=!1)]}class Dl extends ae{constructor(e){super(),ce(this,e,ql,El,ue,{})}}function Dt(t,e,l){const n=t.slice();return n[11]=e[l][0],n[12]=e[l][1],n}function Pt(t){let e,l;return e=new Dl({}),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function Ot(t){let e,l,n,r=t[12]+"",o,i,a,s,c;return a=Ve(t[7][0]),{c(){e=k("label"),l=k("input"),n=I(),o=Z(r),i=I(),B(l,"type","radio"),l.__value=t[11],se(l,l.__value),a.p(l)},m(u,f){v(u,e,f),m(e,l),l.checked=l.__value===t[3].jats[t[0]].properties[t[1]].movements[t[2]].score,m(e,n),m(e,o),m(e,i),s||(c=W(l,"change",t[9]),s=!0)},p(u,f){f&15&&(l.checked=l.__value===u[3].jats[u[0]].properties[u[1]].movements[u[2]].score)},d(u){u&&w(e),a.r(),s=!1,c()}}}function Pl(t){let e,l,n,r,o,i,a,s,c,u,f,d,p,_,g,D,b,j,N,R,q,P,F,L=t[3].jats[t[0]].properties[t[1]].movements[t[2]].kind=="cycling"&&Pt(),z=V(t[4]),T=[];for(let S=0;S<z.length;S+=1)T[S]=Ot(Dt(t,z,S));return q=Ve(t[7][1]),{c(){e=k("label"),l=Z(`Name
  `),n=k("input"),r=I(),o=k("fieldset"),i=k("label"),a=k("input"),s=Z(`
    Cycling`),c=I(),u=k("label"),f=k("input"),d=Z(`
    Walking & Wheeling`),p=I(),L&&L.c(),_=I(),g=k("fieldset");for(let S=0;S<T.length;S+=1)T[S].c();D=I(),b=k("label"),j=Z(`Comments
  `),N=k("textarea"),B(n,"type","text"),B(a,"type","radio"),a.__value="cycling",se(a,a.__value),B(f,"type","radio"),f.__value="walking & wheeling",se(f,f.__value),q.p(a,f)},m(S,h){v(S,e,h),m(e,l),m(e,n),se(n,t[3].jats[t[0]].properties[t[1]].movements[t[2]].name),v(S,r,h),v(S,o,h),m(o,i),m(i,a),a.checked=a.__value===t[3].jats[t[0]].properties[t[1]].movements[t[2]].kind,m(i,s),m(o,c),m(o,u),m(u,f),f.checked=f.__value===t[3].jats[t[0]].properties[t[1]].movements[t[2]].kind,m(u,d),v(S,p,h),L&&L.m(S,h),v(S,_,h),v(S,g,h);for(let K=0;K<T.length;K+=1)T[K]&&T[K].m(g,null);v(S,D,h),v(S,b,h),m(b,j),m(b,N),se(N,t[3].jats[t[0]].properties[t[1]].movements[t[2]].notes),R=!0,P||(F=[W(n,"input",t[5]),W(a,"change",t[6]),W(f,"change",t[8]),W(N,"input",t[10])],P=!0)},p(S,[h]){if(h&15&&n.value!==S[3].jats[S[0]].properties[S[1]].movements[S[2]].name&&se(n,S[3].jats[S[0]].properties[S[1]].movements[S[2]].name),h&15&&(a.checked=a.__value===S[3].jats[S[0]].properties[S[1]].movements[S[2]].kind),h&15&&(f.checked=f.__value===S[3].jats[S[0]].properties[S[1]].movements[S[2]].kind),S[3].jats[S[0]].properties[S[1]].movements[S[2]].kind=="cycling"?L?h&15&&C(L,1):(L=Pt(),L.c(),C(L,1),L.m(_.parentNode,_)):L&&(fe(),M(L,1,1,()=>{L=null}),me()),h&31){z=V(S[4]);let K;for(K=0;K<z.length;K+=1){const $=Dt(S,z,K);T[K]?T[K].p($,h):(T[K]=Ot($),T[K].c(),T[K].m(g,null))}for(;K<T.length;K+=1)T[K].d(1);T.length=z.length}h&15&&se(N,S[3].jats[S[0]].properties[S[1]].movements[S[2]].notes)},i(S){R||(C(L),R=!0)},o(S){M(L),R=!1},d(S){S&&(w(e),w(r),w(o),w(p),w(_),w(g),w(D),w(b)),L&&L.d(S),oe(T,S),q.r(),P=!1,ve(F)}}}function Ol(t,e,l){let n;ne(t,Q,_=>l(3,n=_));let{junctionIdx:r}=e,{stage:o}=e,{idx:i}=e,a=[["X","X - black"],["0","0 - red"],["1","1 - amber"],["2","2 - green"]];const s=[[],[]];function c(){n.jats[r].properties[o].movements[i].name=this.value,Q.set(n)}function u(){n.jats[r].properties[o].movements[i].kind=this.__value,Q.set(n)}function f(){n.jats[r].properties[o].movements[i].kind=this.__value,Q.set(n)}function d(){n.jats[r].properties[o].movements[i].score=this.__value,Q.set(n)}function p(){n.jats[r].properties[o].movements[i].notes=this.value,Q.set(n)}return t.$$set=_=>{"junctionIdx"in _&&l(0,r=_.junctionIdx),"stage"in _&&l(1,o=_.stage),"idx"in _&&l(2,i=_.idx)},[r,o,i,n,a,c,u,s,f,d,p]}class Fl extends ae{constructor(e){super(),ce(this,e,Ol,Pl,ue,{junctionIdx:0,stage:1,idx:2})}}function Jl(t){return t%(2*Math.PI)*180/Math.PI}function Be(t){return t%360*Math.PI/180}function Ft(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Cn(t,e,l={}){if(l.final===!0)return zl(t,e);const n=Ft(t),r=Ft(e),o=Be(n[0]),i=Be(r[0]),a=Be(n[1]),s=Be(r[1]),c=Math.sin(i-o)*Math.cos(s),u=Math.cos(a)*Math.sin(s)-Math.sin(a)*Math.cos(s)*Math.cos(i-o);return Jl(Math.atan2(c,u))}function zl(t,e){let l=Cn(e,t);return l=(l+180)%360,l}var Le=Cn;function Bl(t,e,l={}){const n={type:"Feature"};return(l.id===0||l.id)&&(n.id=l.id),l.bbox&&(n.bbox=l.bbox),n.properties=e||{},n.geometry=t,n}function Rl(t,e,l={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Jt(t[0])||!Jt(t[1]))throw new Error("coordinates must contain numbers");return Bl({type:"Point",coordinates:t},e,l)}function Jt(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function Gl(t,e={}){const l=qn(t),n=(l[0]+l[2])/2,r=(l[1]+l[3])/2;return Rl([n,r],e.properties,e)}var Hl=Gl,ge=63710088e-1,Ul={centimeters:ge*100,centimetres:ge*100,degrees:360/(2*Math.PI),feet:ge*3.28084,inches:ge*39.37,kilometers:ge/1e3,kilometres:ge/1e3,meters:ge,metres:ge,miles:ge/1609.344,millimeters:ge*1e3,millimetres:ge*1e3,nauticalmiles:ge/1852,radians:1,yards:ge*1.0936};function Zl(t,e,l={}){const n={type:"Feature"};return(l.id===0||l.id)&&(n.id=l.id),l.bbox&&(n.bbox=l.bbox),n.properties=e||{},n.geometry=t,n}function Kl(t,e,l={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Bt(t[0])||!Bt(t[1]))throw new Error("coordinates must contain numbers");return Zl({type:"Point",coordinates:t},e,l)}function Xl(t,e="kilometers"){const l=Ul[e];if(!l)throw new Error(e+" units is invalid");return t/l}function zt(t){return t%(2*Math.PI)*180/Math.PI}function Ye(t){return t%360*Math.PI/180}function Bt(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function Wl(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Vl(t,e,l,n={}){const r=Wl(t),o=Ye(r[0]),i=Ye(r[1]),a=Ye(l),s=Xl(e,n.units),c=Math.asin(Math.sin(i)*Math.cos(s)+Math.cos(i)*Math.sin(s)*Math.cos(a)),u=o+Math.atan2(Math.sin(a)*Math.sin(s)*Math.cos(i),Math.cos(s)-Math.sin(i)*Math.sin(c)),f=zt(u),d=zt(c);return Kl([f,d],n.properties)}var Pe=Vl,he=63710088e-1,Ql={centimeters:he*100,centimetres:he*100,degrees:360/(2*Math.PI),feet:he*3.28084,inches:he*39.37,kilometers:he/1e3,kilometres:he/1e3,meters:he,metres:he,miles:he/1609.344,millimeters:he*1e3,millimetres:he*1e3,nauticalmiles:he/1852,radians:1,yards:he*1.0936};function Yl(t,e="kilometers"){const l=Ql[e];if(!l)throw new Error(e+" units is invalid");return t*l}function Re(t){return t%360*Math.PI/180}function Rt(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function xl(t,e,l={}){var n=Rt(t),r=Rt(e),o=Re(r[1]-n[1]),i=Re(r[0]-n[0]),a=Re(n[1]),s=Re(r[1]),c=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(a)*Math.cos(s);return Yl(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),l.units)}var er=xl;function tr(t){let e=Hl({type:"FeatureCollection",features:t.map(n=>({type:"Feature",geometry:{type:"Point",coordinates:n.point},properties:{}}))}).geometry.coordinates;t.sort((n,r)=>Gt(Le(e,r.point))-Gt(Le(e,n.point)));let l=[];for(let n=0;n<t.length;n++){let r=t[n],o=Le(r.point,e),i=1;for(let a of lr(n,t.length)){let s=t[a],c=Le(e,s.point),u=nr(r.point,e,i++),f=er(r.point,e),d=Pe(u,.5*f,o).geometry.coordinates,p=Pe(d,.2*f,c).geometry.coordinates;l.push({point1:u,point2:d,point3:p,kind:"cycling",score:"X",name:`${r.name} to ${s.name}`,notes:""})}}return l}function nr(t,e,l){let n=.003,o=Le(t,e)-90,i=n*l;return Pe(t,i,o).geometry.coordinates}function Gt(t){return(t+360)%360}function lr(t,e){let l=[];for(let n=t+1;n<e;n++)l.push(n);for(let n=0;n<t;n++)l.push(n);return l}const rr="/route-element/assets/movement-aa45473c.svg",or="/route-element/assets/pan-fbcec4cd.svg";function Ht(t,e,l){const n=t.slice();return n[31]=e[l],n[32]=e,n[33]=l,n}function Ut(t,e,l){const n=t.slice();return n[34]=e[l],n[35]=e,n[33]=l,n}function Zt(t){let e,l,n,r,o,i,a,s,c,u,f,d,p,_,g,D,b,j,N;function R(K,$){return K[0].mode=="select"?sr:ir}let q=R(t),P=q(t);function F(K,$){return K[0].mode=="new-arm"?cr:ar}let L=F(t),z=L(t);function T(K,$){return K[0].mode=="new-movement"?fr:ur}let S=T(t),h=S(t);return{c(){e=k("div"),l=k("button"),n=k("img"),o=I(),P.c(),i=I(),a=k("button"),s=Qe("svg"),c=Qe("circle"),u=Qe("text"),f=Z("A"),d=I(),z.c(),p=I(),_=k("button"),g=k("img"),b=I(),h.c(),xe(n.src,r=or)||B(n,"src",r),B(n,"alt","Move map"),x(n,"vertical-align","middle"),B(l,"class","outline"),B(c,"cx","12"),B(c,"cy","12"),B(c,"r","12"),B(c,"fill","white"),B(u,"x","6"),B(u,"y","16"),B(u,"fill","#4472c4"),B(s,"width","24"),B(s,"height","24"),B(s,"xmlns","http://www.w3.org/2000/svg"),x(s,"vertical-align","middle"),B(a,"class","outline"),xe(g.src,D=rr)||B(g,"src",D),B(g,"alt","New movement"),x(g,"vertical-align","middle"),B(_,"class","outline"),B(e,"class","control-panel svelte-l1e6xi")},m(K,$){v(K,e,$),m(e,l),m(l,n),m(l,o),P.m(l,null),m(e,i),m(e,a),m(a,s),m(s,c),m(s,u),m(u,f),m(a,d),z.m(a,null),m(e,p),m(e,_),m(_,g),m(_,b),h.m(_,null),j||(N=[W(l,"click",function(){Dn(t[4])&&t[4].apply(this,arguments)}),W(a,"click",t[12]),W(_,"click",t[13])],j=!0)},p(K,$){t=K,q!==(q=R(t))&&(P.d(1),P=q(t),P&&(P.c(),P.m(l,null))),L!==(L=F(t))&&(z.d(1),z=L(t),z&&(z.c(),z.m(a,null))),S!==(S=T(t))&&(h.d(1),h=S(t),h&&(h.c(),h.m(_,null)))},d(K){K&&w(e),P.d(),z.d(),h.d(),j=!1,ve(N)}}}function ir(t){let e;return{c(){e=Z("Move map")},m(l,n){v(l,e,n)},d(l){l&&w(e)}}}function sr(t){let e;return{c(){e=k("b"),e.textContent="Move map"},m(l,n){v(l,e,n)},d(l){l&&w(e)}}}function ar(t){let e;return{c(){e=Z("New arm")},m(l,n){v(l,e,n)},d(l){l&&w(e)}}}function cr(t){let e;return{c(){e=k("b"),e.textContent="New arm"},m(l,n){v(l,e,n)},d(l){l&&w(e)}}}function ur(t){let e;return{c(){e=Z("New movement")},m(l,n){v(l,e,n)},d(l){l&&w(e)}}}function fr(t){let e;return{c(){e=k("b"),e.textContent="New movement"},m(l,n){v(l,e,n)},d(l){l&&w(e)}}}function mr(t){let e;return{c(){e=k("span"),e.textContent=`${jr(t[33])}`,B(e,"class","dot svelte-l1e6xi"),x(e,"color","#4472c4"),x(e,"background-color","white")},m(l,n){v(l,e,n)},p:ee,d(l){l&&w(e)}}}function Kt(t){let e,l,n;function r(s){t[14](s,t[34])}function o(){return t[15](t[33])}function i(){return t[16](t[33])}let a={draggable:!0,$$slots:{default:[mr]},$$scope:{ctx:t}};return t[34].point!==void 0&&(a.lngLat=t[34].point),e=new Se({props:a}),de.push(()=>we(e,"lngLat",r)),e.$on("dragend",o),e.$on("click",i),{c(){G(e.$$.fragment)},m(s,c){H(e,s,c),n=!0},p(s,c){t=s;const u={};c[1]&32&&(u.$$scope={dirty:c,ctx:t}),!l&&c[0]&38&&(l=!0,u.lngLat=t[34].point,ye(()=>l=!1)),e.$set(u)},i(s){n||(C(e.$$.fragment,s),n=!0)},o(s){M(e.$$.fragment,s),n=!1},d(s){U(e,s)}}}function dr(t){let e;return{c(){e=k("span"),B(e,"class","dot svelte-l1e6xi"),x(e,"background-color",t[7][t[31].score]),x(e,"opacity",t[31].kind=="walking & wheeling"?"0%":"100%")},m(l,n){v(l,e,n)},p(l,n){n[0]&38&&x(e,"background-color",l[7][l[31].score]),n[0]&38&&x(e,"opacity",l[31].kind=="walking & wheeling"?"0%":"100%")},d(l){l&&w(e)}}}function pr(t){let e;return{c(){e=k("span"),B(e,"class","dot svelte-l1e6xi"),x(e,"background-color",t[7][t[31].score])},m(l,n){v(l,e,n)},p(l,n){n[0]&38&&x(e,"background-color",l[7][l[31].score])},d(l){l&&w(e)}}}function _r(t){let e;return{c(){e=k("span"),B(e,"class","dot svelte-l1e6xi"),x(e,"background-color",t[7][t[31].score]),x(e,"opacity","0%")},m(l,n){v(l,e,n)},p(l,n){n[0]&38&&x(e,"background-color",l[7][l[31].score])},d(l){l&&w(e)}}}function Xt(t){let e,l,n,r,o,i,a,s,c;function u(P){t[17](P,t[31])}function f(){return t[18](t[33])}function d(){return t[19](t[33])}let p={draggable:!0,$$slots:{default:[dr]},$$scope:{ctx:t}};t[31].point1!==void 0&&(p.lngLat=t[31].point1),e=new Se({props:p}),de.push(()=>we(e,"lngLat",u)),e.$on("dragend",f),e.$on("click",d);function _(P){t[20](P,t[31])}function g(){return t[21](t[33])}function D(){return t[22](t[33])}let b={draggable:!0,$$slots:{default:[pr]},$$scope:{ctx:t}};t[31].point2!==void 0&&(b.lngLat=t[31].point2),r=new Se({props:b}),de.push(()=>we(r,"lngLat",_)),r.$on("dragend",g),r.$on("click",D);function j(P){t[23](P,t[31])}function N(){return t[24](t[33])}function R(){return t[25](t[33])}let q={draggable:!0,$$slots:{default:[_r]},$$scope:{ctx:t}};return t[31].point3!==void 0&&(q.lngLat=t[31].point3),a=new Se({props:q}),de.push(()=>we(a,"lngLat",j)),a.$on("dragend",N),a.$on("click",R),{c(){G(e.$$.fragment),n=I(),G(r.$$.fragment),i=I(),G(a.$$.fragment)},m(P,F){H(e,P,F),v(P,n,F),H(r,P,F),v(P,i,F),H(a,P,F),c=!0},p(P,F){t=P;const L={};F[0]&38|F[1]&32&&(L.$$scope={dirty:F,ctx:t}),!l&&F[0]&38&&(l=!0,L.lngLat=t[31].point1,ye(()=>l=!1)),e.$set(L);const z={};F[0]&38|F[1]&32&&(z.$$scope={dirty:F,ctx:t}),!o&&F[0]&38&&(o=!0,z.lngLat=t[31].point2,ye(()=>o=!1)),r.$set(z);const T={};F[0]&38|F[1]&32&&(T.$$scope={dirty:F,ctx:t}),!s&&F[0]&38&&(s=!0,T.lngLat=t[31].point3,ye(()=>s=!1)),a.$set(T)},i(P){c||(C(e.$$.fragment,P),C(r.$$.fragment,P),C(a.$$.fragment,P),c=!0)},o(P){M(e.$$.fragment,P),M(r.$$.fragment,P),M(a.$$.fragment,P),c=!1},d(P){P&&(w(n),w(i)),U(e,P),U(r,P),U(a,P)}}}function gr(t){let e=(t[30].name||"Untitled movement")+"",l;return{c(){l=Z(e)},m(n,r){v(n,l,r)},p(n,r){r[0]&1073741824&&e!==(e=(n[30].name||"Untitled movement")+"")&&re(l,e)},d(n){n&&w(l)}}}function hr(t){let e,l;return e=new $n({props:{$$slots:{default:[gr,({props:n})=>({30:n}),({props:n})=>[n?1073741824:0]]},$$scope:{ctx:t}}}),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p(n,r){const o={};r[0]&1073741824|r[1]&32&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function kr(t){let e=(t[30].name||"Untitled movement")+"",l;return{c(){l=Z(e)},m(n,r){v(n,l,r)},p(n,r){r[0]&1073741824&&e!==(e=(n[30].name||"Untitled movement")+"")&&re(l,e)},d(n){n&&w(l)}}}function br(t){let e,l;return e=new $n({props:{$$slots:{default:[kr,({props:n})=>({30:n}),({props:n})=>[n?1073741824:0]]},$$scope:{ctx:t}}}),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p(n,r){const o={};r[0]&1073741824|r[1]&32&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function $r(t){let e,l,n,r,o,i;return e=new qe({props:{id:"jat-cycling",manageHoverState:!0,paint:{"line-width":Ue(6,10),"line-color":["get","color"]},filter:["==",["get","kind"],"cycling"],$$slots:{default:[hr]},$$scope:{ctx:t}}}),e.$on("click",t[9]),n=new qe({props:{id:"jat-walking-wheeling",manageHoverState:!0,paint:{"line-width":Ue(6,8),"line-color":["get","color"],"line-dasharray":[3,2]},filter:["==",["get","kind"],"walking & wheeling"],$$slots:{default:[br]},$$scope:{ctx:t}}}),n.$on("click",t[9]),o=new Un({props:{id:"jat-arrow",filter:["has","angle"],paint:{"text-color":["get","color"],"text-halo-color":"white","text-halo-width":3},layout:{"text-field":"⬆","text-overlap":"always","text-rotate":["get","angle"],"text-size":70}}}),{c(){G(e.$$.fragment),l=I(),G(n.$$.fragment),r=I(),G(o.$$.fragment)},m(a,s){H(e,a,s),v(a,l,s),H(n,a,s),v(a,r,s),H(o,a,s),i=!0},p(a,s){const c={};s[1]&32&&(c.$$scope={dirty:s,ctx:a}),e.$set(c);const u={};s[1]&32&&(u.$$scope={dirty:s,ctx:a}),n.$set(u)},i(a){i||(C(e.$$.fragment,a),C(n.$$.fragment,a),C(o.$$.fragment,a),i=!0)},o(a){M(e.$$.fragment,a),M(n.$$.fragment,a),M(o.$$.fragment,a),i=!1},d(a){a&&(w(l),w(r)),U(e,a),U(n,a),U(o,a)}}}function vr(t){let e,l,n,r;return e=new qe({props:{paint:{"line-width":5,"line-color":"yellow","line-gap-width":45}}}),n=new Fe({props:{filter:["==",["get","kind"],"arm"],paint:{"circle-radius":20,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){G(e.$$.fragment),l=I(),G(n.$$.fragment)},m(o,i){H(e,o,i),v(o,l,i),H(n,o,i),r=!0},p:ee,i(o){r||(C(e.$$.fragment,o),C(n.$$.fragment,o),r=!0)},o(o){M(e.$$.fragment,o),M(n.$$.fragment,o),r=!1},d(o){o&&w(l),U(e,o),U(n,o)}}}function wr(t){let e,l,n,r,o,i,a,s,c;e=new vn({}),e.$on("click",t[8]);let u=t[0].mode!="editing"&&Zt(t),f=V(t[5].jats[t[1]].properties[t[2]].arms),d=[];for(let b=0;b<f.length;b+=1)d[b]=Kt(Ut(t,f,b));const p=b=>M(d[b],1,1,()=>{d[b]=null});let _=V(t[5].jats[t[1]].properties[t[2]].movements),g=[];for(let b=0;b<_.length;b+=1)g[b]=Xt(Ht(t,_,b));const D=b=>M(g[b],1,1,()=>{g[b]=null});return i=new je({props:{data:t[10](t[5]),$$slots:{default:[$r]},$$scope:{ctx:t}}}),s=new je({props:{data:t[6],$$slots:{default:[vr]},$$scope:{ctx:t}}}),{c(){G(e.$$.fragment),l=I(),u&&u.c(),n=I();for(let b=0;b<d.length;b+=1)d[b].c();r=I();for(let b=0;b<g.length;b+=1)g[b].c();o=I(),G(i.$$.fragment),a=I(),G(s.$$.fragment)},m(b,j){H(e,b,j),v(b,l,j),u&&u.m(b,j),v(b,n,j);for(let N=0;N<d.length;N+=1)d[N]&&d[N].m(b,j);v(b,r,j);for(let N=0;N<g.length;N+=1)g[N]&&g[N].m(b,j);v(b,o,j),H(i,b,j),v(b,a,j),H(s,b,j),c=!0},p(b,j){if(b[0].mode!="editing"?u?u.p(b,j):(u=Zt(b),u.c(),u.m(n.parentNode,n)):u&&(u.d(1),u=null),j[0]&46){f=V(b[5].jats[b[1]].properties[b[2]].arms);let q;for(q=0;q<f.length;q+=1){const P=Ut(b,f,q);d[q]?(d[q].p(P,j),C(d[q],1)):(d[q]=Kt(P),d[q].c(),C(d[q],1),d[q].m(r.parentNode,r))}for(fe(),q=f.length;q<d.length;q+=1)p(q);me()}if(j[0]&174){_=V(b[5].jats[b[1]].properties[b[2]].movements);let q;for(q=0;q<_.length;q+=1){const P=Ht(b,_,q);g[q]?(g[q].p(P,j),C(g[q],1)):(g[q]=Xt(P),g[q].c(),C(g[q],1),g[q].m(o.parentNode,o))}for(fe(),q=_.length;q<g.length;q+=1)D(q);me()}const N={};j[0]&32&&(N.data=b[10](b[5])),j[1]&32&&(N.$$scope={dirty:j,ctx:b}),i.$set(N);const R={};j[0]&64&&(R.data=b[6]),j[1]&32&&(R.$$scope={dirty:j,ctx:b}),s.$set(R)},i(b){if(!c){C(e.$$.fragment,b);for(let j=0;j<f.length;j+=1)C(d[j]);for(let j=0;j<_.length;j+=1)C(g[j]);C(i.$$.fragment,b),C(s.$$.fragment,b),c=!0}},o(b){M(e.$$.fragment,b),d=d.filter(Boolean);for(let j=0;j<d.length;j+=1)M(d[j]);g=g.filter(Boolean);for(let j=0;j<g.length;j+=1)M(g[j]);M(i.$$.fragment,b),M(s.$$.fragment,b),c=!1},d(b){b&&(w(l),w(n),w(r),w(o),w(a)),U(e,b),u&&u.d(b),oe(d,b),oe(g,b),U(i,b),U(s,b)}}}function yr(t,e){return{type:"Feature",id:e,properties:{kind:"arm"},geometry:{type:"Point",coordinates:t.point}}}function jr(t){return String.fromCharCode(t+"A".charCodeAt(0))}function Cr(t,e,l){let n,r,o;ne(t,Q,E=>l(5,r=E)),ne(t,Ze,E=>l(26,o=E));let{junctionIdx:i}=e,{stage:a}=e,{mode:s}=e,{hoveringSidebar:c}=e,{select:u}=e,{stopEditing:f}=e,d={0:Ce.red.background,1:Ce.amber.background,2:Ce.green.background,X:Ce.critical.background};function p(E,J,_e){let O={type:"FeatureCollection",features:[]},y=J.mode=="editing"?J.id:_e;return y!=null&&(y.kind=="arm"?O.features.push(yr(E.jats[i].properties[a].arms[y.idx],y.idx)):O.features.push(b(E.jats[i].properties[a].movements[y.idx],y.idx))),O}async function _(E){if(o){for(let J of o.queryRenderedFeatures(E.detail.point,{layers:["jat-cycling","jat-walking-wheeling"]}))return;if(s.mode!="select"){if(s.mode=="editing"){await f();return}s.mode=="new-arm"?(te(Q,r.jats[i].properties[a].arms=[...r.jats[i].properties[a].arms,{point:E.detail.lngLat.toArray(),name:""}],r),await u({kind:"arm",idx:r.jats[i].properties[a].arms.length-1})):(te(Q,r.jats[i].properties[a].movements=[...r.jats[i].properties[a].movements,{point1:E.detail.lngLat.toArray(),point2:Pe(E.detail.lngLat.toArray(),.005,0).geometry.coordinates,point3:Pe(E.detail.lngLat.toArray(),.01,0).geometry.coordinates,kind:"cycling",score:"X",name:"",notes:""}],r),await u({kind:"movement",idx:r.jats[i].properties[a].movements.length-1}))}}}async function g(E){await u({kind:"movement",idx:E.detail.features[0].id})}function D(E){let J={type:"FeatureCollection",features:E.jats[i].properties[a].movements.map((_e,O)=>b(_e,O))};for(let _e of E.jats[i].properties[a].movements)if(J.features.push(j(_e,J.features.length)),_e.kind=="walking & wheeling"){let O={..._e,point1:_e.point3,point3:_e.point1};J.features.push(j(O,J.features.length))}return J}function b(E,J){return{type:"Feature",id:J,properties:{name:E.name,kind:E.kind,color:d[E.score]},geometry:{type:"LineString",coordinates:[E.point1,E.point2,E.point3]}}}function j(E,J){return{type:"Feature",id:J,properties:{kind:E.kind,color:d[E.score],angle:Le(E.point2,E.point3)},geometry:{type:"Point",coordinates:E.point3}}}const N=()=>l(0,s={mode:"new-arm"}),R=()=>l(0,s={mode:"new-movement"});function q(E,J){t.$$.not_equal(J.point,E)&&(J.point=E,Q.set(r))}const P=E=>u({kind:"arm",idx:E}),F=E=>u({kind:"arm",idx:E});function L(E,J){t.$$.not_equal(J.point1,E)&&(J.point1=E,Q.set(r))}const z=E=>u({kind:"movement",idx:E}),T=E=>u({kind:"movement",idx:E});function S(E,J){t.$$.not_equal(J.point2,E)&&(J.point2=E,Q.set(r))}const h=E=>u({kind:"movement",idx:E}),K=E=>u({kind:"movement",idx:E});function $(E,J){t.$$.not_equal(J.point3,E)&&(J.point3=E,Q.set(r))}const Y=E=>u({kind:"movement",idx:E}),ie=E=>u({kind:"movement",idx:E});return t.$$set=E=>{"junctionIdx"in E&&l(1,i=E.junctionIdx),"stage"in E&&l(2,a=E.stage),"mode"in E&&l(0,s=E.mode),"hoveringSidebar"in E&&l(11,c=E.hoveringSidebar),"select"in E&&l(3,u=E.select),"stopEditing"in E&&l(4,f=E.stopEditing)},t.$$.update=()=>{t.$$.dirty[0]&2081&&l(6,n=p(r,s,c))},[s,i,a,u,f,r,n,d,_,g,D,c,N,R,q,P,F,L,z,T,S,h,K,$,Y,ie]}class Ar extends ae{constructor(e){super(),ce(this,e,Cr,wr,ue,{junctionIdx:1,stage:2,mode:0,hoveringSidebar:11,select:3,stopEditing:4},null,[-1,-1])}}function Wt(t){if(t.movements.length==0)return"No movements added";let e=0,l=0;for(let r of t.movements)e+={0:0,1:1,2:2,X:0}[r.score],l+=2;let n=e/l*100;return`${Math.round(n)}%`}const{window:Tr}=lt;function Vt(t,e,l){const n=t.slice();n[27]=e[l],n[30]=l;const r=n[14][n[27].score];return n[28]=r,n}function Qt(t,e,l){const n=t.slice();return n[31]=e[l],n[30]=l,n}function Lr(t){let e,l,n,r,o,i,a,s,c;return{c(){e=k("button"),e.textContent="Done",l=I(),n=k("button"),n.textContent="Delete",r=I(),o=k("label"),i=Z(`Arm name
        `),a=k("input"),B(a,"type","text")},m(u,f){v(u,e,f),v(u,l,f),v(u,n,f),v(u,r,f),v(u,o,f),m(o,i),m(o,a),se(a,t[5].jats[t[0]].properties[t[1]].arms[t[2].id.idx].name),s||(c=[W(e,"click",t[23]),W(n,"click",t[10]),W(a,"input",t[24])],s=!0)},p(u,f){f[0]&39&&a.value!==u[5].jats[u[0]].properties[u[1]].arms[u[2].id.idx].name&&se(a,u[5].jats[u[0]].properties[u[1]].arms[u[2].id.idx].name)},i:ee,o:ee,d(u){u&&(w(e),w(l),w(n),w(r),w(o)),s=!1,ve(c)}}}function Sr(t){let e,l,n,r,o,i,a,s;return e=new Fl({props:{junctionIdx:t[0],stage:t[1],idx:t[2].id.idx}}),{c(){G(e.$$.fragment),l=I(),n=k("button"),n.textContent="Save",r=I(),o=k("button"),o.textContent="Delete"},m(c,u){H(e,c,u),v(c,l,u),v(c,n,u),v(c,r,u),v(c,o,u),i=!0,a||(s=[W(n,"click",t[9]),W(o,"click",t[10])],a=!0)},p(c,u){const f={};u[0]&1&&(f.junctionIdx=c[0]),u[0]&2&&(f.stage=c[1]),u[0]&4&&(f.idx=c[2].id.idx),e.$set(f)},i(c){i||(C(e.$$.fragment,c),i=!0)},o(c){M(e.$$.fragment,c),i=!1},d(c){c&&(w(l),w(n),w(r),w(o)),U(e,c),a=!1,ve(s)}}}function Mr(t){let e,l,n,r,o,i,a,s,c,u,f,d,p,_=t[5].jats[t[0]].properties.name+"",g,D,b=Wt(t[5].jats[t[0]].properties[t[1]])+"",j,N,R,q,P,F,L,z,T,S,h,K=V(t[5].jats[t[0]].properties[t[1]].arms),$=[];for(let y=0;y<K.length;y+=1)$[y]=Yt(Qt(t,K,y));const Y=y=>M($[y],1,1,()=>{$[y]=null});let ie=t[5].jats[t[0]].properties[t[7]].arms.length>0&&xt(t),E=V(t[5].jats[t[0]].properties[t[1]].movements),J=[];for(let y=0;y<E.length;y+=1)J[y]=en(Vt(t,E,y));const _e=y=>M(J[y],1,1,()=>{J[y]=null});let O=t[5].jats[t[0]].properties[t[7]].movements.length>0&&tn(t);return{c(){e=k("button"),e.textContent="Done",l=I(),n=k("h3"),n.textContent="Arms",r=I();for(let y=0;y<$.length;y+=1)$[y].c();o=I(),ie&&ie.c(),i=I(),a=k("h3"),a.textContent="Movements",s=I(),c=k("p"),u=Z("Total JAT score for "),f=Z(t[1]),d=Z(` junction
        `),p=k("i"),g=Z(_),D=Z(`
        : `),j=Z(b),N=I(),R=k("button"),q=Z("Generate cycling movements between all arms"),F=I();for(let y=0;y<J.length;y+=1)J[y].c();L=I(),O&&O.c(),z=We(),B(R,"class","secondary"),R.disabled=P=t[5].jats[t[0]].properties[t[1]].arms.length<2},m(y,A){v(y,e,A),v(y,l,A),v(y,n,A),v(y,r,A);for(let X=0;X<$.length;X+=1)$[X]&&$[X].m(y,A);v(y,o,A),ie&&ie.m(y,A),v(y,i,A),v(y,a,A),v(y,s,A),v(y,c,A),m(c,u),m(c,f),m(c,d),m(c,p),m(p,g),m(c,D),m(c,j),v(y,N,A),v(y,R,A),m(R,q),v(y,F,A);for(let X=0;X<J.length;X+=1)J[X]&&J[X].m(y,A);v(y,L,A),O&&O.m(y,A),v(y,z,A),T=!0,S||(h=[W(e,"click",t[16]),W(R,"click",t[15])],S=!0)},p(y,A){if(A[0]&299){K=V(y[5].jats[y[0]].properties[y[1]].arms);let X;for(X=0;X<K.length;X+=1){const De=Qt(y,K,X);$[X]?($[X].p(De,A),C($[X],1)):($[X]=Yt(De),$[X].c(),C($[X],1),$[X].m(o.parentNode,o))}for(fe(),X=K.length;X<$.length;X+=1)Y(X);me()}if(y[5].jats[y[0]].properties[y[7]].arms.length>0?ie?ie.p(y,A):(ie=xt(y),ie.c(),ie.m(i.parentNode,i)):ie&&(ie.d(1),ie=null),(!T||A[0]&2)&&re(f,y[1]),(!T||A[0]&33)&&_!==(_=y[5].jats[y[0]].properties.name+"")&&re(g,_),(!T||A[0]&35)&&b!==(b=Wt(y[5].jats[y[0]].properties[y[1]])+"")&&re(j,b),(!T||A[0]&35&&P!==(P=y[5].jats[y[0]].properties[y[1]].arms.length<2))&&(R.disabled=P),A[0]&16683){E=V(y[5].jats[y[0]].properties[y[1]].movements);let X;for(X=0;X<E.length;X+=1){const De=Vt(y,E,X);J[X]?(J[X].p(De,A),C(J[X],1)):(J[X]=en(De),J[X].c(),C(J[X],1),J[X].m(L.parentNode,L))}for(fe(),X=E.length;X<J.length;X+=1)_e(X);me()}y[5].jats[y[0]].properties[y[7]].movements.length>0?O?O.p(y,A):(O=tn(y),O.c(),O.m(z.parentNode,z)):O&&(O.d(1),O=null)},i(y){if(!T){for(let A=0;A<K.length;A+=1)C($[A]);for(let A=0;A<E.length;A+=1)C(J[A]);T=!0}},o(y){$=$.filter(Boolean);for(let A=0;A<$.length;A+=1)M($[A]);J=J.filter(Boolean);for(let A=0;A<J.length;A+=1)M(J[A]);T=!1},d(y){y&&(w(e),w(l),w(n),w(r),w(o),w(i),w(a),w(s),w(c),w(N),w(R),w(F),w(L),w(z)),oe($,y),ie&&ie.d(y),oe(J,y),O&&O.d(y),S=!1,ve(h)}}}function Yt(t){let e,l;function n(){return t[17](t[30])}function r(){return t[18](t[30])}return e=new yn({props:{name:`${nn(t[30])} - ${t[31].name||"Unnamed arm"}`,hasSlot:!1}}),e.$on("click",n),e.$on("mouseenter",r),e.$on("mouseleave",t[19]),{c(){G(e.$$.fragment)},m(o,i){H(e,o,i),l=!0},p(o,i){t=o;const a={};i[0]&35&&(a.name=`${nn(t[30])} - ${t[31].name||"Unnamed arm"}`),e.$set(a)},i(o){l||(C(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){U(e,o)}}}function xt(t){let e,l,n;return{c(){e=k("button"),e.textContent=`Copy arms from ${t[7]}`,B(e,"class","secondary")},m(r,o){v(r,e,o),l||(n=W(e,"click",t[12]),l=!0)},p:ee,d(r){r&&w(e),l=!1,n()}}}function Ir(t){let e,l,n,r=t[27].score+"",o,i,a,s=ln(t[27].kind)+"",c;return{c(){e=k("div"),l=k("span"),n=Z("Score: "),o=Z(r),i=I(),a=k("span"),c=Z(s),x(l,"padding","4px"),x(l,"color",t[28].font),x(l,"background-color",t[28].background),x(e,"width","100%"),x(e,"display","flex"),x(e,"justify-content","space-between")},m(u,f){v(u,e,f),m(e,l),m(l,n),m(l,o),m(e,i),m(e,a),m(a,c)},p(u,f){f[0]&35&&r!==(r=u[27].score+"")&&re(o,r),f[0]&35&&x(l,"color",u[28].font),f[0]&35&&x(l,"background-color",u[28].background),f[0]&35&&s!==(s=ln(u[27].kind)+"")&&re(c,s)},d(u){u&&w(e)}}}function en(t){let e,l;function n(){return t[20](t[30])}function r(){return t[21](t[30])}return e=new yn({props:{name:t[27].name||"Unnamed movement",$$slots:{default:[Ir]},$$scope:{ctx:t}}}),e.$on("click",n),e.$on("mouseenter",r),e.$on("mouseleave",t[22]),{c(){G(e.$$.fragment)},m(o,i){H(e,o,i),l=!0},p(o,i){t=o;const a={};i[0]&35&&(a.name=t[27].name||"Unnamed movement"),i[0]&35|i[1]&4&&(a.$$scope={dirty:i,ctx:t}),e.$set(a)},i(o){l||(C(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){U(e,o)}}}function tn(t){let e,l,n;return{c(){e=k("button"),e.textContent=`Copy movements from ${t[7]}`,B(e,"class","secondary")},m(r,o){v(r,e,o),l||(n=W(e,"click",t[13]),l=!0)},p:ee,d(r){r&&w(e),l=!1,n()}}}function Nr(t){let e,l,n,r,o=t[5].jats[t[0]].properties.name+"",i,a,s,c,u;const f=[Mr,Sr,Lr],d=[];function p(_,g){return _[2].mode!="editing"?0:_[2].id.kind=="movement"?1:2}return s=p(t),c=d[s]=f[s](t),{c(){e=k("div"),l=k("h2"),n=Z(t[1]),r=Z(" JAT for "),i=Z(o),a=I(),c.c(),B(e,"slot","sidebar")},m(_,g){v(_,e,g),m(e,l),m(l,n),m(l,r),m(l,i),m(e,a),d[s].m(e,null),t[25](e),u=!0},p(_,g){(!u||g[0]&2)&&re(n,_[1]),(!u||g[0]&33)&&o!==(o=_[5].jats[_[0]].properties.name+"")&&re(i,o);let D=s;s=p(_),s===D?d[s].p(_,g):(fe(),M(d[D],1,1,()=>{d[D]=null}),me(),c=d[s],c?c.p(_,g):(c=d[s]=f[s](_),c.c()),C(c,1),c.m(e,null))},i(_){u||(C(c),u=!0)},o(_){M(c),u=!1},d(_){_&&w(e),d[s].d(),t[25](null)}}}function Er(t){let e,l;return e=new Fe({props:{filter:["!=",["id"],t[0]],paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":"black","circle-radius":20}}}),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p(n,r){const o={};r[0]&1&&(o.filter=["!=",["id"],n[0]]),e.$set(o)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function qr(t){let e,l,n,r,o,i,a;return l=new rt({}),r=new je({props:{data:pe(t[5].jats),generateId:!0,$$slots:{default:[Er]},$$scope:{ctx:t}}}),i=new Ar({props:{junctionIdx:t[0],stage:t[1],mode:t[2],hoveringSidebar:t[3],select:t[8],stopEditing:t[9]}}),{c(){e=k("div"),G(l.$$.fragment),n=I(),G(r.$$.fragment),o=I(),G(i.$$.fragment),B(e,"slot","map")},m(s,c){v(s,e,c),H(l,e,null),m(e,n),H(r,e,null),m(e,o),H(i,e,null),a=!0},p(s,c){const u={};c[0]&32&&(u.data=pe(s[5].jats)),c[0]&1|c[1]&4&&(u.$$scope={dirty:c,ctx:s}),r.$set(u);const f={};c[0]&1&&(f.junctionIdx=s[0]),c[0]&2&&(f.stage=s[1]),c[0]&4&&(f.mode=s[2]),c[0]&8&&(f.hoveringSidebar=s[3]),i.$set(f)},i(s){a||(C(l.$$.fragment,s),C(r.$$.fragment,s),C(i.$$.fragment,s),a=!0)},o(s){M(l.$$.fragment,s),M(r.$$.fragment,s),M(i.$$.fragment,s),a=!1},d(s){s&&w(e),U(l),U(r),U(i)}}}function Dr(t){let e,l,n,r;return e=new Je({props:{$$slots:{map:[qr],sidebar:[Nr]},$$scope:{ctx:t}}}),{c(){G(e.$$.fragment)},m(o,i){H(e,o,i),l=!0,n||(r=W(Tr,"keydown",t[11]),n=!0)},p(o,i){const a={};i[0]&127|i[1]&4&&(a.$$scope={dirty:i,ctx:o}),e.$set(a)},i(o){l||(C(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){U(e,o),n=!1,r()}}}function nn(t){return String.fromCharCode(t+"A".charCodeAt(0))}function ln(t){return t.split(" ").map(e=>e.length>0?e[0].toUpperCase()+e.substr(1):e).join(" ")}function Pr(t,e,l){let n,r;ne(t,Q,$=>l(5,n=$)),ne(t,le,$=>l(6,r=$));let{junctionIdx:o}=e,{stage:i}=e,a=i=="existing"?"proposed":"existing",s={mode:"select"},c=null,u=null,f;async function d($){c=f.scrollTop,l(2,s={mode:"editing",id:$}),l(3,u=null),await Ge(),l(4,f.scrollTop=0,f)}async function p(){l(2,s={mode:"select"}),c!=null&&(await Ge(),l(4,f.scrollTop=c,f),c=null)}function _(){s.mode=="editing"&&window.confirm(`Delete this ${s.id.kind}?`)&&(s.id.kind=="movement"?(n.jats[o].properties[i].movements.splice(s.id.idx,1),Q.set(n)):(n.jats[o].properties[i].arms.splice(s.id.idx,1),Q.set(n)),p())}function g($){if(s.mode!="editing")return;let Y=$.target.tagName,ie=Y=="INPUT"||Y=="TEXTAREA";$.key=="Escape"||$.key=="Enter"&&!ie?($.stopPropagation(),p()):$.key=="Delete"&&!ie&&($.stopPropagation(),_())}function D(){n.jats[o].properties[i].arms.length>0&&!window.confirm("Overwrite arms?")||(te(Q,n.jats[o].properties[i].arms=JSON.parse(JSON.stringify(n.jats[o].properties[a].arms)),n),Q.set(n))}function b(){n.jats[o].properties[i].movements.length>0&&!window.confirm("Overwrite movements?")||(te(Q,n.jats[o].properties[i].movements=JSON.parse(JSON.stringify(n.jats[o].properties[a].movements)),n),Q.set(n))}let j={0:Ce.red,1:Ce.amber,2:Ce.green,X:Ce.critical};function N(){if(n.jats[o].properties[i].movements.length>0&&!window.confirm("Overwrite all cycling movements?"))return;let $=n.jats[o].properties[i].movements.filter(Y=>Y.kind=="walking & wheeling");te(Q,n.jats[o].properties[i].movements=[...$,...tr(n.jats[o].properties[i].arms)],n)}const R=()=>te(le,r={kind:"edit-jat",idx:o},r),q=$=>d({kind:"arm",idx:$}),P=$=>l(3,u={kind:"arm",idx:$}),F=()=>l(3,u=null),L=$=>d({kind:"movement",idx:$}),z=$=>l(3,u={kind:"movement",idx:$}),T=()=>l(3,u=null),S=()=>l(2,s={mode:"select"});function h(){n.jats[o].properties[i].arms[s.id.idx].name=this.value,Q.set(n)}function K($){de[$?"unshift":"push"](()=>{f=$,l(4,f)})}return t.$$set=$=>{"junctionIdx"in $&&l(0,o=$.junctionIdx),"stage"in $&&l(1,i=$.stage)},[o,i,s,u,f,n,r,a,d,p,_,g,D,b,j,N,R,q,P,F,L,z,T,S,h,K]}class Or extends ae{constructor(e){super(),ce(this,e,Pr,Dr,ue,{junctionIdx:0,stage:1},null,[-1,-1])}}const{window:Fr}=lt;function Jr(t){let e,l,n,r,o,i,a,s,c,u,f,d,p,_;return{c(){e=k("div"),l=k("button"),l.textContent="Done",n=I(),r=k("button"),r.textContent="Delete JAT",o=I(),i=k("label"),a=Z(`Name:
      `),s=k("input"),c=I(),u=k("button"),u.textContent="Existing",f=I(),d=k("button"),d.textContent="Proposed",B(s,"type","text"),B(e,"slot","sidebar")},m(g,D){v(g,e,D),m(e,l),m(e,n),m(e,r),m(e,o),m(e,i),m(i,a),m(i,s),se(s,t[1].jats[t[0]].properties.name),m(e,c),m(e,u),m(e,f),m(e,d),p||(_=[W(l,"click",t[6]),W(r,"click",t[4]),W(s,"input",t[7]),W(u,"click",t[8]),W(d,"click",t[9])],p=!0)},p(g,D){D&3&&s.value!==g[1].jats[g[0]].properties.name&&se(s,g[1].jats[g[0]].properties.name)},d(g){g&&w(e),p=!1,ve(_)}}}function zr(t){let e,l;return e=new Fe({props:{filter:["!=",["id"],t[0]],paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":"black","circle-radius":20}}}),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p(n,r){const o={};r&1&&(o.filter=["!=",["id"],n[0]]),e.$set(o)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function Br(t){let e;return{c(){e=k("span"),B(e,"class","dot svelte-114j1n1"),x(e,"border-color",t[1].jats[t[0]].properties.color)},m(l,n){v(l,e,n)},p(l,n){n&3&&x(e,"border-color",l[1].jats[l[0]].properties.color)},d(l){l&&w(e)}}}function Rr(t){let e,l,n,r,o,i,a,s;l=new rt({}),r=new je({props:{data:pe(t[1].jats),generateId:!0,$$slots:{default:[zr]},$$scope:{ctx:t}}});function c(f){t[5](f)}let u={draggable:!0,$$slots:{default:[Br]},$$scope:{ctx:t}};return t[1].jats[t[0]].geometry.coordinates!==void 0&&(u.lngLat=t[1].jats[t[0]].geometry.coordinates),i=new Se({props:u}),de.push(()=>we(i,"lngLat",c)),{c(){e=k("div"),G(l.$$.fragment),n=I(),G(r.$$.fragment),o=I(),G(i.$$.fragment),B(e,"slot","map")},m(f,d){v(f,e,d),H(l,e,null),m(e,n),H(r,e,null),m(e,o),H(i,e,null),s=!0},p(f,d){const p={};d&2&&(p.data=pe(f[1].jats)),d&1025&&(p.$$scope={dirty:d,ctx:f}),r.$set(p);const _={};d&1027&&(_.$$scope={dirty:d,ctx:f}),!a&&d&3&&(a=!0,_.lngLat=f[1].jats[f[0]].geometry.coordinates,ye(()=>a=!1)),i.$set(_)},i(f){s||(C(l.$$.fragment,f),C(r.$$.fragment,f),C(i.$$.fragment,f),s=!0)},o(f){M(l.$$.fragment,f),M(r.$$.fragment,f),M(i.$$.fragment,f),s=!1},d(f){f&&w(e),U(l),U(r),U(i)}}}function Gr(t){let e,l,n,r;return e=new Je({props:{$$slots:{map:[Rr],sidebar:[Jr]},$$scope:{ctx:t}}}),{c(){G(e.$$.fragment)},m(o,i){H(e,o,i),l=!0,n||(r=W(Fr,"keydown",t[3]),n=!0)},p(o,[i]){const a={};i&1031&&(a.$$scope={dirty:i,ctx:o}),e.$set(a)},i(o){l||(C(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){U(e,o),n=!1,r()}}}function Hr(t,e,l){let n,r;ne(t,Q,p=>l(1,n=p)),ne(t,le,p=>l(2,r=p));let{idx:o}=e;function i(p){p.key=="Escape"&&te(le,r={kind:"neutral"},r)}async function a(){window.confirm("Really delete this JAT?")&&(te(le,r={kind:"neutral"},r),await Ge(),n.jats.splice(o,1),Q.set(n))}function s(p){t.$$.not_equal(n.jats[o].geometry.coordinates,p)&&(n.jats[o].geometry.coordinates=p,Q.set(n))}const c=()=>te(le,r={kind:"neutral"},r);function u(){n.jats[o].properties.name=this.value,Q.set(n)}const f=()=>te(le,r={kind:"edit-jat-detail",idx:o,stage:"existing"},r),d=()=>te(le,r={kind:"edit-jat-detail",idx:o,stage:"proposed"},r);return t.$$set=p=>{"idx"in p&&l(0,o=p.idx)},[o,n,r,i,a,s,c,u,f,d]}class Ur extends ae{constructor(e){super(),ce(this,e,Hr,Gr,ue,{idx:0})}}function Zr(t){let e,l,n,r;const o=t[2].default,i=Me(o,t,t[1],null);return{c(){e=k("a"),i&&i.c(),B(e,"href","#"),x(e,"color",t[0])},m(a,s){v(a,e,s),i&&i.m(e,null),l=!0,n||(r=W(e,"click",Pn(t[3])),n=!0)},p(a,[s]){i&&i.p&&(!l||s&2)&&Ie(i,o,a,a[1],l?Ee(o,a[1],s,null):Ne(a[1]),null),s&1&&x(e,"color",a[0])},i(a){l||(C(i,a),l=!0)},o(a){M(i,a),l=!1},d(a){a&&w(e),i&&i.d(a),n=!1,r()}}}function Kr(t,e,l){let{$$slots:n={},$$scope:r}=e,{color:o=void 0}=e;function i(a){be.call(this,t,a)}return t.$$set=a=>{"color"in a&&l(0,o=a.color),"$$scope"in a&&l(1,r=a.$$scope)},[o,r,n,i]}class ot extends ae{constructor(e){super(),ce(this,e,Kr,Zr,ue,{color:0})}}function rn(t,e,l){const n=t.slice();return n[2]=e[l],n[4]=l,n}function on(t,e,l){const n=t.slice();n[5]=e[l];const r=n[5].properties.answers[n[4]];return n[6]=r,n}function sn(t,e,l){const n=t.slice();return n[5]=e[l],n}function an(t){let e,l=t[5].properties.name+"",n;return{c(){e=k("th"),n=Z(l),x(e,"color",t[5].properties.color)},m(r,o){v(r,e,o),m(e,n)},p(r,o){o&1&&l!==(l=r[5].properties.name+"")&&re(n,l),o&1&&x(e,"color",r[5].properties.color)},d(r){r&&w(e)}}}function cn(t){let e,l=t[6]+"",n;return{c(){e=k("td"),n=Z(l),x(e,"background",t[6]==""?"red":"green")},m(r,o){v(r,e,o),m(e,n)},p(r,o){o&1&&l!==(l=r[6]+"")&&re(n,l),o&1&&x(e,"background",r[6]==""?"red":"green")},d(r){r&&w(e)}}}function un(t){let e,l,n,r,o=V(t[0].links),i=[];for(let a=0;a<o.length;a+=1)i[a]=cn(on(t,o,a));return{c(){e=k("tr"),l=k("th"),l.textContent=`${t[2].name}`,n=I();for(let a=0;a<i.length;a+=1)i[a].c();r=I()},m(a,s){v(a,e,s),m(e,l),m(e,n);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(e,null);m(e,r)},p(a,s){if(s&1){o=V(a[0].links);let c;for(c=0;c<o.length;c+=1){const u=on(a,o,c);i[c]?i[c].p(u,s):(i[c]=cn(u),i[c].c(),i[c].m(e,r))}for(;c<i.length;c+=1)i[c].d(1);i.length=o.length}},d(a){a&&w(e),oe(i,a)}}}function Xr(t){let e,l,n,r,o,i,a,s=V(t[0].links),c=[];for(let d=0;d<s.length;d+=1)c[d]=an(sn(t,s,d));let u=V(ke),f=[];for(let d=0;d<u.length;d+=1)f[d]=un(rn(t,u,d));return{c(){e=k("table"),l=k("thead"),n=k("tr"),r=k("th"),o=I();for(let d=0;d<c.length;d+=1)c[d].c();i=I(),a=k("tbody");for(let d=0;d<f.length;d+=1)f[d].c()},m(d,p){v(d,e,p),m(e,l),m(l,n),m(n,r),m(n,o);for(let _=0;_<c.length;_+=1)c[_]&&c[_].m(n,null);m(e,i),m(e,a);for(let _=0;_<f.length;_+=1)f[_]&&f[_].m(a,null)},p(d,p){if(p&1){s=V(d[0].links);let _;for(_=0;_<s.length;_+=1){const g=sn(d,s,_);c[_]?c[_].p(g,p):(c[_]=an(g),c[_].c(),c[_].m(n,null))}for(;_<c.length;_+=1)c[_].d(1);c.length=s.length}if(p&1){u=V(ke);let _;for(_=0;_<u.length;_+=1){const g=rn(d,u,_);f[_]?f[_].p(g,p):(f[_]=un(g),f[_].c(),f[_].m(a,null))}for(;_<f.length;_+=1)f[_].d(1);f.length=u.length}},d(d){d&&w(e),oe(c,d),oe(f,d)}}}function Wr(t){let e,l;return e=new jn({props:{$$slots:{default:[Xr]},$$scope:{ctx:t}}}),e.$on("close",t[1]),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p(n,[r]){const o={};r&2049&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function Vr(t,e,l){let n;ne(t,Q,o=>l(0,n=o));function r(o){be.call(this,t,o)}return[n,r]}class Qr extends ae{constructor(e){super(),ce(this,e,Vr,Wr,ue,{})}}function fn(t,e,l){const n=t.slice();return n[16]=e[l],n[18]=l,n}function mn(t,e,l){const n=t.slice();return n[19]=e[l],n[18]=l,n}function dn(t,e,l){const n=t.slice();return n[21]=e[l],n[18]=l,n}function pn(t){let e,l;return e=new Qr({}),e.$on("close",t[6]),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p:ee,i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function Yr(t){let e=t[21].properties.name+"",l;return{c(){l=Z(e)},m(n,r){v(n,l,r)},p(n,r){r&2&&e!==(e=n[21].properties.name+"")&&re(l,e)},d(n){n&&w(l)}}}function _n(t){let e,l,n,r;function o(){return t[11](t[18])}return l=new ot({props:{color:t[21].properties.color,$$slots:{default:[Yr]},$$scope:{ctx:t}}}),l.$on("click",o),{c(){e=k("li"),G(l.$$.fragment),n=I()},m(i,a){v(i,e,a),H(l,e,null),m(e,n),r=!0},p(i,a){t=i;const s={};a&2&&(s.color=t[21].properties.color),a&8388610&&(s.$$scope={dirty:a,ctx:t}),l.$set(s)},i(i){r||(C(l.$$.fragment,i),r=!0)},o(i){M(l.$$.fragment,i),r=!1},d(i){i&&w(e),U(l)}}}function xr(t){let e=t[19].name+"",l,n;return{c(){l=Z(e),n=I()},m(r,o){v(r,l,o),v(r,n,o)},p:ee,d(r){r&&(w(l),w(n))}}}function gn(t){let e,l,n,r,o,i,a,s;function c(){return t[12](t[18])}l=new ot({props:{$$slots:{default:[xr]},$$scope:{ctx:t}}}),l.$on("click",c);function u(...f){return t[13](t[18],...f)}return{c(){e=k("li"),G(l.$$.fragment),n=Z(`:
          `),r=k("progress"),a=I(),r.value=o=t[1].links.filter(u).length,B(r,"max",i=t[1].links.length),B(r,"class","svelte-zadug4")},m(f,d){v(f,e,d),H(l,e,null),m(e,n),m(e,r),m(e,a),s=!0},p(f,d){t=f;const p={};d&8388608&&(p.$$scope={dirty:d,ctx:t}),l.$set(p),(!s||d&2&&o!==(o=t[1].links.filter(u).length))&&(r.value=o),(!s||d&2&&i!==(i=t[1].links.length))&&B(r,"max",i)},i(f){s||(C(l.$$.fragment,f),s=!0)},o(f){M(l.$$.fragment,f),s=!1},d(f){f&&w(e),U(l)}}}function eo(t){let e=t[16].properties.name+"",l;return{c(){l=Z(e)},m(n,r){v(n,l,r)},p(n,r){r&2&&e!==(e=n[16].properties.name+"")&&re(l,e)},d(n){n&&w(l)}}}function hn(t){let e,l,n,r;function o(){return t[14](t[18])}return l=new ot({props:{color:t[16].properties.color,$$slots:{default:[eo]},$$scope:{ctx:t}}}),l.$on("click",o),{c(){e=k("li"),G(l.$$.fragment),n=I()},m(i,a){v(i,e,a),H(l,e,null),m(e,n),r=!0},p(i,a){t=i;const s={};a&2&&(s.color=t[16].properties.color),a&8388610&&(s.$$scope={dirty:a,ctx:t}),l.$set(s)},i(i){r||(C(l.$$.fragment,i),r=!0)},o(i){M(l.$$.fragment,i),r=!1},d(i){i&&w(e),U(l)}}}function to(t){let e,l,n,r,o,i,a,s,c,u,f,d,p,_,g,D,b,j,N,R,q,P,F,L,z,T,S=V(t[1].links),h=[];for(let O=0;O<S.length;O+=1)h[O]=_n(dn(t,S,O));const K=O=>M(h[O],1,1,()=>{h[O]=null});let $=V(ke),Y=[];for(let O=0;O<$.length;O+=1)Y[O]=gn(mn(t,$,O));const ie=O=>M(Y[O],1,1,()=>{Y[O]=null});let E=V(t[1].jats),J=[];for(let O=0;O<E.length;O+=1)J[O]=hn(fn(t,E,O));const _e=O=>M(J[O],1,1,()=>{J[O]=null});return{c(){e=k("div"),l=k("div"),n=k("button"),n.textContent="Download",r=I(),o=k("button"),o.textContent="Clear",i=I(),a=k("hr"),s=I(),c=k("div"),u=k("button"),u.textContent="New link",f=I(),d=k("button"),d.textContent="Table of questions",p=Z(`

    Links:
    `),_=k("ol");for(let O=0;O<h.length;O+=1)h[O].c();g=Z(`

    Questions:
    `),D=k("ol");for(let O=0;O<Y.length;O+=1)Y[O].c();b=I(),j=k("hr"),N=Z(`

    JATs:

    `),R=k("div"),q=k("button"),q.textContent="New JAT",P=I(),F=k("ol");for(let O=0;O<J.length;O+=1)J[O].c();B(n,"class","secondary"),B(o,"class","secondary"),B(e,"slot","sidebar")},m(O,y){v(O,e,y),m(e,l),m(l,n),m(l,r),m(l,o),m(e,i),m(e,a),m(e,s),m(e,c),m(c,u),m(c,f),m(c,d),m(e,p),m(e,_);for(let A=0;A<h.length;A+=1)h[A]&&h[A].m(_,null);m(e,g),m(e,D);for(let A=0;A<Y.length;A+=1)Y[A]&&Y[A].m(D,null);m(e,b),m(e,j),m(e,N),m(e,R),m(R,q),m(e,P),m(e,F);for(let A=0;A<J.length;A+=1)J[A]&&J[A].m(F,null);L=!0,z||(T=[W(n,"click",t[9]),W(o,"click",t[3]),W(u,"click",t[4]),W(d,"click",t[10]),W(q,"click",t[5])],z=!0)},p(O,y){if(y&6){S=V(O[1].links);let A;for(A=0;A<S.length;A+=1){const X=dn(O,S,A);h[A]?(h[A].p(X,y),C(h[A],1)):(h[A]=_n(X),h[A].c(),C(h[A],1),h[A].m(_,null))}for(fe(),A=S.length;A<h.length;A+=1)K(A);me()}if(y&6){$=V(ke);let A;for(A=0;A<$.length;A+=1){const X=mn(O,$,A);Y[A]?(Y[A].p(X,y),C(Y[A],1)):(Y[A]=gn(X),Y[A].c(),C(Y[A],1),Y[A].m(D,null))}for(fe(),A=$.length;A<Y.length;A+=1)ie(A);me()}if(y&6){E=V(O[1].jats);let A;for(A=0;A<E.length;A+=1){const X=fn(O,E,A);J[A]?(J[A].p(X,y),C(J[A],1)):(J[A]=hn(X),J[A].c(),C(J[A],1),J[A].m(F,null))}for(fe(),A=E.length;A<J.length;A+=1)_e(A);me()}},i(O){if(!L){for(let y=0;y<S.length;y+=1)C(h[y]);for(let y=0;y<$.length;y+=1)C(Y[y]);for(let y=0;y<E.length;y+=1)C(J[y]);L=!0}},o(O){h=h.filter(Boolean);for(let y=0;y<h.length;y+=1)M(h[y]);Y=Y.filter(Boolean);for(let y=0;y<Y.length;y+=1)M(Y[y]);J=J.filter(Boolean);for(let y=0;y<J.length;y+=1)M(J[y]);L=!1},d(O){O&&w(e),oe(h,O),oe(Y,O),oe(J,O),z=!1,ve(T)}}}function no(t){let e,l;return e=new qe({props:{manageHoverState:!0,paint:{"line-color":["get","color"],"line-width":Ue(6,9)},hoverCursor:"pointer"}}),e.$on("click",t[7]),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p:ee,i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function lo(t){let e,l;return e=new Fe({props:{manageHoverState:!0,paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":["get","color"],"circle-radius":Ue(20,25)},hoverCursor:"pointer"}}),e.$on("click",t[8]),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p:ee,i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function ro(t){let e,l,n,r,o;return l=new je({props:{data:pe(t[1].links),generateId:!0,$$slots:{default:[no]},$$scope:{ctx:t}}}),r=new je({props:{data:pe(t[1].jats),generateId:!0,$$slots:{default:[lo]},$$scope:{ctx:t}}}),{c(){e=k("div"),G(l.$$.fragment),n=I(),G(r.$$.fragment),B(e,"slot","map")},m(i,a){v(i,e,a),H(l,e,null),m(e,n),H(r,e,null),o=!0},p(i,a){const s={};a&2&&(s.data=pe(i[1].links)),a&8388612&&(s.$$scope={dirty:a,ctx:i}),l.$set(s);const c={};a&2&&(c.data=pe(i[1].jats)),a&8388612&&(c.$$scope={dirty:a,ctx:i}),r.$set(c)},i(i){o||(C(l.$$.fragment,i),C(r.$$.fragment,i),o=!0)},o(i){M(l.$$.fragment,i),M(r.$$.fragment,i),o=!1},d(i){i&&w(e),U(l),U(r)}}}function oo(t){let e,l,n,r=t[0]&&pn(t);return l=new Je({props:{$$slots:{map:[ro],sidebar:[to]},$$scope:{ctx:t}}}),{c(){r&&r.c(),e=I(),G(l.$$.fragment)},m(o,i){r&&r.m(o,i),v(o,e,i),H(l,o,i),n=!0},p(o,[i]){o[0]?r?(r.p(o,i),i&1&&C(r,1)):(r=pn(o),r.c(),C(r,1),r.m(e.parentNode,e)):r&&(fe(),M(r,1,1,()=>{r=null}),me());const a={};i&8388615&&(a.$$scope={dirty:i,ctx:o}),l.$set(a)},i(o){n||(C(r),C(l.$$.fragment,o),n=!0)},o(o){M(r),M(l.$$.fragment,o),n=!1},d(o){o&&w(e),r&&r.d(o),U(l,o)}}}function io(t,e,l){let n,r,o;ne(t,Q,N=>l(1,n=N)),ne(t,le,N=>l(2,r=N)),ne(t,Ze,N=>l(15,o=N));let i=!1;function a(){te(Q,n.links=[],n),te(Q,n.jats=[],n)}function s(){let N=el(n.links.length);te(Q,n.links=[...n.links,N],n),te(le,r={kind:"edit-link",idx:n.links.length-1},r)}function c(){if(!o)return;let N=tl(n.jats.length,o.getCenter().toArray());te(Q,n.jats=[...n.jats,N],n),te(le,r={kind:"edit-jat",idx:n.jats.length-1},r)}return[i,n,r,a,s,c,()=>l(0,i=!1),N=>te(le,r={kind:"edit-link",idx:N.detail.features[0].id},r),N=>te(le,r={kind:"edit-jat",idx:N.detail.features[0].id},r),()=>Il("rcv2.geojson",JSON.stringify(n)),()=>l(0,i=!0),N=>te(le,r={kind:"edit-link",idx:N},r),N=>te(le,r={kind:"edit-question",idx:N},r),(N,R)=>R.properties.answers[N]!="",N=>te(le,r={kind:"edit-jat",idx:N},r)]}class so extends ae{constructor(e){super(),ce(this,e,io,oo,ue,{})}}function ao(t){let e,l;return{c(){e=k("div"),l=k("div"),B(e,"slot","left")},m(n,r){v(n,e,r),m(e,l),t[9](l)},p:ee,d(n){n&&w(e),t[9](null)}}}function co(t){return{c:ee,m:ee,p:ee,i:ee,o:ee,d:ee}}function uo(t){let e,l,n;function r(i){t[8](i)}let o={style:t[10],standardControls:!0,hash:!0,$$slots:{default:[ho]},$$scope:{ctx:t}};return t[2]!==void 0&&(o.map=t[2]),e=new Fn({props:o}),de.push(()=>we(e,"map",r)),{c(){G(e.$$.fragment)},m(i,a){H(e,i,a),n=!0},p(i,a){const s={};a&2058&&(s.$$scope={dirty:a,ctx:i}),!l&&a&4&&(l=!0,s.map=i[2],ye(()=>l=!1)),e.$set(s)},i(i){n||(C(e.$$.fragment,i),n=!0)},o(i){M(e.$$.fragment,i),n=!1},d(i){U(e,i)}}}function fo(t){let e,l;return e=new wl({props:{qIdx:t[3].idx}}),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p(n,r){const o={};r&8&&(o.qIdx=n[3].idx),e.$set(o)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function mo(t){let e,l;return e=new Or({props:{junctionIdx:t[3].idx,stage:t[3].stage}}),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p(n,r){const o={};r&8&&(o.junctionIdx=n[3].idx),r&8&&(o.stage=n[3].stage),e.$set(o)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function po(t){let e,l;return e=new Ur({props:{idx:t[3].idx}}),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p(n,r){const o={};r&8&&(o.idx=n[3].idx),e.$set(o)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function _o(t){let e,l;return e=new pl({props:{idx:t[3].idx}}),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p(n,r){const o={};r&8&&(o.idx=n[3].idx),e.$set(o)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function go(t){let e,l;return e=new so({}),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p:ee,i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function ho(t){let e,l,n,r,o,i;const a=[go,_o,po,mo,fo],s=[];function c(u,f){return u[3].kind=="neutral"?0:u[3].kind=="edit-link"?1:u[3].kind=="edit-jat"?2:u[3].kind=="edit-jat-detail"?3:u[3].kind=="edit-question"?4:-1}return~(n=c(t))&&(r=s[n]=a[n](t)),{c(){e=k("div"),l=I(),r&&r.c(),o=We()},m(u,f){v(u,e,f),t[7](e),v(u,l,f),~n&&s[n].m(u,f),v(u,o,f),i=!0},p(u,f){let d=n;n=c(u),n===d?~n&&s[n].p(u,f):(r&&(fe(),M(s[d],1,1,()=>{s[d]=null}),me()),~n?(r=s[n],r?r.p(u,f):(r=s[n]=a[n](u),r.c()),C(r,1),r.m(o.parentNode,o)):r=null)},i(u){i||(C(r),i=!0)},o(u){M(r),i=!1},d(u){u&&(w(e),w(l),w(o)),t[7](null),~n&&s[n].d(u)}}}function ko(t){return{c:ee,m:ee,p:ee,i:ee,o:ee,d:ee}}function bo(t){let e,l,n={ctx:t,current:null,token:null,hasCatch:!1,pending:ko,then:uo,catch:co,value:10,blocks:[,,,]};return Jn(yl(new URLSearchParams(window.location.search).get("google")||""),n),{c(){e=k("div"),n.block.c(),B(e,"slot","main"),x(e,"position","relative"),x(e,"width","100%"),x(e,"height","100vh")},m(r,o){v(r,e,o),n.block.m(e,n.anchor=null),n.mount=()=>e,n.anchor=null,l=!0},p(r,o){t=r,zn(n,t,o)},i(r){l||(C(n.block),l=!0)},o(r){for(let o=0;o<3;o+=1){const i=n.blocks[o];M(i)}l=!1},d(r){r&&w(e),n.block.d(),n.token=null,n=null}}}function $o(t){let e,l;return e=new On({props:{$$slots:{main:[bo],left:[ao]},$$scope:{ctx:t}}}),{c(){G(e.$$.fragment)},m(n,r){H(e,n,r),l=!0},p(n,[r]){const o={};r&2063&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){M(e.$$.fragment,n),l=!1},d(n){U(e,n)}}}function vo(t,e,l){let n,r,o,i,a;ne(t,tt,p=>l(4,n=p)),ne(t,et,p=>l(5,r=p)),ne(t,Q,p=>l(6,o=p)),ne(t,Ze,p=>l(2,i=p)),ne(t,le,p=>l(3,a=p));let s,c;function u(p){de[p?"unshift":"push"](()=>{c=p,l(1,c),l(4,n)})}function f(p){i=p,Ze.set(i)}function d(p){de[p?"unshift":"push"](()=>{s=p,l(0,s),l(5,r)})}return t.$$.update=()=>{t.$$.dirty&64&&window.localStorage.setItem("tmp-rcv2",JSON.stringify(o)),t.$$.dirty&33&&s&&r&&(l(0,s.innerHTML="",s),s.appendChild(r)),t.$$.dirty&18&&c&&n&&(l(1,c.innerHTML="",c),c.appendChild(n))},[s,c,i,a,n,r,o,u,f,d]}class wo extends ae{constructor(e){super(),ce(this,e,vo,$o,ue,{})}}new wo({target:document.getElementById("app")});
