import{V as Gn,W as Qn,X as We,r as ae,e as b,v as ce,t as _,Y as Hn,S as ie,i as se,s as le,Z as Jn,_ as Rn,$ as ee,a0 as Kn,L as Xn,b as ue,a as de,c as M,m as T,d as me,f as I,g as Zn,h as je,u as ze,j as Se,k as Be,l as be,y as w,z,q as h,w as $,a1 as Ye,M as Ue,A as P,a2 as Ge,U as W,p as De,a3 as Yn,o as Y,a4 as Vn,O as g,a5 as ft,Q,x as pe,R as $e,F as U,N as he,B as V,K as Wn,G as _e,D as Le,E as Ve,a6 as He,a7 as H,a8 as Ne,a9 as Ke,H as oe,aa as xn,ab as ot,ac as er,C as Xe,P as Dn,ad as tr,I as nr,T as rr}from"./Layout-d1a27f85.js";function or(n,e){const r=e.token={};function t(o,l,i,a){if(e.token!==r)return;e.resolved=a;let s=e.ctx;i!==void 0&&(s=s.slice(),s[i]=a);const u=o&&(e.current=o)(s);let c=!1;e.block&&(e.blocks?e.blocks.forEach((d,f)=>{f!==l&&d&&(ae(),b(d,1,1,()=>{e.blocks[f]===d&&(e.blocks[f]=null)}),ce())}):e.block.d(1),u.c(),_(u,1),u.m(e.mount(),e.anchor),c=!0),e.block=u,e.blocks&&(e.blocks[l]=u),c&&Hn()}if(Gn(n)){const o=Qn();if(n.then(l=>{We(o),t(e.then,1,e.value,l),We(null)},l=>{if(We(o),t(e.catch,2,e.error,l),We(null),!e.hasCatch)throw l}),e.current!==e.pending)return t(e.pending,0),!0}else{if(e.current!==e.then)return t(e.then,1,e.value,n),!0;e.resolved=n}}function lr(n,e,r){const t=e.slice(),{resolved:o}=n;n.current===n.then&&(t[n.value]=o),n.current===n.catch&&(t[n.error]=o),n.block.p(t,r)}function ir(n,e,r){let t;const o=Jn();let{layer:l=void 0}=e;const{map:i}=Rn();ee(n,i,c=>r(2,t=c));function a(c){o(c.type,{...c,map:i})}const s=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu","mouseover","mouseout"],u=["click","dblclick","contextmenu","mousemove","movestart","moveend","zoomstart","zoom","zoomend"];return Kn(()=>{if(t)if(l)for(const c of s)t.off(c,l,a);else for(const c of u)t.off(c,a)}),n.$$set=c=>{"layer"in c&&r(1,l=c.layer)},n.$$.update=()=>{if(n.$$.dirty&6&&t)if(l)for(const c of s)t.on(c,l,a);else for(const c of u)t.on(c,a)},[i,l,t]}class ct extends ie{constructor(e){super(),se(this,e,ir,null,le,{layer:1})}}function sr(n){let e;const r=n[16].default,t=je(r,n,n[24],null);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l&16777216)&&ze(t,r,o,o[24],e?Be(r,o[24],l,null):Se(o[24]),null)},i(o){e||(_(t,o),e=!0)},o(o){b(t,o),e=!1},d(o){t&&t.d(o)}}}function ar(n){let e,r,t;function o(i){n[17](i)}let l={id:n[1],type:"symbol",source:n[2],sourceLayer:n[3],beforeId:n[4],beforeLayerType:n[5],paint:n[6],layout:n[7],filter:n[8],applyToClusters:n[9],minzoom:n[10],maxzoom:n[11],hoverCursor:n[12],manageHoverState:n[13],eventsIfTopMost:n[14],interactive:n[15],$$slots:{default:[sr]},$$scope:{ctx:n}};return n[0]!==void 0&&(l.hovered=n[0]),e=new Xn({props:l}),ue.push(()=>de(e,"hovered",o)),e.$on("click",n[18]),e.$on("dblclick",n[19]),e.$on("contextmenu",n[20]),e.$on("mouseenter",n[21]),e.$on("mousemove",n[22]),e.$on("mouseleave",n[23]),{c(){M(e.$$.fragment)},m(i,a){T(e,i,a),t=!0},p(i,[a]){const s={};a&2&&(s.id=i[1]),a&4&&(s.source=i[2]),a&8&&(s.sourceLayer=i[3]),a&16&&(s.beforeId=i[4]),a&32&&(s.beforeLayerType=i[5]),a&64&&(s.paint=i[6]),a&128&&(s.layout=i[7]),a&256&&(s.filter=i[8]),a&512&&(s.applyToClusters=i[9]),a&1024&&(s.minzoom=i[10]),a&2048&&(s.maxzoom=i[11]),a&4096&&(s.hoverCursor=i[12]),a&8192&&(s.manageHoverState=i[13]),a&16384&&(s.eventsIfTopMost=i[14]),a&32768&&(s.interactive=i[15]),a&16777216&&(s.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,s.hovered=i[0],me(()=>r=!1)),e.$set(s)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){b(e.$$.fragment,i),t=!1},d(i){I(e,i)}}}function cr(n,e,r){let{$$slots:t={},$$scope:o}=e,{id:l=Zn("symbol")}=e,{source:i=void 0}=e,{sourceLayer:a=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:u=void 0}=e,{paint:c=void 0}=e,{layout:d=void 0}=e,{filter:f=void 0}=e,{applyToClusters:m=void 0}=e,{minzoom:p=void 0}=e,{maxzoom:A=void 0}=e,{hoverCursor:O=void 0}=e,{manageHoverState:y=!1}=e,{hovered:v=null}=e,{eventsIfTopMost:N=!1}=e,{interactive:S=!0}=e;function j(D){v=D,r(0,v)}function k(D){be.call(this,n,D)}function C(D){be.call(this,n,D)}function B(D){be.call(this,n,D)}function E(D){be.call(this,n,D)}function K(D){be.call(this,n,D)}function R(D){be.call(this,n,D)}return n.$$set=D=>{"id"in D&&r(1,l=D.id),"source"in D&&r(2,i=D.source),"sourceLayer"in D&&r(3,a=D.sourceLayer),"beforeId"in D&&r(4,s=D.beforeId),"beforeLayerType"in D&&r(5,u=D.beforeLayerType),"paint"in D&&r(6,c=D.paint),"layout"in D&&r(7,d=D.layout),"filter"in D&&r(8,f=D.filter),"applyToClusters"in D&&r(9,m=D.applyToClusters),"minzoom"in D&&r(10,p=D.minzoom),"maxzoom"in D&&r(11,A=D.maxzoom),"hoverCursor"in D&&r(12,O=D.hoverCursor),"manageHoverState"in D&&r(13,y=D.manageHoverState),"hovered"in D&&r(0,v=D.hovered),"eventsIfTopMost"in D&&r(14,N=D.eventsIfTopMost),"interactive"in D&&r(15,S=D.interactive),"$$scope"in D&&r(24,o=D.$$scope)},[v,l,i,a,s,u,c,d,f,m,p,A,O,y,N,S,t,j,k,C,B,E,K,R,o]}class qe extends ie{constructor(e){super(),se(this,e,cr,ar,le,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}const ur=n=>({}),dt=n=>({}),fr=n=>({}),mt=n=>({});function dr(n){let e,r,t,o;const l=n[3].sidebar,i=je(l,n,n[2],mt),a=n[3].map,s=je(a,n,n[2],dt);return{c(){e=w("div"),i&&i.c(),r=z(),t=w("div"),s&&s.c()},m(u,c){h(u,e,c),i&&i.m(e,null),n[4](e),h(u,r,c),h(u,t,c),s&&s.m(t,null),n[5](t),o=!0},p(u,[c]){i&&i.p&&(!o||c&4)&&ze(i,l,u,u[2],o?Be(l,u[2],c,fr):Se(u[2]),mt),s&&s.p&&(!o||c&4)&&ze(s,a,u,u[2],o?Be(a,u[2],c,ur):Se(u[2]),dt)},i(u){o||(_(i,u),_(s,u),o=!0)},o(u){b(i,u),b(s,u),o=!1},d(u){u&&($(e),$(r),$(t)),i&&i.d(u),n[4](null),s&&s.d(u),n[5](null)}}}function mr(n,e,r){let t,o;ee(n,it,u=>r(0,t=u)),ee(n,st,u=>r(1,o=u));let{$$slots:l={},$$scope:i}=e;function a(u){ue[u?"unshift":"push"](()=>{t=u,it.set(t)})}function s(u){ue[u?"unshift":"push"](()=>{o=u,st.set(o)})}return n.$$set=u=>{"$$scope"in u&&r(2,i=u.$$scope)},[t,o,i,l,a,s]}class Te extends ie{constructor(e){super(),se(this,e,mr,dr,le,{})}}let it=Ye(null),st=Ye(null);const En="data:image/png;base64,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",On="data:image/png;base64,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";function ke(){return["","2","1","0","Critical"]}let Ce=["#66C5CC","#F6CF71","#F89C74","#DCB0F2","#87C55F","#9EB9F3","#FE88B1","#C9DB74","#8BE0A4","#B497E7","#D3B484","#B3B3B3"];function pr(n){let e,r;const t=n[4].default,o=je(t,n,n[6],null);return{c(){e=w("span"),o&&o.c(),P(e,"class","dot svelte-117v9mi"),Ge(e,"outline",n[3]),W(e,"background-color",n[3]?void 0:n[1]),W(e,"border-color",n[3]?n[1]:void 0),W(e,"width",n[2]),W(e,"height",n[2])},m(l,i){h(l,e,i),o&&o.m(e,null),r=!0},p(l,i){o&&o.p&&(!r||i&64)&&ze(o,t,l,l[6],r?Be(t,l[6],i,null):Se(l[6]),null),(!r||i&8)&&Ge(e,"outline",l[3]),i&10&&W(e,"background-color",l[3]?void 0:l[1]),i&10&&W(e,"border-color",l[3]?l[1]:void 0),i&4&&W(e,"width",l[2]),i&4&&W(e,"height",l[2])},i(l){r||(_(o,l),r=!0)},o(l){b(o,l),r=!1},d(l){l&&$(e),o&&o.d(l)}}}function gr(n){let e,r,t;function o(i){n[5](i)}let l={draggable:!0,$$slots:{default:[pr]},$$scope:{ctx:n}};return n[0]!==void 0&&(l.lngLat=n[0]),e=new Ue({props:l}),ue.push(()=>de(e,"lngLat",o)),{c(){M(e.$$.fragment)},m(i,a){T(e,i,a),t=!0},p(i,[a]){const s={};a&78&&(s.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,s.lngLat=i[0],me(()=>r=!1)),e.$set(s)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){b(e.$$.fragment,i),t=!1},d(i){I(e,i)}}}function _r(n,e,r){let{$$slots:t={},$$scope:o}=e,{lngLat:l}=e,{color:i}=e,{radius:a="30px"}=e,{outline:s=!1}=e;function u(c){l=c,r(0,l)}return n.$$set=c=>{"lngLat"in c&&r(0,l=c.lngLat),"color"in c&&r(1,i=c.color),"radius"in c&&r(2,a=c.radius),"outline"in c&&r(3,s=c.outline),"$$scope"in c&&r(6,o=c.$$scope)},[l,i,a,s,t,u,o]}class ut extends ie{constructor(e){super(),se(this,e,_r,gr,le,{lngLat:0,color:1,radius:2,outline:3})}}function pt(n,e,r){const t=n.slice();return t[11]=e[r][0],t[12]=e[r][1],t}function gt(n,e,r){const t=n.slice();return t[11]=e[r][0],t[12]=e[r][1],t}function hr(n){let e,r,t,o,l,i;const a=n[5].default,s=je(a,n,n[4],null);let u=Y(n[2]),c=[];for(let d=0;d<u.length;d+=1)c[d]=_t(pt(n,u,d));return{c(){e=w("label"),s&&s.c(),r=z(),t=w("select");for(let d=0;d<c.length;d+=1)c[d].c();n[0]===void 0&&Vn(()=>n[10].call(t))},m(d,f){h(d,e,f),s&&s.m(e,null),g(e,r),g(e,t);for(let m=0;m<c.length;m+=1)c[m]&&c[m].m(t,null);ft(t,n[0],!0),o=!0,l||(i=[Q(t,"change",n[10]),Q(t,"change",n[7])],l=!0)},p(d,f){if(s&&s.p&&(!o||f&16)&&ze(s,a,d,d[4],o?Be(a,d[4],f,null):Se(d[4]),null),f&4){u=Y(d[2]);let m;for(m=0;m<u.length;m+=1){const p=pt(d,u,m);c[m]?c[m].p(p,f):(c[m]=_t(p),c[m].c(),c[m].m(t,null))}for(;m<c.length;m+=1)c[m].d(1);c.length=u.length}f&5&&ft(t,d[0])},i(d){o||(_(s,d),o=!0)},o(d){b(s,d),o=!1},d(d){d&&$(e),s&&s.d(d),pe(c,d),l=!1,$e(i)}}}function $r(n){let e,r,t,o;const l=n[5].default,i=je(l,n,n[4],null);let a=Y(n[2]),s=[];for(let u=0;u<a.length;u+=1)s[u]=ht(gt(n,a,u));return{c(){e=w("fieldset"),i&&i.c(),r=z(),t=w("div");for(let u=0;u<s.length;u+=1)s[u].c();P(t,"class","svelte-1vb210n"),Ge(t,"horiz_radio",n[1]=="horiz-radio")},m(u,c){h(u,e,c),i&&i.m(e,null),g(e,r),g(e,t);for(let d=0;d<s.length;d+=1)s[d]&&s[d].m(t,null);o=!0},p(u,c){if(i&&i.p&&(!o||c&16)&&ze(i,l,u,u[4],o?Be(l,u[4],c,null):Se(u[4]),null),c&5){a=Y(u[2]);let d;for(d=0;d<a.length;d+=1){const f=gt(u,a,d);s[d]?s[d].p(f,c):(s[d]=ht(f),s[d].c(),s[d].m(t,null))}for(;d<s.length;d+=1)s[d].d(1);s.length=a.length}(!o||c&2)&&Ge(t,"horiz_radio",u[1]=="horiz-radio")},i(u){o||(_(i,u),o=!0)},o(u){b(i,u),o=!1},d(u){u&&$(e),i&&i.d(u),pe(s,u)}}}function _t(n){let e,r=n[12]+"",t;return{c(){e=w("option"),t=U(r),e.__value=n[11],he(e,e.__value)},m(o,l){h(o,e,l),g(e,t)},p:V,d(o){o&&$(e)}}}function ht(n){let e,r,t,o=n[12]+"",l,i,a,s,u;return a=Wn(n[9][0]),{c(){e=w("label"),r=w("input"),t=z(),l=U(o),i=z(),P(r,"type","radio"),r.__value=n[11],he(r,r.__value),a.p(r)},m(c,d){h(c,e,d),g(e,r),r.checked=r.__value===n[0],g(e,t),g(e,l),g(e,i),s||(u=[Q(r,"change",n[8]),Q(r,"change",n[6])],s=!0)},p(c,d){d&5&&(r.checked=r.__value===c[0])},d(c){c&&$(e),a.r(),s=!1,$e(u)}}}function kr(n){let e,r,t,o;const l=[$r,hr],i=[];function a(s,u){return s[1]=="horiz-radio"||s[1]=="vert-radio"?0:s[1]=="dropdown"?1:-1}return~(e=a(n))&&(r=i[e]=l[e](n)),{c(){r&&r.c(),t=De()},m(s,u){~e&&i[e].m(s,u),h(s,t,u),o=!0},p(s,[u]){let c=e;e=a(s),e===c?~e&&i[e].p(s,u):(r&&(ae(),b(i[c],1,1,()=>{i[c]=null}),ce()),~e?(r=i[e],r?r.p(s,u):(r=i[e]=l[e](s),r.c()),_(r,1),r.m(t.parentNode,t)):r=null)},i(s){o||(_(r),o=!0)},o(s){b(r),o=!1},d(s){s&&$(t),~e&&i[e].d(s)}}}function br(n,e,r){let{$$slots:t={},$$scope:o}=e,{k:l}=e,{value:i}=e,{choices:a}=e,s=a[0].length==2?a:a.map(p=>[p,p]);const u=[[]];function c(p){be.call(this,n,p)}function d(p){be.call(this,n,p)}function f(){i=this.__value,r(0,i),r(2,s)}function m(){i=Yn(this),r(0,i),r(2,s)}return n.$$set=p=>{"k"in p&&r(1,l=p.k),"value"in p&&r(0,i=p.value),"choices"in p&&r(3,a=p.choices),"$$scope"in p&&r(4,o=p.$$scope)},[i,l,s,a,o,t,c,d,f,u,m]}class Me extends ie{constructor(e){super(),se(this,e,br,kr,le,{k:1,value:0,choices:3})}}let at=Ye(void 0),G=Ye(wr());function re(n){return{type:"FeatureCollection",features:n}}let J=Ye({kind:"neutral"});function Nn(n){return"links"in n&&"jats"in n&&"bus_stops"&&"crossings"in n&&"side_roads"in n}function wr(){try{let n=JSON.parse(window.localStorage.getItem("tmp-rcv2")||"");if(Nn(n))return n}catch{}return{links:[],jats:[],bus_stops:[],crossings:[],side_roads:[]}}function $t(n){let e,r;return e=new _e({props:{data:re(n[2].links),$$slots:{default:[vr]},$$scope:{ctx:n}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&4&&(l.data=re(t[2].links)),o&10&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function vr(n){let e,r;return e=new Le({props:{paint:{"line-color":n[1]?["get","color"]:"black","line-width":6}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&2&&(l.paint={"line-color":t[1]?["get","color"]:"black","line-width":6}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function kt(n){let e,r;return e=new _e({props:{data:re(n[2].bus_stops),$$slots:{default:[yr]},$$scope:{ctx:n}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&4&&(l.data=re(t[2].bus_stops)),o&8&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function yr(n){let e,r;return e=new qe({props:{layout:{"icon-image":"bus_stop","icon-size":3},paint:{"icon-color":"black"}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function bt(n){let e,r;return e=new _e({props:{data:re(n[2].crossings),$$slots:{default:[Ar]},$$scope:{ctx:n}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&4&&(l.data=re(t[2].crossings)),o&8&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function Ar(n){let e,r;return e=new qe({props:{layout:{"icon-image":"crossing","icon-size":.1},paint:{"icon-color":"black"}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function wt(n){let e,r;return e=new _e({props:{data:re(n[2].jats),$$slots:{default:[Cr]},$$scope:{ctx:n}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&4&&(l.data=re(t[2].jats)),o&8&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function Cr(n){let e,r;return e=new Ve({props:{paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":"black","circle-radius":20}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function vt(n){let e,r;return e=new _e({props:{data:re(n[2].side_roads),$$slots:{default:[jr]},$$scope:{ctx:n}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&4&&(l.data=re(t[2].side_roads)),o&8&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function jr(n){let e,r;return e=new Le({props:{paint:{"line-color":"black","line-width":3}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function zr(n){let e,r,t,o,l,i,a=n[0]!="links"&&$t(n),s=n[0]!="bus_stops"&&kt(n),u=n[0]!="crossings"&&bt(n),c=n[0]!="jats"&&wt(n),d=n[0]!="side_roads"&&vt(n);return{c(){a&&a.c(),e=z(),s&&s.c(),r=z(),u&&u.c(),t=z(),c&&c.c(),o=z(),d&&d.c(),l=De()},m(f,m){a&&a.m(f,m),h(f,e,m),s&&s.m(f,m),h(f,r,m),u&&u.m(f,m),h(f,t,m),c&&c.m(f,m),h(f,o,m),d&&d.m(f,m),h(f,l,m),i=!0},p(f,[m]){f[0]!="links"?a?(a.p(f,m),m&1&&_(a,1)):(a=$t(f),a.c(),_(a,1),a.m(e.parentNode,e)):a&&(ae(),b(a,1,1,()=>{a=null}),ce()),f[0]!="bus_stops"?s?(s.p(f,m),m&1&&_(s,1)):(s=kt(f),s.c(),_(s,1),s.m(r.parentNode,r)):s&&(ae(),b(s,1,1,()=>{s=null}),ce()),f[0]!="crossings"?u?(u.p(f,m),m&1&&_(u,1)):(u=bt(f),u.c(),_(u,1),u.m(t.parentNode,t)):u&&(ae(),b(u,1,1,()=>{u=null}),ce()),f[0]!="jats"?c?(c.p(f,m),m&1&&_(c,1)):(c=wt(f),c.c(),_(c,1),c.m(o.parentNode,o)):c&&(ae(),b(c,1,1,()=>{c=null}),ce()),f[0]!="side_roads"?d?(d.p(f,m),m&1&&_(d,1)):(d=vt(f),d.c(),_(d,1),d.m(l.parentNode,l)):d&&(ae(),b(d,1,1,()=>{d=null}),ce())},i(f){i||(_(a),_(s),_(u),_(c),_(d),i=!0)},o(f){b(a),b(s),b(u),b(c),b(d),i=!1},d(f){f&&($(e),$(r),$(t),$(o),$(l)),a&&a.d(f),s&&s.d(f),u&&u.d(f),c&&c.d(f),d&&d.d(f)}}}function Sr(n,e,r){let t;ee(n,G,i=>r(2,t=i));let{except:o}=e,{showLinkColor:l=!1}=e;return n.$$set=i=>{"except"in i&&r(0,o=i.except),"showLinkColor"in i&&r(1,l=i.showLinkColor)},[o,l,t]}class Ee extends ie{constructor(e){super(),se(this,e,Sr,zr,le,{except:0,showLinkColor:1})}}const{window:Br}=He;function Lr(n){let e;return{c(){e=U("ST20: bus stops")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Mr(n){let e,r,t,o,l,i,a,s,u,c,d,f,m,p;function A(y){n[8](y)}let O={k:"horiz-radio",choices:ke(),$$slots:{default:[Lr]},$$scope:{ctx:n}};return n[1].bus_stops[n[0]].properties.st20!==void 0&&(O.value=n[1].bus_stops[n[0]].properties.st20),c=new Me({props:O}),ue.push(()=>de(c,"value",A)),{c(){e=w("div"),r=w("button"),r.textContent="Done",t=z(),o=w("button"),o.textContent="Delete bus stop",l=z(),i=w("label"),a=U(`Name:
      `),s=w("input"),u=z(),M(c.$$.fragment),P(s,"type","text"),P(e,"slot","sidebar")},m(y,v){h(y,e,v),g(e,r),g(e,t),g(e,o),g(e,l),g(e,i),g(i,a),g(i,s),he(s,n[1].bus_stops[n[0]].properties.name),g(e,u),T(c,e,null),f=!0,m||(p=[Q(r,"click",n[6]),Q(o,"click",n[4]),Q(s,"input",n[7])],m=!0)},p(y,v){v&3&&s.value!==y[1].bus_stops[y[0]].properties.name&&he(s,y[1].bus_stops[y[0]].properties.name);const N={};v&512&&(N.$$scope={dirty:v,ctx:y}),!d&&v&3&&(d=!0,N.value=y[1].bus_stops[y[0]].properties.st20,me(()=>d=!1)),c.$set(N)},i(y){f||(_(c.$$.fragment,y),f=!0)},o(y){b(c.$$.fragment,y),f=!1},d(y){y&&$(e),I(c),m=!1,$e(p)}}}function Tr(n){let e,r;return e=new qe({props:{filter:["!=",["id"],n[0]],layout:{"icon-image":"bus_stop","icon-size":3},paint:{"icon-color":"black"}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&1&&(l.filter=["!=",["id"],t[0]]),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function Ir(n){let e,r;return{c(){e=w("img"),Ke(e.src,r=En)||P(e,"src",r)},m(t,o){h(t,e,o)},p:V,d(t){t&&$(e)}}}function Dr(n){let e,r,t,o,l,i,a,s;r=new Ee({props:{except:"bus_stops"}}),o=new _e({props:{data:re(n[1].bus_stops),generateId:!0,$$slots:{default:[Tr]},$$scope:{ctx:n}}});function u(d){n[5](d)}let c={color:n[1].bus_stops[n[0]].properties.color,$$slots:{default:[Ir]},$$scope:{ctx:n}};return n[1].bus_stops[n[0]].geometry.coordinates!==void 0&&(c.lngLat=n[1].bus_stops[n[0]].geometry.coordinates),i=new ut({props:c}),ue.push(()=>de(i,"lngLat",u)),{c(){e=w("div"),M(r.$$.fragment),t=z(),M(o.$$.fragment),l=z(),M(i.$$.fragment),P(e,"slot","map")},m(d,f){h(d,e,f),T(r,e,null),g(e,t),T(o,e,null),g(e,l),T(i,e,null),s=!0},p(d,f){const m={};f&2&&(m.data=re(d[1].bus_stops)),f&513&&(m.$$scope={dirty:f,ctx:d}),o.$set(m);const p={};f&3&&(p.color=d[1].bus_stops[d[0]].properties.color),f&512&&(p.$$scope={dirty:f,ctx:d}),!a&&f&3&&(a=!0,p.lngLat=d[1].bus_stops[d[0]].geometry.coordinates,me(()=>a=!1)),i.$set(p)},i(d){s||(_(r.$$.fragment,d),_(o.$$.fragment,d),_(i.$$.fragment,d),s=!0)},o(d){b(r.$$.fragment,d),b(o.$$.fragment,d),b(i.$$.fragment,d),s=!1},d(d){d&&$(e),I(r),I(o),I(i)}}}function Er(n){let e,r,t,o;return e=new Te({props:{$$slots:{map:[Dr],sidebar:[Mr]},$$scope:{ctx:n}}}),{c(){M(e.$$.fragment)},m(l,i){T(e,l,i),r=!0,t||(o=Q(Br,"keydown",n[3]),t=!0)},p(l,[i]){const a={};i&519&&(a.$$scope={dirty:i,ctx:l}),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){b(e.$$.fragment,l),r=!1},d(l){I(e,l),t=!1,o()}}}function Or(n,e,r){let t,o;ee(n,G,f=>r(1,t=f)),ee(n,J,f=>r(2,o=f));let{idx:l}=e;function i(f){f.key=="Escape"&&H(J,o={kind:"neutral"},o)}async function a(){window.confirm("Really delete this bus stop?")&&(H(J,o={kind:"neutral"},o),await Ne(),t.bus_stops.splice(l,1),G.set(t))}function s(f){n.$$.not_equal(t.bus_stops[l].geometry.coordinates,f)&&(t.bus_stops[l].geometry.coordinates=f,G.set(t))}const u=()=>H(J,o={kind:"neutral"},o);function c(){t.bus_stops[l].properties.name=this.value,G.set(t)}function d(f){n.$$.not_equal(t.bus_stops[l].properties.st20,f)&&(t.bus_stops[l].properties.st20=f,G.set(t))}return n.$$set=f=>{"idx"in f&&r(0,l=f.idx)},[l,t,o,i,a,s,u,c,d]}class Nr extends ie{constructor(e){super(),se(this,e,Or,Er,le,{idx:0})}}let Qe={SA01:{description:"Pedestrian and cyclist conflict with motor traffic at side roads/priority junctions",green:"Side roads/priority junctions have entry treatments that offer greater protection for  pedestrian and cycle movements (e.g. exit only, continuous footways, zebra/parallel crossings as appropriate to context).",amber:"<2,500vpd cut across main walking, wheeling or cycling streams and side roads and priority junctions have entry treatments. ",red:"<2,500vpd cut across main walking, wheeling or cycling streams, but side roads and priority junctions are untreated.",critical:">2,500vpd cut across main walking, wheeling or cycling streams."},SA02:{description:"Pedestrian and cyclist conflict with motor traffic at roundabouts and signal-controlled junctions",green:"All pedestrian and cyclist movements are separated from all motor traffic movements at roundabouts and/or signal controlled junctions.",amber:"The principal pedestrian and cyclist movements are separated from motor traffic movements at roundabouts and/or signal controlled junctions.",red:"The principal pedestrian and/or cyclist movements are in conflict with motor traffic movements at roundabouts and/or signal controlled junctions.",critical:">2,500vpd cut across main walking, wheeling or cycling streams."},SA03:{description:"Effect of lane widths on conflict between cyclists and motor traffic",green:"Cyclists are protected from motor traffic or off-road entirely.",amber:`Cyclists are in cycle lanes with light protection or stepped cycle tracks under 1.8m wide (single direction).

Or, cyclists are in a protected bidirectional cycle facility under 2.5m wide.

Or, cyclists are mixed with traffic on quiet urban streets with no centre line.`,red:`Cyclists are mixed with traffic in lanes less than 3.25m wide or over 3.9m wide.

Or, cyclists are in unprotected cycle lanes and the combined width of the cycle lane and adjacent traffic lane is under 3.25m or over 3.9m. 

Or cyclists are mixed with traffic on busy urban streets with no centre line.

Or, there are speed cushions present.`,critical:`Cyclists are mixed with traffic in lanes between 3.25m and 3.9m wide. 

Or, cyclists are in unprotected cycle lanes and the combined width of the cycle lane and adjacent traffic lane is between 3.25m and 3.9m.`},SA04:{description:"Risk of pedestrians tripping due to hazards",green:"No trip hazards, level clear surface.",amber:"Few trip hazards.",red:"Many trip hazards.",critical:"There are level differences of greater than 13mm with no tactile information and colour contrast to help identify them."},SA05:{description:"Cyclist conflict with kerbside activity, including risk of 'dooring' ",green:"Kerbside activity is well-managed with no or minimal conflict with cyclists. ",amber:"Less frequent kerbside activity, and conflict with cyclists is well-managed.",red:"Frequent kerbside activity for cyclists to contend with. Conflict with cyclists is not well-managed.",critical:`Cycle facility next to parking/loading facility, without a buffer of at least 0.5m.

Or, an unprotected cycle lane is next to a frequently-used bus layby.`},SA06:{description:"Ability of pedestrians to cross the street safely on desire lines",green:`On very busy streets (>8,000vpd), controlled crossings (including zebra crossings) are provided every 50-100m. 

On quieter streets (<8,000vpd), there are controlled crossings or only one lane of traffic to cross.`,amber:`On very busy streets (>8,000vpd), controlled crossings (including zebra crossings) are provided every 100-200m.

On quieter streets (<8,000vpd), loading/parking is formalised with gaps for pedestrians to cross on desire lines.`,red:`On very busy streets (>8,000vpd), controlled crossings (including zebra crossings) are provided every 200-400m.

On quieter streets (<8,000vpd), loading/parking is formalised with gaps for pedestrians to cross.`,critical:`On very busy streets (>8,000vpd) controlled crossings (including zebra crossings) are not present or more than 400m apart.

On quieter streets (<8,000vpd), desire lines are blocked by parking and loading. `},SA07:{description:"Suitability of pedestrian crossings in context",green:`On very busy streets (>8,000vpd), signal crossings rest on green for pedestrians or have rapid response.

On quieter streets (<8,000vpd), crossing points are controlled crossings.`,amber:`On very busy streets (>8,000vpd), signal crossings are provided for pedestrians.

On quieter streets (<8,000vpd), crossing points have effective implied priority for pedestrians.`,red:`On very busy streets (>8,000vpd), there are uncontrolled crossings or zebra/parallel crossings.

On quieter streets (<8,000vpd), crossing points have no implied priority or there are no crossing points.`,critical:`On very busy streets (>8,000vpd), there are uncontrolled crossings of two or more lanes with no gaps in traffic.

At signal junctions there are arms with dropped kerbs and tactile paving but no green pedestrian symbol.`},SA08:{description:"85th percentile speed of motor traffic (where cyclists are not protected or pedestrians are crossing uncontrolled)",green:`85th percentile speed is under 20mph.

Or, cyclists are protected from motor traffic or off-road entirely and controlled crossings are provided for pedestrians wherever needed.`,amber:"85th percentile speed is between 20mph and 25mph.",red:"85th percentile speed is over 25mph.",critical:"85th percentile speed is over 30mph."},SA09:{description:"Volume of motor traffic at the busiest hour (where cyclists are not protected or pedestrians cross uncontrolled)",green:`<200 vehicles in the busiest hour.

Or, cyclists are protected from motor traffic or off-road entirely and controlled crossings are provided for pedestrians wherever needed.`,amber:`200-499 vehicles in the busiest hour.

And, less than 2% of traffic is HGVs.`,red:`500-1,000 vehicles in the busiest hour.

Or, 2-5% of traffic is HGVs where there are 200-499 vehicles in the busiest hour.`,critical:`>1,000 vehicles in the busiest hour.

Or, over 5% of traffic is HGVs where there are over 500 vehicles in the busiest hour.`},SA10:{description:"Required crossing speed at signal crossings (risk of pedestrians coming into conflict with traffic).",green:"There are detectors present on the crossing which extend crossing times based on a crossing speed of 1m/s.",amber:"There are detectors present on the crossing which extend crossing times based on a crossing speed of 1.2m/s.",red:"There are no detectors to extend crossing times, but pedestrians who start crossing at the end of the 'invitation to cross' can cross at a speed of 1.2m/s and get across the whole crossing in time.",critical:"Pedestrians who start crossing at the end of the 'invitation to cross' must cross at a speed of over 1.2m/s to get across the whole crossing in time."},SA11:{description:"Clear walking and wheeling spaces free of permanent obstructions and furniture, reducing risk of pedestrians walking in the carriageway.",green:">3m clear footway width and pedestrian comfort is good (PCL of A-C).",amber:`Where the footway is next to the carriageway, there is:
• 2m-3m clear footway width and pedestrian comfort is good (PCL of A-C).
• >3m clear footway width and pedestrian comfort is poor (PCL of D-E).

Where the footway is not next to the carriageway, the clear footway width is 1.5m-3m.`,red:`Where the footway is next to the carriageway, there is:
• <2m clear footway width but pedestrian comfort is good (PCL of A-C)
• 2m-3m clear footway width and pedestrian comfort is poor (PCL of D-E).

Where the footway is not next to the carriageway, the clear footway width is <1.5m.`,critical:`Where the footway is next to the carriageway, there is:
• <1m clear footway width on any footway
• <1.5m clear footway width for over 6m
• 1m-2m clear footway width with a Pedestrian Comfort Level of D-E

Or there is no footway.`},SA12:{description:"Effective width next to tram line on a straight run or a curve",green:"Physical protection is provided for cyclists.",amber:">2.4m from tramline edge to kerb.",red:"2.4m from tramline edge to kerb.",critical:`<2.4m from tramline edge to kerb on a straight run.

Insufficient clearance on a curve.`},SA13:{description:"Crossing angle (between cyclist desire line and tram or train rails).",green:"Crossing angle between 80 and 90 degrees with track filler creating a smooth crossing for cyclists.",amber:"Crossing angle between 80 and 90 degrees (or between 60 and 80 degrees with track filler creating a smooth crossing for cyclists).",red:"Crossing angle between 60 and 80 degrees.",critical:"Crossing angle less than 60 degrees."},SA14:{description:`Cycling surface and maintenance defects:
• sharp gradients (≥12.5%)
• non cycle friendly ironworks
• raised/sunken covers or gullies
• potholes
• loose/cracked surfaces
• poor drainage or slip risks
• overgrown vegetation`,green:"No defects.",amber:"Few minor defects.",red:"Many minor defects.",critical:"Major defects."},SA15:{description:`Walking/wheeling surface and maintenance defects:
• steep camber (horizontal gradient >2.5% )
• steep longitudinal gradients (≥8% if under 1m, ≥5% if 1m or over) 
• missing dropped kerbs
• non flush tables
• misleading tactile information
• loose/cracked surfaces
• poor drainage or slip risks
• overgrown vegetation
`,green:"No defects.",amber:"Few minor defects.",red:"Many minor defects.",critical:"Major defects."},SA16:{description:"Presence of guard railing",green:"No guard railing anywhere on the route.",amber:"Minimal guard railing, used to address a clear safety issue such as a level difference.",red:"Guard railing used to control behaviour in complex environments.",critical:"Guard railing used as standard without consideration of inherent safety risks."}};function qr(n){let e,r,t,o=n[0].green+"",l,i,a,s,u,c=n[0].amber+"",d,f,m,p,A,O=n[0].red+"",y,v,N,S,j,k=n[0].critical+"",C;return{c(){e=w("p"),r=w("b"),r.textContent="2",t=U(`
  : `),l=U(o),i=z(),a=w("p"),s=w("b"),s.textContent="1",u=U(`
  : `),d=U(c),f=z(),m=w("p"),p=w("b"),p.textContent="0",A=U(`
  : `),y=U(O),v=z(),N=w("p"),S=w("b"),S.textContent="Critical",j=U(`
  : `),C=U(k)},m(B,E){h(B,e,E),g(e,r),g(e,t),g(e,l),h(B,i,E),h(B,a,E),g(a,s),g(a,u),g(a,d),h(B,f,E),h(B,m,E),g(m,p),g(m,A),g(m,y),h(B,v,E),h(B,N,E),g(N,S),g(N,j),g(N,C)},p(B,[E]){E&1&&o!==(o=B[0].green+"")&&oe(l,o),E&1&&c!==(c=B[0].amber+"")&&oe(d,c),E&1&&O!==(O=B[0].red+"")&&oe(y,O),E&1&&k!==(k=B[0].critical+"")&&oe(C,k)},i:V,o:V,d(B){B&&($(e),$(i),$(a),$(f),$(m),$(v),$(N))}}}function Fr(n,e,r){let{metric:t}=e;return n.$$set=o=>{"metric"in o&&r(0,t=o.metric)},[t]}class nt extends ie{constructor(e){super(),se(this,e,Fr,qr,le,{metric:0})}}const{window:Pr}=He;function Ur(n){let e;return{c(){e=U("SA10: pedestrian crossing speed")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Gr(n){let e,r,t,o,l,i,a,s,u,c,d,f,m,p,A,O,y,v;function N(j){n[9](j)}let S={k:"horiz-radio",choices:ke(),$$slots:{default:[Ur]},$$scope:{ctx:n}};return n[1].crossings[n[0]].properties.sa10!==void 0&&(S.value=n[1].crossings[n[0]].properties.sa10),c=new Me({props:S}),ue.push(()=>de(c,"value",N)),A=new nt({props:{metric:n[3]}}),{c(){e=w("div"),r=w("button"),r.textContent="Done",t=z(),o=w("button"),o.textContent="Delete crossing",l=z(),i=w("label"),a=U(`Name:
      `),s=w("input"),u=z(),M(c.$$.fragment),f=z(),m=w("p"),m.textContent=`${n[3].description}`,p=z(),M(A.$$.fragment),P(s,"type","text"),P(e,"slot","sidebar")},m(j,k){h(j,e,k),g(e,r),g(e,t),g(e,o),g(e,l),g(e,i),g(i,a),g(i,s),he(s,n[1].crossings[n[0]].properties.name),g(e,u),T(c,e,null),g(e,f),g(e,m),g(e,p),T(A,e,null),O=!0,y||(v=[Q(r,"click",n[7]),Q(o,"click",n[5]),Q(s,"input",n[8])],y=!0)},p(j,k){k&3&&s.value!==j[1].crossings[j[0]].properties.name&&he(s,j[1].crossings[j[0]].properties.name);const C={};k&1024&&(C.$$scope={dirty:k,ctx:j}),!d&&k&3&&(d=!0,C.value=j[1].crossings[j[0]].properties.sa10,me(()=>d=!1)),c.$set(C)},i(j){O||(_(c.$$.fragment,j),_(A.$$.fragment,j),O=!0)},o(j){b(c.$$.fragment,j),b(A.$$.fragment,j),O=!1},d(j){j&&$(e),I(c),I(A),y=!1,$e(v)}}}function Qr(n){let e,r;return e=new qe({props:{filter:["!=",["id"],n[0]],layout:{"icon-image":"crossing","icon-size":.1},paint:{"icon-color":"black"}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&1&&(l.filter=["!=",["id"],t[0]]),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function Hr(n){let e,r;return{c(){e=w("img"),Ke(e.src,r=On)||P(e,"src",r)},m(t,o){h(t,e,o)},p:V,d(t){t&&$(e)}}}function Jr(n){let e,r,t,o,l,i,a,s;r=new Ee({props:{except:"crossings"}}),o=new _e({props:{data:re(n[1].crossings),generateId:!0,$$slots:{default:[Qr]},$$scope:{ctx:n}}});function u(d){n[6](d)}let c={color:n[1].crossings[n[0]].properties.color,$$slots:{default:[Hr]},$$scope:{ctx:n}};return n[1].crossings[n[0]].geometry.coordinates!==void 0&&(c.lngLat=n[1].crossings[n[0]].geometry.coordinates),i=new ut({props:c}),ue.push(()=>de(i,"lngLat",u)),{c(){e=w("div"),M(r.$$.fragment),t=z(),M(o.$$.fragment),l=z(),M(i.$$.fragment),P(e,"slot","map")},m(d,f){h(d,e,f),T(r,e,null),g(e,t),T(o,e,null),g(e,l),T(i,e,null),s=!0},p(d,f){const m={};f&2&&(m.data=re(d[1].crossings)),f&1025&&(m.$$scope={dirty:f,ctx:d}),o.$set(m);const p={};f&3&&(p.color=d[1].crossings[d[0]].properties.color),f&1024&&(p.$$scope={dirty:f,ctx:d}),!a&&f&3&&(a=!0,p.lngLat=d[1].crossings[d[0]].geometry.coordinates,me(()=>a=!1)),i.$set(p)},i(d){s||(_(r.$$.fragment,d),_(o.$$.fragment,d),_(i.$$.fragment,d),s=!0)},o(d){b(r.$$.fragment,d),b(o.$$.fragment,d),b(i.$$.fragment,d),s=!1},d(d){d&&$(e),I(r),I(o),I(i)}}}function Rr(n){let e,r,t,o;return e=new Te({props:{$$slots:{map:[Jr],sidebar:[Gr]},$$scope:{ctx:n}}}),{c(){M(e.$$.fragment)},m(l,i){T(e,l,i),r=!0,t||(o=Q(Pr,"keydown",n[4]),t=!0)},p(l,[i]){const a={};i&1031&&(a.$$scope={dirty:i,ctx:l}),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){b(e.$$.fragment,l),r=!1},d(l){I(e,l),t=!1,o()}}}function Kr(n,e,r){let t,o;ee(n,G,m=>r(1,t=m)),ee(n,J,m=>r(2,o=m));let{idx:l}=e,i=Qe.SA10;function a(m){m.key=="Escape"&&H(J,o={kind:"neutral"},o)}async function s(){window.confirm("Really delete this crossing?")&&(H(J,o={kind:"neutral"},o),await Ne(),t.crossings.splice(l,1),G.set(t))}function u(m){n.$$.not_equal(t.crossings[l].geometry.coordinates,m)&&(t.crossings[l].geometry.coordinates=m,G.set(t))}const c=()=>H(J,o={kind:"neutral"},o);function d(){t.crossings[l].properties.name=this.value,G.set(t)}function f(m){n.$$.not_equal(t.crossings[l].properties.sa10,m)&&(t.crossings[l].properties.sa10=m,G.set(t))}return n.$$set=m=>{"idx"in m&&r(0,l=m.idx)},[l,t,o,i,a,s,u,c,d,f]}class Xr extends ie{constructor(e){super(),se(this,e,Kr,Rr,le,{idx:0})}}let yt="MZEJTanw3WpxRvt7qDfo";async function Zr(n){return n?{version:8,sources:{"raster-tiles":{type:"raster",tiles:[`https://tile.googleapis.com/v1/2dtiles/{z}/{x}/{y}?session=${await Yr(n)}&key=${n}`],tileSize:256,attribution:"Google (detailed attributions not wired up)"}},layers:[{id:"raster-basemap",type:"raster",source:"raster-tiles"}],glyphs:`https://api.maptiler.com/fonts/{fontstack}/{range}.pbf?key=${yt}`}:`https://api.maptiler.com/maps/dataviz/style.json?key=${yt}`}async function Yr(n){try{let r=await(await fetch(`https://tile.googleapis.com/v1/createSession?key=${n}`,{method:"POST",body:JSON.stringify({mapType:"satellite",language:"en-GB",region:"GB"})})).json();return"session"in r?r.session:(console.error(`Couldn't get Google tile session key: ${JSON.stringify(r)}`),"")}catch(e){return console.error(`Couldn't get Google tile session key: ${e}`),""}}const Vr="/route-element/assets/right-arrow-d8c7892c.svg";function At(n){let e,r;const t=n[4].default,o=je(t,n,n[3],null);return{c(){e=w("div"),o&&o.c(),P(e,"class","section svelte-zax3q3")},m(l,i){h(l,e,i),o&&o.m(e,null),r=!0},p(l,i){o&&o.p&&(!r||i&8)&&ze(o,t,l,l[3],r?Be(t,l[3],i,null):Se(l[3]),null)},i(l){r||(_(o,l),r=!0)},o(l){b(o,l),r=!1},d(l){l&&$(e),o&&o.d(l)}}}function Wr(n){let e,r,t,o,l,i,a,s,u,c,d,f,m=n[2]&&At(n);return{c(){e=w("button"),r=w("div"),t=w("span"),o=U(n[0]),l=z(),i=w("img"),u=z(),m&&m.c(),P(i,"class","arrow svelte-zax3q3"),Ke(i.src,a=Vr)||P(i,"src",a),P(i,"alt",s="Select "+n[0]),P(r,"class","top-section section svelte-zax3q3"),Ge(r,"bordered",n[2]),P(e,"class","clickable-card svelte-zax3q3"),e.disabled=n[1]},m(p,A){h(p,e,A),g(e,r),g(r,t),g(t,o),g(r,l),g(r,i),g(e,u),m&&m.m(e,null),c=!0,d||(f=[Q(e,"click",n[5]),Q(e,"mouseenter",n[6]),Q(e,"mouseleave",n[7])],d=!0)},p(p,[A]){(!c||A&1)&&oe(o,p[0]),(!c||A&1&&s!==(s="Select "+p[0]))&&P(i,"alt",s),(!c||A&4)&&Ge(r,"bordered",p[2]),p[2]?m?(m.p(p,A),A&4&&_(m,1)):(m=At(p),m.c(),_(m,1),m.m(e,null)):m&&(ae(),b(m,1,1,()=>{m=null}),ce()),(!c||A&2)&&(e.disabled=p[1])},i(p){c||(_(m),c=!0)},o(p){b(m),c=!1},d(p){p&&$(e),m&&m.d(),d=!1,$e(f)}}}function xr(n,e,r){let{$$slots:t={},$$scope:o}=e,{name:l}=e,{disabled:i=!1}=e,{hasSlot:a=!0}=e;function s(d){be.call(this,n,d)}function u(d){be.call(this,n,d)}function c(d){be.call(this,n,d)}return n.$$set=d=>{"name"in d&&r(0,l=d.name),"disabled"in d&&r(1,i=d.disabled),"hasSlot"in d&&r(2,a=d.hasSlot),"$$scope"in d&&r(3,o=d.$$scope)},[l,i,a,o,t,s,u,c]}class qn extends ie{constructor(e){super(),se(this,e,xr,Wr,le,{name:0,disabled:1,hasSlot:2})}}let Ie={critical:{background:"#232323",font:"white"},red:{background:"#b73d25",font:"white"},amber:{background:"#ffd833",font:"black"},green:{background:"#006853",font:"white"},notApplicable:{background:"white",font:"black"}};const eo=n=>({dialog:n&1}),Ct=n=>({dialog:n[0]});function to(n){let e,r,t,o,l;const i=n[4].default,a=je(i,n,n[3],Ct);return{c(){e=w("dialog"),r=w("article"),a&&a.c(),e.open=!0},m(s,u){h(s,e,u),g(e,r),a&&a.m(r,null),n[6](e),t=!0,o||(l=[Q(window,"click",n[1]),Q(window,"keydown",n[2]),Q(e,"close",n[5])],o=!0)},p(s,[u]){a&&a.p&&(!t||u&9)&&ze(a,i,s,s[3],t?Be(i,s[3],u,eo):Se(s[3]),Ct)},i(s){t||(_(a,s),t=!0)},o(s){b(a,s),t=!1},d(s){s&&$(e),a&&a.d(s),n[6](null),o=!1,$e(l)}}}function no(n,e,r){let{$$slots:t={},$$scope:o}=e,l;function i(c){l.open&&c.target==l&&l.close()}function a(c){(c.key=="Escape"||c.key=="Enter")&&(c.stopPropagation(),l.close())}function s(c){be.call(this,n,c)}function u(c){ue[c?"unshift":"push"](()=>{l=c,r(0,l)})}return n.$$set=c=>{"$$scope"in c&&r(3,o=c.$$scope)},[l,i,a,o,t,s,u]}class rt extends ie{constructor(e){super(),se(this,e,no,to,le,{})}}function ro(n,e){let r=document.createElement("a");r.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),r.setAttribute("download",n),document.body.appendChild(r),r.click(),document.body.removeChild(r)}const Fe={"Any type of junction":{"All movements":{scoreZero:["Cycle movement in potential conflict with heavy motor traffic flow.","Cycle movement mixed with or crossing traffic with 85th percentile speed exceeding 60kph, or where vehicles accelerate rapidly.","Necessary to cross more than one traffic lane (without refuge or protection) to complete cycle movement unless traffic flows are low.","Cycle movement crosses wide junction entry or exit: e.g. with merge or diverge taper or slip lane.","Pinch points on junction entry or exit (lane width 3.2m-3.9m).","Cycle movement affected by very poor surface quality utility reinstatement, gully positioning, debris."],scoreOne:["Cycle movement in potential conflict with moderate traffic flow.","Cycle lanes through junction meeting appropriate desirable minimum width requirements for the movement under consideration.","Raised table at junction crossed by traffic in potential conflict with cycle movement.","Cycle movement made by transiting onto section of shared use footway."],scoreTwo:["Low traffic speed and volume in mixed traffic environment (e.g. access-only streets in a residential area).","Cycle movement separated physically and/or in time from motor traffic and also separated from pedestrians.","Cycle movement bypasses junction completely, including via good quality grade separation."]}},"Simple priority T-junction":{"Right turn from minor arm":{scoreZero:["Heavy traffic movements and/or high bus and HGV flows in potential conflict with cycle movement, with no physical refuge in the centre of the major road (including ghost island junction)."],scoreOne:["Central refuge allowing two-stage cycle movement crossing one traffic lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm with dedicated cycle signals or cycle priority."]},"Left turn from major arm":{scoreZero:[],scoreOne:["Side road entry treatment (table across minor arm)."],scoreTwo:["Continuous footway and cycle track across minor arm."]},"Right turn from major arm":{scoreZero:["Heavy traffic movements and/or high bus and HGV flows in potential conflict with no physical refuge in the centre of major road (including ghost island junction)."],scoreOne:["Protected turning refuge allowing two stage cycle movement, crossing one lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm via dedicated cycle signals or cycle priority."]},"Ahead on major arm, crossing minor arm":{scoreZero:["Congested conditions causing poor visibility for right-turning motor vehicles from major arm.","Junction corner radius ≥9m, including where off-carriageway cycle track crosses minor arm."],scoreOne:["Junction free from queueing traffic and cycle lane on major arm meeting desirable minimum width requirements.","Junction corner radius <9m, including where off-carriageway cycle track crosses minor arm without priority.","Side road entry treatment (table across minor arm)."],scoreTwo:["Off-carriageway cycle track or stepped cycle track alongside major arm, crossing minor arm with priority over turning traffic."]}},Crossroads:{"Ahead from minor arm":{scoreZero:["Heavy opposing traffic movements with no physical refuge (including ghost island junction)."],scoreOne:["Protected pocket refuge for ahead cycles allowing two stage movement, crossing one lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm via dedicated cycle signals or cycle priority."]}},"Traffic Signals":{"All movements":{scoreZero:["Single or multiple queuing lanes with no cycle lanes or tracks on approaches.","Junctions with unsignalised left turn merge/diverge and signalised ahead lanes."],scoreOne:["Advance Cycle Stop lines, at least 5m deep and where the signals on the approach are on green for <30% of the cycle time.","Signal timings adjusted to provide extended intergreen to suit cycle movement under consideration.","Cycle/pedestrian scramble (toucan crossings with all-red stage).","Early release for cycles, with enough time to clear junction for cycle movement being considered."],scoreTwo:["Cycle movement has no potential conflict with motor traffic, e.g. dedicated cycle stage, conflicting traffic movement held or banned."]},"Right turn":{scoreZero:[],scoreOne:["Two-stage right turn via ASL or marked area in front of stop line."],scoreTwo:["Two-stage right turn with physically protected waiting area."]}},Roundabout:{"All movements":{scoreZero:["Any type of roundabout with high traffic throughput.","Normal roundabout with multi-lane flared approaches.","Any type of roundabout with annular cycle lane marked on the circulatory carriageway."],scoreOne:["Compact roundabout or raised mini roundabout with no more than moderate traffic throughput","Off-carriageway cycle track with crossings of entries and exits without cycle priority, crossing single traffic lanes with traffic flows < 4000 vehicles per day or 400 HGV/bus flow. "],scoreTwo:["Off-carriageway cycle track with crossings of entries and exits with signals or cycle priority."]}}},Fn=Object.keys(Fe);function tt(n){return Object.keys(Fe[n])}const Oe="All movements";function jt(n,e){let r=[],t=Fe[n][e];t&&r.push({junctionType:n,movementType:e,...t});let o=Fe[n][Oe];if(o&&e!=Oe&&r.push({junctionType:n,movementType:Oe,...o}),n=="Crossroads"){let l=Fe["Simple priority T-junction"][Oe];l&&r.push({junctionType:"Simple priority T-junction",movementType:Oe,...l})}if(n!="Any type of junction"){let l=Fe["Any type of junction"][Oe];l&&r.push({junctionType:"Any type of junction",movementType:Oe,...l})}return r}function zt(n,e,r){const t=n.slice();return t[9]=e[r],t}function St(n,e,r){const t=n.slice();return t[12]=e[r],t}function Bt(n,e,r){const t=n.slice();return t[12]=e[r],t}function Lt(n,e,r){const t=n.slice();return t[12]=e[r],t}function Mt(n){let e,r;return e=new rt({props:{$$slots:{default:[io]},$$scope:{ctx:n}}}),e.$on("close",n[8]),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&524295&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function oo(n){let e;return{c(){e=U("Type of junction")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function lo(n){let e;return{c(){e=U("Type of movement")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Tt(n){let e,r,t;function o(i){n[6](i)}let l={k:"vert-radio",choices:tt(n[1]),$$slots:{default:[lo]},$$scope:{ctx:n}};return n[2]!==void 0&&(l.value=n[2]),e=new Me({props:l}),ue.push(()=>de(e,"value",o)),{c(){M(e.$$.fragment)},m(i,a){T(e,i,a),t=!0},p(i,a){const s={};a&2&&(s.choices=tt(i[1])),a&524288&&(s.$$scope={dirty:a,ctx:i}),!r&&a&4&&(r=!0,s.value=i[2],me(()=>r=!1)),e.$set(s)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){b(e.$$.fragment,i),t=!1},d(i){I(e,i)}}}function It(n){let e,r=n[12]+"",t;return{c(){e=w("li"),t=U(r)},m(o,l){h(o,e,l),g(e,t)},p(o,l){l&6&&r!==(r=o[12]+"")&&oe(t,r)},d(o){o&&$(e)}}}function Dt(n){let e,r=n[12]+"",t;return{c(){e=w("li"),t=U(r)},m(o,l){h(o,e,l),g(e,t)},p(o,l){l&6&&r!==(r=o[12]+"")&&oe(t,r)},d(o){o&&$(e)}}}function Et(n){let e,r=n[12]+"",t;return{c(){e=w("li"),t=U(r)},m(o,l){h(o,e,l),g(e,t)},p(o,l){l&6&&r!==(r=o[12]+"")&&oe(t,r)},d(o){o&&$(e)}}}function Ot(n){let e,r,t=n[9].junctionType+"",o,l,i,a,s,u,c=n[9].movementType+"",d,f,m,p,A,O,y,v,N,S,j,k=Y(n[9].scoreZero),C=[];for(let D=0;D<k.length;D+=1)C[D]=It(Lt(n,k,D));let B=Y(n[9].scoreOne),E=[];for(let D=0;D<B.length;D+=1)E[D]=Dt(Bt(n,B,D));let K=Y(n[9].scoreTwo),R=[];for(let D=0;D<K.length;D+=1)R[D]=Et(St(n,K,D));return{c(){e=w("tr"),r=w("td"),o=U(t),l=z(),i=w("br"),a=z(),s=w("br"),u=z(),d=U(c),f=z(),m=w("td"),p=w("ul");for(let D=0;D<C.length;D+=1)C[D].c();A=z(),O=w("td"),y=w("ul");for(let D=0;D<E.length;D+=1)E[D].c();v=z(),N=w("td"),S=w("ul");for(let D=0;D<R.length;D+=1)R[D].c();j=z(),P(r,"class","type-row svelte-k4kgn3"),P(m,"class","score-zero svelte-k4kgn3"),P(O,"class","score-one svelte-k4kgn3"),P(N,"class","score-two svelte-k4kgn3")},m(D,te){h(D,e,te),g(e,r),g(r,o),g(r,l),g(r,i),g(r,a),g(r,s),g(r,u),g(r,d),g(e,f),g(e,m),g(m,p);for(let L=0;L<C.length;L+=1)C[L]&&C[L].m(p,null);g(e,A),g(e,O),g(O,y);for(let L=0;L<E.length;L+=1)E[L]&&E[L].m(y,null);g(e,v),g(e,N),g(N,S);for(let L=0;L<R.length;L+=1)R[L]&&R[L].m(S,null);g(e,j)},p(D,te){if(te&6&&t!==(t=D[9].junctionType+"")&&oe(o,t),te&6&&c!==(c=D[9].movementType+"")&&oe(d,c),te&6){k=Y(D[9].scoreZero);let L;for(L=0;L<k.length;L+=1){const ne=Lt(D,k,L);C[L]?C[L].p(ne,te):(C[L]=It(ne),C[L].c(),C[L].m(p,null))}for(;L<C.length;L+=1)C[L].d(1);C.length=k.length}if(te&6){B=Y(D[9].scoreOne);let L;for(L=0;L<B.length;L+=1){const ne=Bt(D,B,L);E[L]?E[L].p(ne,te):(E[L]=Dt(ne),E[L].c(),E[L].m(y,null))}for(;L<E.length;L+=1)E[L].d(1);E.length=B.length}if(te&6){K=Y(D[9].scoreTwo);let L;for(L=0;L<K.length;L+=1){const ne=St(D,K,L);R[L]?R[L].p(ne,te):(R[L]=Et(ne),R[L].c(),R[L].m(S,null))}for(;L<R.length;L+=1)R[L].d(1);R.length=K.length}},d(D){D&&$(e),pe(C,D),pe(E,D),pe(R,D)}}}function io(n){let e,r,t,o,l,i,a,s,u=n[1],c,d,f,m,p,A,O,y,v;function N(B){n[5](B)}let S={k:"vert-radio",choices:Fn,$$slots:{default:[oo]},$$scope:{ctx:n}};n[1]!==void 0&&(S.value=n[1]),i=new Me({props:S}),ue.push(()=>de(i,"value",N)),i.$on("change",n[3]);let j=Tt(n),k=Y(jt(n[1],n[2])),C=[];for(let B=0;B<k.length;B+=1)C[B]=Ot(zt(n,k,B));return{c(){e=w("h1"),e.textContent="LTN 1/20 scoring guidance",r=z(),t=w("p"),t.innerHTML=`Guidance from <a target="_blank" href="https://assets.publishing.service.gov.uk/media/5ffa1f96d3bf7f65d9e35825/cycle-infrastructure-design-ltn-1-20.pdf">LTN 1/20 appendix B</a>
      .`,o=z(),l=w("div"),M(i.$$.fragment),s=z(),j.c(),c=z(),d=w("table"),f=w("tr"),f.innerHTML=`<th class="type-header svelte-k4kgn3">Type of junction and movement</th> <th class="score-zero-header svelte-k4kgn3"><p class="svelte-k4kgn3"><b>Score = 0</b></p> <p class="svelte-k4kgn3">Suitable only for confident existing cyclists, and may be avoided by
            some experienced cyclists</p> <p class="svelte-k4kgn3">Conditions are most likely to give rise to the most common collision
            types</p></th> <th class="score-one-header svelte-k4kgn3"><p class="svelte-k4kgn3"><b>Score = 1</b></p> <p class="svelte-k4kgn3">Likely to be more acceptable to most cyclists, but may still pose
            problems for less confident or new cyclists</p> <p class="svelte-k4kgn3">The risk of collisions has been reduced by design layout or traffic
            management interventions</p></th> <th class="score-two-header svelte-k4kgn3"><p class="svelte-k4kgn3"><b>Score = 2</b></p> <p class="svelte-k4kgn3">Suitable for all potential and existing cyclists</p> <p class="svelte-k4kgn3">The potential for collisions has been removed, or managed to a high
            standard of safety for cyclists</p></th>`,m=z();for(let B=0;B<C.length;B+=1)C[B].c();p=z(),A=w("button"),A.textContent="OK",W(l,"display","flex"),W(l,"justify-content","space-between")},m(B,E){h(B,e,E),h(B,r,E),h(B,t,E),h(B,o,E),h(B,l,E),T(i,l,null),g(l,s),j.m(l,null),h(B,c,E),h(B,d,E),g(d,f),g(d,m);for(let K=0;K<C.length;K+=1)C[K]&&C[K].m(d,null);h(B,p,E),h(B,A,E),O=!0,y||(v=Q(A,"click",n[7]),y=!0)},p(B,E){const K={};if(E&524288&&(K.$$scope={dirty:E,ctx:B}),!a&&E&2&&(a=!0,K.value=B[1],me(()=>a=!1)),i.$set(K),E&2&&le(u,u=B[1])?(ae(),b(j,1,1,V),ce(),j=Tt(B),j.c(),_(j,1),j.m(l,null)):j.p(B,E),E&6){k=Y(jt(B[1],B[2]));let R;for(R=0;R<k.length;R+=1){const D=zt(B,k,R);C[R]?C[R].p(D,E):(C[R]=Ot(D),C[R].c(),C[R].m(d,null))}for(;R<C.length;R+=1)C[R].d(1);C.length=k.length}},i(B){O||(_(i.$$.fragment,B),_(j),O=!0)},o(B){b(i.$$.fragment,B),b(j),O=!1},d(B){B&&($(e),$(r),$(t),$(o),$(l),$(c),$(d),$(p),$(A)),I(i),j.d(B),pe(C,B),y=!1,v()}}}function so(n){let e,r,t,o,l,i,a=n[0]&&Mt(n);return{c(){e=w("button"),e.textContent="LTN 1/20 scoring guidance",r=z(),a&&a.c(),t=De(),P(e,"class","secondary")},m(s,u){h(s,e,u),h(s,r,u),a&&a.m(s,u),h(s,t,u),o=!0,l||(i=Q(e,"click",n[4]),l=!0)},p(s,[u]){s[0]?a?(a.p(s,u),u&1&&_(a,1)):(a=Mt(s),a.c(),_(a,1),a.m(t.parentNode,t)):a&&(ae(),b(a,1,1,()=>{a=null}),ce())},i(s){o||(_(a),o=!0)},o(s){b(a),o=!1},d(s){s&&($(e),$(r),$(t)),a&&a.d(s),l=!1,i()}}}function ao(n,e,r){let t=!1,o=Fn[0],l=tt(o)[0];function i(){r(2,l=tt(o)[0])}const a=()=>r(0,t=!0);function s(f){o=f,r(1,o)}function u(f){l=f,r(2,l)}return[t,o,l,i,a,s,u,()=>r(0,t=!1),()=>r(0,t=!1)]}class co extends ie{constructor(e){super(),se(this,e,ao,so,le,{})}}function uo(n){let e;return{c(){e=U("User")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Nt(n){let e,r;return e=new co({}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function fo(n){let e;return{c(){e=U("Score")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function mo(n){let e,r,t,o,l,i,a,s,u,c,d,f,m,p,A,O,y;function v(C){n[6](C)}let N={k:"horiz-radio",choices:[["cycling","Cycling"],["walking & wheeling","Walking & Wheeling"]],$$slots:{default:[uo]},$$scope:{ctx:n}};n[3].jats[n[0]].properties[n[1]].movements[n[2]].kind!==void 0&&(N.value=n[3].jats[n[0]].properties[n[1]].movements[n[2]].kind),l=new Me({props:N}),ue.push(()=>de(l,"value",v));let S=n[3].jats[n[0]].properties[n[1]].movements[n[2]].kind=="cycling"&&Nt();function j(C){n[7](C)}let k={k:"horiz-radio",choices:n[4],$$slots:{default:[fo]},$$scope:{ctx:n}};return n[3].jats[n[0]].properties[n[1]].movements[n[2]].score!==void 0&&(k.value=n[3].jats[n[0]].properties[n[1]].movements[n[2]].score),u=new Me({props:k}),ue.push(()=>de(u,"value",j)),{c(){e=w("label"),r=U(`Name
  `),t=w("input"),o=z(),M(l.$$.fragment),a=z(),S&&S.c(),s=z(),M(u.$$.fragment),d=z(),f=w("label"),m=U(`Comments
  `),p=w("textarea"),P(t,"type","text")},m(C,B){h(C,e,B),g(e,r),g(e,t),he(t,n[3].jats[n[0]].properties[n[1]].movements[n[2]].name),h(C,o,B),T(l,C,B),h(C,a,B),S&&S.m(C,B),h(C,s,B),T(u,C,B),h(C,d,B),h(C,f,B),g(f,m),g(f,p),he(p,n[3].jats[n[0]].properties[n[1]].movements[n[2]].notes),A=!0,O||(y=[Q(t,"input",n[5]),Q(p,"input",n[8])],O=!0)},p(C,[B]){B&15&&t.value!==C[3].jats[C[0]].properties[C[1]].movements[C[2]].name&&he(t,C[3].jats[C[0]].properties[C[1]].movements[C[2]].name);const E={};B&512&&(E.$$scope={dirty:B,ctx:C}),!i&&B&15&&(i=!0,E.value=C[3].jats[C[0]].properties[C[1]].movements[C[2]].kind,me(()=>i=!1)),l.$set(E),C[3].jats[C[0]].properties[C[1]].movements[C[2]].kind=="cycling"?S?B&15&&_(S,1):(S=Nt(),S.c(),_(S,1),S.m(s.parentNode,s)):S&&(ae(),b(S,1,1,()=>{S=null}),ce());const K={};B&512&&(K.$$scope={dirty:B,ctx:C}),!c&&B&15&&(c=!0,K.value=C[3].jats[C[0]].properties[C[1]].movements[C[2]].score,me(()=>c=!1)),u.$set(K),B&15&&he(p,C[3].jats[C[0]].properties[C[1]].movements[C[2]].notes)},i(C){A||(_(l.$$.fragment,C),_(S),_(u.$$.fragment,C),A=!0)},o(C){b(l.$$.fragment,C),b(S),b(u.$$.fragment,C),A=!1},d(C){C&&($(e),$(o),$(a),$(s),$(d),$(f)),I(l,C),S&&S.d(C),I(u,C),O=!1,$e(y)}}}function po(n,e,r){let t;ee(n,G,f=>r(3,t=f));let{junctionIdx:o}=e,{stage:l}=e,{idx:i}=e,a=[["X","X - black"],["0","0 - red"],["1","1 - amber"],["2","2 - green"]];function s(){t.jats[o].properties[l].movements[i].name=this.value,G.set(t)}function u(f){n.$$.not_equal(t.jats[o].properties[l].movements[i].kind,f)&&(t.jats[o].properties[l].movements[i].kind=f,G.set(t))}function c(f){n.$$.not_equal(t.jats[o].properties[l].movements[i].score,f)&&(t.jats[o].properties[l].movements[i].score=f,G.set(t))}function d(){t.jats[o].properties[l].movements[i].notes=this.value,G.set(t)}return n.$$set=f=>{"junctionIdx"in f&&r(0,o=f.junctionIdx),"stage"in f&&r(1,l=f.stage),"idx"in f&&r(2,i=f.idx)},[o,l,i,t,a,s,u,c,d]}class go extends ie{constructor(e){super(),se(this,e,po,mo,le,{junctionIdx:0,stage:1,idx:2})}}function _o(n){return n%(2*Math.PI)*180/Math.PI}function xe(n){return n%360*Math.PI/180}function qt(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Pn(n,e,r={}){if(r.final===!0)return ho(n,e);const t=qt(n),o=qt(e),l=xe(t[0]),i=xe(o[0]),a=xe(t[1]),s=xe(o[1]),u=Math.sin(i-l)*Math.cos(s),c=Math.cos(a)*Math.sin(s)-Math.sin(a)*Math.cos(s)*Math.cos(i-l);return _o(Math.atan2(u,c))}function ho(n,e){let r=Pn(e,n);return r=(r+180)%360,r}var Pe=Pn;function $o(n,e,r={}){const t={type:"Feature"};return(r.id===0||r.id)&&(t.id=r.id),r.bbox&&(t.bbox=r.bbox),t.properties=e||{},t.geometry=n,t}function ko(n,e,r={}){if(!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ft(n[0])||!Ft(n[1]))throw new Error("coordinates must contain numbers");return $o({type:"Point",coordinates:n},e,r)}function Ft(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function bo(n,e={}){const r=xn(n),t=(r[0]+r[2])/2,o=(r[1]+r[3])/2;return ko([t,o],e.properties,e)}var wo=bo,ve=63710088e-1,vo={centimeters:ve*100,centimetres:ve*100,degrees:360/(2*Math.PI),feet:ve*3.28084,inches:ve*39.37,kilometers:ve/1e3,kilometres:ve/1e3,meters:ve,metres:ve,miles:ve/1609.344,millimeters:ve*1e3,millimetres:ve*1e3,nauticalmiles:ve/1852,radians:1,yards:ve*1.0936};function yo(n,e,r={}){const t={type:"Feature"};return(r.id===0||r.id)&&(t.id=r.id),r.bbox&&(t.bbox=r.bbox),t.properties=e||{},t.geometry=n,t}function Ao(n,e,r={}){if(!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ut(n[0])||!Ut(n[1]))throw new Error("coordinates must contain numbers");return yo({type:"Point",coordinates:n},e,r)}function Co(n,e="kilometers"){const r=vo[e];if(!r)throw new Error(e+" units is invalid");return n/r}function Pt(n){return n%(2*Math.PI)*180/Math.PI}function lt(n){return n%360*Math.PI/180}function Ut(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function jo(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function zo(n,e,r,t={}){const o=jo(n),l=lt(o[0]),i=lt(o[1]),a=lt(r),s=Co(e,t.units),u=Math.asin(Math.sin(i)*Math.cos(s)+Math.cos(i)*Math.sin(s)*Math.cos(a)),c=l+Math.atan2(Math.sin(a)*Math.sin(s)*Math.cos(i),Math.cos(s)-Math.sin(i)*Math.sin(u)),d=Pt(c),f=Pt(u);return Ao([d,f],t.properties)}var Ze=zo,ye=63710088e-1,So={centimeters:ye*100,centimetres:ye*100,degrees:360/(2*Math.PI),feet:ye*3.28084,inches:ye*39.37,kilometers:ye/1e3,kilometres:ye/1e3,meters:ye,metres:ye,miles:ye/1609.344,millimeters:ye*1e3,millimetres:ye*1e3,nauticalmiles:ye/1852,radians:1,yards:ye*1.0936};function Bo(n,e="kilometers"){const r=So[e];if(!r)throw new Error(e+" units is invalid");return n*r}function et(n){return n%360*Math.PI/180}function Gt(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Lo(n,e,r={}){var t=Gt(n),o=Gt(e),l=et(o[1]-t[1]),i=et(o[0]-t[0]),a=et(t[1]),s=et(o[1]),u=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(a)*Math.cos(s);return Bo(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),r.units)}var Mo=Lo;function To(n){let e=wo({type:"FeatureCollection",features:n.map(t=>({type:"Feature",geometry:{type:"Point",coordinates:t.point},properties:{}}))}).geometry.coordinates;n.sort((t,o)=>Qt(Pe(e,o.point))-Qt(Pe(e,t.point)));let r=[];for(let t=0;t<n.length;t++){let o=n[t],l=Pe(o.point,e),i=1;for(let a of Do(t,n.length)){let s=n[a],u=Pe(e,s.point),c=Io(o.point,e,i++),d=Mo(o.point,e),f=Ze(c,.5*d,l).geometry.coordinates,m=Ze(f,.2*d,u).geometry.coordinates;r.push({point1:c,point2:f,point3:m,kind:"cycling",score:"X",name:`${o.name} to ${s.name}`,notes:""})}}return r}function Io(n,e,r){let t=.003,l=Pe(n,e)-90,i=t*r;return Ze(n,i,l).geometry.coordinates}function Qt(n){return(n+360)%360}function Do(n,e){let r=[];for(let t=n+1;t<e;t++)r.push(t);for(let t=0;t<n;t++)r.push(t);return r}const Eo="/route-element/assets/movement-aa45473c.svg",Oo="/route-element/assets/pan-fbcec4cd.svg";function Ht(n,e,r){const t=n.slice();return t[31]=e[r],t[32]=e,t[33]=r,t}function Jt(n,e,r){const t=n.slice();return t[34]=e[r],t[35]=e,t[33]=r,t}function Rt(n){let e,r,t,o,l,i,a,s,u,c,d,f,m,p,A,O,y,v,N;function S(te,L){return te[0].mode=="select"?qo:No}let j=S(n),k=j(n);function C(te,L){return te[0].mode=="new-arm"?Po:Fo}let B=C(n),E=B(n);function K(te,L){return te[0].mode=="new-movement"?Go:Uo}let R=K(n),D=R(n);return{c(){e=w("div"),r=w("button"),t=w("img"),l=z(),k.c(),i=z(),a=w("button"),s=ot("svg"),u=ot("circle"),c=ot("text"),d=U("A"),f=z(),E.c(),m=z(),p=w("button"),A=w("img"),y=z(),D.c(),Ke(t.src,o=Oo)||P(t,"src",o),P(t,"alt","Move map"),W(t,"vertical-align","middle"),P(r,"class","outline"),P(u,"cx","12"),P(u,"cy","12"),P(u,"r","12"),P(u,"fill","white"),P(c,"x","6"),P(c,"y","16"),P(c,"fill","#4472c4"),P(s,"width","24"),P(s,"height","24"),P(s,"xmlns","http://www.w3.org/2000/svg"),W(s,"vertical-align","middle"),P(a,"class","outline"),Ke(A.src,O=Eo)||P(A,"src",O),P(A,"alt","New movement"),W(A,"vertical-align","middle"),P(p,"class","outline"),P(e,"class","control-panel svelte-l1e6xi")},m(te,L){h(te,e,L),g(e,r),g(r,t),g(r,l),k.m(r,null),g(e,i),g(e,a),g(a,s),g(s,u),g(s,c),g(c,d),g(a,f),E.m(a,null),g(e,m),g(e,p),g(p,A),g(p,y),D.m(p,null),v||(N=[Q(r,"click",function(){er(n[4])&&n[4].apply(this,arguments)}),Q(a,"click",n[12]),Q(p,"click",n[13])],v=!0)},p(te,L){n=te,j!==(j=S(n))&&(k.d(1),k=j(n),k&&(k.c(),k.m(r,null))),B!==(B=C(n))&&(E.d(1),E=B(n),E&&(E.c(),E.m(a,null))),R!==(R=K(n))&&(D.d(1),D=R(n),D&&(D.c(),D.m(p,null)))},d(te){te&&$(e),k.d(),E.d(),D.d(),v=!1,$e(N)}}}function No(n){let e;return{c(){e=U("Move map")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function qo(n){let e;return{c(){e=w("b"),e.textContent="Move map"},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Fo(n){let e;return{c(){e=U("New arm")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Po(n){let e;return{c(){e=w("b"),e.textContent="New arm"},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Uo(n){let e;return{c(){e=U("New movement")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Go(n){let e;return{c(){e=w("b"),e.textContent="New movement"},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Qo(n){let e;return{c(){e=w("span"),e.textContent=`${tl(n[33])}`,P(e,"class","dot svelte-l1e6xi"),W(e,"color","#4472c4"),W(e,"background-color","white")},m(r,t){h(r,e,t)},p:V,d(r){r&&$(e)}}}function Kt(n){let e,r,t;function o(s){n[14](s,n[34])}function l(){return n[15](n[33])}function i(){return n[16](n[33])}let a={draggable:!0,$$slots:{default:[Qo]},$$scope:{ctx:n}};return n[34].point!==void 0&&(a.lngLat=n[34].point),e=new Ue({props:a}),ue.push(()=>de(e,"lngLat",o)),e.$on("dragend",l),e.$on("click",i),{c(){M(e.$$.fragment)},m(s,u){T(e,s,u),t=!0},p(s,u){n=s;const c={};u[1]&32&&(c.$$scope={dirty:u,ctx:n}),!r&&u[0]&38&&(r=!0,c.lngLat=n[34].point,me(()=>r=!1)),e.$set(c)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){b(e.$$.fragment,s),t=!1},d(s){I(e,s)}}}function Ho(n){let e;return{c(){e=w("span"),P(e,"class","dot svelte-l1e6xi"),W(e,"background-color",n[7][n[31].score]),W(e,"opacity",n[31].kind=="walking & wheeling"?"0%":"100%")},m(r,t){h(r,e,t)},p(r,t){t[0]&38&&W(e,"background-color",r[7][r[31].score]),t[0]&38&&W(e,"opacity",r[31].kind=="walking & wheeling"?"0%":"100%")},d(r){r&&$(e)}}}function Jo(n){let e;return{c(){e=w("span"),P(e,"class","dot svelte-l1e6xi"),W(e,"background-color",n[7][n[31].score])},m(r,t){h(r,e,t)},p(r,t){t[0]&38&&W(e,"background-color",r[7][r[31].score])},d(r){r&&$(e)}}}function Ro(n){let e;return{c(){e=w("span"),P(e,"class","dot svelte-l1e6xi"),W(e,"background-color",n[7][n[31].score]),W(e,"opacity","0%")},m(r,t){h(r,e,t)},p(r,t){t[0]&38&&W(e,"background-color",r[7][r[31].score])},d(r){r&&$(e)}}}function Xt(n){let e,r,t,o,l,i,a,s,u;function c(k){n[17](k,n[31])}function d(){return n[18](n[33])}function f(){return n[19](n[33])}let m={draggable:!0,$$slots:{default:[Ho]},$$scope:{ctx:n}};n[31].point1!==void 0&&(m.lngLat=n[31].point1),e=new Ue({props:m}),ue.push(()=>de(e,"lngLat",c)),e.$on("dragend",d),e.$on("click",f);function p(k){n[20](k,n[31])}function A(){return n[21](n[33])}function O(){return n[22](n[33])}let y={draggable:!0,$$slots:{default:[Jo]},$$scope:{ctx:n}};n[31].point2!==void 0&&(y.lngLat=n[31].point2),o=new Ue({props:y}),ue.push(()=>de(o,"lngLat",p)),o.$on("dragend",A),o.$on("click",O);function v(k){n[23](k,n[31])}function N(){return n[24](n[33])}function S(){return n[25](n[33])}let j={draggable:!0,$$slots:{default:[Ro]},$$scope:{ctx:n}};return n[31].point3!==void 0&&(j.lngLat=n[31].point3),a=new Ue({props:j}),ue.push(()=>de(a,"lngLat",v)),a.$on("dragend",N),a.$on("click",S),{c(){M(e.$$.fragment),t=z(),M(o.$$.fragment),i=z(),M(a.$$.fragment)},m(k,C){T(e,k,C),h(k,t,C),T(o,k,C),h(k,i,C),T(a,k,C),u=!0},p(k,C){n=k;const B={};C[0]&38|C[1]&32&&(B.$$scope={dirty:C,ctx:n}),!r&&C[0]&38&&(r=!0,B.lngLat=n[31].point1,me(()=>r=!1)),e.$set(B);const E={};C[0]&38|C[1]&32&&(E.$$scope={dirty:C,ctx:n}),!l&&C[0]&38&&(l=!0,E.lngLat=n[31].point2,me(()=>l=!1)),o.$set(E);const K={};C[0]&38|C[1]&32&&(K.$$scope={dirty:C,ctx:n}),!s&&C[0]&38&&(s=!0,K.lngLat=n[31].point3,me(()=>s=!1)),a.$set(K)},i(k){u||(_(e.$$.fragment,k),_(o.$$.fragment,k),_(a.$$.fragment,k),u=!0)},o(k){b(e.$$.fragment,k),b(o.$$.fragment,k),b(a.$$.fragment,k),u=!1},d(k){k&&($(t),$(i)),I(e,k),I(o,k),I(a,k)}}}function Ko(n){let e=(n[30].name||"Untitled movement")+"",r;return{c(){r=U(e)},m(t,o){h(t,r,o)},p(t,o){o[0]&1073741824&&e!==(e=(t[30].name||"Untitled movement")+"")&&oe(r,e)},d(t){t&&$(r)}}}function Xo(n){let e,r;return e=new Dn({props:{$$slots:{default:[Ko,({props:t})=>({30:t}),({props:t})=>[t?1073741824:0]]},$$scope:{ctx:n}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o[0]&1073741824|o[1]&32&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function Zo(n){let e=(n[30].name||"Untitled movement")+"",r;return{c(){r=U(e)},m(t,o){h(t,r,o)},p(t,o){o[0]&1073741824&&e!==(e=(t[30].name||"Untitled movement")+"")&&oe(r,e)},d(t){t&&$(r)}}}function Yo(n){let e,r;return e=new Dn({props:{$$slots:{default:[Zo,({props:t})=>({30:t}),({props:t})=>[t?1073741824:0]]},$$scope:{ctx:n}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o[0]&1073741824|o[1]&32&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function Vo(n){let e,r,t,o,l,i;return e=new Le({props:{id:"jat-cycling",manageHoverState:!0,paint:{"line-width":Xe(6,10),"line-color":["get","color"]},filter:["==",["get","kind"],"cycling"],$$slots:{default:[Xo]},$$scope:{ctx:n}}}),e.$on("click",n[9]),t=new Le({props:{id:"jat-walking-wheeling",manageHoverState:!0,paint:{"line-width":Xe(6,8),"line-color":["get","color"],"line-dasharray":[3,2]},filter:["==",["get","kind"],"walking & wheeling"],$$slots:{default:[Yo]},$$scope:{ctx:n}}}),t.$on("click",n[9]),l=new qe({props:{id:"jat-arrow",filter:["has","angle"],paint:{"text-color":["get","color"],"text-halo-color":"white","text-halo-width":3},layout:{"text-field":"⬆","text-overlap":"always","text-rotate":["get","angle"],"text-size":70}}}),{c(){M(e.$$.fragment),r=z(),M(t.$$.fragment),o=z(),M(l.$$.fragment)},m(a,s){T(e,a,s),h(a,r,s),T(t,a,s),h(a,o,s),T(l,a,s),i=!0},p(a,s){const u={};s[1]&32&&(u.$$scope={dirty:s,ctx:a}),e.$set(u);const c={};s[1]&32&&(c.$$scope={dirty:s,ctx:a}),t.$set(c)},i(a){i||(_(e.$$.fragment,a),_(t.$$.fragment,a),_(l.$$.fragment,a),i=!0)},o(a){b(e.$$.fragment,a),b(t.$$.fragment,a),b(l.$$.fragment,a),i=!1},d(a){a&&($(r),$(o)),I(e,a),I(t,a),I(l,a)}}}function Wo(n){let e,r,t,o;return e=new Le({props:{paint:{"line-width":5,"line-color":"yellow","line-gap-width":45}}}),t=new Ve({props:{filter:["==",["get","kind"],"arm"],paint:{"circle-radius":20,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){M(e.$$.fragment),r=z(),M(t.$$.fragment)},m(l,i){T(e,l,i),h(l,r,i),T(t,l,i),o=!0},p:V,i(l){o||(_(e.$$.fragment,l),_(t.$$.fragment,l),o=!0)},o(l){b(e.$$.fragment,l),b(t.$$.fragment,l),o=!1},d(l){l&&$(r),I(e,l),I(t,l)}}}function xo(n){let e,r,t,o,l,i,a,s,u;e=new ct({}),e.$on("click",n[8]);let c=n[0].mode!="editing"&&Rt(n),d=Y(n[5].jats[n[1]].properties[n[2]].arms),f=[];for(let y=0;y<d.length;y+=1)f[y]=Kt(Jt(n,d,y));const m=y=>b(f[y],1,1,()=>{f[y]=null});let p=Y(n[5].jats[n[1]].properties[n[2]].movements),A=[];for(let y=0;y<p.length;y+=1)A[y]=Xt(Ht(n,p,y));const O=y=>b(A[y],1,1,()=>{A[y]=null});return i=new _e({props:{data:n[10](n[5]),$$slots:{default:[Vo]},$$scope:{ctx:n}}}),s=new _e({props:{data:n[6],$$slots:{default:[Wo]},$$scope:{ctx:n}}}),{c(){M(e.$$.fragment),r=z(),c&&c.c(),t=z();for(let y=0;y<f.length;y+=1)f[y].c();o=z();for(let y=0;y<A.length;y+=1)A[y].c();l=z(),M(i.$$.fragment),a=z(),M(s.$$.fragment)},m(y,v){T(e,y,v),h(y,r,v),c&&c.m(y,v),h(y,t,v);for(let N=0;N<f.length;N+=1)f[N]&&f[N].m(y,v);h(y,o,v);for(let N=0;N<A.length;N+=1)A[N]&&A[N].m(y,v);h(y,l,v),T(i,y,v),h(y,a,v),T(s,y,v),u=!0},p(y,v){if(y[0].mode!="editing"?c?c.p(y,v):(c=Rt(y),c.c(),c.m(t.parentNode,t)):c&&(c.d(1),c=null),v[0]&46){d=Y(y[5].jats[y[1]].properties[y[2]].arms);let j;for(j=0;j<d.length;j+=1){const k=Jt(y,d,j);f[j]?(f[j].p(k,v),_(f[j],1)):(f[j]=Kt(k),f[j].c(),_(f[j],1),f[j].m(o.parentNode,o))}for(ae(),j=d.length;j<f.length;j+=1)m(j);ce()}if(v[0]&174){p=Y(y[5].jats[y[1]].properties[y[2]].movements);let j;for(j=0;j<p.length;j+=1){const k=Ht(y,p,j);A[j]?(A[j].p(k,v),_(A[j],1)):(A[j]=Xt(k),A[j].c(),_(A[j],1),A[j].m(l.parentNode,l))}for(ae(),j=p.length;j<A.length;j+=1)O(j);ce()}const N={};v[0]&32&&(N.data=y[10](y[5])),v[1]&32&&(N.$$scope={dirty:v,ctx:y}),i.$set(N);const S={};v[0]&64&&(S.data=y[6]),v[1]&32&&(S.$$scope={dirty:v,ctx:y}),s.$set(S)},i(y){if(!u){_(e.$$.fragment,y);for(let v=0;v<d.length;v+=1)_(f[v]);for(let v=0;v<p.length;v+=1)_(A[v]);_(i.$$.fragment,y),_(s.$$.fragment,y),u=!0}},o(y){b(e.$$.fragment,y),f=f.filter(Boolean);for(let v=0;v<f.length;v+=1)b(f[v]);A=A.filter(Boolean);for(let v=0;v<A.length;v+=1)b(A[v]);b(i.$$.fragment,y),b(s.$$.fragment,y),u=!1},d(y){y&&($(r),$(t),$(o),$(l),$(a)),I(e,y),c&&c.d(y),pe(f,y),pe(A,y),I(i,y),I(s,y)}}}function el(n,e){return{type:"Feature",id:e,properties:{kind:"arm"},geometry:{type:"Point",coordinates:n.point}}}function tl(n){return String.fromCharCode(n+"A".charCodeAt(0))}function nl(n,e,r){let t,o,l;ee(n,G,F=>r(5,o=F)),ee(n,at,F=>r(26,l=F));let{junctionIdx:i}=e,{stage:a}=e,{mode:s}=e,{hoveringSidebar:u}=e,{select:c}=e,{stopEditing:d}=e,f={0:Ie.red.background,1:Ie.amber.background,2:Ie.green.background,X:Ie.critical.background};function m(F,X,Ae){let fe={type:"FeatureCollection",features:[]},q=X.mode=="editing"?X.id:Ae;return q!=null&&(q.kind=="arm"?fe.features.push(el(F.jats[i].properties[a].arms[q.idx],q.idx)):fe.features.push(y(F.jats[i].properties[a].movements[q.idx],q.idx))),fe}async function p(F){if(l){for(let X of l.queryRenderedFeatures(F.detail.point,{layers:["jat-cycling","jat-walking-wheeling"]}))return;if(s.mode!="select"){if(s.mode=="editing"){await d();return}s.mode=="new-arm"?(H(G,o.jats[i].properties[a].arms=[...o.jats[i].properties[a].arms,{point:F.detail.lngLat.toArray(),name:""}],o),await c({kind:"arm",idx:o.jats[i].properties[a].arms.length-1})):(H(G,o.jats[i].properties[a].movements=[...o.jats[i].properties[a].movements,{point1:F.detail.lngLat.toArray(),point2:Ze(F.detail.lngLat.toArray(),.005,0).geometry.coordinates,point3:Ze(F.detail.lngLat.toArray(),.01,0).geometry.coordinates,kind:"cycling",score:"X",name:"",notes:""}],o),await c({kind:"movement",idx:o.jats[i].properties[a].movements.length-1}))}}}async function A(F){await c({kind:"movement",idx:F.detail.features[0].id})}function O(F){let X={type:"FeatureCollection",features:F.jats[i].properties[a].movements.map((Ae,fe)=>y(Ae,fe))};for(let Ae of F.jats[i].properties[a].movements)if(X.features.push(v(Ae,X.features.length)),Ae.kind=="walking & wheeling"){let fe={...Ae,point1:Ae.point3,point3:Ae.point1};X.features.push(v(fe,X.features.length))}return X}function y(F,X){return{type:"Feature",id:X,properties:{name:F.name,kind:F.kind,color:f[F.score]},geometry:{type:"LineString",coordinates:[F.point1,F.point2,F.point3]}}}function v(F,X){return{type:"Feature",id:X,properties:{kind:F.kind,color:f[F.score],angle:Pe(F.point2,F.point3)},geometry:{type:"Point",coordinates:F.point3}}}const N=()=>r(0,s={mode:"new-arm"}),S=()=>r(0,s={mode:"new-movement"});function j(F,X){n.$$.not_equal(X.point,F)&&(X.point=F,G.set(o))}const k=F=>c({kind:"arm",idx:F}),C=F=>c({kind:"arm",idx:F});function B(F,X){n.$$.not_equal(X.point1,F)&&(X.point1=F,G.set(o))}const E=F=>c({kind:"movement",idx:F}),K=F=>c({kind:"movement",idx:F});function R(F,X){n.$$.not_equal(X.point2,F)&&(X.point2=F,G.set(o))}const D=F=>c({kind:"movement",idx:F}),te=F=>c({kind:"movement",idx:F});function L(F,X){n.$$.not_equal(X.point3,F)&&(X.point3=F,G.set(o))}const ne=F=>c({kind:"movement",idx:F}),ge=F=>c({kind:"movement",idx:F});return n.$$set=F=>{"junctionIdx"in F&&r(1,i=F.junctionIdx),"stage"in F&&r(2,a=F.stage),"mode"in F&&r(0,s=F.mode),"hoveringSidebar"in F&&r(11,u=F.hoveringSidebar),"select"in F&&r(3,c=F.select),"stopEditing"in F&&r(4,d=F.stopEditing)},n.$$.update=()=>{n.$$.dirty[0]&2081&&r(6,t=m(o,s,u))},[s,i,a,c,d,o,t,f,p,A,O,u,N,S,j,k,C,B,E,K,R,D,te,L,ne,ge]}class rl extends ie{constructor(e){super(),se(this,e,nl,xo,le,{junctionIdx:1,stage:2,mode:0,hoveringSidebar:11,select:3,stopEditing:4},null,[-1,-1])}}function Zt(n){if(n.movements.length==0)return"No movements added";let e=0,r=0;for(let o of n.movements)e+={0:0,1:1,2:2,X:0}[o.score],r+=2;let t=e/r*100;return`${Math.round(t)}%`}const{window:ol}=He;function Yt(n,e,r){const t=n.slice();t[27]=e[r],t[30]=r;const o=t[14][t[27].score];return t[28]=o,t}function Vt(n,e,r){const t=n.slice();return t[31]=e[r],t[30]=r,t}function ll(n){let e,r,t,o,l,i,a,s,u;return{c(){e=w("button"),e.textContent="Done",r=z(),t=w("button"),t.textContent="Delete",o=z(),l=w("label"),i=U(`Arm name
        `),a=w("input"),P(a,"type","text")},m(c,d){h(c,e,d),h(c,r,d),h(c,t,d),h(c,o,d),h(c,l,d),g(l,i),g(l,a),he(a,n[5].jats[n[0]].properties[n[1]].arms[n[2].id.idx].name),s||(u=[Q(e,"click",n[23]),Q(t,"click",n[10]),Q(a,"input",n[24])],s=!0)},p(c,d){d[0]&39&&a.value!==c[5].jats[c[0]].properties[c[1]].arms[c[2].id.idx].name&&he(a,c[5].jats[c[0]].properties[c[1]].arms[c[2].id.idx].name)},i:V,o:V,d(c){c&&($(e),$(r),$(t),$(o),$(l)),s=!1,$e(u)}}}function il(n){let e,r,t,o,l,i,a,s;return e=new go({props:{junctionIdx:n[0],stage:n[1],idx:n[2].id.idx}}),{c(){M(e.$$.fragment),r=z(),t=w("button"),t.textContent="Save",o=z(),l=w("button"),l.textContent="Delete"},m(u,c){T(e,u,c),h(u,r,c),h(u,t,c),h(u,o,c),h(u,l,c),i=!0,a||(s=[Q(t,"click",n[9]),Q(l,"click",n[10])],a=!0)},p(u,c){const d={};c[0]&1&&(d.junctionIdx=u[0]),c[0]&2&&(d.stage=u[1]),c[0]&4&&(d.idx=u[2].id.idx),e.$set(d)},i(u){i||(_(e.$$.fragment,u),i=!0)},o(u){b(e.$$.fragment,u),i=!1},d(u){u&&($(r),$(t),$(o),$(l)),I(e,u),a=!1,$e(s)}}}function sl(n){let e,r,t,o,l,i,a,s,u,c,d,f,m,p=n[5].jats[n[0]].properties.name+"",A,O,y=Zt(n[5].jats[n[0]].properties[n[1]])+"",v,N,S,j,k,C,B,E,K,R,D,te=Y(n[5].jats[n[0]].properties[n[1]].arms),L=[];for(let q=0;q<te.length;q+=1)L[q]=Wt(Vt(n,te,q));const ne=q=>b(L[q],1,1,()=>{L[q]=null});let ge=n[5].jats[n[0]].properties[n[7]].arms.length>0&&xt(n),F=Y(n[5].jats[n[0]].properties[n[1]].movements),X=[];for(let q=0;q<F.length;q+=1)X[q]=en(Yt(n,F,q));const Ae=q=>b(X[q],1,1,()=>{X[q]=null});let fe=n[5].jats[n[0]].properties[n[7]].movements.length>0&&tn(n);return{c(){e=w("button"),e.textContent="Done",r=z(),t=w("h3"),t.textContent="Arms",o=z();for(let q=0;q<L.length;q+=1)L[q].c();l=z(),ge&&ge.c(),i=z(),a=w("h3"),a.textContent="Movements",s=z(),u=w("p"),c=U("Total JAT score for "),d=U(n[1]),f=U(` junction
        `),m=w("i"),A=U(p),O=U(`
        : `),v=U(y),N=z(),S=w("button"),j=U("Generate cycling movements between all arms"),C=z();for(let q=0;q<X.length;q+=1)X[q].c();B=z(),fe&&fe.c(),E=De(),P(S,"class","secondary"),S.disabled=k=n[5].jats[n[0]].properties[n[1]].arms.length<2},m(q,Z){h(q,e,Z),h(q,r,Z),h(q,t,Z),h(q,o,Z);for(let x=0;x<L.length;x+=1)L[x]&&L[x].m(q,Z);h(q,l,Z),ge&&ge.m(q,Z),h(q,i,Z),h(q,a,Z),h(q,s,Z),h(q,u,Z),g(u,c),g(u,d),g(u,f),g(u,m),g(m,A),g(u,O),g(u,v),h(q,N,Z),h(q,S,Z),g(S,j),h(q,C,Z);for(let x=0;x<X.length;x+=1)X[x]&&X[x].m(q,Z);h(q,B,Z),fe&&fe.m(q,Z),h(q,E,Z),K=!0,R||(D=[Q(e,"click",n[16]),Q(S,"click",n[15])],R=!0)},p(q,Z){if(Z[0]&299){te=Y(q[5].jats[q[0]].properties[q[1]].arms);let x;for(x=0;x<te.length;x+=1){const Re=Vt(q,te,x);L[x]?(L[x].p(Re,Z),_(L[x],1)):(L[x]=Wt(Re),L[x].c(),_(L[x],1),L[x].m(l.parentNode,l))}for(ae(),x=te.length;x<L.length;x+=1)ne(x);ce()}if(q[5].jats[q[0]].properties[q[7]].arms.length>0?ge?ge.p(q,Z):(ge=xt(q),ge.c(),ge.m(i.parentNode,i)):ge&&(ge.d(1),ge=null),(!K||Z[0]&2)&&oe(d,q[1]),(!K||Z[0]&33)&&p!==(p=q[5].jats[q[0]].properties.name+"")&&oe(A,p),(!K||Z[0]&35)&&y!==(y=Zt(q[5].jats[q[0]].properties[q[1]])+"")&&oe(v,y),(!K||Z[0]&35&&k!==(k=q[5].jats[q[0]].properties[q[1]].arms.length<2))&&(S.disabled=k),Z[0]&16683){F=Y(q[5].jats[q[0]].properties[q[1]].movements);let x;for(x=0;x<F.length;x+=1){const Re=Yt(q,F,x);X[x]?(X[x].p(Re,Z),_(X[x],1)):(X[x]=en(Re),X[x].c(),_(X[x],1),X[x].m(B.parentNode,B))}for(ae(),x=F.length;x<X.length;x+=1)Ae(x);ce()}q[5].jats[q[0]].properties[q[7]].movements.length>0?fe?fe.p(q,Z):(fe=tn(q),fe.c(),fe.m(E.parentNode,E)):fe&&(fe.d(1),fe=null)},i(q){if(!K){for(let Z=0;Z<te.length;Z+=1)_(L[Z]);for(let Z=0;Z<F.length;Z+=1)_(X[Z]);K=!0}},o(q){L=L.filter(Boolean);for(let Z=0;Z<L.length;Z+=1)b(L[Z]);X=X.filter(Boolean);for(let Z=0;Z<X.length;Z+=1)b(X[Z]);K=!1},d(q){q&&($(e),$(r),$(t),$(o),$(l),$(i),$(a),$(s),$(u),$(N),$(S),$(C),$(B),$(E)),pe(L,q),ge&&ge.d(q),pe(X,q),fe&&fe.d(q),R=!1,$e(D)}}}function Wt(n){let e,r;function t(){return n[17](n[30])}function o(){return n[18](n[30])}return e=new qn({props:{name:`${nn(n[30])} - ${n[31].name||"Unnamed arm"}`,hasSlot:!1}}),e.$on("click",t),e.$on("mouseenter",o),e.$on("mouseleave",n[19]),{c(){M(e.$$.fragment)},m(l,i){T(e,l,i),r=!0},p(l,i){n=l;const a={};i[0]&35&&(a.name=`${nn(n[30])} - ${n[31].name||"Unnamed arm"}`),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){b(e.$$.fragment,l),r=!1},d(l){I(e,l)}}}function xt(n){let e,r,t;return{c(){e=w("button"),e.textContent=`Copy arms from ${n[7]}`,P(e,"class","secondary")},m(o,l){h(o,e,l),r||(t=Q(e,"click",n[12]),r=!0)},p:V,d(o){o&&$(e),r=!1,t()}}}function al(n){let e,r,t,o=n[27].score+"",l,i,a,s=rn(n[27].kind)+"",u;return{c(){e=w("div"),r=w("span"),t=U("Score: "),l=U(o),i=z(),a=w("span"),u=U(s),W(r,"padding","4px"),W(r,"color",n[28].font),W(r,"background-color",n[28].background),W(e,"width","100%"),W(e,"display","flex"),W(e,"justify-content","space-between")},m(c,d){h(c,e,d),g(e,r),g(r,t),g(r,l),g(e,i),g(e,a),g(a,u)},p(c,d){d[0]&35&&o!==(o=c[27].score+"")&&oe(l,o),d[0]&35&&W(r,"color",c[28].font),d[0]&35&&W(r,"background-color",c[28].background),d[0]&35&&s!==(s=rn(c[27].kind)+"")&&oe(u,s)},d(c){c&&$(e)}}}function en(n){let e,r;function t(){return n[20](n[30])}function o(){return n[21](n[30])}return e=new qn({props:{name:n[27].name||"Unnamed movement",$$slots:{default:[al]},$$scope:{ctx:n}}}),e.$on("click",t),e.$on("mouseenter",o),e.$on("mouseleave",n[22]),{c(){M(e.$$.fragment)},m(l,i){T(e,l,i),r=!0},p(l,i){n=l;const a={};i[0]&35&&(a.name=n[27].name||"Unnamed movement"),i[0]&35|i[1]&4&&(a.$$scope={dirty:i,ctx:n}),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){b(e.$$.fragment,l),r=!1},d(l){I(e,l)}}}function tn(n){let e,r,t;return{c(){e=w("button"),e.textContent=`Copy movements from ${n[7]}`,P(e,"class","secondary")},m(o,l){h(o,e,l),r||(t=Q(e,"click",n[13]),r=!0)},p:V,d(o){o&&$(e),r=!1,t()}}}function cl(n){let e,r,t,o,l=n[5].jats[n[0]].properties.name+"",i,a,s,u,c;const d=[sl,il,ll],f=[];function m(p,A){return p[2].mode!="editing"?0:p[2].id.kind=="movement"?1:2}return s=m(n),u=f[s]=d[s](n),{c(){e=w("div"),r=w("h2"),t=U(n[1]),o=U(" JAT for "),i=U(l),a=z(),u.c(),P(e,"slot","sidebar")},m(p,A){h(p,e,A),g(e,r),g(r,t),g(r,o),g(r,i),g(e,a),f[s].m(e,null),n[25](e),c=!0},p(p,A){(!c||A[0]&2)&&oe(t,p[1]),(!c||A[0]&33)&&l!==(l=p[5].jats[p[0]].properties.name+"")&&oe(i,l);let O=s;s=m(p),s===O?f[s].p(p,A):(ae(),b(f[O],1,1,()=>{f[O]=null}),ce(),u=f[s],u?u.p(p,A):(u=f[s]=d[s](p),u.c()),_(u,1),u.m(e,null))},i(p){c||(_(u),c=!0)},o(p){b(u),c=!1},d(p){p&&$(e),f[s].d(),n[25](null)}}}function ul(n){let e,r;return e=new Ve({props:{filter:["!=",["id"],n[0]],paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":"black","circle-radius":20}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o[0]&1&&(l.filter=["!=",["id"],t[0]]),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function fl(n){let e,r,t,o,l,i,a;return r=new Ee({props:{except:"jats"}}),o=new _e({props:{data:re(n[5].jats),generateId:!0,$$slots:{default:[ul]},$$scope:{ctx:n}}}),i=new rl({props:{junctionIdx:n[0],stage:n[1],mode:n[2],hoveringSidebar:n[3],select:n[8],stopEditing:n[9]}}),{c(){e=w("div"),M(r.$$.fragment),t=z(),M(o.$$.fragment),l=z(),M(i.$$.fragment),P(e,"slot","map")},m(s,u){h(s,e,u),T(r,e,null),g(e,t),T(o,e,null),g(e,l),T(i,e,null),a=!0},p(s,u){const c={};u[0]&32&&(c.data=re(s[5].jats)),u[0]&1|u[1]&4&&(c.$$scope={dirty:u,ctx:s}),o.$set(c);const d={};u[0]&1&&(d.junctionIdx=s[0]),u[0]&2&&(d.stage=s[1]),u[0]&4&&(d.mode=s[2]),u[0]&8&&(d.hoveringSidebar=s[3]),i.$set(d)},i(s){a||(_(r.$$.fragment,s),_(o.$$.fragment,s),_(i.$$.fragment,s),a=!0)},o(s){b(r.$$.fragment,s),b(o.$$.fragment,s),b(i.$$.fragment,s),a=!1},d(s){s&&$(e),I(r),I(o),I(i)}}}function dl(n){let e,r,t,o;return e=new Te({props:{$$slots:{map:[fl],sidebar:[cl]},$$scope:{ctx:n}}}),{c(){M(e.$$.fragment)},m(l,i){T(e,l,i),r=!0,t||(o=Q(ol,"keydown",n[11]),t=!0)},p(l,i){const a={};i[0]&127|i[1]&4&&(a.$$scope={dirty:i,ctx:l}),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){b(e.$$.fragment,l),r=!1},d(l){I(e,l),t=!1,o()}}}function nn(n){return String.fromCharCode(n+"A".charCodeAt(0))}function rn(n){return n.split(" ").map(e=>e.length>0?e[0].toUpperCase()+e.substr(1):e).join(" ")}function ml(n,e,r){let t,o;ee(n,G,L=>r(5,t=L)),ee(n,J,L=>r(6,o=L));let{junctionIdx:l}=e,{stage:i}=e,a=i=="existing"?"proposed":"existing",s={mode:"select"},u=null,c=null,d;async function f(L){u=d.scrollTop,r(2,s={mode:"editing",id:L}),r(3,c=null),await Ne(),r(4,d.scrollTop=0,d)}async function m(){r(2,s={mode:"select"}),u!=null&&(await Ne(),r(4,d.scrollTop=u,d),u=null)}function p(){s.mode=="editing"&&window.confirm(`Delete this ${s.id.kind}?`)&&(s.id.kind=="movement"?(t.jats[l].properties[i].movements.splice(s.id.idx,1),G.set(t)):(t.jats[l].properties[i].arms.splice(s.id.idx,1),G.set(t)),m())}function A(L){if(s.mode!="editing")return;let ne=L.target.tagName,ge=ne=="INPUT"||ne=="TEXTAREA";L.key=="Escape"||L.key=="Enter"&&!ge?(L.stopPropagation(),m()):L.key=="Delete"&&!ge&&(L.stopPropagation(),p())}function O(){t.jats[l].properties[i].arms.length>0&&!window.confirm("Overwrite arms?")||(H(G,t.jats[l].properties[i].arms=JSON.parse(JSON.stringify(t.jats[l].properties[a].arms)),t),G.set(t))}function y(){t.jats[l].properties[i].movements.length>0&&!window.confirm("Overwrite movements?")||(H(G,t.jats[l].properties[i].movements=JSON.parse(JSON.stringify(t.jats[l].properties[a].movements)),t),G.set(t))}let v={0:Ie.red,1:Ie.amber,2:Ie.green,X:Ie.critical};function N(){if(t.jats[l].properties[i].movements.length>0&&!window.confirm("Overwrite all cycling movements?"))return;let L=t.jats[l].properties[i].movements.filter(ne=>ne.kind=="walking & wheeling");H(G,t.jats[l].properties[i].movements=[...L,...To(t.jats[l].properties[i].arms)],t)}const S=()=>H(J,o={kind:"edit-jat",idx:l},o),j=L=>f({kind:"arm",idx:L}),k=L=>r(3,c={kind:"arm",idx:L}),C=()=>r(3,c=null),B=L=>f({kind:"movement",idx:L}),E=L=>r(3,c={kind:"movement",idx:L}),K=()=>r(3,c=null),R=()=>r(2,s={mode:"select"});function D(){t.jats[l].properties[i].arms[s.id.idx].name=this.value,G.set(t)}function te(L){ue[L?"unshift":"push"](()=>{d=L,r(4,d)})}return n.$$set=L=>{"junctionIdx"in L&&r(0,l=L.junctionIdx),"stage"in L&&r(1,i=L.stage)},[l,i,s,c,d,t,o,a,f,m,p,A,O,y,v,N,S,j,k,C,B,E,K,R,D,te]}class pl extends ie{constructor(e){super(),se(this,e,ml,dl,le,{junctionIdx:0,stage:1},null,[-1,-1])}}const{window:gl}=He;function _l(n){let e,r,t,o,l,i,a,s,u,c,d,f,m,p;return{c(){e=w("div"),r=w("button"),r.textContent="Done",t=z(),o=w("button"),o.textContent="Delete JAT",l=z(),i=w("label"),a=U(`Name:
      `),s=w("input"),u=z(),c=w("button"),c.textContent="Existing",d=z(),f=w("button"),f.textContent="Proposed",P(s,"type","text"),P(e,"slot","sidebar")},m(A,O){h(A,e,O),g(e,r),g(e,t),g(e,o),g(e,l),g(e,i),g(i,a),g(i,s),he(s,n[1].jats[n[0]].properties.name),g(e,u),g(e,c),g(e,d),g(e,f),m||(p=[Q(r,"click",n[6]),Q(o,"click",n[4]),Q(s,"input",n[7]),Q(c,"click",n[8]),Q(f,"click",n[9])],m=!0)},p(A,O){O&3&&s.value!==A[1].jats[A[0]].properties.name&&he(s,A[1].jats[A[0]].properties.name)},d(A){A&&$(e),m=!1,$e(p)}}}function hl(n){let e,r;return e=new Ve({props:{filter:["!=",["id"],n[0]],paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":"black","circle-radius":20}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&1&&(l.filter=["!=",["id"],t[0]]),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function $l(n){let e,r,t,o,l,i,a,s;r=new Ee({props:{except:"jats"}}),o=new _e({props:{data:re(n[1].jats),generateId:!0,$$slots:{default:[hl]},$$scope:{ctx:n}}});function u(d){n[5](d)}let c={radius:"50px",outline:!0,color:n[1].jats[n[0]].properties.color};return n[1].jats[n[0]].geometry.coordinates!==void 0&&(c.lngLat=n[1].jats[n[0]].geometry.coordinates),i=new ut({props:c}),ue.push(()=>de(i,"lngLat",u)),{c(){e=w("div"),M(r.$$.fragment),t=z(),M(o.$$.fragment),l=z(),M(i.$$.fragment),P(e,"slot","map")},m(d,f){h(d,e,f),T(r,e,null),g(e,t),T(o,e,null),g(e,l),T(i,e,null),s=!0},p(d,f){const m={};f&2&&(m.data=re(d[1].jats)),f&1025&&(m.$$scope={dirty:f,ctx:d}),o.$set(m);const p={};f&3&&(p.color=d[1].jats[d[0]].properties.color),!a&&f&3&&(a=!0,p.lngLat=d[1].jats[d[0]].geometry.coordinates,me(()=>a=!1)),i.$set(p)},i(d){s||(_(r.$$.fragment,d),_(o.$$.fragment,d),_(i.$$.fragment,d),s=!0)},o(d){b(r.$$.fragment,d),b(o.$$.fragment,d),b(i.$$.fragment,d),s=!1},d(d){d&&$(e),I(r),I(o),I(i)}}}function kl(n){let e,r,t,o;return e=new Te({props:{$$slots:{map:[$l],sidebar:[_l]},$$scope:{ctx:n}}}),{c(){M(e.$$.fragment)},m(l,i){T(e,l,i),r=!0,t||(o=Q(gl,"keydown",n[3]),t=!0)},p(l,[i]){const a={};i&1031&&(a.$$scope={dirty:i,ctx:l}),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){b(e.$$.fragment,l),r=!1},d(l){I(e,l),t=!1,o()}}}function bl(n,e,r){let t,o;ee(n,G,m=>r(1,t=m)),ee(n,J,m=>r(2,o=m));let{idx:l}=e;function i(m){m.key=="Escape"&&H(J,o={kind:"neutral"},o)}async function a(){window.confirm("Really delete this JAT?")&&(H(J,o={kind:"neutral"},o),await Ne(),t.jats.splice(l,1),G.set(t))}function s(m){n.$$.not_equal(t.jats[l].geometry.coordinates,m)&&(t.jats[l].geometry.coordinates=m,G.set(t))}const u=()=>H(J,o={kind:"neutral"},o);function c(){t.jats[l].properties.name=this.value,G.set(t)}const d=()=>H(J,o={kind:"edit-jat-detail",idx:l,stage:"existing"},o),f=()=>H(J,o={kind:"edit-jat-detail",idx:l,stage:"proposed"},o);return n.$$set=m=>{"idx"in m&&r(0,l=m.idx)},[l,t,o,i,a,s,u,c,d,f]}class wl extends ie{constructor(e){super(),se(this,e,bl,kl,le,{idx:0})}}function on(n,e,r){const t=n.slice();return t[3]=e[r],t[4]=e,t[5]=r,t}function vl(n){let e,r;return{c(){e=w("span"),r=z(),P(e,"class","dot svelte-jgyhla")},m(t,o){h(t,e,o),h(t,r,o)},p:V,d(t){t&&($(e),$(r))}}}function ln(n){let e,r,t;function o(i){n[2](i,n[3],n[4],n[5])}let l={draggable:!0,$$slots:{default:[vl]},$$scope:{ctx:n}};return n[3]!==void 0&&(l.lngLat=n[3]),e=new Ue({props:l}),ue.push(()=>de(e,"lngLat",o)),{c(){M(e.$$.fragment)},m(i,a){T(e,i,a),t=!0},p(i,a){n=i;const s={};a&64&&(s.$$scope={dirty:a,ctx:n}),!r&&a&1&&(r=!0,s.lngLat=n[3],me(()=>r=!1)),e.$set(s)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){b(e.$$.fragment,i),t=!1},d(i){I(e,i)}}}function yl(n){let e,r,t,o;e=new ct({}),e.$on("click",n[1]);let l=Y(n[0].geometry.coordinates),i=[];for(let s=0;s<l.length;s+=1)i[s]=ln(on(n,l,s));const a=s=>b(i[s],1,1,()=>{i[s]=null});return{c(){M(e.$$.fragment),r=z();for(let s=0;s<i.length;s+=1)i[s].c();t=De()},m(s,u){T(e,s,u),h(s,r,u);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(s,u);h(s,t,u),o=!0},p(s,[u]){if(u&1){l=Y(s[0].geometry.coordinates);let c;for(c=0;c<l.length;c+=1){const d=on(s,l,c);i[c]?(i[c].p(d,u),_(i[c],1)):(i[c]=ln(d),i[c].c(),_(i[c],1),i[c].m(t.parentNode,t))}for(ae(),c=l.length;c<i.length;c+=1)a(c);ce()}},i(s){if(!o){_(e.$$.fragment,s);for(let u=0;u<l.length;u+=1)_(i[u]);o=!0}},o(s){b(e.$$.fragment,s),i=i.filter(Boolean);for(let u=0;u<i.length;u+=1)b(i[u]);o=!1},d(s){s&&($(r),$(t)),I(e,s),pe(i,s)}}}function Al(n,e,r){let{f:t}=e;function o(i){t.geometry.coordinates.push(i.detail.lngLat.toArray()),r(0,t)}function l(i,a,s,u){s[u]=i,r(0,t)}return n.$$set=i=>{"f"in i&&r(0,t=i.f)},[t,o,l]}class Un extends ie{constructor(e){super(),se(this,e,Al,yl,le,{f:0})}}function Cl(n){return{type:"Feature",geometry:{type:"LineString",coordinates:[]},properties:{name:"Untitled link",color:Ce[n%Ce.length],answers:Array(we.length).fill("")}}}let we=[{name:"Street or path check",description:"Is this on-carriageway or a traffic-free path?",choices:["","Street check","Path check"]},{name:"SA03",description:"lane widths",choices:ke()},{name:"SA04",description:"trip hazards",choices:ke()},{name:"SA05",description:"kerbside activity",choices:ke()},{name:"SA08",description:"motor traffic speed",choices:ke()},{name:"SA09",description:"motor traffic volume",choices:ke()},{name:"SA11",description:"footway widths",choices:ke()},{name:"SA12",description:"effective width next to tram lines",choices:ke()},{name:"SA13",description:"crossing angle of tram/train rails",choices:ke()},{name:"SA14",description:"cycling surface and maintenance defects",choices:ke()},{name:"SA15",description:"WW surface and maintenance defects",choices:ke()},{name:"SA16",description:"guard railing",choices:ke()}];const{window:jl}=He;function sn(n,e,r){const t=n.slice();return t[13]=e[r],t[14]=e,t[15]=r,t}function an(n){let e;return{c(){e=w("p"),e.textContent="A link needs at least two points"},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function zl(n){let e,r,t;function o(){return n[10](n[13])}return{c(){e=w("button"),e.textContent="?",P(e,"class","outline")},m(l,i){h(l,e,i),r||(t=Q(e,"click",o),r=!0)},p(l,i){n=l},d(l){l&&$(e),r=!1,t()}}}function Sl(n){let e=n[13].name+"",r,t,o=n[13].description+"",l,i,a,s=Qe[n[13].name]&&zl(n);return{c(){r=U(e),t=U(": "),l=U(o),i=z(),s&&s.c(),a=z()},m(u,c){h(u,r,c),h(u,t,c),h(u,l,c),h(u,i,c),s&&s.m(u,c),h(u,a,c)},p(u,c){Qe[u[13].name]&&s.p(u,c)},d(u){u&&($(r),$(t),$(l),$(i),$(a)),s&&s.d(u)}}}function cn(n){let e,r,t;function o(i){n[11](i,n[15])}let l={k:"horiz-radio",choices:n[13].choices,$$slots:{default:[Sl]},$$scope:{ctx:n}};return n[1].links[n[0]].properties.answers[n[15]]!==void 0&&(l.value=n[1].links[n[0]].properties.answers[n[15]]),e=new Me({props:l}),ue.push(()=>de(e,"value",o)),{c(){M(e.$$.fragment)},m(i,a){T(e,i,a),t=!0},p(i,a){n=i;const s={};a&65540&&(s.$$scope={dirty:a,ctx:n}),!r&&a&3&&(r=!0,s.value=n[1].links[n[0]].properties.answers[n[15]],me(()=>r=!1)),e.$set(s)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){b(e.$$.fragment,i),t=!1},d(i){I(e,i)}}}function Bl(n){let e,r,t,o,l,i,a,s,u,c,d,f,m,p,A,O=!n[3]&&an(),y=Y(we),v=[];for(let S=0;S<y.length;S+=1)v[S]=cn(sn(n,y,S));const N=S=>b(v[S],1,1,()=>{v[S]=null});return{c(){e=w("div"),r=w("button"),t=U("Done"),l=z(),i=w("button"),i.textContent="Delete link",a=z(),O&&O.c(),s=z(),u=w("label"),c=U(`Name:
      `),d=w("input"),f=z();for(let S=0;S<v.length;S+=1)v[S].c();r.disabled=o=!n[3],P(d,"type","text"),P(e,"slot","sidebar")},m(S,j){h(S,e,j),g(e,r),g(r,t),g(e,l),g(e,i),g(e,a),O&&O.m(e,null),g(e,s),g(e,u),g(u,c),g(u,d),he(d,n[1].links[n[0]].properties.name),g(e,f);for(let k=0;k<v.length;k+=1)v[k]&&v[k].m(e,null);m=!0,p||(A=[Q(r,"click",n[8]),Q(i,"click",n[6]),Q(d,"input",n[9])],p=!0)},p(S,j){if((!m||j&8&&o!==(o=!S[3]))&&(r.disabled=o),S[3]?O&&(O.d(1),O=null):O||(O=an(),O.c(),O.m(e,s)),j&3&&d.value!==S[1].links[S[0]].properties.name&&he(d,S[1].links[S[0]].properties.name),j&7){y=Y(we);let k;for(k=0;k<y.length;k+=1){const C=sn(S,y,k);v[k]?(v[k].p(C,j),_(v[k],1)):(v[k]=cn(C),v[k].c(),_(v[k],1),v[k].m(e,null))}for(ae(),k=y.length;k<v.length;k+=1)N(k);ce()}},i(S){if(!m){for(let j=0;j<y.length;j+=1)_(v[j]);m=!0}},o(S){v=v.filter(Boolean);for(let j=0;j<v.length;j+=1)b(v[j]);m=!1},d(S){S&&$(e),O&&O.d(),pe(v,S),p=!1,$e(A)}}}function Ll(n){let e,r;return e=new Le({props:{paint:{"line-color":["case",["==",["id"],n[0]],["get","color"],"black"],"line-width":6}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&1&&(l.paint={"line-color":["case",["==",["id"],t[0]],["get","color"],"black"],"line-width":6}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function Ml(n){let e,r,t,o,l,i,a,s;r=new Ee({props:{except:"links"}}),o=new _e({props:{data:re(n[1].links),generateId:!0,$$slots:{default:[Ll]},$$scope:{ctx:n}}});function u(d){n[7](d)}let c={};return n[1].links[n[0]]!==void 0&&(c.f=n[1].links[n[0]]),i=new Un({props:c}),ue.push(()=>de(i,"f",u)),{c(){e=w("div"),M(r.$$.fragment),t=z(),M(o.$$.fragment),l=z(),M(i.$$.fragment),P(e,"slot","map")},m(d,f){h(d,e,f),T(r,e,null),g(e,t),T(o,e,null),g(e,l),T(i,e,null),s=!0},p(d,f){const m={};f&2&&(m.data=re(d[1].links)),f&65537&&(m.$$scope={dirty:f,ctx:d}),o.$set(m);const p={};!a&&f&3&&(a=!0,p.f=d[1].links[d[0]],me(()=>a=!1)),i.$set(p)},i(d){s||(_(r.$$.fragment,d),_(o.$$.fragment,d),_(i.$$.fragment,d),s=!0)},o(d){b(r.$$.fragment,d),b(o.$$.fragment,d),b(i.$$.fragment,d),s=!1},d(d){d&&$(e),I(r),I(o),I(i)}}}function un(n){let e,r;return e=new rt({props:{$$slots:{default:[Tl]},$$scope:{ctx:n}}}),e.$on("close",n[12]),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&65540&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function Tl(n){let e,r=n[2].description+"",t,o,l,i;return l=new nt({props:{metric:n[2]}}),{c(){e=w("p"),t=U(r),o=z(),M(l.$$.fragment)},m(a,s){h(a,e,s),g(e,t),h(a,o,s),T(l,a,s),i=!0},p(a,s){(!i||s&4)&&r!==(r=a[2].description+"")&&oe(t,r);const u={};s&4&&(u.metric=a[2]),l.$set(u)},i(a){i||(_(l.$$.fragment,a),i=!0)},o(a){b(l.$$.fragment,a),i=!1},d(a){a&&($(e),$(o)),I(l,a)}}}function Il(n){let e,r,t,o,l,i;e=new Te({props:{$$slots:{map:[Ml],sidebar:[Bl]},$$scope:{ctx:n}}});let a=n[2]&&un(n);return{c(){M(e.$$.fragment),r=z(),a&&a.c(),t=De()},m(s,u){T(e,s,u),h(s,r,u),a&&a.m(s,u),h(s,t,u),o=!0,l||(i=Q(jl,"keydown",n[5]),l=!0)},p(s,[u]){const c={};u&65567&&(c.$$scope={dirty:u,ctx:s}),e.$set(c),s[2]?a?(a.p(s,u),u&4&&_(a,1)):(a=un(s),a.c(),_(a,1),a.m(t.parentNode,t)):a&&(ae(),b(a,1,1,()=>{a=null}),ce())},i(s){o||(_(e.$$.fragment,s),_(a),o=!0)},o(s){b(e.$$.fragment,s),b(a),o=!1},d(s){s&&($(r),$(t)),I(e,s),a&&a.d(s),l=!1,i()}}}function Dl(n,e,r){let t,o,l;ee(n,G,O=>r(1,o=O)),ee(n,J,O=>r(4,l=O));let{idx:i}=e,a=null;function s(O){O.key=="Escape"&&t&&H(J,l={kind:"neutral"},l)}async function u(){window.confirm("Really delete this link?")&&(H(J,l={kind:"neutral"},l),await Ne(),o.links.splice(i,1),G.set(o))}function c(O){n.$$.not_equal(o.links[i],O)&&(o.links[i]=O,G.set(o))}const d=()=>H(J,l={kind:"neutral"},l);function f(){o.links[i].properties.name=this.value,G.set(o)}const m=O=>r(2,a=Qe[O.name]);function p(O,y){n.$$.not_equal(o.links[i].properties.answers[y],O)&&(o.links[i].properties.answers[y]=O,G.set(o))}const A=()=>r(2,a=null);return n.$$set=O=>{"idx"in O&&r(0,i=O.idx)},n.$$.update=()=>{n.$$.dirty&3&&r(3,t=o.links[i].geometry.coordinates.length>=2)},[i,o,a,t,l,s,u,c,d,f,m,p,A]}class El extends ie{constructor(e){super(),se(this,e,Dl,Il,le,{idx:0})}}function fn(n,e,r){const t=n.slice();return t[7]=e[r],t[8]=e,t[9]=r,t}function Ol(n){let e;return{c(){e=w("p"),e.textContent=`${n[3].description}`},m(r,t){h(r,e,t)},p:V,d(r){r&&$(e)}}}function dn(n){let e,r,t=n[7].properties.name+"",o,l,i,a,s,u;function c(f){n[6](f,n[7])}let d={k:"horiz-radio",choices:we[n[0]].choices};return n[7].properties.answers[n[0]]!==void 0&&(d.value=n[7].properties.answers[n[0]]),i=new Me({props:d}),ue.push(()=>de(i,"value",c)),{c(){e=w("li"),r=w("span"),o=U(t),l=z(),M(i.$$.fragment),s=z(),W(r,"color",n[7].properties.color)},m(f,m){h(f,e,m),g(e,r),g(r,o),g(e,l),T(i,e,null),g(e,s),u=!0},p(f,m){n=f,(!u||m&4)&&t!==(t=n[7].properties.name+"")&&oe(o,t),m&4&&W(r,"color",n[7].properties.color);const p={};m&1&&(p.choices=we[n[0]].choices),!a&&m&5&&(a=!0,p.value=n[7].properties.answers[n[0]],me(()=>a=!1)),i.$set(p)},i(f){u||(_(i.$$.fragment,f),u=!0)},o(f){b(i.$$.fragment,f),u=!1},d(f){f&&$(e),I(i)}}}function Nl(n){let e,r;return e=new nt({props:{metric:n[3]}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function ql(n){let e,r,t,o,l=we[n[0]].name+"",i,a,s=we[n[0]].description+"",u,c,d,f,m,p,A,O,y=n[3]&&Ol(n),v=Y(n[2].links),N=[];for(let k=0;k<v.length;k+=1)N[k]=dn(fn(n,v,k));const S=k=>b(N[k],1,1,()=>{N[k]=null});let j=n[3]&&Nl(n);return{c(){e=w("div"),r=w("button"),r.textContent="Done",t=z(),o=w("h2"),i=U(l),a=U(": "),u=U(s),c=z(),y&&y.c(),d=z(),f=w("ol");for(let k=0;k<N.length;k+=1)N[k].c();m=z(),j&&j.c(),P(e,"slot","sidebar")},m(k,C){h(k,e,C),g(e,r),g(e,t),g(e,o),g(o,i),g(o,a),g(o,u),g(e,c),y&&y.m(e,null),g(e,d),g(e,f);for(let B=0;B<N.length;B+=1)N[B]&&N[B].m(f,null);g(e,m),j&&j.m(e,null),p=!0,A||(O=Q(r,"click",n[5]),A=!0)},p(k,C){if((!p||C&1)&&l!==(l=we[k[0]].name+"")&&oe(i,l),(!p||C&1)&&s!==(s=we[k[0]].description+"")&&oe(u,s),k[3]&&y.p(k,C),C&5){v=Y(k[2].links);let B;for(B=0;B<v.length;B+=1){const E=fn(k,v,B);N[B]?(N[B].p(E,C),_(N[B],1)):(N[B]=dn(E),N[B].c(),_(N[B],1),N[B].m(f,null))}for(ae(),B=v.length;B<N.length;B+=1)S(B);ce()}k[3]&&j.p(k,C)},i(k){if(!p){for(let C=0;C<v.length;C+=1)_(N[C]);_(j),p=!0}},o(k){N=N.filter(Boolean);for(let C=0;C<N.length;C+=1)b(N[C]);b(j),p=!1},d(k){k&&$(e),y&&y.d(),pe(N,k),j&&j.d(),A=!1,O()}}}function Fl(n){let e,r,t;return r=new Ee({props:{showLinkColor:!0,except:""}}),{c(){e=w("div"),M(r.$$.fragment),P(e,"slot","map")},m(o,l){h(o,e,l),T(r,e,null),t=!0},p:V,i(o){t||(_(r.$$.fragment,o),t=!0)},o(o){b(r.$$.fragment,o),t=!1},d(o){o&&$(e),I(r)}}}function Pl(n){let e,r,t,o;return e=new Te({props:{$$slots:{map:[Fl],sidebar:[ql]},$$scope:{ctx:n}}}),{c(){M(e.$$.fragment)},m(l,i){T(e,l,i),r=!0,t||(o=Q(window,"keydown",n[4]),t=!0)},p(l,[i]){const a={};i&1031&&(a.$$scope={dirty:i,ctx:l}),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){b(e.$$.fragment,l),r=!1},d(l){I(e,l),t=!1,o()}}}function Ul(n,e,r){let t,o;ee(n,J,c=>r(1,t=c)),ee(n,G,c=>r(2,o=c));let{qIdx:l}=e,i=Qe[we[l].name];function a(c){c.key=="Escape"&&H(J,t={kind:"neutral"},t)}const s=()=>H(J,t={kind:"neutral"},t);function u(c,d){n.$$.not_equal(d.properties.answers[l],c)&&(d.properties.answers[l]=c,G.set(o))}return n.$$set=c=>{"qIdx"in c&&r(0,l=c.qIdx)},[l,t,o,i,a,s,u]}class Gl extends ie{constructor(e){super(),se(this,e,Ul,Pl,le,{qIdx:0})}}function Ql(n){let e,r,t,o;const l=n[2].default,i=je(l,n,n[1],null);return{c(){e=w("a"),i&&i.c(),P(e,"href","#"),W(e,"color",n[0])},m(a,s){h(a,e,s),i&&i.m(e,null),r=!0,t||(o=Q(e,"click",tr(n[3])),t=!0)},p(a,[s]){i&&i.p&&(!r||s&2)&&ze(i,l,a,a[1],r?Be(l,a[1],s,null):Se(a[1]),null),s&1&&W(e,"color",a[0])},i(a){r||(_(i,a),r=!0)},o(a){b(i,a),r=!1},d(a){a&&$(e),i&&i.d(a),t=!1,o()}}}function Hl(n,e,r){let{$$slots:t={},$$scope:o}=e,{color:l=void 0}=e;function i(a){be.call(this,n,a)}return n.$$set=a=>{"color"in a&&r(0,l=a.color),"$$scope"in a&&r(1,o=a.$$scope)},[l,o,t,i]}class Je extends ie{constructor(e){super(),se(this,e,Hl,Ql,le,{color:0})}}function mn(n,e,r){const t=n.slice();return t[4]=e[r],t[6]=r,t}function Jl(n){let e=n[4].properties.name+"",r;return{c(){r=U(e)},m(t,o){h(t,r,o)},p(t,o){o&2&&e!==(e=t[4].properties.name+"")&&oe(r,e)},d(t){t&&$(r)}}}function pn(n){let e,r,t,o;function l(){return n[3](n[6])}return r=new Je({props:{color:n[4].properties.color,$$slots:{default:[Jl]},$$scope:{ctx:n}}}),r.$on("click",l),{c(){e=w("li"),M(r.$$.fragment),t=z()},m(i,a){h(i,e,a),T(r,e,null),g(e,t),o=!0},p(i,a){n=i;const s={};a&2&&(s.color=n[4].properties.color),a&130&&(s.$$scope={dirty:a,ctx:n}),r.$set(s)},i(i){o||(_(r.$$.fragment,i),o=!0)},o(i){b(r.$$.fragment,i),o=!1},d(i){i&&$(e),I(r)}}}function Rl(n){let e,r,t,o,l,i,a,s,u=Y(n[1].bus_stops),c=[];for(let f=0;f<u.length;f+=1)c[f]=pn(mn(n,u,f));const d=f=>b(c[f],1,1,()=>{c[f]=null});return{c(){e=U(`Bus stops:

`),r=w("div"),t=w("button"),t.textContent="New bus stop",o=z(),l=w("ol");for(let f=0;f<c.length;f+=1)c[f].c()},m(f,m){h(f,e,m),h(f,r,m),g(r,t),h(f,o,m),h(f,l,m);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(l,null);i=!0,a||(s=Q(t,"click",n[2]),a=!0)},p(f,[m]){if(m&3){u=Y(f[1].bus_stops);let p;for(p=0;p<u.length;p+=1){const A=mn(f,u,p);c[p]?(c[p].p(A,m),_(c[p],1)):(c[p]=pn(A),c[p].c(),_(c[p],1),c[p].m(l,null))}for(ae(),p=u.length;p<c.length;p+=1)d(p);ce()}},i(f){if(!i){for(let m=0;m<u.length;m+=1)_(c[m]);i=!0}},o(f){c=c.filter(Boolean);for(let m=0;m<c.length;m+=1)b(c[m]);i=!1},d(f){f&&($(e),$(r),$(o),$(l)),pe(c,f),a=!1,s()}}}function Kl(n,e,r){let t,o;return ee(n,J,a=>r(0,t=a)),ee(n,G,a=>r(1,o=a)),[t,o,()=>H(J,t={kind:"new-point",obj:"bus stop"},t),a=>H(J,t={kind:"edit-bus-stop",idx:a},t)]}let Xl=class extends ie{constructor(e){super(),se(this,e,Kl,Rl,le,{})}};function gn(n,e,r){const t=n.slice();return t[4]=e[r],t[6]=r,t}function Zl(n){let e=n[4].properties.name+"",r;return{c(){r=U(e)},m(t,o){h(t,r,o)},p(t,o){o&2&&e!==(e=t[4].properties.name+"")&&oe(r,e)},d(t){t&&$(r)}}}function _n(n){let e,r,t,o;function l(){return n[3](n[6])}return r=new Je({props:{color:n[4].properties.color,$$slots:{default:[Zl]},$$scope:{ctx:n}}}),r.$on("click",l),{c(){e=w("li"),M(r.$$.fragment),t=z()},m(i,a){h(i,e,a),T(r,e,null),g(e,t),o=!0},p(i,a){n=i;const s={};a&2&&(s.color=n[4].properties.color),a&130&&(s.$$scope={dirty:a,ctx:n}),r.$set(s)},i(i){o||(_(r.$$.fragment,i),o=!0)},o(i){b(r.$$.fragment,i),o=!1},d(i){i&&$(e),I(r)}}}function Yl(n){let e,r,t,o,l,i,a,s,u=Y(n[1].crossings),c=[];for(let f=0;f<u.length;f+=1)c[f]=_n(gn(n,u,f));const d=f=>b(c[f],1,1,()=>{c[f]=null});return{c(){e=U(`Crossings:

`),r=w("div"),t=w("button"),t.textContent="New crossing",o=z(),l=w("ol");for(let f=0;f<c.length;f+=1)c[f].c()},m(f,m){h(f,e,m),h(f,r,m),g(r,t),h(f,o,m),h(f,l,m);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(l,null);i=!0,a||(s=Q(t,"click",n[2]),a=!0)},p(f,[m]){if(m&3){u=Y(f[1].crossings);let p;for(p=0;p<u.length;p+=1){const A=gn(f,u,p);c[p]?(c[p].p(A,m),_(c[p],1)):(c[p]=_n(A),c[p].c(),_(c[p],1),c[p].m(l,null))}for(ae(),p=u.length;p<c.length;p+=1)d(p);ce()}},i(f){if(!i){for(let m=0;m<u.length;m+=1)_(c[m]);i=!0}},o(f){c=c.filter(Boolean);for(let m=0;m<c.length;m+=1)b(c[m]);i=!1},d(f){f&&($(e),$(r),$(o),$(l)),pe(c,f),a=!1,s()}}}function Vl(n,e,r){let t,o;return ee(n,J,a=>r(0,t=a)),ee(n,G,a=>r(1,o=a)),[t,o,()=>H(J,t={kind:"new-point",obj:"crossing"},t),a=>H(J,t={kind:"edit-crossing",idx:a},t)]}let Wl=class extends ie{constructor(e){super(),se(this,e,Vl,Yl,le,{})}};function hn(n,e,r){const t=n.slice();return t[4]=e[r],t[6]=r,t}function xl(n){let e=n[4].properties.name+"",r;return{c(){r=U(e)},m(t,o){h(t,r,o)},p(t,o){o&2&&e!==(e=t[4].properties.name+"")&&oe(r,e)},d(t){t&&$(r)}}}function $n(n){let e,r,t,o;function l(){return n[3](n[6])}return r=new Je({props:{color:n[4].properties.color,$$slots:{default:[xl]},$$scope:{ctx:n}}}),r.$on("click",l),{c(){e=w("li"),M(r.$$.fragment),t=z()},m(i,a){h(i,e,a),T(r,e,null),g(e,t),o=!0},p(i,a){n=i;const s={};a&2&&(s.color=n[4].properties.color),a&130&&(s.$$scope={dirty:a,ctx:n}),r.$set(s)},i(i){o||(_(r.$$.fragment,i),o=!0)},o(i){b(r.$$.fragment,i),o=!1},d(i){i&&$(e),I(r)}}}function ei(n){let e,r,t,o,l,i,a,s,u=Y(n[1].jats),c=[];for(let f=0;f<u.length;f+=1)c[f]=$n(hn(n,u,f));const d=f=>b(c[f],1,1,()=>{c[f]=null});return{c(){e=U(`JATs:

`),r=w("div"),t=w("button"),t.textContent="New JAT",o=z(),l=w("ol");for(let f=0;f<c.length;f+=1)c[f].c()},m(f,m){h(f,e,m),h(f,r,m),g(r,t),h(f,o,m),h(f,l,m);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(l,null);i=!0,a||(s=Q(t,"click",n[2]),a=!0)},p(f,[m]){if(m&3){u=Y(f[1].jats);let p;for(p=0;p<u.length;p+=1){const A=hn(f,u,p);c[p]?(c[p].p(A,m),_(c[p],1)):(c[p]=$n(A),c[p].c(),_(c[p],1),c[p].m(l,null))}for(ae(),p=u.length;p<c.length;p+=1)d(p);ce()}},i(f){if(!i){for(let m=0;m<u.length;m+=1)_(c[m]);i=!0}},o(f){c=c.filter(Boolean);for(let m=0;m<c.length;m+=1)b(c[m]);i=!1},d(f){f&&($(e),$(r),$(o),$(l)),pe(c,f),a=!1,s()}}}function ti(n,e,r){let t,o;return ee(n,J,a=>r(0,t=a)),ee(n,G,a=>r(1,o=a)),[t,o,()=>H(J,t={kind:"new-point",obj:"jat"},t),a=>H(J,t={kind:"edit-jat",idx:a},t)]}let ni=class extends ie{constructor(e){super(),se(this,e,ti,ei,le,{})}};function kn(n,e,r){const t=n.slice();return t[2]=e[r],t[4]=r,t}function bn(n,e,r){const t=n.slice();t[5]=e[r];const o=t[5].properties.answers[t[4]];return t[6]=o,t}function wn(n,e,r){const t=n.slice();return t[5]=e[r],t}function vn(n){let e,r=n[5].properties.name+"",t;return{c(){e=w("th"),t=U(r),W(e,"color",n[5].properties.color)},m(o,l){h(o,e,l),g(e,t)},p(o,l){l&1&&r!==(r=o[5].properties.name+"")&&oe(t,r),l&1&&W(e,"color",o[5].properties.color)},d(o){o&&$(e)}}}function yn(n){let e,r=n[6]+"",t;return{c(){e=w("td"),t=U(r),W(e,"background",n[6]==""?"red":"green")},m(o,l){h(o,e,l),g(e,t)},p(o,l){l&1&&r!==(r=o[6]+"")&&oe(t,r),l&1&&W(e,"background",o[6]==""?"red":"green")},d(o){o&&$(e)}}}function An(n){let e,r,t,o,l=Y(n[0].links),i=[];for(let a=0;a<l.length;a+=1)i[a]=yn(bn(n,l,a));return{c(){e=w("tr"),r=w("th"),r.textContent=`${n[2].name}`,t=z();for(let a=0;a<i.length;a+=1)i[a].c();o=z()},m(a,s){h(a,e,s),g(e,r),g(e,t);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);g(e,o)},p(a,s){if(s&1){l=Y(a[0].links);let u;for(u=0;u<l.length;u+=1){const c=bn(a,l,u);i[u]?i[u].p(c,s):(i[u]=yn(c),i[u].c(),i[u].m(e,o))}for(;u<i.length;u+=1)i[u].d(1);i.length=l.length}},d(a){a&&$(e),pe(i,a)}}}function ri(n){let e,r,t,o,l,i,a,s=Y(n[0].links),u=[];for(let f=0;f<s.length;f+=1)u[f]=vn(wn(n,s,f));let c=Y(we),d=[];for(let f=0;f<c.length;f+=1)d[f]=An(kn(n,c,f));return{c(){e=w("table"),r=w("thead"),t=w("tr"),o=w("th"),l=z();for(let f=0;f<u.length;f+=1)u[f].c();i=z(),a=w("tbody");for(let f=0;f<d.length;f+=1)d[f].c()},m(f,m){h(f,e,m),g(e,r),g(r,t),g(t,o),g(t,l);for(let p=0;p<u.length;p+=1)u[p]&&u[p].m(t,null);g(e,i),g(e,a);for(let p=0;p<d.length;p+=1)d[p]&&d[p].m(a,null)},p(f,m){if(m&1){s=Y(f[0].links);let p;for(p=0;p<s.length;p+=1){const A=wn(f,s,p);u[p]?u[p].p(A,m):(u[p]=vn(A),u[p].c(),u[p].m(t,null))}for(;p<u.length;p+=1)u[p].d(1);u.length=s.length}if(m&1){c=Y(we);let p;for(p=0;p<c.length;p+=1){const A=kn(f,c,p);d[p]?d[p].p(A,m):(d[p]=An(A),d[p].c(),d[p].m(a,null))}for(;p<d.length;p+=1)d[p].d(1);d.length=c.length}},d(f){f&&$(e),pe(u,f),pe(d,f)}}}function oi(n){let e,r;return e=new rt({props:{$$slots:{default:[ri]},$$scope:{ctx:n}}}),e.$on("close",n[1]),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,[o]){const l={};o&2049&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function li(n,e,r){let t;ee(n,G,l=>r(0,t=l));function o(l){be.call(this,n,l)}return[t,o]}class ii extends ie{constructor(e){super(),se(this,e,li,oi,le,{})}}function Cn(n,e,r){const t=n.slice();return t[9]=e[r],t[11]=r,t}function jn(n,e,r){const t=n.slice();return t[12]=e[r],t[11]=r,t}function zn(n){let e,r;return e=new ii({}),e.$on("close",n[4]),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function si(n){let e=n[12].properties.name+"",r;return{c(){r=U(e)},m(t,o){h(t,r,o)},p(t,o){o&2&&e!==(e=t[12].properties.name+"")&&oe(r,e)},d(t){t&&$(r)}}}function Sn(n){let e,r,t,o;function l(){return n[6](n[11])}return r=new Je({props:{color:n[12].properties.color,$$slots:{default:[si]},$$scope:{ctx:n}}}),r.$on("click",l),{c(){e=w("li"),M(r.$$.fragment),t=z()},m(i,a){h(i,e,a),T(r,e,null),g(e,t),o=!0},p(i,a){n=i;const s={};a&2&&(s.color=n[12].properties.color),a&16386&&(s.$$scope={dirty:a,ctx:n}),r.$set(s)},i(i){o||(_(r.$$.fragment,i),o=!0)},o(i){b(r.$$.fragment,i),o=!1},d(i){i&&$(e),I(r)}}}function ai(n){let e=n[9].name+"",r,t;return{c(){r=U(e),t=z()},m(o,l){h(o,r,l),h(o,t,l)},p:V,d(o){o&&($(r),$(t))}}}function Bn(n){let e,r,t,o,l,i,a,s;function u(){return n[7](n[11])}r=new Je({props:{$$slots:{default:[ai]},$$scope:{ctx:n}}}),r.$on("click",u);function c(...d){return n[8](n[11],...d)}return{c(){e=w("li"),M(r.$$.fragment),t=U(`:
      `),o=w("progress"),a=z(),o.value=l=n[1].links.filter(c).length,P(o,"max",i=n[1].links.length),P(o,"class","svelte-zadug4")},m(d,f){h(d,e,f),T(r,e,null),g(e,t),g(e,o),g(e,a),s=!0},p(d,f){n=d;const m={};f&16384&&(m.$$scope={dirty:f,ctx:n}),r.$set(m),(!s||f&2&&l!==(l=n[1].links.filter(c).length))&&(o.value=l),(!s||f&2&&i!==(i=n[1].links.length))&&P(o,"max",i)},i(d){s||(_(r.$$.fragment,d),s=!0)},o(d){b(r.$$.fragment,d),s=!1},d(d){d&&$(e),I(r)}}}function ci(n){let e,r,t,o,l,i,a,s,u,c,d,f,m=n[0]&&zn(n),p=Y(n[1].links),A=[];for(let S=0;S<p.length;S+=1)A[S]=Sn(jn(n,p,S));const O=S=>b(A[S],1,1,()=>{A[S]=null});let y=Y(we),v=[];for(let S=0;S<y.length;S+=1)v[S]=Bn(Cn(n,y,S));const N=S=>b(v[S],1,1,()=>{v[S]=null});return{c(){m&&m.c(),e=z(),r=w("div"),t=w("button"),t.textContent="New link",o=z(),l=w("button"),l.textContent="Table of questions",i=U(`

Links:
`),a=w("ol");for(let S=0;S<A.length;S+=1)A[S].c();s=U(`

Questions:
`),u=w("ol");for(let S=0;S<v.length;S+=1)v[S].c()},m(S,j){m&&m.m(S,j),h(S,e,j),h(S,r,j),g(r,t),g(r,o),g(r,l),h(S,i,j),h(S,a,j);for(let k=0;k<A.length;k+=1)A[k]&&A[k].m(a,null);h(S,s,j),h(S,u,j);for(let k=0;k<v.length;k+=1)v[k]&&v[k].m(u,null);c=!0,d||(f=[Q(t,"click",n[3]),Q(l,"click",n[5])],d=!0)},p(S,[j]){if(S[0]?m?(m.p(S,j),j&1&&_(m,1)):(m=zn(S),m.c(),_(m,1),m.m(e.parentNode,e)):m&&(ae(),b(m,1,1,()=>{m=null}),ce()),j&6){p=Y(S[1].links);let k;for(k=0;k<p.length;k+=1){const C=jn(S,p,k);A[k]?(A[k].p(C,j),_(A[k],1)):(A[k]=Sn(C),A[k].c(),_(A[k],1),A[k].m(a,null))}for(ae(),k=p.length;k<A.length;k+=1)O(k);ce()}if(j&6){y=Y(we);let k;for(k=0;k<y.length;k+=1){const C=Cn(S,y,k);v[k]?(v[k].p(C,j),_(v[k],1)):(v[k]=Bn(C),v[k].c(),_(v[k],1),v[k].m(u,null))}for(ae(),k=y.length;k<v.length;k+=1)N(k);ce()}},i(S){if(!c){_(m);for(let j=0;j<p.length;j+=1)_(A[j]);for(let j=0;j<y.length;j+=1)_(v[j]);c=!0}},o(S){b(m),A=A.filter(Boolean);for(let j=0;j<A.length;j+=1)b(A[j]);v=v.filter(Boolean);for(let j=0;j<v.length;j+=1)b(v[j]);c=!1},d(S){S&&($(e),$(r),$(i),$(a),$(s),$(u)),m&&m.d(S),pe(A,S),pe(v,S),d=!1,$e(f)}}}function ui(n,e,r){let t,o;ee(n,G,f=>r(1,t=f)),ee(n,J,f=>r(2,o=f));let l=!1;function i(){let f=Cl(t.links.length);H(G,t.links=[...t.links,f],t),H(J,o={kind:"edit-link",idx:t.links.length-1},o)}return[l,t,o,i,()=>r(0,l=!1),()=>r(0,l=!0),f=>H(J,o={kind:"edit-link",idx:f},o),f=>H(J,o={kind:"edit-question",idx:f},o),(f,m)=>m.properties.answers[f]!=""]}let fi=class extends ie{constructor(e){super(),se(this,e,ui,ci,le,{})}};function di(n){return{type:"Feature",geometry:{type:"LineString",coordinates:[]},properties:{name:"Untitled side road",color:Ce[n%Ce.length],sa01:""}}}function Ln(n,e,r){const t=n.slice();return t[4]=e[r],t[6]=r,t}function mi(n){let e=n[4].properties.name+"",r;return{c(){r=U(e)},m(t,o){h(t,r,o)},p(t,o){o&1&&e!==(e=t[4].properties.name+"")&&oe(r,e)},d(t){t&&$(r)}}}function Mn(n){let e,r,t,o;function l(){return n[3](n[6])}return r=new Je({props:{color:n[4].properties.color,$$slots:{default:[mi]},$$scope:{ctx:n}}}),r.$on("click",l),{c(){e=w("li"),M(r.$$.fragment),t=z()},m(i,a){h(i,e,a),T(r,e,null),g(e,t),o=!0},p(i,a){n=i;const s={};a&1&&(s.color=n[4].properties.color),a&129&&(s.$$scope={dirty:a,ctx:n}),r.$set(s)},i(i){o||(_(r.$$.fragment,i),o=!0)},o(i){b(r.$$.fragment,i),o=!1},d(i){i&&$(e),I(r)}}}function pi(n){let e,r,t,o,l,i,a,s,u=Y(n[0].side_roads),c=[];for(let f=0;f<u.length;f+=1)c[f]=Mn(Ln(n,u,f));const d=f=>b(c[f],1,1,()=>{c[f]=null});return{c(){e=U(`Side roads:

`),r=w("div"),t=w("button"),t.textContent="New side road",o=z(),l=w("ol");for(let f=0;f<c.length;f+=1)c[f].c()},m(f,m){h(f,e,m),h(f,r,m),g(r,t),h(f,o,m),h(f,l,m);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(l,null);i=!0,a||(s=Q(t,"click",n[2]),a=!0)},p(f,[m]){if(m&3){u=Y(f[0].side_roads);let p;for(p=0;p<u.length;p+=1){const A=Ln(f,u,p);c[p]?(c[p].p(A,m),_(c[p],1)):(c[p]=Mn(A),c[p].c(),_(c[p],1),c[p].m(l,null))}for(ae(),p=u.length;p<c.length;p+=1)d(p);ce()}},i(f){if(!i){for(let m=0;m<u.length;m+=1)_(c[m]);i=!0}},o(f){c=c.filter(Boolean);for(let m=0;m<c.length;m+=1)b(c[m]);i=!1},d(f){f&&($(e),$(r),$(o),$(l)),pe(c,f),a=!1,s()}}}function gi(n,e,r){let t,o;ee(n,G,a=>r(0,t=a)),ee(n,J,a=>r(1,o=a));function l(){let a=di(t.side_roads.length);H(G,t.side_roads=[...t.side_roads,a],t),H(J,o={kind:"edit-side-road",idx:t.side_roads.length-1},o)}return[t,o,l,a=>H(J,o={kind:"edit-side-road",idx:a},o)]}class _i extends ie{constructor(e){super(),se(this,e,gi,pi,le,{})}}function hi(n){let e,r,t,o,l,i,a,s,u,c,d,f,m,p,A,O,y,v,N,S,j,k,C,B,E,K,R,D,te,L;return d=new fi({}),A=new ni({}),N=new Xl({}),C=new Wl({}),R=new _i({}),{c(){e=w("div"),r=w("div"),t=w("button"),t.textContent="Load file",o=z(),l=w("button"),l.textContent="Download",i=z(),a=w("button"),a.textContent="Clear",s=z(),u=w("hr"),c=z(),M(d.$$.fragment),f=z(),m=w("hr"),p=z(),M(A.$$.fragment),O=z(),y=w("hr"),v=z(),M(N.$$.fragment),S=z(),j=w("hr"),k=z(),M(C.$$.fragment),B=z(),E=w("hr"),K=z(),M(R.$$.fragment),P(t,"class","secondary"),P(l,"class","secondary"),P(a,"class","secondary"),P(e,"slot","sidebar")},m(ne,ge){h(ne,e,ge),g(e,r),g(r,t),g(r,o),g(r,l),g(r,i),g(r,a),g(e,s),g(e,u),g(e,c),T(d,e,null),g(e,f),g(e,m),g(e,p),T(A,e,null),g(e,O),g(e,y),g(e,v),T(N,e,null),g(e,S),g(e,j),g(e,k),T(C,e,null),g(e,B),g(e,E),g(e,K),T(R,e,null),D=!0,te||(L=[Q(t,"click",n[11]),Q(l,"click",n[12]),Q(a,"click",n[5])],te=!0)},p:V,i(ne){D||(_(d.$$.fragment,ne),_(A.$$.fragment,ne),_(N.$$.fragment,ne),_(C.$$.fragment,ne),_(R.$$.fragment,ne),D=!0)},o(ne){b(d.$$.fragment,ne),b(A.$$.fragment,ne),b(N.$$.fragment,ne),b(C.$$.fragment,ne),b(R.$$.fragment,ne),D=!1},d(ne){ne&&$(e),I(d),I(A),I(N),I(C),I(R),te=!1,$e(L)}}}function $i(n){let e,r;return e=new Le({props:{manageHoverState:!0,paint:{"line-color":["get","color"],"line-width":Xe(6,9)},hoverCursor:"pointer"}}),e.$on("click",n[6]),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function ki(n){let e,r;return e=new Ve({props:{manageHoverState:!0,paint:{"circle-color":"rgba(0,0,0,0)","circle-stroke-width":5,"circle-stroke-color":["get","color"],"circle-radius":Xe(20,25)},hoverCursor:"pointer"}}),e.$on("click",n[7]),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function bi(n){let e,r;return e=new qe({props:{manageHoverState:!0,layout:{"icon-image":"bus_stop","icon-size":3},paint:{"icon-color":["get","color"]},hoverCursor:"pointer"}}),e.$on("click",n[8]),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function wi(n){let e,r;return e=new qe({props:{manageHoverState:!0,layout:{"icon-image":"crossing","icon-size":.1},paint:{"icon-color":["get","color"]},hoverCursor:"pointer"}}),e.$on("click",n[9]),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function vi(n){let e,r;return e=new Le({props:{manageHoverState:!0,paint:{"line-color":["get","color"],"line-width":Xe(3,6)},hoverCursor:"pointer"}}),e.$on("click",n[10]),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function yi(n){let e,r,t,o,l,i,a,s,u,c,d;return r=new _e({props:{data:re(n[2].links),generateId:!0,$$slots:{default:[$i]},$$scope:{ctx:n}}}),o=new _e({props:{data:re(n[2].jats),generateId:!0,$$slots:{default:[ki]},$$scope:{ctx:n}}}),i=new _e({props:{data:re(n[2].bus_stops),generateId:!0,$$slots:{default:[bi]},$$scope:{ctx:n}}}),s=new _e({props:{data:re(n[2].crossings),generateId:!0,$$slots:{default:[wi]},$$scope:{ctx:n}}}),c=new _e({props:{data:re(n[2].side_roads),generateId:!0,$$slots:{default:[vi]},$$scope:{ctx:n}}}),{c(){e=w("div"),M(r.$$.fragment),t=z(),M(o.$$.fragment),l=z(),M(i.$$.fragment),a=z(),M(s.$$.fragment),u=z(),M(c.$$.fragment),P(e,"slot","map")},m(f,m){h(f,e,m),T(r,e,null),g(e,t),T(o,e,null),g(e,l),T(i,e,null),g(e,a),T(s,e,null),g(e,u),T(c,e,null),d=!0},p(f,m){const p={};m&4&&(p.data=re(f[2].links)),m&32776&&(p.$$scope={dirty:m,ctx:f}),r.$set(p);const A={};m&4&&(A.data=re(f[2].jats)),m&32776&&(A.$$scope={dirty:m,ctx:f}),o.$set(A);const O={};m&4&&(O.data=re(f[2].bus_stops)),m&32776&&(O.$$scope={dirty:m,ctx:f}),i.$set(O);const y={};m&4&&(y.data=re(f[2].crossings)),m&32776&&(y.$$scope={dirty:m,ctx:f}),s.$set(y);const v={};m&4&&(v.data=re(f[2].side_roads)),m&32776&&(v.$$scope={dirty:m,ctx:f}),c.$set(v)},i(f){d||(_(r.$$.fragment,f),_(o.$$.fragment,f),_(i.$$.fragment,f),_(s.$$.fragment,f),_(c.$$.fragment,f),d=!0)},o(f){b(r.$$.fragment,f),b(o.$$.fragment,f),b(i.$$.fragment,f),b(s.$$.fragment,f),b(c.$$.fragment,f),d=!1},d(f){f&&$(e),I(r),I(o),I(i),I(s),I(c)}}}function Tn(n){let e,r;return e=new rt({props:{$$slots:{default:[Ai]},$$scope:{ctx:n}}}),e.$on("close",n[14]),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&32770&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function Ai(n){let e,r,t,o,l;return{c(){e=w("h1"),e.textContent="Load a file previously downloaded from this tool",r=z(),t=w("input"),P(t,"type","file")},m(i,a){h(i,e,a),h(i,r,a),h(i,t,a),n[13](t),o||(l=Q(t,"change",n[4]),o=!0)},p:V,d(i){i&&($(e),$(r),$(t)),n[13](null),o=!1,l()}}}function Ci(n){let e,r,t,o;e=new Te({props:{$$slots:{map:[yi],sidebar:[hi]},$$scope:{ctx:n}}});let l=n[0]&&Tn(n);return{c(){M(e.$$.fragment),r=z(),l&&l.c(),t=De()},m(i,a){T(e,i,a),h(i,r,a),l&&l.m(i,a),h(i,t,a),o=!0},p(i,[a]){const s={};a&32781&&(s.$$scope={dirty:a,ctx:i}),e.$set(s),i[0]?l?(l.p(i,a),a&1&&_(l,1)):(l=Tn(i),l.c(),_(l,1),l.m(t.parentNode,t)):l&&(ae(),b(l,1,1,()=>{l=null}),ce())},i(i){o||(_(e.$$.fragment,i),_(l),o=!0)},o(i){b(e.$$.fragment,i),b(l),o=!1},d(i){i&&($(r),$(t)),I(e,i),l&&l.d(i)}}}function ji(n,e,r){let t,o;ee(n,G,v=>r(2,t=v)),ee(n,J,v=>r(3,o=v));let l=!1,i;async function a(v){try{let N=JSON.parse(await i.files[0].text());if(Nn(N)){H(G,t=N,t),r(0,l=!1);return}}catch{}window.alert("Something's wrong with that file")}function s(){H(G,t.links=[],t),H(G,t.jats=[],t),H(G,t.bus_stops=[],t),H(G,t.crossings=[],t),H(G,t.side_roads=[],t)}const u=v=>H(J,o={kind:"edit-link",idx:v.detail.features[0].id},o),c=v=>H(J,o={kind:"edit-jat",idx:v.detail.features[0].id},o),d=v=>H(J,o={kind:"edit-bus-stop",idx:v.detail.features[0].id},o),f=v=>H(J,o={kind:"edit-crossing",idx:v.detail.features[0].id},o),m=v=>H(J,o={kind:"edit-side-road",idx:v.detail.features[0].id},o),p=()=>r(0,l=!0),A=()=>ro("rcv2.geojson",JSON.stringify(t));function O(v){ue[v?"unshift":"push"](()=>{i=v,r(1,i)})}return[l,i,t,o,a,s,u,c,d,f,m,p,A,O,()=>r(0,l=!1)]}class zi extends ie{constructor(e){super(),se(this,e,ji,Ci,le,{})}}function Si(n,e){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{name:"Untitled bus stop",color:Ce[n%Ce.length],st20:""}}}function Bi(n,e){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{name:"Untitled crossing",color:Ce[n%Ce.length],sa10:""}}}function Li(n,e){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{name:"Untitled JAT",color:Ce[n%Ce.length],existing:{arms:[],movements:[],notes:""},proposed:{arms:[],movements:[],notes:""}}}}function Mi(n){let e,r,t,o,l,i,a,s;return{c(){e=w("div"),r=w("h1"),t=U("Click map to create new "),o=U(n[0]),l=z(),i=w("button"),i.textContent="Cancel",P(e,"slot","sidebar")},m(u,c){h(u,e,c),g(e,r),g(r,t),g(r,o),g(e,l),g(e,i),a||(s=Q(i,"click",n[3]),a=!0)},p(u,c){c&1&&oe(o,u[0])},d(u){u&&$(e),a=!1,s()}}}function Ti(n){let e,r,t;return r=new Ee({props:{except:""}}),{c(){e=w("div"),M(r.$$.fragment),P(e,"slot","map")},m(o,l){h(o,e,l),T(r,e,null),t=!0},p:V,i(o){t||(_(r.$$.fragment,o),t=!0)},o(o){b(r.$$.fragment,o),t=!1},d(o){o&&$(e),I(r)}}}function Ii(n){let e,r,t,o;return e=new ct({}),e.$on("click",n[2]),t=new Te({props:{$$slots:{map:[Ti],sidebar:[Mi]},$$scope:{ctx:n}}}),{c(){M(e.$$.fragment),r=z(),M(t.$$.fragment)},m(l,i){T(e,l,i),h(l,r,i),T(t,l,i),o=!0},p(l,[i]){const a={};i&35&&(a.$$scope={dirty:i,ctx:l}),t.$set(a)},i(l){o||(_(e.$$.fragment,l),_(t.$$.fragment,l),o=!0)},o(l){b(e.$$.fragment,l),b(t.$$.fragment,l),o=!1},d(l){l&&$(r),I(e,l),I(t,l)}}}function Di(n,e,r){let t,o;ee(n,G,s=>r(4,t=s)),ee(n,J,s=>r(1,o=s));let{obj:l}=e;function i(s){let u=s.detail.lngLat.toArray();if(l=="jat"){let c=Li(t.jats.length,u);H(G,t.jats=[...t.jats,c],t),H(J,o={kind:"edit-jat",idx:t.jats.length-1},o)}else if(l=="crossing"){let c=Bi(t.crossings.length,u);H(G,t.crossings=[...t.crossings,c],t),H(J,o={kind:"edit-crossing",idx:t.crossings.length-1},o)}else if(l=="bus stop"){let c=Si(t.bus_stops.length,u);H(G,t.bus_stops=[...t.bus_stops,c],t),H(J,o={kind:"edit-bus-stop",idx:t.bus_stops.length-1},o)}}const a=()=>H(J,o={kind:"neutral"},o);return n.$$set=s=>{"obj"in s&&r(0,l=s.obj)},[l,o,i,a]}class Ei extends ie{constructor(e){super(),se(this,e,Di,Ii,le,{obj:0})}}const{window:Oi}=He;function In(n){let e;return{c(){e=w("p"),e.textContent="A side road needs at least two points"},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function Ni(n){let e;return{c(){e=U("SA01: conflict at side roads and priority junctions")},m(r,t){h(r,e,t)},d(r){r&&$(e)}}}function qi(n){let e,r,t,o,l,i,a,s,u,c,d,f,m,p,A,O,y,v,N,S,j,k=!n[2]&&In();function C(E){n[10](E)}let B={k:"horiz-radio",choices:ke(),$$slots:{default:[Ni]},$$scope:{ctx:n}};return n[1].side_roads[n[0]].properties.sa01!==void 0&&(B.value=n[1].side_roads[n[0]].properties.sa01),m=new Me({props:B}),ue.push(()=>de(m,"value",C)),v=new nt({props:{metric:n[4]}}),{c(){e=w("div"),r=w("button"),t=U("Done"),l=z(),i=w("button"),i.textContent="Delete side road",a=z(),k&&k.c(),s=z(),u=w("label"),c=U(`Name:
      `),d=w("input"),f=z(),M(m.$$.fragment),A=z(),O=w("p"),O.textContent=`${n[4].description}`,y=z(),M(v.$$.fragment),r.disabled=o=!n[2],P(d,"type","text"),P(e,"slot","sidebar")},m(E,K){h(E,e,K),g(e,r),g(r,t),g(e,l),g(e,i),g(e,a),k&&k.m(e,null),g(e,s),g(e,u),g(u,c),g(u,d),he(d,n[1].side_roads[n[0]].properties.name),g(e,f),T(m,e,null),g(e,A),g(e,O),g(e,y),T(v,e,null),N=!0,S||(j=[Q(r,"click",n[8]),Q(i,"click",n[6]),Q(d,"input",n[9])],S=!0)},p(E,K){(!N||K&4&&o!==(o=!E[2]))&&(r.disabled=o),E[2]?k&&(k.d(1),k=null):k||(k=In(),k.c(),k.m(e,s)),K&3&&d.value!==E[1].side_roads[E[0]].properties.name&&he(d,E[1].side_roads[E[0]].properties.name);const R={};K&2048&&(R.$$scope={dirty:K,ctx:E}),!p&&K&3&&(p=!0,R.value=E[1].side_roads[E[0]].properties.sa01,me(()=>p=!1)),m.$set(R)},i(E){N||(_(m.$$.fragment,E),_(v.$$.fragment,E),N=!0)},o(E){b(m.$$.fragment,E),b(v.$$.fragment,E),N=!1},d(E){E&&$(e),k&&k.d(),I(m),I(v),S=!1,$e(j)}}}function Fi(n){let e,r;return e=new Le({props:{paint:{"line-color":["case",["==",["id"],n[0]],["get","color"],"black"],"line-width":3}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&1&&(l.paint={"line-color":["case",["==",["id"],t[0]],["get","color"],"black"],"line-width":3}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function Pi(n){let e,r,t,o,l,i,a,s;r=new Ee({props:{except:"side_roads"}}),o=new _e({props:{data:re(n[1].side_roads),generateId:!0,$$slots:{default:[Fi]},$$scope:{ctx:n}}});function u(d){n[7](d)}let c={};return n[1].side_roads[n[0]]!==void 0&&(c.f=n[1].side_roads[n[0]]),i=new Un({props:c}),ue.push(()=>de(i,"f",u)),{c(){e=w("div"),M(r.$$.fragment),t=z(),M(o.$$.fragment),l=z(),M(i.$$.fragment),P(e,"slot","map")},m(d,f){h(d,e,f),T(r,e,null),g(e,t),T(o,e,null),g(e,l),T(i,e,null),s=!0},p(d,f){const m={};f&2&&(m.data=re(d[1].side_roads)),f&2049&&(m.$$scope={dirty:f,ctx:d}),o.$set(m);const p={};!a&&f&3&&(a=!0,p.f=d[1].side_roads[d[0]],me(()=>a=!1)),i.$set(p)},i(d){s||(_(r.$$.fragment,d),_(o.$$.fragment,d),_(i.$$.fragment,d),s=!0)},o(d){b(r.$$.fragment,d),b(o.$$.fragment,d),b(i.$$.fragment,d),s=!1},d(d){d&&$(e),I(r),I(o),I(i)}}}function Ui(n){let e,r,t,o;return e=new Te({props:{$$slots:{map:[Pi],sidebar:[qi]},$$scope:{ctx:n}}}),{c(){M(e.$$.fragment)},m(l,i){T(e,l,i),r=!0,t||(o=Q(Oi,"keydown",n[5]),t=!0)},p(l,[i]){const a={};i&2063&&(a.$$scope={dirty:i,ctx:l}),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){b(e.$$.fragment,l),r=!1},d(l){I(e,l),t=!1,o()}}}function Gi(n,e,r){let t,o,l;ee(n,G,p=>r(1,o=p)),ee(n,J,p=>r(3,l=p));let{idx:i}=e,a=Qe.SA01;function s(p){p.key=="Escape"&&H(J,l={kind:"neutral"},l)}async function u(){window.confirm("Really delete this side road?")&&(H(J,l={kind:"neutral"},l),await Ne(),o.side_roads.splice(i,1),G.set(o))}function c(p){n.$$.not_equal(o.side_roads[i],p)&&(o.side_roads[i]=p,G.set(o))}const d=()=>H(J,l={kind:"neutral"},l);function f(){o.side_roads[i].properties.name=this.value,G.set(o)}function m(p){n.$$.not_equal(o.side_roads[i].properties.sa01,p)&&(o.side_roads[i].properties.sa01=p,G.set(o))}return n.$$set=p=>{"idx"in p&&r(0,i=p.idx)},n.$$.update=()=>{n.$$.dirty&3&&r(2,t=o.side_roads[i].geometry.coordinates.length>=2)},[i,o,t,l,a,s,u,c,d,f,m]}class Qi extends ie{constructor(e){super(),se(this,e,Gi,Ui,le,{idx:0})}}function Hi(n){let e,r;return{c(){e=w("div"),r=w("div"),P(e,"slot","left")},m(t,o){h(t,e,o),g(e,r),n[9](r)},p:V,d(t){t&&$(e),n[9](null)}}}function Ji(n){return{c:V,m:V,p:V,i:V,o:V,d:V}}function Ri(n){let e,r,t;function o(i){n[8](i)}let l={style:n[10],standardControls:!0,hash:!0,images:[{id:"bus_stop",url:En,options:{sdf:!0}},{id:"crossing",url:On,options:{sdf:!0}}],$$slots:{default:[ns]},$$scope:{ctx:n}};return n[2]!==void 0&&(l.map=n[2]),e=new rr({props:l}),ue.push(()=>de(e,"map",o)),{c(){M(e.$$.fragment)},m(i,a){T(e,i,a),t=!0},p(i,a){const s={};a&2058&&(s.$$scope={dirty:a,ctx:i}),!r&&a&4&&(r=!0,s.map=i[2],me(()=>r=!1)),e.$set(s)},i(i){t||(_(e.$$.fragment,i),t=!0)},o(i){b(e.$$.fragment,i),t=!1},d(i){I(e,i)}}}function Ki(n){let e,r;return e=new Gl({props:{qIdx:n[3].idx}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.qIdx=t[3].idx),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function Xi(n){let e,r;return e=new Qi({props:{idx:n[3].idx}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.idx=t[3].idx),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function Zi(n){let e,r;return e=new Xr({props:{idx:n[3].idx}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.idx=t[3].idx),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function Yi(n){let e,r;return e=new Nr({props:{idx:n[3].idx}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.idx=t[3].idx),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function Vi(n){let e,r;return e=new pl({props:{junctionIdx:n[3].idx,stage:n[3].stage}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.junctionIdx=t[3].idx),o&8&&(l.stage=t[3].stage),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function Wi(n){let e,r;return e=new wl({props:{idx:n[3].idx}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.idx=t[3].idx),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function xi(n){let e,r;return e=new El({props:{idx:n[3].idx}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.idx=t[3].idx),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function es(n){let e,r;return e=new Ei({props:{obj:n[3].obj}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,o){const l={};o&8&&(l.obj=t[3].obj),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function ts(n){let e,r;return e=new zi({}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p:V,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function ns(n){let e,r,t,o,l,i;const a=[ts,es,xi,Wi,Vi,Yi,Zi,Xi,Ki],s=[];function u(c,d){return c[3].kind=="neutral"?0:c[3].kind=="new-point"?1:c[3].kind=="edit-link"?2:c[3].kind=="edit-jat"?3:c[3].kind=="edit-jat-detail"?4:c[3].kind=="edit-bus-stop"?5:c[3].kind=="edit-crossing"?6:c[3].kind=="edit-side-road"?7:c[3].kind=="edit-question"?8:-1}return~(t=u(n))&&(o=s[t]=a[t](n)),{c(){e=w("div"),r=z(),o&&o.c(),l=De()},m(c,d){h(c,e,d),n[7](e),h(c,r,d),~t&&s[t].m(c,d),h(c,l,d),i=!0},p(c,d){let f=t;t=u(c),t===f?~t&&s[t].p(c,d):(o&&(ae(),b(s[f],1,1,()=>{s[f]=null}),ce()),~t?(o=s[t],o?o.p(c,d):(o=s[t]=a[t](c),o.c()),_(o,1),o.m(l.parentNode,l)):o=null)},i(c){i||(_(o),i=!0)},o(c){b(o),i=!1},d(c){c&&($(e),$(r),$(l)),n[7](null),~t&&s[t].d(c)}}}function rs(n){return{c:V,m:V,p:V,i:V,o:V,d:V}}function os(n){let e,r,t={ctx:n,current:null,token:null,hasCatch:!1,pending:rs,then:Ri,catch:Ji,value:10,blocks:[,,,]};return or(Zr(new URLSearchParams(window.location.search).get("google")||""),t),{c(){e=w("div"),t.block.c(),P(e,"slot","main"),W(e,"position","relative"),W(e,"width","100%"),W(e,"height","100vh")},m(o,l){h(o,e,l),t.block.m(e,t.anchor=null),t.mount=()=>e,t.anchor=null,r=!0},p(o,l){n=o,lr(t,n,l)},i(o){r||(_(t.block),r=!0)},o(o){for(let l=0;l<3;l+=1){const i=t.blocks[l];b(i)}r=!1},d(o){o&&$(e),t.block.d(),t.token=null,t=null}}}function ls(n){let e,r;return e=new nr({props:{$$slots:{main:[os],left:[Hi]},$$scope:{ctx:n}}}),{c(){M(e.$$.fragment)},m(t,o){T(e,t,o),r=!0},p(t,[o]){const l={};o&2063&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){b(e.$$.fragment,t),r=!1},d(t){I(e,t)}}}function is(n,e,r){let t,o,l,i,a;ee(n,st,m=>r(4,t=m)),ee(n,it,m=>r(5,o=m)),ee(n,G,m=>r(6,l=m)),ee(n,at,m=>r(2,i=m)),ee(n,J,m=>r(3,a=m));let s,u;function c(m){ue[m?"unshift":"push"](()=>{u=m,r(1,u),r(4,t)})}function d(m){i=m,at.set(i)}function f(m){ue[m?"unshift":"push"](()=>{s=m,r(0,s),r(5,o)})}return n.$$.update=()=>{n.$$.dirty&64&&window.localStorage.setItem("tmp-rcv2",JSON.stringify(l)),n.$$.dirty&33&&s&&o&&(r(0,s.innerHTML="",s),s.appendChild(o)),n.$$.dirty&18&&u&&t&&(r(1,u.innerHTML="",u),u.appendChild(t))},[s,u,i,a,t,o,l,c,d,f]}class ss extends ie{constructor(e){super(),se(this,e,is,ls,le,{})}}new ss({target:document.getElementById("app")});
